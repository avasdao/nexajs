{"version":3,"file":"vendors-node_modules_theia_plugin-ext_lib_hosted_browser_hosted-plugin_js.js","mappings":"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;;;;;;;;ACvaD,gFAAgF;AAChF,+CAA+C;AAC/C,EAAE;AACF,2EAA2E;AAC3E,mEAAmE;AACnE,wCAAwC;AACxC,EAAE;AACF,4EAA4E;AAC5E,8EAA8E;AAC9E,6EAA6E;AAC7E,yDAAyD;AACzD,uDAAuD;AACvD,EAAE;AACF,gFAAgF;AAChF,gFAAgF;;;AAEnE,8BAAsB,GAAG,wBAAwB,CAAC;AAE/D,wEAAwE;AAC3D,0BAAkB,GAAG,MAAM,CAAC,oBAAoB,CAAC,CAAC;;;;;;;;;;;;ACnBlD;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D,cAAc,mBAAO,CAAC,iDAAO;AAC7B,kBAAkB,mBAAO,CAAC,+FAAa;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA,0DAA0D,oBAAoB;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,kBAAe;;;;;;;;;;;;ACvCF;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D,cAAc,mBAAO,CAAC,iDAAO;AAC7B,eAAe,mBAAO,CAAC,yFAAU;AACjC;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA,qDAAqD,kCAAkC;AACvF;AACA,SAAS;AACT;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,wCAAwC,0CAA0C,IAAI;AAC9I;AACA;AACA;AACA;AACA,uCAAuC,YAAY;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,YAAY;AACnD;AACA;AACA,0EAA0E,kBAAkB;AAC5F;AACA;AACA;AACA;AACA,CAAC;AACD,kBAAe;;;;;;;;;;;;AClHF;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D,kBAAkB,GAAG,wBAAwB,GAAG,iBAAiB;AACjE,iBAAiB;AACjB,wBAAwB;AACxB,kBAAkB;;;;;;;;;;;;ACLL;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D,kBAAkB,GAAG,mBAAmB,GAAG,iBAAiB,GAAG,aAAa;AAC5E,cAAc,mBAAO,CAAC,iDAAO;AAC7B,cAAc,mBAAO,CAAC,uFAAS;AAC/B,yCAAwC,EAAE,qCAAqC,2BAA2B,EAAC;AAC3G,kBAAkB,mBAAO,CAAC,+FAAa;AACvC,6CAA4C,EAAE,qCAAqC,+BAA+B,EAAC;AACnH,oBAAoB,mBAAO,CAAC,mGAAe;AAC3C,+CAA8C,EAAE,qCAAqC,qCAAqC,EAAC;AAC3H,mBAAmB,mBAAO,CAAC,iGAAc;AACzC,8CAA6C,EAAE,qCAAqC,mCAAmC,EAAC;AACxH,qBAAqB,mBAAO,CAAC,yFAAU;;;;;;;;;;;;ACZ1B;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D,kBAAkB;AAClB,eAAe,mBAAO,CAAC,yFAAU;AACjC,oBAAoB,mBAAO,CAAC,mGAAe;AAC3C;AACA;AACA,2CAA2C;AAC3C;AACA;AACA;AACA,kBAAkB;;;;;;;;;;;;ACXL;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D,mBAAmB;AACnB,cAAc,mBAAO,CAAC,iDAAO;AAC7B;AACA,eAAe,mBAAO,CAAC,yFAAU;AACjC;AACA;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA,4DAA4D;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa,IAAI;AACjB,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,8BAA8B;AACvE,aAAa;AACb,SAAS;AACT,gCAAgC,yBAAyB;AACzD,gCAAgC,yBAAyB;AACzD,qCAAqC,8BAA8B;AACnE;AACA;AACA,mBAAmB;;;;;;;;;;;;;ACrGnB,gFAAgF;AAChF,0CAA0C;AAC1C,EAAE;AACF,2EAA2E;AAC3E,mEAAmE;AACnE,wCAAwC;AACxC,EAAE;AACF,4EAA4E;AAC5E,8EAA8E;AAC9E,6EAA6E;AAC7E,yDAAyD;AACzD,uDAAuD;AACvD,EAAE;AACF,gFAAgF;AAChF,gFAAgF;;;;;;;;;;;;AAEhF,2HAA+B;AAC/B,qIAAoC;AACpC,mJAA2C;AAC3C,6JAAgD;AAChD,6JAAgD;AAChD,yIAAsC;;;;;;;;;;;;;;;;;;;ACrBwD;AAC9F,YAAyG;;AAEzG;;AAEA;AACA;;AAEA,aAAa,6FAAG,CAAC,sFAAO;;;;AAIxB,iEAAe,sFAAO,aAAa","sources":["webpack:///./node_modules/@theia/plugin-ext/src/main/browser/dialogs/style/modal-notification.css?./node_modules/css-loader/dist/cjs.js","webpack:///./node_modules/@theia/core/shared/@theia/request/index.js?","webpack:///./node_modules/@theia/editor-preview/src/browser/editor-preview-widget.ts?","webpack:///./node_modules/@theia/file-search/src/common/file-search-service.ts?","webpack:///./node_modules/@theia/monaco/src/browser/textmate/index.ts?","webpack:///./node_modules/@theia/notebook/src/browser/index.ts?","webpack:///./node_modules/@theia/plugin-ext/src/common/language-pack-service.ts?","webpack:///./node_modules/@theia/plugin-ext/src/hosted/browser/hosted-plugin-watcher.ts?","webpack:///./node_modules/@theia/plugin-ext/src/hosted/browser/hosted-plugin.ts?","webpack:///./node_modules/@theia/plugin-ext/src/hosted/browser/plugin-worker.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/authentication-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/clipboard-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/command-registry-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/comments/comments-context-key-service.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/comments/comments-contribution.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/comments/comments-decorator.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/comments/comments-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/comments/comments-service.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/custom-editors/custom-editor-service.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/custom-editors/custom-editors-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/custom-editors/plugin-custom-editor-registry.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/data-transfer/data-transfer-type-converters.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/debug/debug-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/debug/plugin-debug-adapter-contribution.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/debug/plugin-debug-configuration-provider.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/debug/plugin-debug-service.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/debug/plugin-debug-session-contribution-registry.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/debug/plugin-debug-session-factory.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/decorations/decorations-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/dialogs-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/dialogs/modal-notification.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/editors-and-documents-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/env-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/file-system-main-impl.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/keybindings/keybindings-contribution-handler.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/label-service-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/languages-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/localization-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/main-context.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/main-file-system-event-service.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/menus/menus-contribution-handler.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/menus/plugin-menu-command-adapter.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/message-registry-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/notebooks/notebook-documents-and-editors-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/notebooks/notebook-documents-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/notebooks/notebook-dto.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/notebooks/notebook-editors-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/notebooks/notebook-kernels-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/notebooks/notebook-renderers-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/notebooks/notebooks-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/notification-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/plugin-contribution-handler.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/plugin-icon-service.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/plugin-icon-theme-service.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/plugin-storage.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/plugin-terminal-registry.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/preference-registry-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/quick-open-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/scm-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/secrets-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/status-bar-message-registry-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/tabs/tabs-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/tasks-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/terminal-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/test-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/text-editor-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/text-editor-model-service.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/text-editors-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/theming-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/timeline-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/view-column-service.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/view/plugin-view-registry.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/view/plugin-view-widget.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/view/tree-views-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/view/view-context-key-service.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/webview-views/webview-views-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/webviews-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/window-state-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/workspace-main.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/common/plugin-paths-protocol.ts?","webpack:///./node_modules/@theia/plugin-ext/node_modules/async-mutex/lib/Mutex.js?","webpack:///./node_modules/@theia/plugin-ext/node_modules/async-mutex/lib/Semaphore.js?","webpack:///./node_modules/@theia/plugin-ext/node_modules/async-mutex/lib/errors.js?","webpack:///./node_modules/@theia/plugin-ext/node_modules/async-mutex/lib/index.js?","webpack:///./node_modules/@theia/plugin-ext/node_modules/async-mutex/lib/tryAcquire.js?","webpack:///./node_modules/@theia/plugin-ext/node_modules/async-mutex/lib/withTimeout.js?","webpack:///./node_modules/@theia/task/src/browser/index.ts?","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/dialogs/style/modal-notification.css?"],"sourcesContent":["// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../../../../css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/********************************************************************************\n * Copyright (C) 2018 Red Hat, Inc. and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n ********************************************************************************/\n.modal-Notification {\n  pointer-events: all;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  display: flex;\n  flex-direction: row;\n  -webkit-justify-content: center;\n  justify-content: center;\n  clear: both;\n  box-sizing: border-box;\n  position: relative;\n  min-width: 200px;\n  max-width: min(66vw, 800px);\n  background-color: var(--theia-editorWidget-background);\n  min-height: 35px;\n  margin-bottom: 1px;\n  color: var(--theia-editorWidget-foreground);\n}\n\n.modal-Notification .icon {\n  display: inline-block;\n  font-size: 20px;\n  padding: 5px 0;\n  width: 35px;\n  order: 1;\n}\n\n.modal-Notification .icon .codicon {\n  line-height: inherit;\n  vertical-align: middle;\n  font-size: calc(var(--theia-ui-padding) * 5);\n  color: var(--theia-editorInfo-foreground);\n}\n\n.modal-Notification .icon .error {\n  color: var(--theia-editorError-foreground);\n}\n\n.modal-Notification .icon .warning {\n  color: var(--theia-editorWarning-foreground);\n}\n\n.modal-Notification .text {\n  order: 2;\n  display: inline-block;\n  max-height: min(66vh, 600px);\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  -ms-user-select: text;\n  user-select: text;\n  align-self: center;\n  flex: 1 100%;\n  padding: 10px;\n  overflow: auto;\n  white-space: pre-wrap;\n}\n\n.modal-Notification .text > p {\n  margin: 0;\n  font-size: var(--theia-ui-font-size1);\n  font-family: var(--theia-ui-font-family);\n  vertical-align: middle;\n}\n\n.modal-Notification .buttons {\n  display: flex;\n  flex-direction: row;\n  order: 3;\n  white-space: nowrap;\n  align-self: flex-end;\n  height: 40px;\n}\n\n.modal-Notification .buttons > button {\n  background-color: var(--theia-button-background);\n  color: var(--theia-button-foreground);\n  border: none;\n  border-radius: 0;\n  text-align: center;\n  text-decoration: none;\n  display: inline-block;\n  padding: 0 10px;\n  margin: 0;\n  font-size: var(--theia-ui-font-size1);\n  outline: none;\n  cursor: pointer;\n}\n\n.modal-Notification .buttons > button:hover {\n  background-color: var(--theia-button-hoverBackground);\n}\n\n.modal-Notification .detail {\n  align-self: center;\n  order: 3;\n  flex: 1 100%;\n  color: var(--theia-descriptionForeground);\n}\n\n.modal-Notification .detail > p {\n  margin: calc(var(--theia-ui-padding) * 2) 0px 0px 0px;\n}\n\n.modal-Notification .text {\n  padding: calc(var(--theia-ui-padding) * 1.5);\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./node_modules/@theia/plugin-ext/src/main/browser/dialogs/style/modal-notification.css\"],\"names\":[],\"mappings\":\"AAAA;;;;;;;;;;;;;;iFAciF;AACjF;EACE,mBAAmB;EACnB,yBAAyB;EACzB,sBAAsB;EACtB,qBAAqB;EACrB,iBAAiB;EACjB,aAAa;EACb,mBAAmB;EACnB,+BAA+B;EAC/B,uBAAuB;EACvB,WAAW;EACX,sBAAsB;EACtB,kBAAkB;EAClB,gBAAgB;EAChB,2BAA2B;EAC3B,sDAAsD;EACtD,gBAAgB;EAChB,kBAAkB;EAClB,2CAA2C;AAC7C;;AAEA;EACE,qBAAqB;EACrB,eAAe;EACf,cAAc;EACd,WAAW;EACX,QAAQ;AACV;;AAEA;EACE,oBAAoB;EACpB,sBAAsB;EACtB,4CAA4C;EAC5C,yCAAyC;AAC3C;;AAEA;EACE,0CAA0C;AAC5C;;AAEA;EACE,4CAA4C;AAC9C;;AAEA;EACE,QAAQ;EACR,qBAAqB;EACrB,4BAA4B;EAC5B,yBAAyB;EACzB,sBAAsB;EACtB,qBAAqB;EACrB,iBAAiB;EACjB,kBAAkB;EAClB,YAAY;EACZ,aAAa;EACb,cAAc;EACd,qBAAqB;AACvB;;AAEA;EACE,SAAS;EACT,qCAAqC;EACrC,wCAAwC;EACxC,sBAAsB;AACxB;;AAEA;EACE,aAAa;EACb,mBAAmB;EACnB,QAAQ;EACR,mBAAmB;EACnB,oBAAoB;EACpB,YAAY;AACd;;AAEA;EACE,gDAAgD;EAChD,qCAAqC;EACrC,YAAY;EACZ,gBAAgB;EAChB,kBAAkB;EAClB,qBAAqB;EACrB,qBAAqB;EACrB,eAAe;EACf,SAAS;EACT,qCAAqC;EACrC,aAAa;EACb,eAAe;AACjB;;AAEA;EACE,qDAAqD;AACvD;;AAEA;EACE,kBAAkB;EAClB,QAAQ;EACR,YAAY;EACZ,yCAAyC;AAC3C;;AAEA;EACE,qDAAqD;AACvD;;AAEA;EACE,4CAA4C;AAC9C\",\"sourcesContent\":[\"/********************************************************************************\\n * Copyright (C) 2018 Red Hat, Inc. and others.\\n *\\n * This program and the accompanying materials are made available under the\\n * terms of the Eclipse Public License v. 2.0 which is available at\\n * http://www.eclipse.org/legal/epl-2.0.\\n *\\n * This Source Code may also be made available under the following Secondary\\n * Licenses when the conditions for such availability set forth in the Eclipse\\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\\n * with the GNU Classpath Exception which is available at\\n * https://www.gnu.org/software/classpath/license.html.\\n *\\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\\n ********************************************************************************/\\n.modal-Notification {\\n  pointer-events: all;\\n  -webkit-user-select: none;\\n  -moz-user-select: none;\\n  -ms-user-select: none;\\n  user-select: none;\\n  display: flex;\\n  flex-direction: row;\\n  -webkit-justify-content: center;\\n  justify-content: center;\\n  clear: both;\\n  box-sizing: border-box;\\n  position: relative;\\n  min-width: 200px;\\n  max-width: min(66vw, 800px);\\n  background-color: var(--theia-editorWidget-background);\\n  min-height: 35px;\\n  margin-bottom: 1px;\\n  color: var(--theia-editorWidget-foreground);\\n}\\n\\n.modal-Notification .icon {\\n  display: inline-block;\\n  font-size: 20px;\\n  padding: 5px 0;\\n  width: 35px;\\n  order: 1;\\n}\\n\\n.modal-Notification .icon .codicon {\\n  line-height: inherit;\\n  vertical-align: middle;\\n  font-size: calc(var(--theia-ui-padding) * 5);\\n  color: var(--theia-editorInfo-foreground);\\n}\\n\\n.modal-Notification .icon .error {\\n  color: var(--theia-editorError-foreground);\\n}\\n\\n.modal-Notification .icon .warning {\\n  color: var(--theia-editorWarning-foreground);\\n}\\n\\n.modal-Notification .text {\\n  order: 2;\\n  display: inline-block;\\n  max-height: min(66vh, 600px);\\n  -webkit-user-select: text;\\n  -moz-user-select: text;\\n  -ms-user-select: text;\\n  user-select: text;\\n  align-self: center;\\n  flex: 1 100%;\\n  padding: 10px;\\n  overflow: auto;\\n  white-space: pre-wrap;\\n}\\n\\n.modal-Notification .text > p {\\n  margin: 0;\\n  font-size: var(--theia-ui-font-size1);\\n  font-family: var(--theia-ui-font-family);\\n  vertical-align: middle;\\n}\\n\\n.modal-Notification .buttons {\\n  display: flex;\\n  flex-direction: row;\\n  order: 3;\\n  white-space: nowrap;\\n  align-self: flex-end;\\n  height: 40px;\\n}\\n\\n.modal-Notification .buttons > button {\\n  background-color: var(--theia-button-background);\\n  color: var(--theia-button-foreground);\\n  border: none;\\n  border-radius: 0;\\n  text-align: center;\\n  text-decoration: none;\\n  display: inline-block;\\n  padding: 0 10px;\\n  margin: 0;\\n  font-size: var(--theia-ui-font-size1);\\n  outline: none;\\n  cursor: pointer;\\n}\\n\\n.modal-Notification .buttons > button:hover {\\n  background-color: var(--theia-button-hoverBackground);\\n}\\n\\n.modal-Notification .detail {\\n  align-self: center;\\n  order: 3;\\n  flex: 1 100%;\\n  color: var(--theia-descriptionForeground);\\n}\\n\\n.modal-Notification .detail > p {\\n  margin: calc(var(--theia-ui-padding) * 2) 0px 0px 0px;\\n}\\n\\n.modal-Notification .text {\\n  padding: calc(var(--theia-ui-padding) * 1.5);\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","module.exports = require('@theia/request');\n","// *****************************************************************************\n// Copyright (C) 2021 Ericsson and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { TabBar, Widget, PINNED_CLASS } from '@theia/core/lib/browser';\nimport { EditorWidget, TextEditor } from '@theia/editor/lib/browser';\nimport { Disposable, DisposableCollection, Emitter, SelectionService, UNTITLED_SCHEME } from '@theia/core/lib/common';\n\nconst PREVIEW_TITLE_CLASS = 'theia-editor-preview-title-unpinned';\nexport class EditorPreviewWidget extends EditorWidget {\n    protected _isPreview = false;\n\n    protected readonly onDidChangePreviewStateEmitter = new Emitter<void>();\n    readonly onDidChangePreviewState = this.onDidChangePreviewStateEmitter.event;\n\n    get isPreview(): boolean {\n        return this._isPreview;\n    }\n\n    constructor(\n        editor: TextEditor,\n        selectionService: SelectionService\n    ) {\n        super(editor, selectionService);\n        this.toDispose.push(this.onDidChangePreviewStateEmitter);\n    }\n\n    initializePreview(): void {\n        const oneTimeListeners = new DisposableCollection();\n        this._isPreview = true;\n        this.title.className += ` ${PREVIEW_TITLE_CLASS}`;\n        const oneTimeDirtyChangeListener = this.saveable.onDirtyChanged(() => {\n            this.convertToNonPreview();\n            oneTimeListeners.dispose();\n        });\n        oneTimeListeners.push(oneTimeDirtyChangeListener);\n        const oneTimeTitleChangeHandler = () => {\n            if (this.title.className.includes(PINNED_CLASS)) {\n                this.convertToNonPreview();\n                oneTimeListeners.dispose();\n            }\n        };\n        this.title.changed.connect(oneTimeTitleChangeHandler);\n        oneTimeListeners.push(Disposable.create(() => this.title.changed.disconnect(oneTimeTitleChangeHandler)));\n        this.toDispose.push(oneTimeListeners);\n    }\n\n    convertToNonPreview(): void {\n        if (this._isPreview) {\n            this._isPreview = false;\n            this.currentTabbar = undefined;\n            this.title.className = this.title.className.replace(PREVIEW_TITLE_CLASS, '');\n            this.onDidChangePreviewStateEmitter.fire();\n            this.onDidChangePreviewStateEmitter.dispose();\n        }\n    }\n\n    protected override handleTabBarChange(oldTabBar?: TabBar<Widget> | undefined, newTabBar?: TabBar<Widget> | undefined): void {\n        super.handleTabBarChange(oldTabBar, newTabBar);\n        if (this._isPreview) {\n            if (oldTabBar && newTabBar) { this.convertToNonPreview(); }\n        }\n    }\n\n    override storeState(): { isPreview: boolean, editorState: object } | undefined {\n        if (this.getResourceUri()?.scheme !== UNTITLED_SCHEME) {\n            const { _isPreview: isPreview } = this;\n            return { isPreview, editorState: this.editor.storeViewState() };\n        }\n    }\n\n    override restoreState(oldState: { isPreview: boolean, editorState: object }): void {\n        if (!oldState.isPreview) {\n            this.convertToNonPreview();\n        }\n        this.editor.restoreViewState(oldState.editorState);\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2017 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { CancellationToken } from '@theia/core';\n\nexport const fileSearchServicePath = '/services/search';\n\n/**\n * The JSON-RPC file search service interface.\n */\nexport interface FileSearchService {\n\n    /**\n     * finds files by a given search pattern.\n     * @return the matching file uris\n     */\n    find(searchPattern: string, options: FileSearchService.Options, cancellationToken?: CancellationToken): Promise<string[]>;\n\n}\n\nexport const FileSearchService = Symbol('FileSearchService');\nexport namespace FileSearchService {\n    export interface BaseOptions {\n        useGitIgnore?: boolean\n        includePatterns?: string[]\n        excludePatterns?: string[]\n    }\n    export interface RootOptions {\n        [rootUri: string]: BaseOptions\n    }\n    export interface Options extends BaseOptions {\n        rootUris?: string[]\n        rootOptions?: RootOptions\n        fuzzyMatch?: boolean\n        limit?: number\n    }\n}\n\nexport const WHITESPACE_QUERY_SEPARATOR = /\\s+/;\n","// *****************************************************************************\n// Copyright (C) 2018 Ericsson and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nexport * from './textmate-registry';\nexport * from './textmate-contribution';\nexport * from './monaco-textmate-service';\nexport * from './monaco-textmate-frontend-bindings';\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nexport * from './notebook-type-registry';\nexport * from './notebook-renderer-registry';\nexport * from './notebook-editor-widget';\nexport * from './service/notebook-service';\nexport * from './service/notebook-editor-widget-service';\nexport * from './service/notebook-kernel-service';\nexport * from './service/notebook-execution-state-service';\nexport * from './service/notebook-model-resolver-service';\nexport * from './service/notebook-renderer-messaging-service';\nexport * from './renderers/cell-output-webview';\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\n/**\n * Starting with vscode 1.73.0, language pack bundles have changed their shape to accommodate the new `l10n` API.\n * They are now a record of { [englishValue]: translation }\n */\nexport interface LanguagePackBundle {\n    contents: Record<string, string>\n    uri: string\n}\n\nexport const languagePackServicePath = '/services/languagePackService';\n\nexport const LanguagePackService = Symbol('LanguagePackService');\n\nexport interface LanguagePackService {\n    storeBundle(pluginId: string, locale: string, bundle: LanguagePackBundle): void;\n    deleteBundle(pluginId: string, locale?: string): void;\n    getBundle(pluginId: string, locale: string): Promise<LanguagePackBundle | undefined>;\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { injectable } from '@theia/core/shared/inversify';\nimport { Emitter, Event } from '@theia/core/lib/common/event';\nimport { HostedPluginClient } from '../../common/plugin-protocol';\nimport { LogPart } from '../../common/types';\n\n@injectable()\nexport class HostedPluginWatcher {\n    private onPostMessage = new Emitter<{ pluginHostId: string, message: Uint8Array }>();\n\n    private onLogMessage = new Emitter<LogPart>();\n\n    private readonly onDidDeployEmitter = new Emitter<void>();\n    readonly onDidDeploy = this.onDidDeployEmitter.event;\n\n    getHostedPluginClient(): HostedPluginClient {\n        const messageEmitter = this.onPostMessage;\n        const logEmitter = this.onLogMessage;\n        return {\n            postMessage(pluginHostId, message: Uint8Array): Promise<void> {\n                messageEmitter.fire({ pluginHostId, message });\n                return Promise.resolve();\n            },\n            log(logPart: LogPart): Promise<void> {\n                logEmitter.fire(logPart);\n                return Promise.resolve();\n            },\n            onDidDeploy: () => this.onDidDeployEmitter.fire(undefined)\n        };\n    }\n\n    get onPostMessageEvent(): Event<{ pluginHostId: string, message: Uint8Array }> {\n        return this.onPostMessage.event;\n    }\n\n    get onLogMessageEvent(): Event<LogPart> {\n        return this.onLogMessage.event;\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n// some code copied and modified from https://github.com/microsoft/vscode/blob/da5fb7d5b865aa522abc7e82c10b746834b98639/src/vs/workbench/api/node/extHostExtensionService.ts\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport debounce = require('@theia/core/shared/lodash.debounce');\nimport { UUID } from '@theia/core/shared/@phosphor/coreutils';\nimport { injectable, inject, interfaces, named, postConstruct } from '@theia/core/shared/inversify';\nimport { PluginWorker } from './plugin-worker';\nimport { PluginMetadata, getPluginId, HostedPluginServer, DeployedPlugin, PluginServer, PluginIdentifiers } from '../../common/plugin-protocol';\nimport { HostedPluginWatcher } from './hosted-plugin-watcher';\nimport { MAIN_RPC_CONTEXT, PluginManagerExt, ConfigStorage, UIKind } from '../../common/plugin-api-rpc';\nimport { setUpPluginApi } from '../../main/browser/main-context';\nimport { RPCProtocol, RPCProtocolImpl } from '../../common/rpc-protocol';\nimport {\n    Disposable, DisposableCollection, Emitter, isCancelled,\n    ILogger, ContributionProvider, CommandRegistry, WillExecuteCommandEvent,\n    CancellationTokenSource, RpcProxy, ProgressService, nls\n} from '@theia/core';\nimport { PreferenceServiceImpl, PreferenceProviderProvider } from '@theia/core/lib/browser/preferences';\nimport { WorkspaceService } from '@theia/workspace/lib/browser';\nimport { PluginContributionHandler } from '../../main/browser/plugin-contribution-handler';\nimport { getQueryParameters } from '../../main/browser/env-main';\nimport { MainPluginApiProvider } from '../../common/plugin-ext-api-contribution';\nimport { PluginPathsService } from '../../main/common/plugin-paths-protocol';\nimport { getPreferences } from '../../main/browser/preference-registry-main';\nimport { Deferred } from '@theia/core/lib/common/promise-util';\nimport { DebugSessionManager } from '@theia/debug/lib/browser/debug-session-manager';\nimport { DebugConfigurationManager } from '@theia/debug/lib/browser/debug-configuration-manager';\nimport { WaitUntilEvent } from '@theia/core/lib/common/event';\nimport { FileSearchService } from '@theia/file-search/lib/common/file-search-service';\nimport { FrontendApplicationStateService } from '@theia/core/lib/browser/frontend-application-state';\nimport { PluginViewRegistry } from '../../main/browser/view/plugin-view-registry';\nimport { WillResolveTaskProvider, TaskProviderRegistry, TaskResolverRegistry } from '@theia/task/lib/browser/task-contribution';\nimport { TaskDefinitionRegistry } from '@theia/task/lib/browser/task-definition-registry';\nimport { WebviewEnvironment } from '../../main/browser/webview/webview-environment';\nimport { WebviewWidget } from '../../main/browser/webview/webview';\nimport { WidgetManager } from '@theia/core/lib/browser/widget-manager';\nimport { TerminalService } from '@theia/terminal/lib/browser/base/terminal-service';\nimport { EnvVariablesServer } from '@theia/core/lib/common/env-variables';\nimport URI from '@theia/core/lib/common/uri';\nimport { FrontendApplicationConfigProvider } from '@theia/core/lib/browser/frontend-application-config-provider';\nimport { environment } from '@theia/core/shared/@theia/application-package/lib/environment';\nimport { JsonSchemaStore } from '@theia/core/lib/browser/json-schema-store';\nimport { FileService, FileSystemProviderActivationEvent } from '@theia/filesystem/lib/browser/file-service';\nimport { PluginCustomEditorRegistry } from '../../main/browser/custom-editors/plugin-custom-editor-registry';\nimport { CustomEditorWidget } from '../../main/browser/custom-editors/custom-editor-widget';\nimport { StandaloneServices } from '@theia/monaco-editor-core/esm/vs/editor/standalone/browser/standaloneServices';\nimport { ILanguageService } from '@theia/monaco-editor-core/esm/vs/editor/common/languages/language';\nimport { LanguageService } from '@theia/monaco-editor-core/esm/vs/editor/common/services/languageService';\nimport { Measurement, Stopwatch } from '@theia/core/lib/common';\nimport { Uint8ArrayReadBuffer, Uint8ArrayWriteBuffer } from '@theia/core/lib/common/message-rpc/uint8-array-message-buffer';\nimport { BasicChannel } from '@theia/core/lib/common/message-rpc/channel';\nimport { NotebookTypeRegistry, NotebookService, NotebookRendererMessagingService } from '@theia/notebook/lib/browser';\n\nexport type PluginHost = 'frontend' | string;\nexport type DebugActivationEvent = 'onDebugResolve' | 'onDebugInitialConfigurations' | 'onDebugAdapterProtocolTracker' | 'onDebugDynamicConfigurations';\n\nexport const PluginProgressLocation = 'plugin';\nexport const ALL_ACTIVATION_EVENT = '*';\n\n@injectable()\nexport class HostedPluginSupport {\n\n    protected readonly clientId = UUID.uuid4();\n\n    protected container: interfaces.Container;\n\n    @inject(ILogger)\n    protected readonly logger: ILogger;\n\n    @inject(HostedPluginServer)\n    protected readonly server: RpcProxy<HostedPluginServer>;\n\n    @inject(HostedPluginWatcher)\n    protected readonly watcher: HostedPluginWatcher;\n\n    @inject(PluginContributionHandler)\n    protected readonly contributionHandler: PluginContributionHandler;\n\n    @inject(ContributionProvider)\n    @named(MainPluginApiProvider)\n    protected readonly mainPluginApiProviders: ContributionProvider<MainPluginApiProvider>;\n\n    @inject(PluginServer)\n    protected readonly pluginServer: PluginServer;\n\n    @inject(PreferenceProviderProvider)\n    protected readonly preferenceProviderProvider: PreferenceProviderProvider;\n\n    @inject(PreferenceServiceImpl)\n    protected readonly preferenceServiceImpl: PreferenceServiceImpl;\n\n    @inject(PluginPathsService)\n    protected readonly pluginPathsService: PluginPathsService;\n\n    @inject(WorkspaceService)\n    protected readonly workspaceService: WorkspaceService;\n\n    @inject(NotebookService)\n    protected readonly notebookService: NotebookService;\n\n    @inject(NotebookRendererMessagingService)\n    protected readonly notebookRendererMessagingService: NotebookRendererMessagingService;\n\n    @inject(CommandRegistry)\n    protected readonly commands: CommandRegistry;\n\n    @inject(DebugSessionManager)\n    protected readonly debugSessionManager: DebugSessionManager;\n\n    @inject(DebugConfigurationManager)\n    protected readonly debugConfigurationManager: DebugConfigurationManager;\n\n    @inject(FileService)\n    protected readonly fileService: FileService;\n\n    @inject(FileSearchService)\n    protected readonly fileSearchService: FileSearchService;\n\n    @inject(FrontendApplicationStateService)\n    protected readonly appState: FrontendApplicationStateService;\n\n    @inject(NotebookTypeRegistry)\n    protected readonly notebookTypeRegistry: NotebookTypeRegistry;\n\n    @inject(PluginViewRegistry)\n    protected readonly viewRegistry: PluginViewRegistry;\n\n    @inject(TaskProviderRegistry)\n    protected readonly taskProviderRegistry: TaskProviderRegistry;\n\n    @inject(TaskResolverRegistry)\n    protected readonly taskResolverRegistry: TaskResolverRegistry;\n\n    @inject(TaskDefinitionRegistry)\n    protected readonly taskDefinitionRegistry: TaskDefinitionRegistry;\n\n    @inject(ProgressService)\n    protected readonly progressService: ProgressService;\n\n    @inject(WebviewEnvironment)\n    protected readonly webviewEnvironment: WebviewEnvironment;\n\n    @inject(WidgetManager)\n    protected readonly widgets: WidgetManager;\n\n    @inject(TerminalService)\n    protected readonly terminalService: TerminalService;\n\n    @inject(EnvVariablesServer)\n    protected readonly envServer: EnvVariablesServer;\n\n    @inject(JsonSchemaStore)\n    protected readonly jsonSchemaStore: JsonSchemaStore;\n\n    @inject(PluginCustomEditorRegistry)\n    protected readonly customEditorRegistry: PluginCustomEditorRegistry;\n\n    @inject(Stopwatch)\n    protected readonly stopwatch: Stopwatch;\n\n    protected theiaReadyPromise: Promise<any>;\n\n    protected readonly managers = new Map<string, PluginManagerExt>();\n\n    protected readonly contributions = new Map<PluginIdentifiers.UnversionedId, PluginContributions>();\n\n    protected readonly activationEvents = new Set<string>();\n\n    protected readonly onDidChangePluginsEmitter = new Emitter<void>();\n    readonly onDidChangePlugins = this.onDidChangePluginsEmitter.event;\n\n    protected readonly deferredWillStart = new Deferred<void>();\n    /**\n     * Resolves when the initial plugins are loaded and about to be started.\n     */\n    get willStart(): Promise<void> {\n        return this.deferredWillStart.promise;\n    }\n\n    protected readonly deferredDidStart = new Deferred<void>();\n    /**\n     * Resolves when the initial plugins are started.\n     */\n    get didStart(): Promise<void> {\n        return this.deferredDidStart.promise;\n    }\n\n    @postConstruct()\n    protected init(): void {\n        this.theiaReadyPromise = Promise.all([this.preferenceServiceImpl.ready, this.workspaceService.roots]);\n        this.workspaceService.onWorkspaceChanged(() => this.updateStoragePath());\n\n        const languageService = (StandaloneServices.get(ILanguageService) as LanguageService);\n        for (const language of languageService['_encounteredLanguages'] as Set<string>) {\n            this.activateByLanguage(language);\n        }\n        languageService.onDidEncounterLanguage(language => this.activateByLanguage(language));\n        this.commands.onWillExecuteCommand(event => this.ensureCommandHandlerRegistration(event));\n        this.debugSessionManager.onWillStartDebugSession(event => this.ensureDebugActivation(event));\n        this.debugSessionManager.onWillResolveDebugConfiguration(event => this.ensureDebugActivation(event, 'onDebugResolve', event.debugType));\n        this.debugConfigurationManager.onWillProvideDebugConfiguration(event => this.ensureDebugActivation(event, 'onDebugInitialConfigurations'));\n        // Activate all providers of dynamic configurations, i.e. Let the user pick a configuration from all the available ones.\n        this.debugConfigurationManager.onWillProvideDynamicDebugConfiguration(event => this.ensureDebugActivation(event, 'onDebugDynamicConfigurations', ALL_ACTIVATION_EVENT));\n        this.viewRegistry.onDidExpandView(id => this.activateByView(id));\n        this.taskProviderRegistry.onWillProvideTaskProvider(event => this.ensureTaskActivation(event));\n        this.taskResolverRegistry.onWillProvideTaskResolver(event => this.ensureTaskActivation(event));\n        this.fileService.onWillActivateFileSystemProvider(event => this.ensureFileSystemActivation(event));\n        this.customEditorRegistry.onWillOpenCustomEditor(event => this.activateByCustomEditor(event));\n        this.notebookService.onWillOpenNotebook(async event => this.activateByNotebook(event));\n        this.notebookRendererMessagingService.onWillActivateRenderer(rendererId => this.activateByNotebookRenderer(rendererId));\n\n        this.widgets.onDidCreateWidget(({ factoryId, widget }) => {\n            if ((factoryId === WebviewWidget.FACTORY_ID || factoryId === CustomEditorWidget.FACTORY_ID) && widget instanceof WebviewWidget) {\n                const storeState = widget.storeState.bind(widget);\n                const restoreState = widget.restoreState.bind(widget);\n\n                widget.storeState = () => {\n                    if (this.webviewRevivers.has(widget.viewType)) {\n                        return storeState();\n                    }\n                    return undefined;\n                };\n\n                widget.restoreState = state => {\n                    if (state.viewType) {\n                        restoreState(state);\n                        this.preserveWebview(widget);\n                    } else {\n                        widget.dispose();\n                    }\n                };\n            }\n        });\n    }\n\n    get plugins(): PluginMetadata[] {\n        const plugins: PluginMetadata[] = [];\n        this.contributions.forEach(contributions => plugins.push(contributions.plugin.metadata));\n        return plugins;\n    }\n\n    getPlugin(id: PluginIdentifiers.UnversionedId): DeployedPlugin | undefined {\n        const contributions = this.contributions.get(id);\n        return contributions && contributions.plugin;\n    }\n\n    /** do not call it, except from the plugin frontend contribution */\n    onStart(container: interfaces.Container): void {\n        this.container = container;\n        this.load();\n        this.watcher.onDidDeploy(() => this.load());\n        this.server.onDidOpenConnection(() => this.load());\n    }\n\n    protected loadQueue: Promise<void> = Promise.resolve(undefined);\n    load = debounce(() => this.loadQueue = this.loadQueue.then(async () => {\n        try {\n            await this.progressService.withProgress('', PluginProgressLocation, () => this.doLoad());\n        } catch (e) {\n            console.error('Failed to load plugins:', e);\n        }\n    }), 50, { leading: true });\n\n    protected async doLoad(): Promise<void> {\n        const toDisconnect = new DisposableCollection(Disposable.create(() => { /* mark as connected */ }));\n        toDisconnect.push(Disposable.create(() => this.preserveWebviews()));\n        this.server.onDidCloseConnection(() => toDisconnect.dispose());\n\n        // process empty plugins as well in order to properly remove stale plugin widgets\n        await this.syncPlugins();\n\n        // it has to be resolved before awaiting layout is initialized\n        // otherwise clients can hang forever in the initialization phase\n        this.deferredWillStart.resolve();\n\n        // make sure that the previous state, including plugin widgets, is restored\n        // and core layout is initialized, i.e. explorer, scm, debug views are already added to the shell\n        // but shell is not yet revealed\n        await this.appState.reachedState('initialized_layout');\n\n        if (toDisconnect.disposed) {\n            // if disconnected then don't try to load plugin contributions\n            return;\n        }\n        const contributionsByHost = this.loadContributions(toDisconnect);\n\n        await this.viewRegistry.initWidgets();\n        // remove restored plugin widgets which were not registered by contributions\n        this.viewRegistry.removeStaleWidgets();\n        await this.theiaReadyPromise;\n\n        if (toDisconnect.disposed) {\n            // if disconnected then don't try to init plugin code and dynamic contributions\n            return;\n        }\n        await this.startPlugins(contributionsByHost, toDisconnect);\n\n        this.deferredDidStart.resolve();\n    }\n\n    /**\n     * Sync loaded and deployed plugins:\n     * - undeployed plugins are unloaded\n     * - newly deployed plugins are initialized\n     */\n    protected async syncPlugins(): Promise<void> {\n        let initialized = 0;\n        const waitPluginsMeasurement = this.measure('waitForDeployment');\n        let syncPluginsMeasurement: Measurement | undefined;\n\n        const toUnload = new Set(this.contributions.keys());\n        let didChangeInstallationStatus = false;\n        try {\n            const newPluginIds: PluginIdentifiers.VersionedId[] = [];\n            const [deployedPluginIds, uninstalledPluginIds] = await Promise.all([this.server.getDeployedPluginIds(), this.server.getUninstalledPluginIds()]);\n            waitPluginsMeasurement.log('Waiting for backend deployment');\n            syncPluginsMeasurement = this.measure('syncPlugins');\n            for (const versionedId of deployedPluginIds) {\n                const unversionedId = PluginIdentifiers.unversionedFromVersioned(versionedId);\n                toUnload.delete(unversionedId);\n                if (!this.contributions.has(unversionedId)) {\n                    newPluginIds.push(versionedId);\n                }\n            }\n            for (const pluginId of toUnload) {\n                this.contributions.get(pluginId)?.dispose();\n            }\n            for (const versionedId of uninstalledPluginIds) {\n                const plugin = this.getPlugin(PluginIdentifiers.unversionedFromVersioned(versionedId));\n                if (plugin && PluginIdentifiers.componentsToVersionedId(plugin.metadata.model) === versionedId && !plugin.metadata.outOfSync) {\n                    plugin.metadata.outOfSync = didChangeInstallationStatus = true;\n                }\n            }\n            for (const contribution of this.contributions.values()) {\n                if (contribution.plugin.metadata.outOfSync && !uninstalledPluginIds.includes(PluginIdentifiers.componentsToVersionedId(contribution.plugin.metadata.model))) {\n                    contribution.plugin.metadata.outOfSync = false;\n                    didChangeInstallationStatus = true;\n                }\n            }\n            if (newPluginIds.length) {\n                const plugins = await this.server.getDeployedPlugins({ pluginIds: newPluginIds });\n                for (const plugin of plugins) {\n                    const pluginId = PluginIdentifiers.componentsToUnversionedId(plugin.metadata.model);\n                    const contributions = new PluginContributions(plugin);\n                    this.contributions.set(pluginId, contributions);\n                    contributions.push(Disposable.create(() => this.contributions.delete(pluginId)));\n                    initialized++;\n                }\n            }\n        } finally {\n            if (initialized || toUnload.size || didChangeInstallationStatus) {\n                this.onDidChangePluginsEmitter.fire(undefined);\n            }\n\n            if (!syncPluginsMeasurement) {\n                // await didn't complete normally\n                waitPluginsMeasurement.error('Backend deployment failed.');\n            }\n        }\n\n        syncPluginsMeasurement?.log(`Sync of ${this.getPluginCount(initialized)}`);\n    }\n\n    /**\n     * Always synchronous in order to simplify handling disconnections.\n     * @throws never\n     */\n    protected loadContributions(toDisconnect: DisposableCollection): Map<PluginHost, PluginContributions[]> {\n        let loaded = 0;\n        const loadPluginsMeasurement = this.measure('loadPlugins');\n\n        const hostContributions = new Map<PluginHost, PluginContributions[]>();\n        console.log(`[${this.clientId}] Loading plugin contributions`);\n        for (const contributions of this.contributions.values()) {\n            const plugin = contributions.plugin.metadata;\n            const pluginId = plugin.model.id;\n\n            if (contributions.state === PluginContributions.State.INITIALIZING) {\n                contributions.state = PluginContributions.State.LOADING;\n                contributions.push(Disposable.create(() => console.log(`[${pluginId}]: Unloaded plugin.`)));\n                contributions.push(this.contributionHandler.handleContributions(this.clientId, contributions.plugin));\n                contributions.state = PluginContributions.State.LOADED;\n                console.debug(`[${this.clientId}][${pluginId}]: Loaded contributions.`);\n                loaded++;\n            }\n\n            if (contributions.state === PluginContributions.State.LOADED) {\n                contributions.state = PluginContributions.State.STARTING;\n                const host = plugin.model.entryPoint.frontend ? 'frontend' : plugin.host;\n                const dynamicContributions = hostContributions.get(host) || [];\n                dynamicContributions.push(contributions);\n                hostContributions.set(host, dynamicContributions);\n                toDisconnect.push(Disposable.create(() => {\n                    contributions!.state = PluginContributions.State.LOADED;\n                    console.debug(`[${this.clientId}][${pluginId}]: Disconnected.`);\n                }));\n            }\n        }\n\n        loadPluginsMeasurement.log(`Load contributions of ${this.getPluginCount(loaded)}`);\n\n        return hostContributions;\n    }\n\n    protected async startPlugins(contributionsByHost: Map<PluginHost, PluginContributions[]>, toDisconnect: DisposableCollection): Promise<void> {\n        let started = 0;\n        const startPluginsMeasurement = this.measure('startPlugins');\n\n        const [hostLogPath, hostStoragePath, hostGlobalStoragePath] = await Promise.all([\n            this.pluginPathsService.getHostLogPath(),\n            this.getStoragePath(),\n            this.getHostGlobalStoragePath()\n        ]);\n\n        if (toDisconnect.disposed) {\n            return;\n        }\n\n        const thenable: Promise<void>[] = [];\n        const configStorage: ConfigStorage = {\n            hostLogPath,\n            hostStoragePath,\n            hostGlobalStoragePath\n        };\n\n        for (const [host, hostContributions] of contributionsByHost) {\n            // do not start plugins for electron browser\n            if (host === 'frontend' && environment.electron.is()) {\n                continue;\n            }\n\n            const manager = await this.obtainManager(host, hostContributions, toDisconnect);\n            if (!manager) {\n                continue;\n            }\n\n            const plugins = hostContributions.map(contributions => contributions.plugin.metadata);\n            thenable.push((async () => {\n                try {\n                    const activationEvents = [...this.activationEvents];\n                    await manager.$start({ plugins, configStorage, activationEvents });\n                    if (toDisconnect.disposed) {\n                        return;\n                    }\n                    console.log(`[${this.clientId}] Starting plugins.`);\n                    for (const contributions of hostContributions) {\n                        started++;\n                        const plugin = contributions.plugin;\n                        const id = plugin.metadata.model.id;\n                        contributions.state = PluginContributions.State.STARTED;\n                        console.debug(`[${this.clientId}][${id}]: Started plugin.`);\n                        toDisconnect.push(contributions.push(Disposable.create(() => {\n                            console.debug(`[${this.clientId}][${id}]: Stopped plugin.`);\n                            manager.$stop(id);\n                        })));\n\n                        this.activateByWorkspaceContains(manager, plugin);\n                    }\n                } catch (e) {\n                    console.error(`Failed to start plugins for '${host}' host`, e);\n                }\n            })());\n        }\n\n        await Promise.all(thenable);\n        await this.activateByEvent('onStartupFinished');\n        if (toDisconnect.disposed) {\n            return;\n        }\n\n        startPluginsMeasurement.log(`Start of ${this.getPluginCount(started)}`);\n    }\n\n    protected async obtainManager(host: string, hostContributions: PluginContributions[], toDisconnect: DisposableCollection): Promise<PluginManagerExt | undefined> {\n        let manager = this.managers.get(host);\n        if (!manager) {\n            const pluginId = getPluginId(hostContributions[0].plugin.metadata.model);\n            const rpc = this.initRpc(host, pluginId);\n            toDisconnect.push(rpc);\n\n            manager = rpc.getProxy(MAIN_RPC_CONTEXT.HOSTED_PLUGIN_MANAGER_EXT);\n            this.managers.set(host, manager);\n            toDisconnect.push(Disposable.create(() => this.managers.delete(host)));\n\n            const [extApi, globalState, workspaceState, webviewResourceRoot, webviewCspSource, defaultShell, jsonValidation] = await Promise.all([\n                this.server.getExtPluginAPI(),\n                this.pluginServer.getAllStorageValues(undefined),\n                this.pluginServer.getAllStorageValues({\n                    workspace: this.workspaceService.workspace?.resource.toString(),\n                    roots: this.workspaceService.tryGetRoots().map(root => root.resource.toString())\n                }),\n                this.webviewEnvironment.resourceRoot(host),\n                this.webviewEnvironment.cspSource(),\n                this.terminalService.getDefaultShell(),\n                this.jsonSchemaStore.schemas\n            ]);\n            if (toDisconnect.disposed) {\n                return undefined;\n            }\n\n            const isElectron = environment.electron.is();\n            await manager.$init({\n                preferences: getPreferences(this.preferenceProviderProvider, this.workspaceService.tryGetRoots()),\n                globalState,\n                workspaceState,\n                env: {\n                    queryParams: getQueryParameters(),\n                    language: nls.locale || nls.defaultLocale,\n                    shell: defaultShell,\n                    uiKind: isElectron ? UIKind.Desktop : UIKind.Web,\n                    appName: FrontendApplicationConfigProvider.get().applicationName,\n                    appHost: isElectron ? 'desktop' : 'web' // TODO: 'web' could be the embedder's name, e.g. 'github.dev'\n                },\n                extApi,\n                webview: {\n                    webviewResourceRoot,\n                    webviewCspSource\n                },\n                jsonValidation\n            });\n            if (toDisconnect.disposed) {\n                return undefined;\n            }\n        }\n        return manager;\n    }\n\n    protected initRpc(host: PluginHost, pluginId: string): RPCProtocol {\n        const rpc = host === 'frontend' ? new PluginWorker().rpc : this.createServerRpc(host);\n        setUpPluginApi(rpc, this.container);\n        this.mainPluginApiProviders.getContributions().forEach(p => p.initialize(rpc, this.container));\n        return rpc;\n    }\n\n    protected createServerRpc(pluginHostId: string): RPCProtocol {\n\n        const channel = new BasicChannel(() => {\n            const writer = new Uint8ArrayWriteBuffer();\n            writer.onCommit(buffer => {\n                this.server.onMessage(pluginHostId, buffer);\n            });\n            return writer;\n        });\n\n        // Create RPC protocol before adding the listener to the watcher to receive the watcher's cached messages after the rpc protocol was created.\n        const rpc = new RPCProtocolImpl(channel);\n\n        this.watcher.onPostMessageEvent(received => {\n            if (pluginHostId === received.pluginHostId) {\n                channel.onMessageEmitter.fire(() => new Uint8ArrayReadBuffer(received.message));\n            }\n        });\n\n        return rpc;\n    }\n\n    protected async updateStoragePath(): Promise<void> {\n        const path = await this.getStoragePath();\n        for (const manager of this.managers.values()) {\n            manager.$updateStoragePath(path);\n        }\n    }\n\n    protected async getStoragePath(): Promise<string | undefined> {\n        const roots = await this.workspaceService.roots;\n        return this.pluginPathsService.getHostStoragePath(this.workspaceService.workspace?.resource.toString(), roots.map(root => root.resource.toString()));\n    }\n\n    protected async getHostGlobalStoragePath(): Promise<string> {\n        const configDirUri = await this.envServer.getConfigDirUri();\n        const globalStorageFolderUri = new URI(configDirUri).resolve('globalStorage');\n\n        // Make sure that folder by the path exists\n        if (!await this.fileService.exists(globalStorageFolderUri)) {\n            await this.fileService.createFolder(globalStorageFolderUri, { fromUserGesture: false });\n        }\n        const globalStorageFolderFsPath = await this.fileService.fsPath(globalStorageFolderUri);\n        if (!globalStorageFolderFsPath) {\n            throw new Error(`Could not resolve the FS path for URI: ${globalStorageFolderUri}`);\n        }\n        return globalStorageFolderFsPath;\n    }\n\n    async activateByEvent(activationEvent: string): Promise<void> {\n        if (this.activationEvents.has(activationEvent)) {\n            return;\n        }\n        this.activationEvents.add(activationEvent);\n        await Promise.all(Array.from(this.managers.values(), manager => manager.$activateByEvent(activationEvent)));\n    }\n\n    async activateByViewContainer(viewContainerId: string): Promise<void> {\n        await Promise.all(this.viewRegistry.getContainerViews(viewContainerId).map(viewId => this.activateByView(viewId)));\n    }\n\n    async activateByView(viewId: string): Promise<void> {\n        await this.activateByEvent(`onView:${viewId}`);\n    }\n\n    async activateByLanguage(languageId: string): Promise<void> {\n        await this.activateByEvent(`onLanguage:${languageId}`);\n    }\n\n    async activateByCommand(commandId: string): Promise<void> {\n        await this.activateByEvent(`onCommand:${commandId}`);\n    }\n\n    async activateByTaskType(taskType: string): Promise<void> {\n        await this.activateByEvent(`onTaskType:${taskType}`);\n    }\n\n    async activateByCustomEditor(viewType: string): Promise<void> {\n        await this.activateByEvent(`onCustomEditor:${viewType}`);\n    }\n\n    async activateByNotebook(viewType: string): Promise<void> {\n        await this.activateByEvent(`onNotebook:${viewType}`);\n    }\n\n    async activateByNotebookSerializer(viewType: string): Promise<void> {\n        await this.activateByEvent(`onNotebookSerializer:${viewType}`);\n    }\n\n    async activateByNotebookRenderer(rendererId: string): Promise<void> {\n        await this.activateByEvent(`onRenderer:${rendererId}`);\n    }\n\n    activateByFileSystem(event: FileSystemProviderActivationEvent): Promise<void> {\n        return this.activateByEvent(`onFileSystem:${event.scheme}`);\n    }\n\n    activateByTerminalProfile(profileId: string): Promise<void> {\n        return this.activateByEvent(`onTerminalProfile:${profileId}`);\n    }\n\n    protected ensureFileSystemActivation(event: FileSystemProviderActivationEvent): void {\n        event.waitUntil(this.activateByFileSystem(event));\n    }\n\n    protected ensureCommandHandlerRegistration(event: WillExecuteCommandEvent): void {\n        const activation = this.activateByCommand(event.commandId);\n        if (this.commands.getCommand(event.commandId) &&\n            (!this.contributionHandler.hasCommand(event.commandId) ||\n                this.contributionHandler.hasCommandHandler(event.commandId))) {\n            return;\n        }\n        const waitForCommandHandler = new Deferred<void>();\n        const listener = this.contributionHandler.onDidRegisterCommandHandler(id => {\n            if (id === event.commandId) {\n                listener.dispose();\n                waitForCommandHandler.resolve();\n            }\n        });\n        const p = Promise.all([\n            activation,\n            waitForCommandHandler.promise\n        ]);\n        p.then(() => listener.dispose(), () => listener.dispose());\n        event.waitUntil(p);\n    }\n\n    protected ensureTaskActivation(event: WillResolveTaskProvider): void {\n        const promises = [this.activateByCommand('workbench.action.tasks.runTask')];\n        const taskType = event.taskType;\n        if (taskType) {\n            if (taskType === ALL_ACTIVATION_EVENT) {\n                for (const taskDefinition of this.taskDefinitionRegistry.getAll()) {\n                    promises.push(this.activateByTaskType(taskDefinition.taskType));\n                }\n            } else {\n                promises.push(this.activateByTaskType(taskType));\n            }\n        }\n\n        event.waitUntil(Promise.all(promises));\n    }\n\n    protected ensureDebugActivation(event: WaitUntilEvent, activationEvent?: DebugActivationEvent, debugType?: string): void {\n        event.waitUntil(this.activateByDebug(activationEvent, debugType));\n    }\n\n    async activateByDebug(activationEvent?: DebugActivationEvent, debugType?: string): Promise<void> {\n        const promises = [this.activateByEvent('onDebug')];\n        if (activationEvent) {\n            promises.push(this.activateByEvent(activationEvent));\n            if (debugType) {\n                promises.push(this.activateByEvent(activationEvent + ':' + debugType));\n            }\n        }\n        await Promise.all(promises);\n    }\n\n    protected async activateByWorkspaceContains(manager: PluginManagerExt, plugin: DeployedPlugin): Promise<void> {\n        const activationEvents = plugin.contributes && plugin.contributes.activationEvents;\n        if (!activationEvents) {\n            return;\n        }\n        const paths: string[] = [];\n        const includePatterns: string[] = [];\n        // should be aligned with https://github.com/microsoft/vscode/blob/da5fb7d5b865aa522abc7e82c10b746834b98639/src/vs/workbench/api/node/extHostExtensionService.ts#L460-L469\n        for (const activationEvent of activationEvents) {\n            if (/^workspaceContains:/.test(activationEvent)) {\n                const fileNameOrGlob = activationEvent.substring('workspaceContains:'.length);\n                if (fileNameOrGlob.indexOf(ALL_ACTIVATION_EVENT) >= 0 || fileNameOrGlob.indexOf('?') >= 0) {\n                    includePatterns.push(fileNameOrGlob);\n                } else {\n                    paths.push(fileNameOrGlob);\n                }\n            }\n        }\n        const activatePlugin = () => manager.$activateByEvent(`onPlugin:${plugin.metadata.model.id}`);\n        const promises: Promise<boolean>[] = [];\n        if (paths.length) {\n            promises.push(this.workspaceService.containsSome(paths));\n        }\n        if (includePatterns.length) {\n            const tokenSource = new CancellationTokenSource();\n            const searchTimeout = setTimeout(() => {\n                tokenSource.cancel();\n                // activate eagerly if took to long to search\n                activatePlugin();\n            }, 7000);\n            promises.push((async () => {\n                try {\n                    const result = await this.fileSearchService.find('', {\n                        rootUris: this.workspaceService.tryGetRoots().map(r => r.resource.toString()),\n                        includePatterns,\n                        limit: 1\n                    }, tokenSource.token);\n                    return result.length > 0;\n                } catch (e) {\n                    if (!isCancelled(e)) {\n                        console.error(e);\n                    }\n                    return false;\n                } finally {\n                    clearTimeout(searchTimeout);\n                }\n            })());\n        }\n        if (promises.length && await Promise.all(promises).then(exists => exists.some(v => v))) {\n            await activatePlugin();\n        }\n    }\n\n    async activatePlugin(id: string): Promise<void> {\n        const activation = [];\n        for (const manager of this.managers.values()) {\n            activation.push(manager.$activatePlugin(id));\n        }\n        await Promise.all(activation);\n    }\n\n    protected measure(name: string): Measurement {\n        return this.stopwatch.start(name, { context: this.clientId });\n    }\n\n    protected getPluginCount(plugins: number): string {\n        return `${plugins} plugin${plugins === 1 ? '' : 's'}`;\n    }\n\n    protected readonly webviewsToRestore = new Map<string, WebviewWidget>();\n    protected readonly webviewRevivers = new Map<string, (webview: WebviewWidget) => Promise<void>>();\n\n    registerWebviewReviver(viewType: string, reviver: (webview: WebviewWidget) => Promise<void>): void {\n        if (this.webviewRevivers.has(viewType)) {\n            throw new Error(`Reviver for ${viewType} already registered`);\n        }\n        this.webviewRevivers.set(viewType, reviver);\n\n        if (this.webviewsToRestore.has(viewType)) {\n            this.restoreWebview(this.webviewsToRestore.get(viewType) as WebviewWidget);\n        }\n    }\n\n    unregisterWebviewReviver(viewType: string): void {\n        this.webviewRevivers.delete(viewType);\n    }\n\n    protected async preserveWebviews(): Promise<void> {\n        for (const webview of this.widgets.getWidgets(WebviewWidget.FACTORY_ID)) {\n            this.preserveWebview(webview as WebviewWidget);\n        }\n        for (const webview of this.widgets.getWidgets(CustomEditorWidget.FACTORY_ID)) {\n            (webview as CustomEditorWidget).modelRef.dispose();\n            if ((webview as any)['closeWithoutSaving']) {\n                delete (webview as any)['closeWithoutSaving'];\n            }\n            this.customEditorRegistry.resolveWidget(webview as CustomEditorWidget);\n        }\n    }\n\n    protected preserveWebview(webview: WebviewWidget): void {\n        if (!this.webviewsToRestore.has(webview.viewType)) {\n            this.activateByEvent(`onWebviewPanel:${webview.viewType}`);\n            this.webviewsToRestore.set(webview.viewType, webview);\n            webview.disposed.connect(() => this.webviewsToRestore.delete(webview.viewType));\n        }\n    }\n\n    protected async restoreWebview(webview: WebviewWidget): Promise<void> {\n        const restore = this.webviewRevivers.get(webview.viewType);\n        if (restore) {\n            try {\n                await restore(webview);\n            } catch (e) {\n                webview.setHTML(this.getDeserializationFailedContents(`\n                An error occurred while restoring '${webview.viewType}' view. Please check logs.\n                `));\n                console.error('Failed to restore the webview', e);\n            }\n        }\n    }\n\n    protected getDeserializationFailedContents(message: string): string {\n        return `<!DOCTYPE html>\n        <html>\n            <head>\n                <meta http-equiv=\"Content-type\" content=\"text/html;charset=UTF-8\">\n                <meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'none';\">\n            </head>\n            <body>${message}</body>\n        </html>`;\n    }\n\n}\n\nexport class PluginContributions extends DisposableCollection {\n    constructor(\n        readonly plugin: DeployedPlugin\n    ) {\n        super();\n    }\n    state: PluginContributions.State = PluginContributions.State.INITIALIZING;\n}\n\nexport namespace PluginContributions {\n    export enum State {\n        INITIALIZING = 0,\n        LOADING = 1,\n        LOADED = 2,\n        STARTING = 3,\n        STARTED = 4\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\nimport { BasicChannel } from '@theia/core/lib/common/message-rpc/channel';\nimport { Uint8ArrayReadBuffer, Uint8ArrayWriteBuffer } from '@theia/core/lib/common/message-rpc/uint8-array-message-buffer';\nimport { injectable } from '@theia/core/shared/inversify';\nimport { RPCProtocol, RPCProtocolImpl } from '../../common/rpc-protocol';\n\n@injectable()\nexport class PluginWorker {\n\n    private worker: Worker;\n\n    public readonly rpc: RPCProtocol;\n\n    constructor() {\n        this.worker = new Worker(new URL('./worker/worker-main',\n            // @ts-expect-error (TS1343)\n            // We compile to CommonJS but `import.meta` is still available in the browser\n            import.meta.url));\n\n        const channel = new BasicChannel(() => {\n            const writer = new Uint8ArrayWriteBuffer();\n            writer.onCommit(buffer => {\n                this.worker.postMessage(buffer);\n            });\n            return writer;\n        });\n\n        this.rpc = new RPCProtocolImpl(channel);\n\n        // eslint-disable-next-line arrow-body-style\n        this.worker.onmessage = buffer => channel.onMessageEmitter.fire(() => {\n            return new Uint8ArrayReadBuffer(buffer.data);\n        });\n\n        this.worker.onerror = e => channel.onErrorEmitter.fire(e);\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2020 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n// code copied and modified from https://github.com/microsoft/vscode/blob/1.47.3/src/vs/workbench/api/browser/mainThreadAuthentication.ts\n\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { AuthenticationExt, AuthenticationMain, MAIN_RPC_CONTEXT } from '../../common/plugin-api-rpc';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport { MessageService } from '@theia/core/lib/common/message-service';\nimport { ConfirmDialog, Dialog, StorageService } from '@theia/core/lib/browser';\nimport {\n    AuthenticationProvider,\n    AuthenticationService,\n    readAllowedExtensions\n} from '@theia/core/lib/browser/authentication-service';\nimport { QuickPickService } from '@theia/core/lib/common/quick-pick-service';\nimport * as theia from '@theia/plugin';\nimport { QuickPickValue } from '@theia/core/lib/browser/quick-input/quick-input-service';\nimport { nls } from '@theia/core/lib/common/nls';\nimport { isObject } from '@theia/core';\n\nexport function getAuthenticationProviderActivationEvent(id: string): string { return `onAuthenticationRequest:${id}`; }\n\nexport class AuthenticationMainImpl implements AuthenticationMain {\n    private readonly proxy: AuthenticationExt;\n    private readonly messageService: MessageService;\n    private readonly storageService: StorageService;\n    private readonly authenticationService: AuthenticationService;\n    private readonly quickPickService: QuickPickService;\n    constructor(rpc: RPCProtocol, container: interfaces.Container) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.AUTHENTICATION_EXT);\n        this.messageService = container.get(MessageService);\n        this.storageService = container.get(StorageService);\n        this.authenticationService = container.get(AuthenticationService);\n        this.quickPickService = container.get(QuickPickService);\n\n        this.authenticationService.onDidChangeSessions(e => {\n            this.proxy.$onDidChangeAuthenticationSessions({ id: e.providerId, label: e.label });\n        });\n    }\n\n    async $registerAuthenticationProvider(id: string, label: string, supportsMultipleAccounts: boolean): Promise<void> {\n        const provider = new AuthenticationProviderImpl(this.proxy, id, label, supportsMultipleAccounts, this.storageService, this.messageService);\n        this.authenticationService.registerAuthenticationProvider(id, provider);\n    }\n\n    async $unregisterAuthenticationProvider(id: string): Promise<void> {\n        this.authenticationService.unregisterAuthenticationProvider(id);\n    }\n\n    async $updateSessions(id: string, event: theia.AuthenticationProviderAuthenticationSessionsChangeEvent): Promise<void> {\n        this.authenticationService.updateSessions(id, event);\n    }\n\n    $logout(providerId: string, sessionId: string): Promise<void> {\n        return this.authenticationService.logout(providerId, sessionId);\n    }\n\n    protected async requestNewSession(providerId: string, scopes: string[], extensionId: string, extensionName: string): Promise<void> {\n        return this.authenticationService.requestNewSession(providerId, scopes, extensionId, extensionName);\n    }\n\n    async $getSession(providerId: string, scopes: string[], extensionId: string, extensionName: string,\n        options: theia.AuthenticationGetSessionOptions): Promise<theia.AuthenticationSession | undefined> {\n        const sessions = await this.authenticationService.getSessions(providerId, scopes);\n\n        // Error cases\n        if (options.forceNewSession && !sessions.length) {\n            throw new Error('No existing sessions found.');\n        }\n        if (options.forceNewSession && options.createIfNone) {\n            throw new Error('Invalid combination of options. Please remove one of the following: forceNewSession, createIfNone');\n        }\n        if (options.forceNewSession && options.silent) {\n            throw new Error('Invalid combination of options. Please remove one of the following: forceNewSession, silent');\n        }\n        if (options.createIfNone && options.silent) {\n            throw new Error('Invalid combination of options. Please remove one of the following: createIfNone, silent');\n        }\n\n        const supportsMultipleAccounts = this.authenticationService.supportsMultipleAccounts(providerId);\n        // Check if the sessions we have are valid\n        if (!options.forceNewSession && sessions.length) {\n            if (supportsMultipleAccounts) {\n                if (options.clearSessionPreference) {\n                    await this.storageService.setData(`authentication-session-${extensionName}-${providerId}`, undefined);\n                } else {\n                    const existingSessionPreference = await this.storageService.getData(`authentication-session-${extensionName}-${providerId}`);\n                    if (existingSessionPreference) {\n                        const matchingSession = sessions.find(session => session.id === existingSessionPreference);\n                        if (matchingSession && await this.isAccessAllowed(providerId, matchingSession.account.label, extensionId)) {\n                            return matchingSession;\n                        }\n                    }\n                }\n            } else if (await this.isAccessAllowed(providerId, sessions[0].account.label, extensionId)) {\n                return sessions[0];\n            }\n        }\n\n        // We may need to prompt because we don't have a valid session modal flows\n        if (options.createIfNone || options.forceNewSession) {\n            const providerName = this.authenticationService.getLabel(providerId);\n            const detail = isAuthenticationForceNewSessionOptions(options.forceNewSession) ? options.forceNewSession!.detail : undefined;\n            const isAllowed = await this.loginPrompt(providerName, extensionName, !!options.forceNewSession, detail);\n            if (!isAllowed) {\n                throw new Error('User did not consent to login.');\n            }\n\n            const session = sessions?.length && !options.forceNewSession && supportsMultipleAccounts\n                ? await this.selectSession(providerId, providerName, extensionId, extensionName, sessions, scopes, !!options.clearSessionPreference)\n                : await this.authenticationService.login(providerId, scopes);\n            await this.setTrustedExtensionAndAccountPreference(providerId, session.account.label, extensionId, extensionName, session.id);\n            return session;\n        }\n\n        // passive flows (silent or default)\n        const validSession = sessions.find(s => this.isAccessAllowed(providerId, s.account.label, extensionId));\n        if (!options.silent && !validSession) {\n            this.authenticationService.requestNewSession(providerId, scopes, extensionId, extensionName);\n        }\n        return validSession;\n    }\n\n    protected async selectSession(providerId: string, providerName: string, extensionId: string, extensionName: string,\n        potentialSessions: Readonly<theia.AuthenticationSession[]>, scopes: string[], clearSessionPreference: boolean): Promise<theia.AuthenticationSession> {\n        if (!potentialSessions.length) {\n            throw new Error('No potential sessions found');\n        }\n\n        return new Promise(async (resolve, reject) => {\n            const items: QuickPickValue<{ session?: theia.AuthenticationSession }>[] = potentialSessions.map(session => ({\n                label: session.account.label,\n                value: { session }\n            }));\n            items.push({\n                label: nls.localizeByDefault('Sign in to another account'),\n                value: { session: undefined }\n            });\n            const selected = await this.quickPickService.show(items,\n                {\n                    title: nls.localizeByDefault(\"The extension '{0}' wants to access a {1} account\", extensionName, providerName),\n                    ignoreFocusOut: true\n                });\n            if (selected) {\n                const session = selected.value?.session ?? await this.authenticationService.login(providerId, scopes);\n                const accountName = session.account.label;\n\n                const allowList = await readAllowedExtensions(this.storageService, providerId, accountName);\n                if (!allowList.find(allowed => allowed.id === extensionId)) {\n                    allowList.push({ id: extensionId, name: extensionName });\n                    this.storageService.setData(`authentication-trusted-extensions-${providerId}-${accountName}`, JSON.stringify(allowList));\n                }\n\n                this.storageService.setData(`authentication-session-${extensionName}-${providerId}`, session.id);\n\n                resolve(session);\n\n            } else {\n                reject('User did not consent to account access');\n            }\n        });\n    }\n\n    protected async getSessionsPrompt(providerId: string, accountName: string, providerName: string, extensionId: string, extensionName: string): Promise<boolean> {\n        const allowList = await readAllowedExtensions(this.storageService, providerId, accountName);\n        const extensionData = allowList.find(extension => extension.id === extensionId);\n        if (extensionData) {\n            addAccountUsage(this.storageService, providerId, accountName, extensionId, extensionName);\n            return true;\n        }\n        const choice = await this.messageService.info(`The extension '${extensionName}' wants to access the ${providerName} account '${accountName}'.`, 'Allow', 'Cancel');\n\n        const allow = choice === 'Allow';\n        if (allow) {\n            await addAccountUsage(this.storageService, providerId, accountName, extensionId, extensionName);\n            allowList.push({ id: extensionId, name: extensionName });\n            this.storageService.setData(`authentication-trusted-extensions-${providerId}-${accountName}`, JSON.stringify(allowList));\n        }\n\n        return allow;\n    }\n\n    protected async loginPrompt(providerName: string, extensionName: string, recreatingSession: boolean, detail?: string): Promise<boolean> {\n        const msg = document.createElement('span');\n        msg.textContent = recreatingSession\n            ? nls.localizeByDefault(\"The extension '{0}' wants you to sign in again using {1}.\", extensionName, providerName)\n            : nls.localizeByDefault(\"The extension '{0}' wants to sign in using {1}.\", extensionName, providerName);\n\n        if (detail) {\n            const detailElement = document.createElement('p');\n            detailElement.textContent = detail;\n            msg.appendChild(detailElement);\n        }\n\n        return !!await new ConfirmDialog({\n            title: nls.localize('theia/plugin-ext/authentication-main/loginTitle', 'Login'),\n            msg,\n            ok: nls.localizeByDefault('Allow'),\n            cancel: Dialog.CANCEL\n        }).open();\n    }\n\n    protected async isAccessAllowed(providerId: string, accountName: string, extensionId: string): Promise<boolean> {\n        const allowList = await readAllowedExtensions(this.storageService, providerId, accountName);\n        return !!allowList.find(allowed => allowed.id === extensionId);\n    }\n\n    protected async setTrustedExtensionAndAccountPreference(providerId: string, accountName: string, extensionId: string, extensionName: string, sessionId: string): Promise<void> {\n        const allowList = await readAllowedExtensions(this.storageService, providerId, accountName);\n        if (!allowList.find(allowed => allowed.id === extensionId)) {\n            allowList.push({ id: extensionId, name: extensionName });\n            this.storageService.setData(`authentication-trusted-extensions-${providerId}-${accountName}`, JSON.stringify(allowList));\n        }\n        this.storageService.setData(`authentication-session-${extensionName}-${providerId}`, sessionId);\n    }\n\n    $onDidChangeSessions(providerId: string, event: theia.AuthenticationProviderAuthenticationSessionsChangeEvent): void {\n        this.authenticationService.updateSessions(providerId, event);\n    }\n}\n\nfunction isAuthenticationForceNewSessionOptions(arg: unknown): arg is theia.AuthenticationForceNewSessionOptions {\n    return isObject<theia.AuthenticationForceNewSessionOptions>(arg) && typeof arg.detail === 'string';\n}\n\nasync function addAccountUsage(storageService: StorageService, providerId: string, accountName: string, extensionId: string, extensionName: string): Promise<void> {\n    const accountKey = `authentication-${providerId}-${accountName}-usages`;\n    const usages = await readAccountUsages(storageService, providerId, accountName);\n\n    const existingUsageIndex = usages.findIndex(usage => usage.extensionId === extensionId);\n    if (existingUsageIndex > -1) {\n        usages.splice(existingUsageIndex, 1, {\n            extensionId,\n            extensionName,\n            lastUsed: Date.now()\n        });\n    } else {\n        usages.push({\n            extensionId,\n            extensionName,\n            lastUsed: Date.now()\n        });\n    }\n\n    await storageService.setData(accountKey, JSON.stringify(usages));\n}\n\ninterface AccountUsage {\n    extensionId: string;\n    extensionName: string;\n    lastUsed: number;\n}\n\nexport class AuthenticationProviderImpl implements AuthenticationProvider {\n    /** map from account name to session ids */\n    private accounts = new Map<string, string[]>();\n    /** map from session id to account name */\n    private sessions = new Map<string, string>();\n\n    readonly onDidChangeSessions: theia.Event<theia.AuthenticationProviderAuthenticationSessionsChangeEvent>;\n\n    constructor(\n        private readonly proxy: AuthenticationExt,\n        public readonly id: string,\n        public readonly label: string,\n        public readonly supportsMultipleAccounts: boolean,\n        private readonly storageService: StorageService,\n        private readonly messageService: MessageService\n    ) { }\n\n    public hasSessions(): boolean {\n        return !!this.sessions.size;\n    }\n\n    private registerSession(session: theia.AuthenticationSession): void {\n        this.sessions.set(session.id, session.account.label);\n\n        const existingSessionsForAccount = this.accounts.get(session.account.label);\n        if (existingSessionsForAccount) {\n            this.accounts.set(session.account.label, existingSessionsForAccount.concat(session.id));\n            return;\n        } else {\n            this.accounts.set(session.account.label, [session.id]);\n        }\n    }\n\n    async signOut(accountName: string): Promise<void> {\n        const accountUsages = await readAccountUsages(this.storageService, this.id, accountName);\n        const sessionsForAccount = this.accounts.get(accountName);\n        const result = await this.messageService.info(accountUsages.length\n            ? nls.localizeByDefault(\"The account '{0}' has been used by: \\n\\n{1}\\n\\n Sign out from these extensions?\", accountName,\n                accountUsages.map(usage => usage.extensionName).join(', '))\n            : nls.localizeByDefault(\"Sign out of '{0}'?\", accountName),\n            nls.localizeByDefault('Sign Out'),\n            Dialog.CANCEL);\n\n        if (result && result === nls.localizeByDefault('Sign Out') && sessionsForAccount) {\n            sessionsForAccount.forEach(sessionId => this.removeSession(sessionId));\n            removeAccountUsage(this.storageService, this.id, accountName);\n        }\n    }\n\n    async getSessions(scopes?: string[]): Promise<ReadonlyArray<theia.AuthenticationSession>> {\n        return this.proxy.$getSessions(this.id, scopes);\n    }\n\n    async updateSessionItems(event: theia.AuthenticationProviderAuthenticationSessionsChangeEvent): Promise<void> {\n        const { added, removed } = event;\n        const session = await this.proxy.$getSessions(this.id);\n        const addedSessions = added ? session.filter(s => added.some(addedSession => addedSession.id === s.id)) : [];\n\n        removed?.forEach(removedSession => {\n            const sessionId = removedSession.id;\n            if (sessionId) {\n                const accountName = this.sessions.get(sessionId);\n                if (accountName) {\n                    this.sessions.delete(sessionId);\n                    const sessionsForAccount = this.accounts.get(accountName) || [];\n                    const sessionIndex = sessionsForAccount.indexOf(sessionId);\n                    sessionsForAccount.splice(sessionIndex);\n\n                    if (!sessionsForAccount.length) {\n                        this.accounts.delete(accountName);\n                    }\n                }\n            }\n        });\n\n        addedSessions.forEach(s => this.registerSession(s));\n    }\n\n    async login(scopes: string[]): Promise<theia.AuthenticationSession> {\n        return this.createSession(scopes);\n    }\n\n    async logout(sessionId: string): Promise<void> {\n        return this.removeSession(sessionId);\n    }\n\n    createSession(scopes: string[]): Thenable<theia.AuthenticationSession> {\n        return this.proxy.$createSession(this.id, scopes);\n    }\n\n    removeSession(sessionId: string): Thenable<void> {\n        return this.proxy.$removeSession(this.id, sessionId)\n            .then(() => { this.messageService.info('Successfully signed out.'); });\n    }\n}\n\nasync function readAccountUsages(storageService: StorageService, providerId: string, accountName: string): Promise<AccountUsage[]> {\n    const accountKey = `authentication-${providerId}-${accountName}-usages`;\n    const storedUsages: string | undefined = await storageService.getData(accountKey);\n    let usages: AccountUsage[] = [];\n    if (storedUsages) {\n        try {\n            usages = JSON.parse(storedUsages);\n        } catch (e) {\n            console.log(e);\n        }\n    }\n\n    return usages;\n}\n\nfunction removeAccountUsage(storageService: StorageService, providerId: string, accountName: string): void {\n    const accountKey = `authentication-${providerId}-${accountName}-usages`;\n    storageService.setData(accountKey, undefined);\n}\n","// *****************************************************************************\n// Copyright (C) 2019 RedHat and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { ClipboardMain } from '../../common';\nimport { ClipboardService } from '@theia/core/lib/browser/clipboard-service';\n\nexport class ClipboardMainImpl implements ClipboardMain {\n\n    protected readonly clipboardService: ClipboardService;\n\n    constructor(container: interfaces.Container) {\n        this.clipboardService = container.get(ClipboardService);\n    }\n\n    async $readText(): Promise<string> {\n        const result = await this.clipboardService.readText();\n        return result;\n    }\n\n    async $writeText(value: string): Promise<void> {\n        await this.clipboardService.writeText(value);\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { CommandRegistry } from '@theia/core/lib/common/command';\nimport * as theia from '@theia/plugin';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\nimport { CommandRegistryMain, CommandRegistryExt, MAIN_RPC_CONTEXT } from '../../common/plugin-api-rpc';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport { KeybindingRegistry } from '@theia/core/lib/browser';\nimport { PluginContributionHandler } from './plugin-contribution-handler';\nimport { ArgumentProcessor } from '../../common/commands';\n\nexport class CommandRegistryMainImpl implements CommandRegistryMain, Disposable {\n    private readonly proxy: CommandRegistryExt;\n    private readonly commands = new Map<string, Disposable>();\n    private readonly handlers = new Map<string, Disposable>();\n    private readonly delegate: CommandRegistry;\n    private readonly keyBinding: KeybindingRegistry;\n    private readonly contributions: PluginContributionHandler;\n\n    private readonly argumentProcessors: ArgumentProcessor[] = [];\n\n    protected readonly toDispose = new DisposableCollection();\n\n    constructor(rpc: RPCProtocol, container: interfaces.Container) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.COMMAND_REGISTRY_EXT);\n        this.delegate = container.get(CommandRegistry);\n        this.keyBinding = container.get(KeybindingRegistry);\n        this.contributions = container.get(PluginContributionHandler);\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    registerArgumentProcessor(processor: ArgumentProcessor): Disposable {\n        this.argumentProcessors.push(processor);\n        return Disposable.create(() => {\n            const index = this.argumentProcessors.lastIndexOf(processor);\n            if (index >= 0) {\n                this.argumentProcessors.splice(index, 1);\n            }\n        });\n    }\n\n    $registerCommand(command: theia.CommandDescription): void {\n        const id = command.id;\n        this.commands.set(id, this.contributions.registerCommand(command));\n        this.toDispose.push(Disposable.create(() => this.$unregisterCommand(id)));\n    }\n    $unregisterCommand(id: string): void {\n        const command = this.commands.get(id);\n        if (command) {\n            command.dispose();\n            this.commands.delete(id);\n        }\n    }\n\n    $registerHandler(id: string): void {\n        this.handlers.set(id, this.contributions.registerCommandHandler(id, (...args) =>\n            this.proxy.$executeCommand(id, ...args.map(arg => this.argumentProcessors.reduce((currentValue, processor) => processor.processArgument(currentValue), arg)))\n        ));\n        this.toDispose.push(Disposable.create(() => this.$unregisterHandler(id)));\n    }\n    $unregisterHandler(id: string): void {\n        const handler = this.handlers.get(id);\n        if (handler) {\n            handler.dispose();\n            this.handlers.delete(id);\n        }\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    async $executeCommand<T>(id: string, ...args: any[]): Promise<T | undefined> {\n        if (!this.delegate.getCommand(id)) {\n            throw new Error(`Command with id '${id}' is not registered.`);\n        }\n        try {\n            return await this.delegate.executeCommand<T>(id, ...args);\n        } catch (e) {\n            // Command handler may be not active at the moment so the error must be caught. See https://github.com/eclipse-theia/theia/pull/6687#discussion_r354810079\n            if ('code' in e && e['code'] === 'NO_ACTIVE_HANDLER') {\n                return;\n            } else {\n                throw e;\n            }\n        }\n    }\n\n    $getKeyBinding(commandId: string): PromiseLike<theia.CommandKeyBinding[] | undefined> {\n        try {\n            const keyBindings = this.keyBinding.getKeybindingsForCommand(commandId);\n            if (keyBindings) {\n                // transform inner type to CommandKeyBinding\n                return Promise.resolve(keyBindings.map(keyBinding => ({ id: commandId, value: keyBinding.keybinding })));\n            } else {\n                return Promise.resolve(undefined);\n            }\n\n        } catch (e) {\n            return Promise.reject(e);\n        }\n    }\n\n    $getCommands(): PromiseLike<string[]> {\n        return Promise.resolve(this.delegate.commandIds);\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2020 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { injectable, inject, postConstruct } from '@theia/core/shared/inversify';\nimport { ContextKeyService, ContextKey } from '@theia/core/lib/browser/context-key-service';\nimport { Emitter } from '@theia/core/lib/common';\n\n@injectable()\nexport class CommentsContextKeyService {\n\n    @inject(ContextKeyService)\n    protected readonly contextKeyService: ContextKeyService;\n    protected readonly contextKeys: Set<string> = new Set();\n    protected readonly onDidChangeEmitter = new Emitter<void>();\n    readonly onDidChange = this.onDidChangeEmitter.event;\n    protected _commentIsEmpty: ContextKey<boolean>;\n    protected _commentController: ContextKey<string | undefined>;\n    protected _comment: ContextKey<string | undefined>;\n\n    get commentController(): ContextKey<string | undefined> {\n        return this._commentController;\n    }\n\n    get comment(): ContextKey<string | undefined> {\n        return this._comment;\n    }\n\n    get commentIsEmpty(): ContextKey<boolean> {\n        return this._commentIsEmpty;\n    }\n\n    @postConstruct()\n    protected init(): void {\n        this.contextKeys.add('commentIsEmpty');\n        this._commentController = this.contextKeyService.createKey<string | undefined>('commentController', undefined);\n        this._comment = this.contextKeyService.createKey<string | undefined>('comment', undefined);\n        this._commentIsEmpty = this.contextKeyService.createKey<boolean>('commentIsEmpty', true);\n        this.contextKeyService.onDidChange(event => {\n            if (event.affects(this.contextKeys)) {\n                this.onDidChangeEmitter.fire();\n            }\n        });\n    }\n\n    setExpression(expression: string): void {\n        this.contextKeyService.parseKeys(expression)?.forEach(key => {\n            this.contextKeys.add(key);\n        });\n    }\n\n    match(expression: string | undefined): boolean {\n        return !expression || this.contextKeyService.match(expression);\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2020 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport * as monaco from '@theia/monaco-editor-core';\nimport { CommentingRangeDecorator } from './comments-decorator';\nimport { EditorManager, EditorMouseEvent, EditorWidget } from '@theia/editor/lib/browser';\nimport { MonacoDiffEditor } from '@theia/monaco/lib/browser/monaco-diff-editor';\nimport { CommentThreadWidget } from './comment-thread-widget';\nimport { CommentsService, CommentInfoMain } from './comments-service';\nimport { CommentThread } from '../../../common/plugin-api-rpc-model';\nimport { CommandRegistry, DisposableCollection, MenuModelRegistry } from '@theia/core/lib/common';\nimport { URI } from '@theia/core/shared/vscode-uri';\nimport { CommentsContextKeyService } from './comments-context-key-service';\nimport { ContextKeyService } from '@theia/core/lib/browser/context-key-service';\n\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n// some code copied and modified from https://github.com/microsoft/vscode/blob/1.49.3/src/vs/workbench/contrib/comments/browser/comments.contribution.ts\n\n@injectable()\nexport class CommentsContribution {\n\n    private addInProgress!: boolean;\n    private commentWidgets: CommentThreadWidget[];\n    private commentInfos: CommentInfoMain[];\n    private emptyThreadsToAddQueue: [number, EditorMouseEvent | undefined][] = [];\n\n    @inject(MenuModelRegistry) protected readonly menus: MenuModelRegistry;\n    @inject(CommentsContextKeyService) protected readonly commentsContextKeyService: CommentsContextKeyService;\n    @inject(ContextKeyService) protected readonly contextKeyService: ContextKeyService;\n    @inject(CommandRegistry) protected readonly commands: CommandRegistry;\n\n    constructor(@inject(CommentingRangeDecorator) protected readonly rangeDecorator: CommentingRangeDecorator,\n        @inject(CommentsService) protected readonly commentService: CommentsService,\n        @inject(EditorManager) protected readonly editorManager: EditorManager) {\n        this.commentWidgets = [];\n        this.commentInfos = [];\n        this.commentService.onDidSetResourceCommentInfos(e => {\n            const editor = this.getCurrentEditor();\n            const editorURI = editor && editor.editor instanceof MonacoDiffEditor && editor.editor.diffEditor.getModifiedEditor().getModel();\n            if (editorURI && editorURI.toString() === e.resource.toString()) {\n                this.setComments(e.commentInfos.filter(commentInfo => commentInfo !== null));\n            }\n        });\n        this.editorManager.onCreated(async widget => {\n            const disposables = new DisposableCollection();\n            const editor = widget.editor;\n            if (editor instanceof MonacoDiffEditor) {\n                const originalEditorModel = editor.diffEditor.getOriginalEditor().getModel();\n                if (originalEditorModel) {\n                    const originalComments = await this.commentService.getComments(originalEditorModel.uri);\n                    if (originalComments) {\n                        this.rangeDecorator.update(editor.diffEditor.getOriginalEditor(), <CommentInfoMain[]>originalComments.filter(c => !!c));\n                    }\n                }\n                const modifiedEditorModel = editor.diffEditor.getModifiedEditor().getModel();\n                if (modifiedEditorModel) {\n                    const modifiedComments = await this.commentService.getComments(modifiedEditorModel.uri);\n                    if (modifiedComments) {\n                        this.rangeDecorator.update(editor.diffEditor.getModifiedEditor(), <CommentInfoMain[]>modifiedComments.filter(c => !!c));\n                    }\n                }\n                disposables.push(editor.onMouseDown(e => this.onEditorMouseDown(e)));\n                disposables.push(this.commentService.onDidUpdateCommentThreads(async e => {\n                    const editorURI = editor.document.uri;\n                    const commentInfo = this.commentInfos.filter(info => info.owner === e.owner);\n                    if (!commentInfo || !commentInfo.length) {\n                        return;\n                    }\n\n                    const added = e.added.filter(thread => thread.resource && thread.resource.toString() === editorURI.toString());\n                    const removed = e.removed.filter(thread => thread.resource && thread.resource.toString() === editorURI.toString());\n                    const changed = e.changed.filter(thread => thread.resource && thread.resource.toString() === editorURI.toString());\n\n                    removed.forEach(thread => {\n                        const matchedZones = this.commentWidgets.filter(zoneWidget => zoneWidget.owner === e.owner\n                            && zoneWidget.commentThread.threadId === thread.threadId && zoneWidget.commentThread.threadId !== '');\n                        if (matchedZones.length) {\n                            const matchedZone = matchedZones[0];\n                            const index = this.commentWidgets.indexOf(matchedZone);\n                            this.commentWidgets.splice(index, 1);\n                            matchedZone.dispose();\n                        }\n                    });\n\n                    changed.forEach(thread => {\n                        const matchedZones = this.commentWidgets.filter(zoneWidget => zoneWidget.owner === e.owner\n                            && zoneWidget.commentThread.threadId === thread.threadId);\n                        if (matchedZones.length) {\n                            const matchedZone = matchedZones[0];\n                            matchedZone.update();\n                        }\n                    });\n                    added.forEach(thread => {\n                        this.displayCommentThread(e.owner, thread);\n                        this.commentInfos.filter(info => info.owner === e.owner)[0].threads.push(thread);\n                    });\n                })\n                );\n                editor.onDispose(() => {\n                    disposables.dispose();\n                });\n                this.beginCompute();\n            }\n        });\n    }\n\n    private onEditorMouseDown(e: EditorMouseEvent): void {\n        let mouseDownInfo = null;\n\n        const range = e.target.range;\n\n        if (!range) {\n            return;\n        }\n\n        if (e.target.type !== monaco.editor.MouseTargetType.GUTTER_LINE_DECORATIONS) {\n            return;\n        }\n\n        const data = e.target.detail;\n        const gutterOffsetX = data.offsetX - data.glyphMarginWidth - data.lineNumbersWidth - data.glyphMarginLeft;\n\n        // don't collide with folding and git decorations\n        if (gutterOffsetX > 14) {\n            return;\n        }\n\n        mouseDownInfo = { lineNumber: range.start };\n\n        const { lineNumber } = mouseDownInfo;\n        mouseDownInfo = null;\n\n        if (!range || range.start !== lineNumber) {\n            return;\n        }\n\n        if (!e.target.element) {\n            return;\n        }\n\n        if (e.target.element.className.indexOf('comment-diff-added') >= 0) {\n            this.addOrToggleCommentAtLine(e.target.position!.line + 1, e);\n        }\n    }\n\n    private async beginCompute(): Promise<void> {\n        const editorModel = this.editor && this.editor.getModel();\n        const editorURI = this.editor && editorModel && editorModel.uri;\n        if (editorURI) {\n            const comments = await this.commentService.getComments(editorURI);\n            this.setComments(<CommentInfoMain[]>comments.filter(c => !!c));\n        }\n    }\n\n    private setComments(commentInfos: CommentInfoMain[]): void {\n        if (!this.editor) {\n            return;\n        }\n\n        this.commentInfos = commentInfos;\n    }\n\n    get editor(): monaco.editor.IStandaloneCodeEditor | undefined {\n        const editor = this.getCurrentEditor();\n        if (editor && editor.editor instanceof MonacoDiffEditor) {\n            return editor.editor.diffEditor.getModifiedEditor();\n        }\n    }\n\n    private displayCommentThread(owner: string, thread: CommentThread): void {\n        const editor = this.editor;\n        if (editor) {\n            const provider = this.commentService.getCommentController(owner);\n            if (provider) {\n                this.commentsContextKeyService.commentController.set(provider.id);\n            }\n            const zoneWidget = new CommentThreadWidget(editor, owner, thread, this.commentService, this.menus, this.commentsContextKeyService, this.commands);\n            zoneWidget.display({ afterLineNumber: thread.range.startLineNumber, heightInLines: 5 });\n            const currentEditor = this.getCurrentEditor();\n            if (currentEditor) {\n                currentEditor.onDispose(() => zoneWidget.dispose());\n            }\n            this.commentWidgets.push(zoneWidget);\n        }\n    }\n\n    public async addOrToggleCommentAtLine(lineNumber: number, e: EditorMouseEvent | undefined): Promise<void> {\n        // If an add is already in progress, queue the next add and process it after the current one finishes to\n        // prevent empty comment threads from being added to the same line.\n        if (!this.addInProgress) {\n            this.addInProgress = true;\n            // The widget's position is undefined until the widget has been displayed, so rely on the glyph position instead\n            const existingCommentsAtLine = this.commentWidgets.filter(widget => widget.getGlyphPosition() === lineNumber);\n            if (existingCommentsAtLine.length) {\n                existingCommentsAtLine.forEach(widget => widget.toggleExpand(lineNumber));\n                this.processNextThreadToAdd();\n                return;\n            } else {\n                this.addCommentAtLine(lineNumber, e);\n            }\n        } else {\n            this.emptyThreadsToAddQueue.push([lineNumber, e]);\n        }\n    }\n\n    private processNextThreadToAdd(): void {\n        this.addInProgress = false;\n        const info = this.emptyThreadsToAddQueue.shift();\n        if (info) {\n            this.addOrToggleCommentAtLine(info[0], info[1]);\n        }\n    }\n\n    private getCurrentEditor(): EditorWidget | undefined {\n        return this.editorManager.currentEditor;\n    }\n\n    public addCommentAtLine(lineNumber: number, e: EditorMouseEvent | undefined): Promise<void> {\n        const newCommentInfos = this.rangeDecorator.getMatchedCommentAction(lineNumber);\n        const editor = this.getCurrentEditor();\n        if (!editor) {\n            return Promise.resolve();\n        }\n        if (!newCommentInfos.length) {\n            return Promise.resolve();\n        }\n\n        const { ownerId } = newCommentInfos[0]!;\n        this.addCommentAtLine2(lineNumber, ownerId);\n\n        return Promise.resolve();\n    }\n\n    public addCommentAtLine2(lineNumber: number, ownerId: string): void {\n        const editorModel = this.editor && this.editor.getModel();\n        const editorURI = this.editor && editorModel && editorModel.uri;\n        if (editorURI) {\n            this.commentService.createCommentThreadTemplate(ownerId, URI.parse(editorURI.toString()), {\n                startLineNumber: lineNumber,\n                endLineNumber: lineNumber,\n                startColumn: 1,\n                endColumn: 1\n            });\n            this.processNextThreadToAdd();\n        }\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2020 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { injectable } from '@theia/core/shared/inversify';\nimport { CommentInfoMain } from './comments-service';\nimport { CommentingRanges, Range } from '../../../common/plugin-api-rpc-model';\nimport * as monaco from '@theia/monaco-editor-core';\n\n@injectable()\nexport class CommentingRangeDecorator {\n\n    private decorationOptions: monaco.editor.IModelDecorationOptions;\n    private commentingRangeDecorations: CommentingRangeDecoration[] = [];\n\n    constructor() {\n        this.decorationOptions = {\n            isWholeLine: true,\n            linesDecorationsClassName: 'comment-range-glyph comment-diff-added'\n        };\n    }\n\n    public update(editor: monaco.editor.ICodeEditor, commentInfos: CommentInfoMain[]): void {\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n\n        const commentingRangeDecorations: CommentingRangeDecoration[] = [];\n        for (const info of commentInfos) {\n            info.commentingRanges.ranges.forEach(range => {\n                commentingRangeDecorations.push(new CommentingRangeDecoration(editor, info.owner, info.extensionId, info.label,\n                    range, this.decorationOptions, info.commentingRanges));\n            });\n        }\n\n        const oldDecorations = this.commentingRangeDecorations.map(decoration => decoration.id);\n        editor.deltaDecorations(oldDecorations, []);\n\n        this.commentingRangeDecorations = commentingRangeDecorations;\n    }\n\n    public getMatchedCommentAction(line: number): { ownerId: string, extensionId: string | undefined, label: string | undefined, commentingRangesInfo: CommentingRanges }[] {\n        const result = [];\n        for (const decoration of this.commentingRangeDecorations) {\n            const range = decoration.getActiveRange();\n            if (range && range.startLineNumber <= line && line <= range.endLineNumber) {\n                result.push(decoration.getCommentAction());\n            }\n        }\n\n        return result;\n    }\n}\n\nclass CommentingRangeDecoration {\n    private decorationId: string;\n\n    public get id(): string {\n        return this.decorationId;\n    }\n\n    constructor(private _editor: monaco.editor.ICodeEditor, private _ownerId: string, private _extensionId: string | undefined,\n        private _label: string | undefined, private _range: Range, commentingOptions: monaco.editor.IModelDecorationOptions,\n        private commentingRangesInfo: CommentingRanges) {\n        const startLineNumber = _range.startLineNumber;\n        const endLineNumber = _range.endLineNumber;\n        const commentingRangeDecorations = [{\n            range: {\n                startLineNumber: startLineNumber, startColumn: 1,\n                endLineNumber: endLineNumber, endColumn: 1\n            },\n            options: commentingOptions\n        }];\n\n        this.decorationId = this._editor.deltaDecorations([], commentingRangeDecorations)[0];\n    }\n\n    public getCommentAction(): { ownerId: string, extensionId: string | undefined, label: string | undefined, commentingRangesInfo: CommentingRanges } {\n        return {\n            extensionId: this._extensionId,\n            label: this._label,\n            ownerId: this._ownerId,\n            commentingRangesInfo: this.commentingRangesInfo\n        };\n    }\n\n    public getOriginalRange(): Range {\n        return this._range;\n    }\n\n    public getActiveRange(): Range | undefined {\n        const range = this._editor.getModel()!.getDecorationRange(this.decorationId);\n        if (range) {\n            return range;\n        }\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2020 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport {\n    Range,\n    Comment,\n    CommentInput,\n    CommentOptions,\n    CommentThread,\n    CommentThreadChangedEvent\n} from '../../../common/plugin-api-rpc-model';\nimport { Event, Emitter } from '@theia/core/lib/common/event';\nimport { CommentThreadCollapsibleState, CommentThreadState } from '../../../plugin/types-impl';\nimport {\n    CommentProviderFeatures,\n    CommentsExt,\n    CommentsMain,\n    CommentThreadChanges,\n    MAIN_RPC_CONTEXT\n} from '../../../common/plugin-api-rpc';\nimport { Disposable } from '@theia/core/lib/common/disposable';\nimport { CommentsService, CommentInfoMain } from './comments-service';\nimport { UriComponents } from '../../../common/uri-components';\nimport { URI } from '@theia/core/shared/vscode-uri';\nimport { CancellationToken } from '@theia/core/lib/common';\nimport { RPCProtocol } from '../../../common/rpc-protocol';\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { v4 as uuidv4 } from 'uuid';\nimport { CommentsContribution } from './comments-contribution';\n\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n// some code copied and modified from https://github.com/microsoft/vscode/blob/1.49.3/src/vs/workbench/api/browser/mainThreadComments.ts\n\nexport class CommentThreadImpl implements CommentThread, Disposable {\n    private _input?: CommentInput;\n    get input(): CommentInput | undefined {\n        return this._input;\n    }\n\n    set input(value: CommentInput | undefined) {\n        this._input = value;\n        this.onDidChangeInputEmitter.fire(value);\n    }\n\n    private readonly onDidChangeInputEmitter = new Emitter<CommentInput | undefined>();\n    get onDidChangeInput(): Event<CommentInput | undefined> { return this.onDidChangeInputEmitter.event; }\n\n    private _label: string | undefined;\n\n    get label(): string | undefined {\n        return this._label;\n    }\n\n    set label(label: string | undefined) {\n        this._label = label;\n        this.onDidChangeLabelEmitter.fire(this._label);\n    }\n\n    private readonly onDidChangeLabelEmitter = new Emitter<string | undefined>();\n    readonly onDidChangeLabel: Event<string | undefined> = this.onDidChangeLabelEmitter.event;\n\n    private _contextValue: string | undefined;\n\n    get contextValue(): string | undefined {\n        return this._contextValue;\n    }\n\n    set contextValue(context: string | undefined) {\n        this._contextValue = context;\n    }\n\n    private _comments: Comment[] | undefined;\n\n    public get comments(): Comment[] | undefined {\n        return this._comments;\n    }\n\n    public set comments(newComments: Comment[] | undefined) {\n        this._comments = newComments;\n        this.onDidChangeCommentsEmitter.fire(this._comments);\n    }\n\n    private readonly onDidChangeCommentsEmitter = new Emitter<Comment[] | undefined>();\n    get onDidChangeComments(): Event<Comment[] | undefined> { return this.onDidChangeCommentsEmitter.event; }\n\n    set range(range: Range) {\n        this._range = range;\n        this.onDidChangeRangeEmitter.fire(this._range);\n    }\n\n    get range(): Range {\n        return this._range;\n    }\n\n    private readonly onDidChangeRangeEmitter = new Emitter<Range>();\n    public onDidChangeRange = this.onDidChangeRangeEmitter.event;\n\n    private _collapsibleState: CommentThreadCollapsibleState | undefined;\n    get collapsibleState(): CommentThreadCollapsibleState | undefined {\n        return this._collapsibleState;\n    }\n\n    set collapsibleState(newState: CommentThreadCollapsibleState | undefined) {\n        this._collapsibleState = newState;\n        this.onDidChangeCollapsibleStateEmitter.fire(this._collapsibleState);\n    }\n\n    private readonly onDidChangeCollapsibleStateEmitter = new Emitter<CommentThreadCollapsibleState | undefined>();\n    readonly onDidChangeCollapsibleState = this.onDidChangeCollapsibleStateEmitter.event;\n\n    private _state: CommentThreadState | undefined;\n    get state(): CommentThreadState | undefined {\n        return this._state;\n    }\n\n    set state(newState: CommentThreadState | undefined) {\n        if (this._state !== newState) {\n            this._state = newState;\n            this.onDidChangeStateEmitter.fire(this._state);\n        }\n    }\n\n    private readonly onDidChangeStateEmitter = new Emitter<CommentThreadState | undefined>();\n    readonly onDidChangeState = this.onDidChangeStateEmitter.event;\n\n    private readonly onDidChangeCanReplyEmitter = new Emitter<boolean>();\n    readonly onDidChangeCanReply = this.onDidChangeCanReplyEmitter.event;\n\n    private _isDisposed: boolean;\n\n    get isDisposed(): boolean {\n        return this._isDisposed;\n    }\n\n    private _canReply: boolean = true;\n    get canReply(): boolean {\n        return this._canReply;\n    }\n\n    set canReply(canReply: boolean) {\n        this._canReply = canReply;\n        this.onDidChangeCanReplyEmitter.fire(this._canReply);\n    }\n\n    constructor(\n        public commentThreadHandle: number,\n        public controllerHandle: number,\n        public extensionId: string,\n        public threadId: string,\n        public resource: string,\n        private _range: Range\n    ) {\n        this._isDisposed = false;\n    }\n\n    batchUpdate(changes: CommentThreadChanges): void {\n        const modified = (value: keyof CommentThreadChanges): boolean =>\n            Object.prototype.hasOwnProperty.call(changes, value);\n\n        if (modified('range')) { this._range = changes.range!; }\n        if (modified('label')) { this._label = changes.label; }\n        if (modified('contextValue')) { this._contextValue = changes.contextValue; }\n        if (modified('comments')) { this._comments = changes.comments; }\n        if (modified('collapseState')) { this._collapsibleState = changes.collapseState; }\n        if (modified('state')) { this._state = changes.state; }\n        if (modified('canReply')) { this._canReply = changes.canReply!; }\n    }\n\n    dispose(): void {\n        this._isDisposed = true;\n        this.onDidChangeCollapsibleStateEmitter.dispose();\n        this.onDidChangeStateEmitter.dispose();\n        this.onDidChangeCommentsEmitter.dispose();\n        this.onDidChangeInputEmitter.dispose();\n        this.onDidChangeLabelEmitter.dispose();\n        this.onDidChangeRangeEmitter.dispose();\n        this.onDidChangeCanReplyEmitter.dispose();\n    }\n}\n\nexport class CommentController {\n    get handle(): number {\n        return this._handle;\n    }\n\n    get id(): string {\n        return this._id;\n    }\n\n    get contextValue(): string {\n        return this._id;\n    }\n\n    get proxy(): CommentsExt {\n        return this._proxy;\n    }\n\n    get label(): string {\n        return this._label;\n    }\n\n    get options(): CommentOptions | undefined {\n        return this._features.options;\n    }\n\n    private readonly threads: Map<number, CommentThreadImpl> = new Map<number, CommentThreadImpl>();\n    public activeCommentThread?: CommentThread;\n\n    get features(): CommentProviderFeatures {\n        return this._features;\n    }\n\n    constructor(\n        private readonly _proxy: CommentsExt,\n        private readonly _commentService: CommentsService,\n        private readonly _handle: number,\n        private readonly _uniqueId: string,\n        private readonly _id: string,\n        private readonly _label: string,\n        private _features: CommentProviderFeatures\n    ) { }\n\n    updateFeatures(features: CommentProviderFeatures): void {\n        this._features = features;\n    }\n\n    createCommentThread(extensionId: string,\n        commentThreadHandle: number,\n        threadId: string,\n        resource: UriComponents,\n        range: Range,\n    ): CommentThread {\n        const thread = new CommentThreadImpl(\n            commentThreadHandle,\n            this.handle,\n            extensionId,\n            threadId,\n            URI.revive(resource).toString(),\n            range\n        );\n\n        this.threads.set(commentThreadHandle, thread);\n\n        this._commentService.updateComments(this._uniqueId, {\n            added: [thread],\n            removed: [],\n            changed: []\n        });\n\n        return thread;\n    }\n\n    updateCommentThread(commentThreadHandle: number,\n        threadId: string,\n        resource: UriComponents,\n        changes: CommentThreadChanges): void {\n        const thread = this.getKnownThread(commentThreadHandle);\n        thread.batchUpdate(changes);\n\n        this._commentService.updateComments(this._uniqueId, {\n            added: [],\n            removed: [],\n            changed: [thread]\n        });\n    }\n\n    deleteCommentThread(commentThreadHandle: number): void {\n        const thread = this.getKnownThread(commentThreadHandle);\n        this.threads.delete(commentThreadHandle);\n\n        this._commentService.updateComments(this._uniqueId, {\n            added: [],\n            removed: [thread],\n            changed: []\n        });\n\n        thread.dispose();\n    }\n\n    deleteCommentThreadMain(commentThreadId: string): void {\n        this.threads.forEach(thread => {\n            if (thread.threadId === commentThreadId) {\n                this._proxy.$deleteCommentThread(this._handle, thread.commentThreadHandle);\n            }\n        });\n    }\n\n    updateInput(input: string): void {\n        const thread = this.activeCommentThread;\n\n        if (thread && thread.input) {\n            const commentInput = thread.input;\n            commentInput.value = input;\n            thread.input = commentInput;\n        }\n    }\n\n    private getKnownThread(commentThreadHandle: number): CommentThreadImpl {\n        const thread = this.threads.get(commentThreadHandle);\n        if (!thread) {\n            throw new Error('unknown thread');\n        }\n        return thread;\n    }\n\n    async getDocumentComments(resource: URI, token: CancellationToken): Promise<CommentInfoMain> {\n        const ret: CommentThread[] = [];\n        for (const thread of [...this.threads.keys()]) {\n            const commentThread = this.threads.get(thread)!;\n            if (commentThread.resource === resource.toString()) {\n                ret.push(commentThread);\n            }\n        }\n\n        const commentingRanges = await this._proxy.$provideCommentingRanges(this.handle, resource, token);\n\n        return <CommentInfoMain>{\n            owner: this._uniqueId,\n            label: this.label,\n            threads: ret,\n            commentingRanges: {\n                resource: resource,\n                ranges: commentingRanges || []\n            }\n        };\n    }\n\n    async getCommentingRanges(resource: URI, token: CancellationToken): Promise<Range[]> {\n        const commentingRanges = await this._proxy.$provideCommentingRanges(this.handle, resource, token);\n        return commentingRanges || [];\n    }\n\n    getAllComments(): CommentThread[] {\n        const ret: CommentThread[] = [];\n        for (const thread of [...this.threads.keys()]) {\n            ret.push(this.threads.get(thread)!);\n        }\n\n        return ret;\n    }\n\n    createCommentThreadTemplate(resource: UriComponents, range: Range): void {\n        this._proxy.$createCommentThreadTemplate(this.handle, resource, range);\n    }\n\n    async updateCommentThreadTemplate(threadHandle: number, range: Range): Promise<void> {\n        await this._proxy.$updateCommentThreadTemplate(this.handle, threadHandle, range);\n    }\n}\n\nexport class CommentsMainImp implements CommentsMain {\n    private readonly proxy: CommentsExt;\n    private documentProviders = new Map<number, Disposable>();\n    private workspaceProviders = new Map<number, Disposable>();\n    private handlers = new Map<number, string>();\n    private commentControllers = new Map<number, CommentController>();\n\n    private activeCommentThread?: CommentThread;\n    private readonly commentService: CommentsService;\n\n    constructor(rpc: RPCProtocol, container: interfaces.Container) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.COMMENTS_EXT);\n        container.get(CommentsContribution);\n        this.commentService = container.get(CommentsService);\n        this.commentService.onDidChangeActiveCommentThread(async thread => {\n            const handle = (thread as CommentThread).controllerHandle;\n            const controller = this.commentControllers.get(handle);\n\n            if (!controller) {\n                return;\n            }\n\n            this.activeCommentThread = thread as CommentThread;\n            controller.activeCommentThread = this.activeCommentThread;\n        });\n    }\n\n    $registerCommentController(handle: number, id: string, label: string): void {\n        const providerId = uuidv4();\n        this.handlers.set(handle, providerId);\n\n        const provider = new CommentController(this.proxy, this.commentService, handle, providerId, id, label, {});\n        this.commentService.registerCommentController(providerId, provider);\n        this.commentControllers.set(handle, provider);\n        this.commentService.setWorkspaceComments(String(handle), []);\n    }\n\n    $unregisterCommentController(handle: number): void {\n        const providerId = this.handlers.get(handle);\n        if (typeof providerId !== 'string') {\n            throw new Error('unknown handler');\n        }\n        this.commentService.unregisterCommentController(providerId);\n        this.handlers.delete(handle);\n        this.commentControllers.delete(handle);\n    }\n\n    $updateCommentControllerFeatures(handle: number, features: CommentProviderFeatures): void {\n        const provider = this.commentControllers.get(handle);\n\n        if (!provider) {\n            return undefined;\n        }\n\n        provider.updateFeatures(features);\n    }\n\n    $createCommentThread(handle: number,\n        commentThreadHandle: number,\n        threadId: string,\n        resource: UriComponents,\n        range: Range,\n        extensionId: string\n    ): CommentThread | undefined {\n        const provider = this.commentControllers.get(handle);\n\n        if (!provider) {\n            return undefined;\n        }\n\n        return provider.createCommentThread(extensionId, commentThreadHandle, threadId, resource, range);\n    }\n\n    $updateCommentThread(handle: number,\n        commentThreadHandle: number,\n        threadId: string,\n        resource: UriComponents,\n        changes: CommentThreadChanges): void {\n        const provider = this.commentControllers.get(handle);\n\n        if (!provider) {\n            return undefined;\n        }\n\n        return provider.updateCommentThread(commentThreadHandle, threadId, resource, changes);\n    }\n\n    $deleteCommentThread(handle: number, commentThreadHandle: number): void {\n        const provider = this.commentControllers.get(handle);\n\n        if (!provider) {\n            return;\n        }\n\n        return provider.deleteCommentThread(commentThreadHandle);\n    }\n\n    private getHandler(handle: number): string {\n        if (!this.handlers.has(handle)) {\n            throw new Error('Unknown handler');\n        }\n        return this.handlers.get(handle)!;\n    }\n\n    $onDidCommentThreadsChange(handle: number, event: CommentThreadChangedEvent): void {\n        const providerId = this.getHandler(handle);\n        this.commentService.updateComments(providerId, event);\n    }\n\n    dispose(): void {\n        this.workspaceProviders.forEach(value => value.dispose());\n        this.workspaceProviders.clear();\n        this.documentProviders.forEach(value => value.dispose());\n        this.documentProviders.clear();\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2020 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { injectable } from '@theia/core/shared/inversify';\nimport { URI } from '@theia/core/shared/vscode-uri';\nimport { Event, Emitter } from '@theia/core/lib/common/event';\nimport {\n    Range,\n    CommentInfo,\n    CommentingRanges,\n    CommentThread,\n    CommentThreadChangedEvent,\n    CommentThreadChangedEventMain\n} from '../../../common/plugin-api-rpc-model';\nimport { CommentController } from './comments-main';\nimport { CancellationToken } from '@theia/core/lib/common/cancellation';\n\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n// some code copied and modified from https://github.com/microsoft/vscode/blob/1.49.3/src/vs/workbench/contrib/comments/browser/commentService.ts\n\nexport interface ResourceCommentThreadEvent {\n    resource: URI;\n    commentInfos: CommentInfoMain[];\n}\n\nexport interface CommentInfoMain extends CommentInfo {\n    owner: string;\n    label?: string;\n}\n\nexport interface WorkspaceCommentThreadsEventMain {\n    ownerId: string;\n    commentThreads: CommentThread[];\n}\n\nexport const CommentsService = Symbol('CommentsService');\n\nexport interface CommentsService {\n    readonly onDidSetResourceCommentInfos: Event<ResourceCommentThreadEvent>;\n    readonly onDidSetAllCommentThreads: Event<WorkspaceCommentThreadsEventMain>;\n    readonly onDidUpdateCommentThreads: Event<CommentThreadChangedEventMain>;\n    readonly onDidChangeActiveCommentThread: Event<CommentThread | null>;\n    readonly onDidChangeActiveCommentingRange: Event<{ range: Range, commentingRangesInfo: CommentingRanges }>;\n    readonly onDidSetDataProvider: Event<void>;\n    readonly onDidDeleteDataProvider: Event<string>;\n\n    setDocumentComments(resource: URI, commentInfos: CommentInfoMain[]): void;\n\n    setWorkspaceComments(owner: string, commentsByResource: CommentThread[]): void;\n\n    removeWorkspaceComments(owner: string): void;\n\n    registerCommentController(owner: string, commentControl: CommentController): void;\n\n    unregisterCommentController(owner: string): void;\n\n    getCommentController(owner: string): CommentController | undefined;\n\n    createCommentThreadTemplate(owner: string, resource: URI, range: Range): void;\n\n    updateCommentThreadTemplate(owner: string, threadHandle: number, range: Range): Promise<void>;\n\n    updateComments(ownerId: string, event: CommentThreadChangedEvent): void;\n\n    disposeCommentThread(ownerId: string, threadId: string): void;\n\n    getComments(resource: URI): Promise<(CommentInfoMain | null)[]>;\n\n    getCommentingRanges(resource: URI): Promise<Range[]>;\n\n    setActiveCommentThread(commentThread: CommentThread | null): void;\n}\n\n@injectable()\nexport class PluginCommentService implements CommentsService {\n\n    private readonly onDidSetDataProviderEmitter: Emitter<void> = new Emitter<void>();\n    readonly onDidSetDataProvider: Event<void> = this.onDidSetDataProviderEmitter.event;\n\n    private readonly onDidDeleteDataProviderEmitter: Emitter<string> = new Emitter<string>();\n    readonly onDidDeleteDataProvider: Event<string> = this.onDidDeleteDataProviderEmitter.event;\n\n    private readonly onDidSetResourceCommentInfosEmitter: Emitter<ResourceCommentThreadEvent> = new Emitter<ResourceCommentThreadEvent>();\n    readonly onDidSetResourceCommentInfos: Event<ResourceCommentThreadEvent> = this.onDidSetResourceCommentInfosEmitter.event;\n\n    private readonly onDidSetAllCommentThreadsEmitter: Emitter<WorkspaceCommentThreadsEventMain> = new Emitter<WorkspaceCommentThreadsEventMain>();\n    readonly onDidSetAllCommentThreads: Event<WorkspaceCommentThreadsEventMain> = this.onDidSetAllCommentThreadsEmitter.event;\n\n    private readonly onDidUpdateCommentThreadsEmitter: Emitter<CommentThreadChangedEventMain> = new Emitter<CommentThreadChangedEventMain>();\n    readonly onDidUpdateCommentThreads: Event<CommentThreadChangedEventMain> = this.onDidUpdateCommentThreadsEmitter.event;\n\n    private readonly onDidChangeActiveCommentThreadEmitter = new Emitter<CommentThread | null>();\n    readonly onDidChangeActiveCommentThread = this.onDidChangeActiveCommentThreadEmitter.event;\n\n    private readonly onDidChangeActiveCommentingRangeEmitter = new Emitter<{ range: Range, commentingRangesInfo: CommentingRanges }>();\n    readonly onDidChangeActiveCommentingRange: Event<{ range: Range, commentingRangesInfo: CommentingRanges }> = this.onDidChangeActiveCommentingRangeEmitter.event;\n\n    private commentControls = new Map<string, CommentController>();\n\n    setActiveCommentThread(commentThread: CommentThread | null): void {\n        this.onDidChangeActiveCommentThreadEmitter.fire(commentThread);\n    }\n\n    setDocumentComments(resource: URI, commentInfos: CommentInfoMain[]): void {\n        this.onDidSetResourceCommentInfosEmitter.fire({ resource, commentInfos });\n    }\n\n    setWorkspaceComments(owner: string, commentsByResource: CommentThread[]): void {\n        this.onDidSetAllCommentThreadsEmitter.fire({ ownerId: owner, commentThreads: commentsByResource });\n    }\n\n    removeWorkspaceComments(owner: string): void {\n        this.onDidSetAllCommentThreadsEmitter.fire({ ownerId: owner, commentThreads: [] });\n    }\n\n    registerCommentController(owner: string, commentControl: CommentController): void {\n        this.commentControls.set(owner, commentControl);\n        this.onDidSetDataProviderEmitter.fire();\n    }\n\n    unregisterCommentController(owner: string): void {\n        this.commentControls.delete(owner);\n        this.onDidDeleteDataProviderEmitter.fire(owner);\n    }\n\n    getCommentController(owner: string): CommentController | undefined {\n        return this.commentControls.get(owner);\n    }\n\n    createCommentThreadTemplate(owner: string, resource: URI, range: Range): void {\n        const commentController = this.commentControls.get(owner);\n\n        if (!commentController) {\n            return;\n        }\n\n        commentController.createCommentThreadTemplate(resource, range);\n    }\n\n    async updateCommentThreadTemplate(owner: string, threadHandle: number, range: Range): Promise<void> {\n        const commentController = this.commentControls.get(owner);\n\n        if (!commentController) {\n            return;\n        }\n\n        await commentController.updateCommentThreadTemplate(threadHandle, range);\n    }\n\n    disposeCommentThread(owner: string, threadId: string): void {\n        const controller = this.getCommentController(owner);\n        if (controller) {\n            controller.deleteCommentThreadMain(threadId);\n        }\n    }\n\n    updateComments(ownerId: string, event: CommentThreadChangedEvent): void {\n        const evt: CommentThreadChangedEventMain = Object.assign({}, event, { owner: ownerId });\n        this.onDidUpdateCommentThreadsEmitter.fire(evt);\n    }\n\n    async getComments(resource: URI): Promise<(CommentInfoMain | null)[]> {\n        const commentControlResult: Promise<CommentInfoMain | null>[] = [];\n\n        this.commentControls.forEach(control => {\n            commentControlResult.push(control.getDocumentComments(resource, CancellationToken.None)\n                .catch(e => {\n                    console.log(e);\n                    return null;\n                }));\n        });\n\n        return Promise.all(commentControlResult);\n    }\n\n    async getCommentingRanges(resource: URI): Promise<Range[]> {\n        const commentControlResult: Promise<Range[]>[] = [];\n\n        this.commentControls.forEach(control => {\n            commentControlResult.push(control.getCommentingRanges(resource, CancellationToken.None));\n        });\n\n        const ret = await Promise.all(commentControlResult);\n        return ret.reduce((prev, curr) => {\n            prev.push(...curr);\n            return prev;\n        }, []);\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2021 SAP SE or an SAP affiliate company and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n// copied and modified from https://github.com/microsoft/vscode/blob/53eac52308c4611000a171cc7bf1214293473c78/src/vs/workbench/contrib/customEditor/browser/customEditors.ts\n\nimport { injectable } from '@theia/core/shared/inversify';\nimport URI from '@theia/core/lib/common/uri';\nimport { Reference } from '@theia/core/lib/common/reference';\nimport { CustomEditorModel } from './custom-editors-main';\n\n@injectable()\nexport class CustomEditorService {\n    protected _models = new CustomEditorModelManager();\n    get models(): CustomEditorModelManager { return this._models; }\n}\n\nexport class CustomEditorModelManager {\n\n    private readonly references = new Map<string, {\n        readonly viewType: string,\n        readonly model: Promise<CustomEditorModel>,\n        counter: number\n    }>();\n\n    add(resource: URI, viewType: string, model: Promise<CustomEditorModel>): Promise<Reference<CustomEditorModel>> {\n        const key = this.key(resource, viewType);\n        const existing = this.references.get(key);\n        if (existing) {\n            throw new Error('Model already exists');\n        }\n\n        this.references.set(key, { viewType, model, counter: 0 });\n        return this.tryRetain(resource, viewType)!;\n    }\n\n    async get(resource: URI, viewType: string): Promise<CustomEditorModel | undefined> {\n        const key = this.key(resource, viewType);\n        const entry = this.references.get(key);\n        return entry?.model;\n    }\n\n    tryRetain(resource: URI, viewType: string): Promise<Reference<CustomEditorModel>> | undefined {\n        const key = this.key(resource, viewType);\n\n        const entry = this.references.get(key);\n        if (!entry) {\n            return undefined;\n        }\n\n        entry.counter++;\n\n        return entry.model.then(model => ({\n            object: model,\n            dispose: once(() => {\n                if (--entry!.counter <= 0) {\n                    entry.model.then(x => x.dispose());\n                    this.references.delete(key);\n                }\n            }),\n        }));\n    }\n\n    disposeAllModelsForView(viewType: string): void {\n        for (const [key, value] of this.references) {\n            if (value.viewType === viewType) {\n                value.model.then(x => x.dispose());\n                this.references.delete(key);\n            }\n        }\n    }\n\n    private key(resource: URI, viewType: string): string {\n        return `${resource.toString()}@@@${viewType}`;\n    }\n}\n\nexport function once<T extends Function>(this: unknown, fn: T): T {\n    const _this = this;\n    let didCall = false;\n    let result: unknown;\n\n    return function (): unknown {\n        if (didCall) {\n            return result;\n        }\n\n        didCall = true;\n        result = fn.apply(_this, arguments);\n\n        return result;\n    } as unknown as T;\n}\n","// *****************************************************************************\n// Copyright (C) 2021 SAP SE or an SAP affiliate company and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n// some code copied and modified from https://github.com/microsoft/vscode/blob/53eac52308c4611000a171cc7bf1214293473c78/src/vs/workbench/api/browser/mainThreadCustomEditors.ts\n\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { MAIN_RPC_CONTEXT, CustomEditorsMain, CustomEditorsExt, CustomTextEditorCapabilities } from '../../../common/plugin-api-rpc';\nimport { RPCProtocol } from '../../../common/rpc-protocol';\nimport { HostedPluginSupport } from '../../../hosted/browser/hosted-plugin';\nimport { PluginCustomEditorRegistry } from './plugin-custom-editor-registry';\nimport { CustomEditorWidget } from './custom-editor-widget';\nimport { Emitter, UNTITLED_SCHEME } from '@theia/core';\nimport { UriComponents } from '../../../common/uri-components';\nimport { URI } from '@theia/core/shared/vscode-uri';\nimport TheiaURI from '@theia/core/lib/common/uri';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\nimport { Reference } from '@theia/core/lib/common/reference';\nimport { CancellationToken, CancellationTokenSource } from '@theia/core/lib/common/cancellation';\nimport { MonacoEditorModel } from '@theia/monaco/lib/browser/monaco-editor-model';\nimport { EditorModelService } from '../text-editor-model-service';\nimport { CustomEditorService } from './custom-editor-service';\nimport { FileService } from '@theia/filesystem/lib/browser/file-service';\nimport { UndoRedoService } from '@theia/editor/lib/browser/undo-redo-service';\nimport { WebviewsMainImpl } from '../webviews-main';\nimport { WidgetManager } from '@theia/core/lib/browser/widget-manager';\nimport { ApplicationShell, DefaultUriLabelProviderContribution, Saveable, SaveOptions, WidgetOpenerOptions } from '@theia/core/lib/browser';\nimport { WebviewOptions, WebviewPanelOptions, WebviewPanelShowOptions } from '@theia/plugin';\nimport { WebviewWidgetIdentifier } from '../webview/webview';\nimport { EditorPreferences } from '@theia/editor/lib/browser';\nimport { ViewColumn, WebviewPanelTargetArea } from '../../../plugin/types-impl';\n\nconst enum CustomEditorModelType {\n    Custom,\n    Text,\n}\n\nexport class CustomEditorsMainImpl implements CustomEditorsMain, Disposable {\n    protected readonly pluginService: HostedPluginSupport;\n    protected readonly shell: ApplicationShell;\n    protected readonly textModelService: EditorModelService;\n    protected readonly fileService: FileService;\n    protected readonly customEditorService: CustomEditorService;\n    protected readonly undoRedoService: UndoRedoService;\n    protected readonly customEditorRegistry: PluginCustomEditorRegistry;\n    protected readonly labelProvider: DefaultUriLabelProviderContribution;\n    protected readonly widgetManager: WidgetManager;\n    protected readonly editorPreferences: EditorPreferences;\n    private readonly proxy: CustomEditorsExt;\n    private readonly editorProviders = new Map<string, Disposable>();\n\n    constructor(rpc: RPCProtocol,\n        container: interfaces.Container,\n        readonly webviewsMain: WebviewsMainImpl,\n    ) {\n        this.pluginService = container.get(HostedPluginSupport);\n        this.shell = container.get(ApplicationShell);\n        this.textModelService = container.get(EditorModelService);\n        this.fileService = container.get(FileService);\n        this.customEditorService = container.get(CustomEditorService);\n        this.undoRedoService = container.get(UndoRedoService);\n        this.customEditorRegistry = container.get(PluginCustomEditorRegistry);\n        this.labelProvider = container.get(DefaultUriLabelProviderContribution);\n        this.editorPreferences = container.get(EditorPreferences);\n        this.widgetManager = container.get(WidgetManager);\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.CUSTOM_EDITORS_EXT);\n    }\n\n    dispose(): void {\n        for (const disposable of this.editorProviders.values()) {\n            disposable.dispose();\n        }\n        this.editorProviders.clear();\n    }\n\n    $registerTextEditorProvider(\n        viewType: string, options: WebviewPanelOptions, capabilities: CustomTextEditorCapabilities): void {\n        this.registerEditorProvider(CustomEditorModelType.Text, viewType, options, capabilities, true);\n    }\n\n    $registerCustomEditorProvider(viewType: string, options: WebviewPanelOptions, supportsMultipleEditorsPerDocument: boolean): void {\n        this.registerEditorProvider(CustomEditorModelType.Custom, viewType, options, {}, supportsMultipleEditorsPerDocument);\n    }\n\n    protected async registerEditorProvider(\n        modelType: CustomEditorModelType,\n        viewType: string,\n        options: WebviewPanelOptions,\n        capabilities: CustomTextEditorCapabilities,\n        supportsMultipleEditorsPerDocument: boolean,\n    ): Promise<void> {\n        if (this.editorProviders.has(viewType)) {\n            throw new Error(`Provider for ${viewType} already registered`);\n        }\n\n        const disposables = new DisposableCollection();\n\n        disposables.push(\n            this.customEditorRegistry.registerResolver(viewType, async (widget, widgetOpenerOptions) => {\n                const { resource, identifier } = widget;\n                widget.options = options;\n\n                const cancellationSource = new CancellationTokenSource();\n                let modelRef = await this.getOrCreateCustomEditorModel(modelType, resource, viewType, cancellationSource.token);\n                widget.modelRef = modelRef;\n\n                widget.onDidDispose(() => {\n                    // If the model is still dirty, make sure we have time to save it\n                    if (modelRef.object.dirty) {\n                        const sub = modelRef.object.onDirtyChanged(() => {\n                            if (!modelRef.object.dirty) {\n                                sub.dispose();\n                                modelRef.dispose();\n                            }\n                        });\n                        return;\n                    }\n\n                    modelRef.dispose();\n                });\n\n                if (capabilities.supportsMove) {\n                    const onMoveCancelTokenSource = new CancellationTokenSource();\n                    widget.onMove(async (newResource: TheiaURI) => {\n                        const oldModel = modelRef;\n                        modelRef = await this.getOrCreateCustomEditorModel(modelType, newResource, viewType, onMoveCancelTokenSource.token);\n                        this.proxy.$onMoveCustomEditor(identifier.id, URI.file(newResource.path.toString()), viewType);\n                        oldModel.dispose();\n                    });\n                }\n\n                const _cancellationSource = new CancellationTokenSource();\n                await this.proxy.$resolveWebviewEditor(\n                    URI.file(resource.path.toString()),\n                    identifier.id,\n                    viewType,\n                    this.labelProvider.getName(resource)!,\n                    widgetOpenerOptions,\n                    options,\n                    _cancellationSource.token\n                );\n            })\n        );\n\n        this.editorProviders.set(viewType, disposables);\n    }\n\n    $unregisterEditorProvider(viewType: string): void {\n        const provider = this.editorProviders.get(viewType);\n        if (!provider) {\n            throw new Error(`No provider for ${viewType} registered`);\n        }\n\n        provider.dispose();\n        this.editorProviders.delete(viewType);\n\n        this.customEditorService.models.disposeAllModelsForView(viewType);\n    }\n\n    protected async getOrCreateCustomEditorModel(\n        modelType: CustomEditorModelType,\n        resource: TheiaURI,\n        viewType: string,\n        cancellationToken: CancellationToken,\n    ): Promise<Reference<CustomEditorModel>> {\n        const existingModel = this.customEditorService.models.tryRetain(resource, viewType);\n        if (existingModel) {\n            return existingModel;\n        }\n\n        switch (modelType) {\n            case CustomEditorModelType.Text: {\n                const model = CustomTextEditorModel.create(viewType, resource, this.textModelService, this.fileService);\n                return this.customEditorService.models.add(resource, viewType, model);\n            }\n            case CustomEditorModelType.Custom: {\n                const model = MainCustomEditorModel.create(this.proxy, viewType, resource, this.undoRedoService, this.fileService, this.editorPreferences, cancellationToken);\n                return this.customEditorService.models.add(resource, viewType, model);\n            }\n        }\n    }\n\n    protected async getCustomEditorModel(resourceComponents: UriComponents, viewType: string): Promise<MainCustomEditorModel> {\n        const resource = URI.revive(resourceComponents);\n        const model = await this.customEditorService.models.get(new TheiaURI(resource), viewType);\n        if (!model || !(model instanceof MainCustomEditorModel)) {\n            throw new Error('Could not find model for custom editor');\n        }\n        return model;\n    }\n\n    async $onDidEdit(resourceComponents: UriComponents, viewType: string, editId: number, label: string | undefined): Promise<void> {\n        const model = await this.getCustomEditorModel(resourceComponents, viewType);\n        model.pushEdit(editId, label);\n    }\n\n    async $onContentChange(resourceComponents: UriComponents, viewType: string): Promise<void> {\n        const model = await this.getCustomEditorModel(resourceComponents, viewType);\n        model.changeContent();\n    }\n\n    async $createCustomEditorPanel(\n        panelId: string,\n        title: string,\n        widgetOpenerOptions: WidgetOpenerOptions | undefined,\n        options: WebviewPanelOptions & WebviewOptions\n    ): Promise<void> {\n        const view = await this.widgetManager.getOrCreateWidget<CustomEditorWidget>(CustomEditorWidget.FACTORY_ID, <WebviewWidgetIdentifier>{ id: panelId });\n        this.webviewsMain.hookWebview(view);\n        view.title.label = title;\n        const { enableFindWidget, retainContextWhenHidden, enableScripts, enableForms, localResourceRoots, ...contentOptions } = options;\n        view.viewColumn = ViewColumn.One; // behaviour might be overridden later using widgetOpenerOptions (if available)\n        view.options = { enableFindWidget, retainContextWhenHidden };\n        view.setContentOptions({\n            allowScripts: enableScripts,\n            allowForms: enableForms,\n            localResourceRoots: localResourceRoots && localResourceRoots.map(root => root.toString()),\n            ...contentOptions,\n            ...view.contentOptions\n        });\n        if (view.isAttached) {\n            if (view.isVisible) {\n                this.shell.revealWidget(view.id);\n            }\n            return;\n        }\n        const showOptions: WebviewPanelShowOptions = {\n            preserveFocus: true\n        };\n\n        if (widgetOpenerOptions) {\n            if (widgetOpenerOptions.mode === 'reveal') {\n                showOptions.preserveFocus = false;\n            }\n\n            if (widgetOpenerOptions.widgetOptions) {\n                let area: WebviewPanelTargetArea;\n                switch (widgetOpenerOptions.widgetOptions.area) {\n                    case 'main':\n                        area = WebviewPanelTargetArea.Main;\n                    case 'left':\n                        area = WebviewPanelTargetArea.Left;\n                    case 'right':\n                        area = WebviewPanelTargetArea.Right;\n                    case 'bottom':\n                        area = WebviewPanelTargetArea.Bottom;\n                    default: // includes 'top' and 'secondaryWindow'\n                        area = WebviewPanelTargetArea.Main;\n                }\n                showOptions.area = area;\n\n                if (widgetOpenerOptions.widgetOptions.mode === 'split-right' ||\n                    widgetOpenerOptions.widgetOptions.mode === 'open-to-right') {\n                    showOptions.viewColumn = ViewColumn.Beside;\n                }\n            }\n        }\n\n        this.webviewsMain.addOrReattachWidget(view, showOptions);\n    }\n}\n\nexport interface CustomEditorModel extends Saveable, Disposable {\n    readonly viewType: string;\n    readonly resource: URI;\n    readonly readonly: boolean;\n    readonly dirty: boolean;\n\n    revert(options?: Saveable.RevertOptions): Promise<void>;\n    saveCustomEditor(options?: SaveOptions): Promise<void>;\n    saveCustomEditorAs(resource: TheiaURI, targetResource: TheiaURI, options?: SaveOptions): Promise<void>;\n}\n\nexport class MainCustomEditorModel implements CustomEditorModel {\n    private currentEditIndex: number = -1;\n    private savePoint: number = -1;\n    private isDirtyFromContentChange = false;\n    private ongoingSave?: CancellationTokenSource;\n    private readonly edits: Array<number> = [];\n    private readonly toDispose = new DisposableCollection();\n\n    private readonly onDirtyChangedEmitter = new Emitter<void>();\n    readonly onDirtyChanged = this.onDirtyChangedEmitter.event;\n\n    autoSave: 'off' | 'afterDelay' | 'onFocusChange' | 'onWindowChange';\n    autoSaveDelay: number;\n\n    static async create(\n        proxy: CustomEditorsExt,\n        viewType: string,\n        resource: TheiaURI,\n        undoRedoService: UndoRedoService,\n        fileService: FileService,\n        editorPreferences: EditorPreferences,\n        cancellation: CancellationToken,\n    ): Promise<MainCustomEditorModel> {\n        const { editable } = await proxy.$createCustomDocument(URI.file(resource.path.toString()), viewType, {}, cancellation);\n        return new MainCustomEditorModel(proxy, viewType, resource, editable, undoRedoService, fileService, editorPreferences);\n    }\n\n    constructor(\n        private proxy: CustomEditorsExt,\n        readonly viewType: string,\n        private readonly editorResource: TheiaURI,\n        private readonly editable: boolean,\n        private readonly undoRedoService: UndoRedoService,\n        private readonly fileService: FileService,\n        private readonly editorPreferences: EditorPreferences\n    ) {\n        this.autoSave = this.editorPreferences.get('files.autoSave', undefined, editorResource.toString());\n        this.autoSaveDelay = this.editorPreferences.get('files.autoSaveDelay', undefined, editorResource.toString());\n\n        this.toDispose.push(\n            this.editorPreferences.onPreferenceChanged(event => {\n                if (event.preferenceName === 'files.autoSave') {\n                    this.autoSave = this.editorPreferences.get('files.autoSave', undefined, editorResource.toString());\n                }\n                if (event.preferenceName === 'files.autoSaveDelay') {\n                    this.autoSaveDelay = this.editorPreferences.get('files.autoSaveDelay', undefined, editorResource.toString());\n                }\n            })\n        );\n        this.toDispose.push(this.onDirtyChangedEmitter);\n    }\n\n    get resource(): URI {\n        return URI.file(this.editorResource.path.toString());\n    }\n\n    get dirty(): boolean {\n        if (this.isDirtyFromContentChange) {\n            return true;\n        }\n        if (this.edits.length > 0) {\n            return this.savePoint !== this.currentEditIndex;\n        }\n        return false;\n    }\n\n    get readonly(): boolean {\n        return !this.editable;\n    }\n\n    setProxy(proxy: CustomEditorsExt): void {\n        this.proxy = proxy;\n    }\n\n    dispose(): void {\n        if (this.editable) {\n            this.undoRedoService.removeElements(this.editorResource);\n        }\n        this.proxy.$disposeCustomDocument(this.resource, this.viewType);\n    }\n\n    changeContent(): void {\n        this.change(() => {\n            this.isDirtyFromContentChange = true;\n        });\n    }\n\n    pushEdit(editId: number, label: string | undefined): void {\n        if (!this.editable) {\n            throw new Error('Document is not editable');\n        }\n\n        this.change(() => {\n            this.spliceEdits(editId);\n            this.currentEditIndex = this.edits.length - 1;\n        });\n\n        this.undoRedoService.pushElement(\n            this.editorResource,\n            () => this.undo(),\n            () => this.redo(),\n        );\n    }\n\n    async revert(options?: Saveable.RevertOptions): Promise<void> {\n        if (!this.editable) {\n            return;\n        }\n\n        if (this.currentEditIndex === this.savePoint && !this.isDirtyFromContentChange) {\n            return;\n        }\n\n        const cancellationSource = new CancellationTokenSource();\n        this.proxy.$revert(this.resource, this.viewType, cancellationSource.token);\n        this.change(() => {\n            this.isDirtyFromContentChange = false;\n            this.currentEditIndex = this.savePoint;\n            this.spliceEdits();\n        });\n    }\n\n    async save(options?: SaveOptions): Promise<void> {\n        await this.saveCustomEditor(options);\n    }\n\n    async saveCustomEditor(options?: SaveOptions): Promise<void> {\n        if (!this.editable) {\n            return;\n        }\n\n        const cancelable = new CancellationTokenSource();\n        const savePromise = this.proxy.$onSave(this.resource, this.viewType, cancelable.token);\n        this.ongoingSave?.cancel();\n        this.ongoingSave = cancelable;\n\n        try {\n            await savePromise;\n\n            if (this.ongoingSave === cancelable) { // Make sure we are still doing the same save\n                this.change(() => {\n                    this.isDirtyFromContentChange = false;\n                    this.savePoint = this.currentEditIndex;\n                });\n            }\n        } finally {\n            if (this.ongoingSave === cancelable) { // Make sure we are still doing the same save\n                this.ongoingSave = undefined;\n            }\n        }\n    }\n\n    async saveCustomEditorAs(resource: TheiaURI, targetResource: TheiaURI, options?: SaveOptions): Promise<void> {\n        if (this.editable) {\n            const source = new CancellationTokenSource();\n            await this.proxy.$onSaveAs(this.resource, this.viewType, URI.file(targetResource.path.toString()), source.token);\n            this.change(() => {\n                this.savePoint = this.currentEditIndex;\n            });\n        } else {\n            // Since the editor is readonly, just copy the file over\n            await this.fileService.copy(resource, targetResource, { overwrite: false });\n        }\n    }\n\n    private async undo(): Promise<void> {\n        if (!this.editable) {\n            return;\n        }\n\n        if (this.currentEditIndex < 0) {\n            // nothing to undo\n            return;\n        }\n\n        const undoneEdit = this.edits[this.currentEditIndex];\n        this.change(() => {\n            --this.currentEditIndex;\n        });\n        await this.proxy.$undo(this.resource, this.viewType, undoneEdit, this.dirty);\n    }\n\n    private async redo(): Promise<void> {\n        if (!this.editable) {\n            return;\n        }\n\n        if (this.currentEditIndex >= this.edits.length - 1) {\n            // nothing to redo\n            return;\n        }\n\n        const redoneEdit = this.edits[this.currentEditIndex + 1];\n        this.change(() => {\n            ++this.currentEditIndex;\n        });\n        await this.proxy.$redo(this.resource, this.viewType, redoneEdit, this.dirty);\n    }\n\n    private spliceEdits(editToInsert?: number): void {\n        const start = this.currentEditIndex + 1;\n        const toRemove = this.edits.length - this.currentEditIndex;\n\n        const removedEdits = typeof editToInsert === 'number'\n            ? this.edits.splice(start, toRemove, editToInsert)\n            : this.edits.splice(start, toRemove);\n\n        if (removedEdits.length) {\n            this.proxy.$disposeEdits(this.resource, this.viewType, removedEdits);\n        }\n    }\n\n    private change(makeEdit: () => void): void {\n        const wasDirty = this.dirty;\n        makeEdit();\n\n        if (this.dirty !== wasDirty) {\n            this.onDirtyChangedEmitter.fire();\n        }\n\n        if (this.autoSave !== 'off' && this.dirty && this.resource.scheme !== UNTITLED_SCHEME) {\n            const handle = window.setTimeout(() => {\n                this.save();\n                window.clearTimeout(handle);\n            }, this.autoSaveDelay);\n        }\n    }\n\n}\n\n// copied from https://github.com/microsoft/vscode/blob/53eac52308c4611000a171cc7bf1214293473c78/src/vs/workbench/contrib/customEditor/common/customTextEditorModel.ts\nexport class CustomTextEditorModel implements CustomEditorModel {\n    private readonly toDispose = new DisposableCollection();\n    private readonly onDirtyChangedEmitter = new Emitter<void>();\n    readonly onDirtyChanged = this.onDirtyChangedEmitter.event;\n\n    static async create(\n        viewType: string,\n        resource: TheiaURI,\n        editorModelService: EditorModelService,\n        fileService: FileService,\n    ): Promise<CustomTextEditorModel> {\n        const model = await editorModelService.createModelReference(resource);\n        model.object.suppressOpenEditorWhenDirty = true;\n        return new CustomTextEditorModel(viewType, resource, model, fileService);\n    }\n\n    constructor(\n        readonly viewType: string,\n        readonly editorResource: TheiaURI,\n        private readonly model: Reference<MonacoEditorModel>,\n        private readonly fileService: FileService,\n    ) {\n        this.toDispose.push(\n            this.editorTextModel.onDirtyChanged(e => {\n                this.onDirtyChangedEmitter.fire();\n            })\n        );\n        this.toDispose.push(this.onDirtyChangedEmitter);\n    }\n\n    get autoSave(): 'off' | 'afterDelay' | 'onFocusChange' | 'onWindowChange' {\n        return this.editorTextModel.autoSave;\n    }\n\n    get autoSaveDelay(): number {\n        return this.editorTextModel.autoSaveDelay;\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n        this.model.dispose();\n    }\n\n    get resource(): URI {\n        return URI.file(this.editorResource.path.toString());\n    }\n\n    get dirty(): boolean {\n        return this.editorTextModel.dirty;\n    };\n\n    get readonly(): boolean {\n        return this.editorTextModel.readOnly;\n    }\n\n    get editorTextModel(): MonacoEditorModel {\n        return this.model.object;\n    }\n\n    revert(options?: Saveable.RevertOptions): Promise<void> {\n        return this.editorTextModel.revert(options);\n    }\n\n    save(options?: SaveOptions): Promise<void> {\n        return this.saveCustomEditor(options);\n    }\n\n    saveCustomEditor(options?: SaveOptions): Promise<void> {\n        return this.editorTextModel.save(options);\n    }\n\n    async saveCustomEditorAs(resource: TheiaURI, targetResource: TheiaURI, options?: SaveOptions): Promise<void> {\n        await this.saveCustomEditor(options);\n        await this.fileService.copy(resource, targetResource, { overwrite: false });\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2021 SAP SE or an SAP affiliate company and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { injectable, inject, postConstruct } from '@theia/core/shared/inversify';\nimport { CustomEditor } from '../../../common';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\nimport { CustomEditorOpener } from './custom-editor-opener';\nimport { WorkspaceCommands } from '@theia/workspace/lib/browser';\nimport { CommandRegistry, Emitter, MenuModelRegistry } from '@theia/core';\nimport { SelectionService } from '@theia/core/lib/common';\nimport { UriAwareCommandHandler } from '@theia/core/lib/common/uri-command-handler';\nimport { NavigatorContextMenu } from '@theia/navigator/lib//browser/navigator-contribution';\nimport { ApplicationShell, DefaultOpenerService, WidgetManager, WidgetOpenerOptions } from '@theia/core/lib/browser';\nimport { CustomEditorWidget } from './custom-editor-widget';\n\n@injectable()\nexport class PluginCustomEditorRegistry {\n    private readonly editors = new Map<string, CustomEditor>();\n    private readonly pendingEditors = new Set<CustomEditorWidget>();\n    private readonly resolvers = new Map<string, (widget: CustomEditorWidget, options?: WidgetOpenerOptions) => void>();\n\n    private readonly onWillOpenCustomEditorEmitter = new Emitter<string>();\n    readonly onWillOpenCustomEditor = this.onWillOpenCustomEditorEmitter.event;\n\n    @inject(DefaultOpenerService)\n    protected readonly defaultOpenerService: DefaultOpenerService;\n\n    @inject(MenuModelRegistry)\n    protected readonly menuModelRegistry: MenuModelRegistry;\n\n    @inject(CommandRegistry)\n    protected readonly commandRegistry: CommandRegistry;\n\n    @inject(SelectionService)\n    protected readonly selectionService: SelectionService;\n\n    @inject(WidgetManager)\n    protected readonly widgetManager: WidgetManager;\n\n    @inject(ApplicationShell)\n    protected readonly shell: ApplicationShell;\n\n    @postConstruct()\n    protected init(): void {\n        this.widgetManager.onDidCreateWidget(({ factoryId, widget }) => {\n            if (factoryId === CustomEditorWidget.FACTORY_ID && widget instanceof CustomEditorWidget) {\n                const restoreState = widget.restoreState.bind(widget);\n\n                widget.restoreState = state => {\n                    if (state.viewType && state.strResource) {\n                        restoreState(state);\n                        this.resolveWidget(widget);\n                    } else {\n                        widget.dispose();\n                    }\n                };\n            }\n        });\n    }\n\n    registerCustomEditor(editor: CustomEditor): Disposable {\n        if (this.editors.has(editor.viewType)) {\n            console.warn('editor with such id already registered: ', JSON.stringify(editor));\n            return Disposable.NULL;\n        }\n        this.editors.set(editor.viewType, editor);\n\n        const toDispose = new DisposableCollection();\n        toDispose.push(Disposable.create(() => this.editors.delete(editor.viewType)));\n\n        const editorOpenHandler = new CustomEditorOpener(\n            editor,\n            this.shell,\n            this.widgetManager\n        );\n        toDispose.push(this.defaultOpenerService.addHandler(editorOpenHandler));\n\n        const openWithCommand = WorkspaceCommands.FILE_OPEN_WITH(editorOpenHandler);\n        toDispose.push(\n            this.menuModelRegistry.registerMenuAction(\n                NavigatorContextMenu.OPEN_WITH,\n                {\n                    commandId: openWithCommand.id,\n                    label: editorOpenHandler.label\n                }\n            )\n        );\n        toDispose.push(\n            this.commandRegistry.registerCommand(\n                openWithCommand,\n                UriAwareCommandHandler.MonoSelect(this.selectionService, {\n                    execute: uri => editorOpenHandler.open(uri),\n                    isEnabled: uri => editorOpenHandler.canHandle(uri) > 0,\n                    isVisible: uri => editorOpenHandler.canHandle(uri) > 0\n                })\n            )\n        );\n        toDispose.push(\n            editorOpenHandler.onDidOpenCustomEditor(event => this.resolveWidget(event[0], event[1]))\n        );\n        return toDispose;\n    }\n\n    resolveWidget = (widget: CustomEditorWidget, options?: WidgetOpenerOptions) => {\n        const resolver = this.resolvers.get(widget.viewType);\n        if (resolver) {\n            resolver(widget, options);\n        } else {\n            this.pendingEditors.add(widget);\n            this.onWillOpenCustomEditorEmitter.fire(widget.viewType);\n        }\n    };\n\n    registerResolver(viewType: string, resolver: (widget: CustomEditorWidget, options?: WidgetOpenerOptions) => void): Disposable {\n        if (this.resolvers.has(viewType)) {\n            throw new Error(`Resolver for ${viewType} already registered`);\n        }\n\n        for (const editorWidget of this.pendingEditors) {\n            if (editorWidget.viewType === viewType) {\n                resolver(editorWidget);\n                this.pendingEditors.delete(editorWidget);\n            }\n        }\n\n        this.resolvers.set(viewType, resolver);\n        return Disposable.create(() => this.resolvers.delete(viewType));\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { IDataTransferItem, VSDataTransfer } from '@theia/monaco-editor-core/esm/vs/base/common/dataTransfer';\nimport { DataTransferDTO, DataTransferItemDTO } from '../../../common/plugin-api-rpc-model';\nimport { URI } from '../../../plugin/types-impl';\n\nexport namespace DataTransferItem {\n    export async function from(mime: string, item: IDataTransferItem): Promise<DataTransferItemDTO> {\n        const stringValue = await item.asString();\n\n        if (mime === 'text/uri-list') {\n            return {\n                id: item.id,\n                asString: '',\n                fileData: undefined,\n                uriListData: serializeUriList(stringValue),\n            };\n        }\n\n        const fileValue = item.asFile();\n        return {\n            id: item.id,\n            asString: stringValue,\n            fileData: fileValue ? { name: fileValue.name, uri: fileValue.uri } : undefined,\n        };\n    }\n\n    function serializeUriList(stringValue: string): ReadonlyArray<string | URI> {\n        return stringValue.split('\\r\\n').map(part => {\n            if (part.startsWith('#')) {\n                return part;\n            }\n\n            try {\n                return URI.parse(part);\n            } catch {\n                // noop\n            }\n\n            return part;\n        });\n    }\n}\n\nexport namespace DataTransfer {\n    export async function toDataTransferDTO(value: VSDataTransfer): Promise<DataTransferDTO> {\n        return {\n            items: await Promise.all(\n                Array.from(value.entries())\n                    .map(\n                        async ([mime, item]) => [mime, await DataTransferItem.from(mime, item)]\n                    )\n            )\n        };\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { RPCProtocol } from '../../../common/rpc-protocol';\nimport {\n    DebugConfigurationProviderDescriptor,\n    DebugMain,\n    DebugExt,\n    MAIN_RPC_CONTEXT\n} from '../../../common/plugin-api-rpc';\nimport { DebugSessionManager } from '@theia/debug/lib/browser/debug-session-manager';\nimport { Breakpoint, WorkspaceFolder } from '../../../common/plugin-api-rpc-model';\nimport { LabelProvider } from '@theia/core/lib/browser';\nimport { EditorManager } from '@theia/editor/lib/browser';\nimport { BreakpointManager, BreakpointsChangeEvent } from '@theia/debug/lib/browser/breakpoint/breakpoint-manager';\nimport { DebugSourceBreakpoint } from '@theia/debug/lib/browser/model/debug-source-breakpoint';\nimport { URI as Uri } from '@theia/core/shared/vscode-uri';\nimport { SourceBreakpoint, FunctionBreakpoint } from '@theia/debug/lib/browser/breakpoint/breakpoint-marker';\nimport { DebugConfiguration, DebugSessionOptions } from '@theia/debug/lib/common/debug-configuration';\nimport { DebuggerDescription } from '@theia/debug/lib/common/debug-service';\nimport { DebugProtocol } from '@vscode/debugprotocol';\nimport { DebugConfigurationManager } from '@theia/debug/lib/browser/debug-configuration-manager';\nimport { TerminalService } from '@theia/terminal/lib/browser/base/terminal-service';\nimport { MessageClient } from '@theia/core/lib/common/message-service-protocol';\nimport { OutputChannelManager } from '@theia/output/lib/browser/output-channel';\nimport { DebugPreferences } from '@theia/debug/lib/browser/debug-preferences';\nimport { PluginDebugAdapterContribution } from './plugin-debug-adapter-contribution';\nimport { PluginDebugConfigurationProvider } from './plugin-debug-configuration-provider';\nimport { PluginDebugSessionContributionRegistrator, PluginDebugSessionContributionRegistry } from './plugin-debug-session-contribution-registry';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\nimport { PluginDebugSessionFactory } from './plugin-debug-session-factory';\nimport { PluginDebugService } from './plugin-debug-service';\nimport { HostedPluginSupport } from '../../../hosted/browser/hosted-plugin';\nimport { DebugFunctionBreakpoint } from '@theia/debug/lib/browser/model/debug-function-breakpoint';\nimport { FileService } from '@theia/filesystem/lib/browser/file-service';\nimport { ConsoleSessionManager } from '@theia/console/lib/browser/console-session-manager';\nimport { DebugConsoleSession } from '@theia/debug/lib/browser/console/debug-console-session';\nimport { ContributionProvider } from '@theia/core/lib/common';\nimport { DebugContribution } from '@theia/debug/lib/browser/debug-contribution';\nimport { ConnectionImpl } from '../../../common/connection';\nimport { WorkspaceService } from '@theia/workspace/lib/browser';\nimport { DebugSessionOptions as TheiaDebugSessionOptions } from '@theia/debug/lib/browser/debug-session-options';\n\nexport class DebugMainImpl implements DebugMain, Disposable {\n    private readonly debugExt: DebugExt;\n\n    private readonly sessionManager: DebugSessionManager;\n    private readonly labelProvider: LabelProvider;\n    private readonly editorManager: EditorManager;\n    private readonly breakpointsManager: BreakpointManager;\n    private readonly consoleSessionManager: ConsoleSessionManager;\n    private readonly configurationManager: DebugConfigurationManager;\n    private readonly terminalService: TerminalService;\n    private readonly messages: MessageClient;\n    private readonly outputChannelManager: OutputChannelManager;\n    private readonly debugPreferences: DebugPreferences;\n    private readonly sessionContributionRegistrator: PluginDebugSessionContributionRegistrator;\n    private readonly pluginDebugService: PluginDebugService;\n    private readonly fileService: FileService;\n    private readonly pluginService: HostedPluginSupport;\n    private readonly debugContributionProvider: ContributionProvider<DebugContribution>;\n    private readonly workspaceService: WorkspaceService;\n\n    private readonly debuggerContributions = new Map<string, DisposableCollection>();\n    private readonly configurationProviders = new Map<number, DisposableCollection>();\n    private readonly toDispose = new DisposableCollection();\n\n    constructor(rpc: RPCProtocol, readonly connectionMain: ConnectionImpl, container: interfaces.Container) {\n        this.debugExt = rpc.getProxy(MAIN_RPC_CONTEXT.DEBUG_EXT);\n        this.sessionManager = container.get(DebugSessionManager);\n        this.labelProvider = container.get(LabelProvider);\n        this.editorManager = container.get(EditorManager);\n        this.breakpointsManager = container.get(BreakpointManager);\n        this.consoleSessionManager = container.get(ConsoleSessionManager);\n        this.configurationManager = container.get(DebugConfigurationManager);\n        this.terminalService = container.get(TerminalService);\n        this.messages = container.get(MessageClient);\n        this.outputChannelManager = container.get(OutputChannelManager);\n        this.debugPreferences = container.get(DebugPreferences);\n        this.pluginDebugService = container.get(PluginDebugService);\n        this.sessionContributionRegistrator = container.get(PluginDebugSessionContributionRegistry);\n        this.debugContributionProvider = container.getNamed(ContributionProvider, DebugContribution);\n        this.fileService = container.get(FileService);\n        this.pluginService = container.get(HostedPluginSupport);\n        this.workspaceService = container.get(WorkspaceService);\n\n        const fireDidChangeBreakpoints = ({ added, removed, changed }: BreakpointsChangeEvent<SourceBreakpoint | FunctionBreakpoint>) => {\n            this.debugExt.$breakpointsDidChange(\n                this.toTheiaPluginApiBreakpoints(added),\n                removed.map(b => b.id),\n                this.toTheiaPluginApiBreakpoints(changed)\n            );\n        };\n        this.debugExt.$breakpointsDidChange(this.toTheiaPluginApiBreakpoints(this.breakpointsManager.getBreakpoints()), [], []);\n        this.debugExt.$breakpointsDidChange(this.toTheiaPluginApiBreakpoints(this.breakpointsManager.getFunctionBreakpoints()), [], []);\n\n        this.toDispose.pushAll([\n            this.breakpointsManager.onDidChangeBreakpoints(fireDidChangeBreakpoints),\n            this.breakpointsManager.onDidChangeFunctionBreakpoints(fireDidChangeBreakpoints),\n            this.sessionManager.onDidCreateDebugSession(debugSession => this.debugExt.$sessionDidCreate(debugSession.id)),\n            this.sessionManager.onDidStartDebugSession(debugSession => this.debugExt.$sessionDidStart(debugSession.id)),\n            this.sessionManager.onDidDestroyDebugSession(debugSession => this.debugExt.$sessionDidDestroy(debugSession.id)),\n            this.sessionManager.onDidChangeActiveDebugSession(event => this.debugExt.$sessionDidChange(event.current && event.current.id)),\n            this.sessionManager.onDidReceiveDebugSessionCustomEvent(event => this.debugExt.$onSessionCustomEvent(event.session.id, event.event, event.body))\n        ]);\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    async $appendToDebugConsole(value: string): Promise<void> {\n        const session = this.consoleSessionManager.selectedSession;\n        if (session instanceof DebugConsoleSession) {\n            session.append(value);\n        }\n    }\n\n    async $appendLineToDebugConsole(value: string): Promise<void> {\n        const session = this.consoleSessionManager.selectedSession;\n        if (session instanceof DebugConsoleSession) {\n            session.appendLine(value);\n        }\n    }\n\n    async $registerDebuggerContribution(description: DebuggerDescription): Promise<void> {\n        const debugType = description.type;\n        const terminalOptionsExt = await this.debugExt.$getTerminalCreationOptions(debugType);\n        if (this.toDispose.disposed) {\n            return;\n        }\n\n        const debugSessionFactory = new PluginDebugSessionFactory(\n            this.terminalService,\n            this.editorManager,\n            this.breakpointsManager,\n            this.labelProvider,\n            this.messages,\n            this.outputChannelManager,\n            this.debugPreferences,\n            async (sessionId: string) => {\n                const connection = await this.connectionMain.ensureConnection(sessionId);\n                return connection;\n            },\n            this.fileService,\n            terminalOptionsExt,\n            this.debugContributionProvider,\n            this.workspaceService,\n        );\n\n        const toDispose = new DisposableCollection(\n            Disposable.create(() => this.debuggerContributions.delete(debugType))\n        );\n        this.debuggerContributions.set(debugType, toDispose);\n        toDispose.pushAll([\n            this.pluginDebugService.registerDebugAdapterContribution(\n                new PluginDebugAdapterContribution(description, this.debugExt, this.pluginService)\n            ),\n            this.sessionContributionRegistrator.registerDebugSessionContribution({\n                debugType: description.type,\n                debugSessionFactory: () => debugSessionFactory\n            })\n        ]);\n        this.toDispose.push(Disposable.create(() => this.$unregisterDebuggerConfiguration(debugType)));\n    }\n\n    async $unregisterDebuggerConfiguration(debugType: string): Promise<void> {\n        const disposable = this.debuggerContributions.get(debugType);\n        if (disposable) {\n            disposable.dispose();\n        }\n    }\n\n    $registerDebugConfigurationProvider(description: DebugConfigurationProviderDescriptor): void {\n        const handle = description.handle;\n        const toDispose = new DisposableCollection(\n            Disposable.create(() => this.configurationProviders.delete(handle))\n        );\n        this.configurationProviders.set(handle, toDispose);\n\n        toDispose.push(\n            this.pluginDebugService.registerDebugConfigurationProvider(new PluginDebugConfigurationProvider(description, this.debugExt))\n        );\n\n        this.toDispose.push(Disposable.create(() => this.$unregisterDebugConfigurationProvider(handle)));\n    }\n\n    async $unregisterDebugConfigurationProvider(handle: number): Promise<void> {\n        const disposable = this.configurationProviders.get(handle);\n        if (disposable) {\n            disposable.dispose();\n        }\n    }\n\n    async $addBreakpoints(breakpoints: Breakpoint[]): Promise<void> {\n        const newBreakpoints = new Map<string, Breakpoint>();\n        breakpoints.forEach(b => newBreakpoints.set(b.id, b));\n        this.breakpointsManager.findMarkers({\n            dataFilter: data => {\n                // install only new breakpoints\n                if (newBreakpoints.has(data.id)) {\n                    newBreakpoints.delete(data.id);\n                }\n                return false;\n            }\n        });\n        let addedFunctionBreakpoints = false;\n        const functionBreakpoints = this.breakpointsManager.getFunctionBreakpoints();\n        for (const breakpoint of functionBreakpoints) {\n            // install only new breakpoints\n            if (newBreakpoints.has(breakpoint.id)) {\n                newBreakpoints.delete(breakpoint.id);\n            }\n        }\n        for (const breakpoint of newBreakpoints.values()) {\n            if (breakpoint.location) {\n                const location = breakpoint.location;\n                const column = breakpoint.location.range.startColumn;\n                this.breakpointsManager.addBreakpoint({\n                    id: breakpoint.id,\n                    uri: Uri.revive(location.uri).toString(),\n                    enabled: breakpoint.enabled,\n                    raw: {\n                        line: breakpoint.location.range.startLineNumber + 1,\n                        column: column > 0 ? column + 1 : undefined,\n                        condition: breakpoint.condition,\n                        hitCondition: breakpoint.hitCondition,\n                        logMessage: breakpoint.logMessage\n                    }\n                });\n            } else if (breakpoint.functionName) {\n                addedFunctionBreakpoints = true;\n                functionBreakpoints.push({\n                    id: breakpoint.id,\n                    enabled: breakpoint.enabled,\n                    raw: {\n                        name: breakpoint.functionName\n                    }\n                });\n            }\n        }\n        if (addedFunctionBreakpoints) {\n            this.breakpointsManager.setFunctionBreakpoints(functionBreakpoints);\n        }\n    }\n\n    async $getDebugProtocolBreakpoint(sessionId: string, breakpointId: string): Promise<DebugProtocol.Breakpoint | undefined> {\n        const session = this.sessionManager.getSession(sessionId);\n        if (session) {\n            return session.getBreakpoint(breakpointId)?.raw;\n        } else {\n            throw new Error(`Debug session '${sessionId}' not found`);\n        }\n    }\n\n    async $removeBreakpoints(breakpoints: string[]): Promise<void> {\n        const { labelProvider, breakpointsManager, editorManager } = this;\n        const session = this.sessionManager.currentSession;\n\n        const ids = new Set<string>(breakpoints);\n        for (const origin of this.breakpointsManager.findMarkers({ dataFilter: data => ids.has(data.id) })) {\n            const breakpoint = new DebugSourceBreakpoint(origin.data, { labelProvider, breakpoints: breakpointsManager, editorManager, session });\n            breakpoint.remove();\n        }\n        for (const origin of this.breakpointsManager.getFunctionBreakpoints()) {\n            if (ids.has(origin.id)) {\n                const breakpoint = new DebugFunctionBreakpoint(origin, { labelProvider, breakpoints: breakpointsManager, editorManager, session });\n                breakpoint.remove();\n            }\n        }\n    }\n\n    async $customRequest(sessionId: string, command: string, args?: any): Promise<DebugProtocol.Response> {\n        const session = this.sessionManager.getSession(sessionId);\n        if (session) {\n            return session.sendCustomRequest(command, args);\n        }\n\n        throw new Error(`Debug session '${sessionId}' not found`);\n    }\n\n    async $startDebugging(folder: WorkspaceFolder | undefined, nameOrConfiguration: string | DebugConfiguration, options: DebugSessionOptions): Promise<boolean> {\n        // search for matching options\n        let sessionOptions: TheiaDebugSessionOptions | undefined;\n        if (typeof nameOrConfiguration === 'string') {\n            for (const configOptions of this.configurationManager.all) {\n                if (configOptions.name === nameOrConfiguration) {\n                    sessionOptions = configOptions;\n                }\n            }\n        } else {\n            sessionOptions = {\n                name: nameOrConfiguration.name,\n                configuration: nameOrConfiguration\n            };\n        }\n\n        if (!sessionOptions) {\n            console.error(`There is no debug configuration for ${nameOrConfiguration}`);\n            return false;\n        }\n\n        // translate given extra data\n        const workspaceFolderUri = folder && Uri.revive(folder.uri).toString();\n        if (TheiaDebugSessionOptions.isConfiguration(sessionOptions)) {\n            sessionOptions = { ...sessionOptions, configuration: { ...sessionOptions.configuration, ...options }, workspaceFolderUri };\n        } else {\n            sessionOptions = { ...sessionOptions, ...options, workspaceFolderUri };\n        }\n\n        // start options\n        const session = await this.sessionManager.start(sessionOptions);\n        return !!session;\n    }\n\n    async $stopDebugging(sessionId?: string): Promise<void> {\n        if (sessionId) {\n            const session = this.sessionManager.getSession(sessionId);\n            return this.sessionManager.terminateSession(session);\n        }\n        // Terminate all sessions if no session is provided.\n        for (const session of this.sessionManager.sessions) {\n            this.sessionManager.terminateSession(session);\n        }\n    }\n\n    private toTheiaPluginApiBreakpoints(breakpoints: (SourceBreakpoint | FunctionBreakpoint)[]): Breakpoint[] {\n        return breakpoints.map(b => this.toTheiaPluginApiBreakpoint(b));\n    }\n\n    private toTheiaPluginApiBreakpoint(breakpoint: SourceBreakpoint | FunctionBreakpoint): Breakpoint {\n        if ('uri' in breakpoint) {\n            const raw = breakpoint.raw;\n            return {\n                id: breakpoint.id,\n                enabled: breakpoint.enabled,\n                condition: breakpoint.raw.condition,\n                hitCondition: breakpoint.raw.hitCondition,\n                logMessage: raw.logMessage,\n                location: {\n                    uri: Uri.parse(breakpoint.uri),\n                    range: {\n                        startLineNumber: raw.line - 1,\n                        startColumn: (raw.column || 1) - 1,\n                        endLineNumber: raw.line - 1,\n                        endColumn: (raw.column || 1) - 1\n                    }\n                }\n            };\n        }\n        return {\n            id: breakpoint.id,\n            enabled: breakpoint.enabled,\n            functionName: breakpoint.raw.name\n        };\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { DebugExt } from '../../../common/plugin-api-rpc';\nimport { DebugConfiguration } from '@theia/debug/lib/common/debug-configuration';\nimport { MaybePromise } from '@theia/core/lib/common/types';\nimport { DebuggerDescription } from '@theia/debug/lib/common/debug-service';\nimport { HostedPluginSupport } from '../../../hosted/browser/hosted-plugin';\n\n/**\n * Plugin [DebugAdapterContribution](#DebugAdapterContribution).\n */\nexport class PluginDebugAdapterContribution {\n    constructor(\n        protected readonly description: DebuggerDescription,\n        protected readonly debugExt: DebugExt,\n        protected readonly pluginService: HostedPluginSupport) { }\n\n    get type(): string {\n        return this.description.type;\n    }\n\n    get label(): MaybePromise<string | undefined> {\n        return this.description.label;\n    }\n\n    async createDebugSession(config: DebugConfiguration, workspaceFolder: string | undefined): Promise<string> {\n        await this.pluginService.activateByDebug('onDebugAdapterProtocolTracker', config.type);\n        return this.debugExt.$createDebugSession(config, workspaceFolder);\n    }\n\n    async terminateDebugSession(sessionId: string): Promise<void> {\n        this.debugExt.$terminateDebugSession(sessionId);\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2022 Ericsson and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport {\n    DebugConfigurationProvider,\n    DebugConfigurationProviderDescriptor,\n    DebugConfigurationProviderTriggerKind,\n    DebugExt\n} from '../../../common/plugin-api-rpc';\nimport { DebugConfiguration } from '@theia/debug/lib/common/debug-configuration';\n\nexport class PluginDebugConfigurationProvider implements DebugConfigurationProvider {\n    public handle: number;\n    public type: string;\n    public triggerKind: DebugConfigurationProviderTriggerKind;\n    provideDebugConfigurations: (folder: string | undefined) => Promise<DebugConfiguration[]>;\n    resolveDebugConfiguration: (\n        folder: string | undefined,\n        debugConfiguration: DebugConfiguration\n    ) => Promise<DebugConfiguration | undefined | null>;\n    resolveDebugConfigurationWithSubstitutedVariables: (\n        folder: string | undefined,\n        debugConfiguration: DebugConfiguration\n    ) => Promise<DebugConfiguration | undefined | null>;\n\n    constructor(\n        description: DebugConfigurationProviderDescriptor,\n        protected readonly debugExt: DebugExt\n    ) {\n        this.handle = description.handle;\n        this.type = description.type;\n        this.triggerKind = description.trigger;\n\n        if (description.provideDebugConfiguration) {\n            this.provideDebugConfigurations = async (folder: string | undefined) => this.debugExt.$provideDebugConfigurationsByHandle(this.handle, folder);\n        }\n\n        if (description.resolveDebugConfigurations) {\n            this.resolveDebugConfiguration =\n                async (folder: string | undefined, debugConfiguration: DebugConfiguration) =>\n                    this.debugExt.$resolveDebugConfigurationByHandle(this.handle, folder, debugConfiguration);\n        }\n\n        if (description.resolveDebugConfigurationWithSubstitutedVariables) {\n            this.resolveDebugConfigurationWithSubstitutedVariables =\n                async (folder: string | undefined, debugConfiguration: DebugConfiguration) =>\n                    this.debugExt.$resolveDebugConfigurationWithSubstitutedVariablesByHandle(this.handle, folder, debugConfiguration);\n        }\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { DebuggerDescription, DebugPath, DebugService } from '@theia/debug/lib/common/debug-service';\nimport debounce = require('@theia/core/shared/lodash.debounce');\nimport { Emitter, Event } from '@theia/core';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\nimport { DebugConfiguration } from '@theia/debug/lib/common/debug-configuration';\nimport { IJSONSchema, IJSONSchemaSnippet } from '@theia/core/lib/common/json-schema';\nimport { PluginDebugAdapterContribution } from './plugin-debug-adapter-contribution';\nimport { PluginDebugConfigurationProvider } from './plugin-debug-configuration-provider';\nimport { injectable, inject, postConstruct } from '@theia/core/shared/inversify';\nimport { WebSocketConnectionProvider } from '@theia/core/lib/browser/messaging/ws-connection-provider';\nimport { WorkspaceService } from '@theia/workspace/lib/browser';\nimport { CommandIdVariables } from '@theia/variable-resolver/lib/common/variable-types';\nimport { DebugConfigurationProviderTriggerKind } from '../../../common/plugin-api-rpc';\nimport { DebuggerContribution } from '../../../common/plugin-protocol';\nimport { DebugRequestTypes } from '@theia/debug/lib/browser/debug-session-connection';\nimport * as theia from '@theia/plugin';\n\n/**\n * Debug service to work with plugin and extension contributions.\n */\n@injectable()\nexport class PluginDebugService implements DebugService {\n\n    protected readonly onDidChangeDebuggersEmitter = new Emitter<void>();\n    get onDidChangeDebuggers(): Event<void> {\n        return this.onDidChangeDebuggersEmitter.event;\n    }\n\n    protected readonly debuggers: DebuggerContribution[] = [];\n    protected readonly contributors = new Map<string, PluginDebugAdapterContribution>();\n    protected readonly configurationProviders = new Map<number, PluginDebugConfigurationProvider>();\n    protected readonly toDispose = new DisposableCollection(this.onDidChangeDebuggersEmitter);\n\n    protected readonly onDidChangeDebugConfigurationProvidersEmitter = new Emitter<void>();\n    get onDidChangeDebugConfigurationProviders(): Event<void> {\n        return this.onDidChangeDebugConfigurationProvidersEmitter.event;\n    }\n\n    // maps session and contribution\n    protected readonly sessionId2contrib = new Map<string, PluginDebugAdapterContribution>();\n    protected delegated: DebugService;\n\n    @inject(WebSocketConnectionProvider)\n    protected readonly connectionProvider: WebSocketConnectionProvider;\n    @inject(WorkspaceService)\n    protected readonly workspaceService: WorkspaceService;\n\n    @postConstruct()\n    protected init(): void {\n        this.delegated = this.connectionProvider.createProxy<DebugService>(DebugPath);\n        this.toDispose.pushAll([\n            Disposable.create(() => this.delegated.dispose()),\n            Disposable.create(() => {\n                for (const sessionId of this.sessionId2contrib.keys()) {\n                    const contrib = this.sessionId2contrib.get(sessionId)!;\n                    contrib.terminateDebugSession(sessionId);\n                }\n                this.sessionId2contrib.clear();\n            })]);\n    }\n\n    registerDebugAdapterContribution(contrib: PluginDebugAdapterContribution): Disposable {\n        const { type } = contrib;\n\n        if (this.contributors.has(type)) {\n            console.warn(`Debugger with type '${type}' already registered.`);\n            return Disposable.NULL;\n        }\n\n        this.contributors.set(type, contrib);\n        return Disposable.create(() => this.unregisterDebugAdapterContribution(type));\n    }\n\n    unregisterDebugAdapterContribution(debugType: string): void {\n        this.contributors.delete(debugType);\n    }\n\n    // debouncing to send a single notification for multiple registrations at initialization time\n    fireOnDidConfigurationProvidersChanged = debounce(() => {\n        this.onDidChangeDebugConfigurationProvidersEmitter.fire();\n    }, 100);\n\n    registerDebugConfigurationProvider(provider: PluginDebugConfigurationProvider): Disposable {\n        const handle = provider.handle;\n        this.configurationProviders.set(handle, provider);\n        this.fireOnDidConfigurationProvidersChanged();\n        return Disposable.create(() => this.unregisterDebugConfigurationProvider(handle));\n    }\n\n    unregisterDebugConfigurationProvider(handle: number): void {\n        this.configurationProviders.delete(handle);\n        this.fireOnDidConfigurationProvidersChanged();\n    }\n\n    async debugTypes(): Promise<string[]> {\n        const debugTypes = new Set(await this.delegated.debugTypes());\n        for (const contribution of this.debuggers) {\n            debugTypes.add(contribution.type);\n        }\n        for (const debugType of this.contributors.keys()) {\n            debugTypes.add(debugType);\n        }\n        return [...debugTypes];\n    }\n\n    async provideDebugConfigurations(debugType: keyof DebugRequestTypes, workspaceFolderUri: string | undefined): Promise<theia.DebugConfiguration[]> {\n        const pluginProviders =\n            Array.from(this.configurationProviders.values()).filter(p => (\n                p.triggerKind === DebugConfigurationProviderTriggerKind.Initial &&\n                (p.type === debugType || p.type === '*') &&\n                p.provideDebugConfigurations\n            ));\n\n        if (pluginProviders.length === 0) {\n            return this.delegated.provideDebugConfigurations(debugType, workspaceFolderUri);\n        }\n\n        const results: DebugConfiguration[] = [];\n        await Promise.all(pluginProviders.map(async p => {\n            const result = await p.provideDebugConfigurations(workspaceFolderUri);\n            if (result) {\n                results.push(...result);\n            }\n        }));\n\n        return results;\n    }\n\n    async fetchDynamicDebugConfiguration(name: string, providerType: string, folder?: string): Promise<DebugConfiguration | undefined> {\n        const pluginProviders =\n            Array.from(this.configurationProviders.values()).filter(p => (\n                p.triggerKind === DebugConfigurationProviderTriggerKind.Dynamic &&\n                p.type === providerType &&\n                p.provideDebugConfigurations\n            ));\n\n        for (const provider of pluginProviders) {\n            const configurations = await provider.provideDebugConfigurations(folder);\n            for (const configuration of configurations) {\n                if (configuration.name === name) {\n                    return configuration;\n                }\n            }\n        }\n    }\n\n    async provideDynamicDebugConfigurations(folder?: string): Promise<Record<string, DebugConfiguration[]>> {\n        const pluginProviders =\n            Array.from(this.configurationProviders.values()).filter(p => (\n                p.triggerKind === DebugConfigurationProviderTriggerKind.Dynamic &&\n                p.provideDebugConfigurations\n            ));\n\n        const configurationsRecord: Record<string, DebugConfiguration[]> = {};\n\n        await Promise.all(pluginProviders.map(async provider => {\n            const configurations = await provider.provideDebugConfigurations(folder);\n            let configurationsPerType = configurationsRecord[provider.type];\n            configurationsPerType = configurationsPerType ? configurationsPerType.concat(configurations) : configurations;\n\n            if (configurationsPerType.length > 0) {\n                configurationsRecord[provider.type] = configurationsPerType;\n            }\n        }));\n\n        return configurationsRecord;\n    }\n\n    async resolveDebugConfiguration(\n        config: DebugConfiguration,\n        workspaceFolderUri: string | undefined\n    ): Promise<DebugConfiguration | undefined | null> {\n        const allProviders = Array.from(this.configurationProviders.values());\n\n        const resolvers = allProviders\n            .filter(p => p.type === config.type && !!p.resolveDebugConfiguration)\n            .map(p => p.resolveDebugConfiguration);\n\n        // Append debug type '*' at the end\n        resolvers.push(\n            ...allProviders\n                .filter(p => p.type === '*' && !!p.resolveDebugConfiguration)\n                .map(p => p.resolveDebugConfiguration)\n        );\n\n        const resolved = await this.resolveDebugConfigurationByResolversChain(config, workspaceFolderUri, resolvers);\n\n        return resolved ? this.delegated.resolveDebugConfiguration(resolved, workspaceFolderUri) : resolved;\n    }\n\n    async resolveDebugConfigurationWithSubstitutedVariables(\n        config: DebugConfiguration,\n        workspaceFolderUri: string | undefined\n    ): Promise<DebugConfiguration | undefined | null> {\n        const allProviders = Array.from(this.configurationProviders.values());\n\n        const resolvers = allProviders\n            .filter(p => p.type === config.type && !!p.resolveDebugConfigurationWithSubstitutedVariables)\n            .map(p => p.resolveDebugConfigurationWithSubstitutedVariables);\n\n        // Append debug type '*' at the end\n        resolvers.push(\n            ...allProviders\n                .filter(p => p.type === '*' && !!p.resolveDebugConfigurationWithSubstitutedVariables)\n                .map(p => p.resolveDebugConfigurationWithSubstitutedVariables)\n        );\n\n        const resolved = await this.resolveDebugConfigurationByResolversChain(config, workspaceFolderUri, resolvers);\n\n        return resolved\n            ? this.delegated.resolveDebugConfigurationWithSubstitutedVariables(resolved, workspaceFolderUri)\n            : resolved;\n    }\n\n    protected async resolveDebugConfigurationByResolversChain(\n        config: DebugConfiguration,\n        workspaceFolderUri: string | undefined,\n        resolvers: ((\n            folder: string | undefined,\n            debugConfiguration: DebugConfiguration\n        ) => Promise<DebugConfiguration | null | undefined>)[]\n    ): Promise<DebugConfiguration | undefined | null> {\n        let resolved: DebugConfiguration | undefined | null = config;\n        for (const resolver of resolvers) {\n            try {\n                if (!resolved) {\n                    // A provider has indicated to stop and process undefined or null as per specified in the vscode API\n                    // https://code.visualstudio.com/api/references/vscode-api#DebugConfigurationProvider\n                    break;\n                }\n                resolved = await resolver(workspaceFolderUri, resolved);\n            } catch (e) {\n                console.error(e);\n            }\n        }\n        return resolved;\n    }\n\n    registerDebugger(contribution: DebuggerContribution): Disposable {\n        this.debuggers.push(contribution);\n        return Disposable.create(() => {\n            const index = this.debuggers.indexOf(contribution);\n            if (index !== -1) {\n                this.debuggers.splice(index, 1);\n            }\n        });\n    }\n\n    async provideDebuggerVariables(debugType: string): Promise<CommandIdVariables> {\n        for (const contribution of this.debuggers) {\n            if (contribution.type === debugType) {\n                const variables = contribution.variables;\n                if (variables && Object.keys(variables).length > 0) {\n                    return variables;\n                }\n            }\n        }\n        return {};\n    }\n\n    async getDebuggersForLanguage(language: string): Promise<DebuggerDescription[]> {\n        const debuggers = await this.delegated.getDebuggersForLanguage(language);\n\n        for (const contributor of this.debuggers) {\n            const languages = contributor.languages;\n            if (languages && languages.indexOf(language) !== -1) {\n                const { label, type } = contributor;\n                debuggers.push({ type, label: label || type });\n            }\n        }\n\n        return debuggers;\n    }\n\n    async getSchemaAttributes(debugType: string): Promise<IJSONSchema[]> {\n        let schemas = await this.delegated.getSchemaAttributes(debugType);\n        for (const contribution of this.debuggers) {\n            if (contribution.configurationAttributes &&\n                (contribution.type === debugType || contribution.type === '*' || debugType === '*')) {\n                schemas = schemas.concat(contribution.configurationAttributes);\n            }\n        }\n        return schemas;\n    }\n\n    async getConfigurationSnippets(): Promise<IJSONSchemaSnippet[]> {\n        let snippets = await this.delegated.getConfigurationSnippets();\n\n        for (const contribution of this.debuggers) {\n            if (contribution.configurationSnippets) {\n                snippets = snippets.concat(contribution.configurationSnippets);\n            }\n        }\n\n        return snippets;\n    }\n\n    async createDebugSession(config: DebugConfiguration, workspaceFolder: string | undefined): Promise<string> {\n        const contributor = this.contributors.get(config.type);\n        if (contributor) {\n            const sessionId = await contributor.createDebugSession(config, workspaceFolder);\n            this.sessionId2contrib.set(sessionId, contributor);\n            return sessionId;\n        } else {\n            return this.delegated.createDebugSession(config, workspaceFolder);\n        }\n    }\n\n    async terminateDebugSession(sessionId: string): Promise<void> {\n        const contributor = this.sessionId2contrib.get(sessionId);\n        if (contributor) {\n            this.sessionId2contrib.delete(sessionId);\n            return contributor.terminateDebugSession(sessionId);\n        } else {\n            return this.delegated.terminateDebugSession(sessionId);\n        }\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { DebugSessionContributionRegistry, DebugSessionContribution } from '@theia/debug/lib/browser/debug-session-contribution';\nimport { injectable, inject, named, postConstruct } from '@theia/core/shared/inversify';\nimport { ContributionProvider } from '@theia/core/lib/common/contribution-provider';\nimport { Disposable } from '@theia/core/lib/common/disposable';\n\n/**\n * Debug session contribution registrator.\n */\nexport interface PluginDebugSessionContributionRegistrator {\n    /**\n     * Registers [DebugSessionContribution](#DebugSessionContribution).\n     * @param contrib contribution\n     */\n    registerDebugSessionContribution(contrib: DebugSessionContribution): Disposable;\n\n    /**\n     * Unregisters [DebugSessionContribution](#DebugSessionContribution).\n     * @param debugType the debug type\n     */\n    unregisterDebugSessionContribution(debugType: string): void;\n}\n\n/**\n * Plugin debug session contribution registry implementation with functionality\n * to register / unregister plugin contributions.\n */\n@injectable()\nexport class PluginDebugSessionContributionRegistry implements DebugSessionContributionRegistry, PluginDebugSessionContributionRegistrator {\n    protected readonly contribs = new Map<string, DebugSessionContribution>();\n\n    @inject(ContributionProvider) @named(DebugSessionContribution)\n    protected readonly contributions: ContributionProvider<DebugSessionContribution>;\n\n    @postConstruct()\n    protected init(): void {\n        for (const contrib of this.contributions.getContributions()) {\n            this.contribs.set(contrib.debugType, contrib);\n        }\n    }\n\n    get(debugType: string): DebugSessionContribution | undefined {\n        return this.contribs.get(debugType);\n    }\n\n    registerDebugSessionContribution(contrib: DebugSessionContribution): Disposable {\n        const { debugType } = contrib;\n\n        if (this.contribs.has(debugType)) {\n            console.warn(`Debug session contribution already registered for ${debugType}`);\n            return Disposable.NULL;\n        }\n\n        this.contribs.set(debugType, contrib);\n        return Disposable.create(() => this.unregisterDebugSessionContribution(debugType));\n    }\n\n    unregisterDebugSessionContribution(debugType: string): void {\n        this.contribs.delete(debugType);\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { DefaultDebugSessionFactory } from '@theia/debug/lib/browser/debug-session-contribution';\nimport { TerminalService } from '@theia/terminal/lib/browser/base/terminal-service';\nimport { EditorManager } from '@theia/editor/lib/browser/editor-manager';\nimport { BreakpointManager } from '@theia/debug/lib/browser/breakpoint/breakpoint-manager';\nimport { LabelProvider } from '@theia/core/lib/browser/label-provider';\nimport { MessageClient } from '@theia/core/lib/common/message-service-protocol';\nimport { OutputChannelManager } from '@theia/output/lib/browser/output-channel';\nimport { DebugPreferences } from '@theia/debug/lib/browser/debug-preferences';\nimport { DebugConfigurationSessionOptions } from '@theia/debug/lib/browser/debug-session-options';\nimport { DebugSession } from '@theia/debug/lib/browser/debug-session';\nimport { DebugSessionConnection } from '@theia/debug/lib/browser/debug-session-connection';\nimport { TerminalWidgetOptions, TerminalWidget } from '@theia/terminal/lib/browser/base/terminal-widget';\nimport { TerminalOptionsExt } from '../../../common/plugin-api-rpc';\nimport { FileService } from '@theia/filesystem/lib/browser/file-service';\nimport { DebugContribution } from '@theia/debug/lib/browser/debug-contribution';\nimport { ContributionProvider } from '@theia/core/lib/common/contribution-provider';\nimport { WorkspaceService } from '@theia/workspace/lib/browser';\nimport { PluginChannel } from '../../../common/connection';\n\nexport class PluginDebugSession extends DebugSession {\n    constructor(\n        override readonly id: string,\n        override readonly options: DebugConfigurationSessionOptions,\n        override readonly parentSession: DebugSession | undefined,\n        protected override readonly connection: DebugSessionConnection,\n        protected override readonly terminalServer: TerminalService,\n        protected override readonly editorManager: EditorManager,\n        protected override readonly breakpoints: BreakpointManager,\n        protected override readonly labelProvider: LabelProvider,\n        protected override readonly messages: MessageClient,\n        protected override readonly fileService: FileService,\n        protected readonly terminalOptionsExt: TerminalOptionsExt | undefined,\n        protected override readonly debugContributionProvider: ContributionProvider<DebugContribution>,\n        protected override readonly workspaceService: WorkspaceService) {\n        super(id, options, parentSession, connection, terminalServer, editorManager, breakpoints, labelProvider, messages, fileService, debugContributionProvider,\n            workspaceService);\n    }\n\n    protected override async doCreateTerminal(terminalWidgetOptions: TerminalWidgetOptions): Promise<TerminalWidget> {\n        terminalWidgetOptions = Object.assign({}, terminalWidgetOptions, this.terminalOptionsExt);\n        return super.doCreateTerminal(terminalWidgetOptions);\n    }\n}\n\n/**\n * Session factory for a client debug session that communicates with debug adapter contributed as plugin.\n * The main difference is to use a connection factory that creates [Channel](#Channel) over Rpc channel.\n */\nexport class PluginDebugSessionFactory extends DefaultDebugSessionFactory {\n    constructor(\n        protected override readonly terminalService: TerminalService,\n        protected override readonly editorManager: EditorManager,\n        protected override readonly breakpoints: BreakpointManager,\n        protected override readonly labelProvider: LabelProvider,\n        protected override readonly messages: MessageClient,\n        protected override readonly outputChannelManager: OutputChannelManager,\n        protected override readonly debugPreferences: DebugPreferences,\n        protected readonly connectionFactory: (sessionId: string) => Promise<PluginChannel>,\n        protected override readonly fileService: FileService,\n        protected readonly terminalOptionsExt: TerminalOptionsExt | undefined,\n        protected override readonly debugContributionProvider: ContributionProvider<DebugContribution>,\n        protected override readonly workspaceService: WorkspaceService,\n    ) {\n        super();\n    }\n\n    override get(sessionId: string, options: DebugConfigurationSessionOptions, parentSession?: DebugSession): DebugSession {\n        const connection = new DebugSessionConnection(\n            sessionId,\n            this.connectionFactory,\n            this.getTraceOutputChannel());\n\n        return new PluginDebugSession(\n            sessionId,\n            options,\n            parentSession,\n            connection,\n            this.terminalService,\n            this.editorManager,\n            this.breakpoints,\n            this.labelProvider,\n            this.messages,\n            this.fileService,\n            this.terminalOptionsExt,\n            this.debugContributionProvider,\n            this.workspaceService,\n        );\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2019 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\nimport {\n    DecorationData,\n    DecorationRequest,\n    DecorationsExt,\n    DecorationsMain,\n    MAIN_RPC_CONTEXT\n} from '../../../common/plugin-api-rpc';\n\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { Emitter } from '@theia/core/lib/common/event';\nimport { Disposable } from '@theia/core/lib/common/disposable';\nimport { RPCProtocol } from '../../../common/rpc-protocol';\nimport { UriComponents } from '../../../common/uri-components';\nimport { URI as VSCodeURI } from '@theia/core/shared/vscode-uri';\nimport { CancellationToken } from '@theia/core/lib/common/cancellation';\nimport URI from '@theia/core/lib/common/uri';\nimport { Decoration, DecorationsService } from '@theia/core/lib/browser/decorations-service';\n\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n// some code copied and modified from https://github.com/microsoft/vscode/blob/1.52.1/src/vs/workbench/api/browser/mainThreadDecorations.ts#L85\n\nclass DecorationRequestsQueue {\n\n    private idPool = 0;\n    private requests = new Map<number, DecorationRequest>();\n    private resolver = new Map<number, (data: DecorationData) => void>();\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    private timer: any;\n\n    constructor(\n        private readonly proxy: DecorationsExt,\n        private readonly handle: number\n    ) {\n    }\n\n    enqueue(uri: URI, token: CancellationToken): Promise<DecorationData> {\n        const id = ++this.idPool;\n        const result = new Promise<DecorationData>(resolve => {\n            this.requests.set(id, { id, uri: VSCodeURI.parse(uri.toString()) });\n            this.resolver.set(id, resolve);\n            this.processQueue();\n        });\n        token.onCancellationRequested(() => {\n            this.requests.delete(id);\n            this.resolver.delete(id);\n        });\n        return result;\n    }\n\n    private processQueue(): void {\n        if (typeof this.timer === 'number') {\n            // already queued\n            return;\n        }\n        this.timer = setTimeout(() => {\n            // make request\n            const requests = this.requests;\n            const resolver = this.resolver;\n            this.proxy.$provideDecorations(this.handle, [...requests.values()], CancellationToken.None).then(data => {\n                for (const [id, resolve] of resolver) {\n                    resolve(data[id]);\n                }\n            });\n\n            // reset\n            this.requests = new Map();\n            this.resolver = new Map();\n            this.timer = undefined;\n        }, 0);\n    }\n}\n\nexport class DecorationsMainImpl implements DecorationsMain, Disposable {\n\n    private readonly proxy: DecorationsExt;\n    private readonly providers = new Map<number, [Emitter<URI[]>, Disposable]>();\n    private readonly decorationsService: DecorationsService;\n\n    constructor(rpc: RPCProtocol, container: interfaces.Container) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.DECORATIONS_EXT);\n        this.decorationsService = container.get(DecorationsService);\n    }\n\n    dispose(): void {\n        this.providers.forEach(value => value.forEach(v => v.dispose()));\n        this.providers.clear();\n    }\n\n    async $registerDecorationProvider(handle: number): Promise<void> {\n        const emitter = new Emitter<URI[]>();\n        const queue = new DecorationRequestsQueue(this.proxy, handle);\n        const registration = this.decorationsService.registerDecorationsProvider({\n            onDidChange: emitter.event,\n            provideDecorations: async (uri, token) => {\n                const data = await queue.enqueue(uri, token);\n                if (!data) {\n                    return undefined;\n                }\n                const [bubble, tooltip, letter, themeColor] = data;\n                return <Decoration>{\n                    weight: 10,\n                    bubble: bubble ?? false,\n                    colorId: themeColor?.id,\n                    tooltip,\n                    letter\n                };\n            }\n        });\n        this.providers.set(handle, [emitter, registration]);\n    }\n\n    $onDidChange(handle: number, resources: UriComponents[]): void {\n        const providerSet = this.providers.get(handle);\n        if (providerSet) {\n            const [emitter] = providerSet;\n            emitter.fire(resources && resources.map(r => new URI(VSCodeURI.revive(r).toString())));\n        }\n    }\n\n    $unregisterDecorationProvider(handle: number): void {\n        const provider = this.providers.get(handle);\n        if (provider) {\n            provider.forEach(p => p.dispose());\n            this.providers.delete(handle);\n        }\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport { OpenDialogOptionsMain, SaveDialogOptionsMain, DialogsMain, UploadDialogOptionsMain } from '../../common/plugin-api-rpc';\nimport { OpenFileDialogProps, SaveFileDialogProps, FileDialogService } from '@theia/filesystem/lib/browser';\nimport { WorkspaceService } from '@theia/workspace/lib/browser';\nimport URI from '@theia/core/lib/common/uri';\nimport { FileUploadService } from '@theia/filesystem/lib/browser/file-upload-service';\nimport { FileService } from '@theia/filesystem/lib/browser/file-service';\nimport { FileStat } from '@theia/filesystem/lib/common/files';\nimport { EnvVariablesServer } from '@theia/core/lib/common/env-variables';\nimport { nls } from '@theia/core';\n\nexport class DialogsMainImpl implements DialogsMain {\n\n    private workspaceService: WorkspaceService;\n    private fileService: FileService;\n    private environments: EnvVariablesServer;\n\n    private fileDialogService: FileDialogService;\n    private uploadService: FileUploadService;\n\n    constructor(rpc: RPCProtocol, container: interfaces.Container) {\n        this.workspaceService = container.get(WorkspaceService);\n        this.fileService = container.get(FileService);\n        this.environments = container.get(EnvVariablesServer);\n        this.fileDialogService = container.get(FileDialogService);\n        this.uploadService = container.get(FileUploadService);\n    }\n\n    protected async getRootStat(defaultUri: string | undefined): Promise<FileStat | undefined> {\n        let rootStat: FileStat | undefined;\n\n        // Try to use default URI as root\n        if (defaultUri) {\n            try {\n                rootStat = await this.fileService.resolve(new URI(defaultUri));\n            } catch {\n                rootStat = undefined;\n            }\n\n            // Try to use as root the parent folder of existing file URI/non existing URI\n            if (rootStat && !rootStat.isDirectory || !rootStat) {\n                try {\n                    rootStat = await this.fileService.resolve(new URI(defaultUri).parent);\n                } catch {\n                    rootStat = undefined;\n                }\n            }\n        }\n\n        // Try to use workspace service root if there is no pre-configured URI\n        if (!rootStat) {\n            rootStat = (await this.workspaceService.roots)[0];\n        }\n\n        // Try to use current user home if root folder is still not taken\n        if (!rootStat) {\n            const homeDirUri = await this.environments.getHomeDirUri();\n            try {\n                rootStat = await this.fileService.resolve(new URI(homeDirUri));\n            } catch { }\n        }\n\n        return rootStat;\n    }\n\n    async $showOpenDialog(options: OpenDialogOptionsMain): Promise<string[] | undefined> {\n        const rootStat = await this.getRootStat(options.defaultUri ? options.defaultUri : undefined);\n        if (!rootStat) {\n            throw new Error('Unable to find the rootStat');\n        }\n\n        try {\n            const canSelectFiles = typeof options.canSelectFiles === 'boolean' ? options.canSelectFiles : true;\n            const canSelectFolders = typeof options.canSelectFolders === 'boolean' ? options.canSelectFolders : true;\n\n            let title = options.title;\n            if (!title) {\n                if (canSelectFiles && canSelectFolders) {\n                    title = 'Open';\n                } else {\n                    if (canSelectFiles) {\n                        title = 'Open File';\n                    } else {\n                        title = 'Open Folder';\n                    }\n                    if (options.canSelectMany) {\n                        title += '(s)';\n                    }\n                }\n            }\n\n            // Create open file dialog props\n            const dialogProps = {\n                title: title,\n                openLabel: options.openLabel,\n                canSelectFiles: options.canSelectFiles,\n                canSelectFolders: options.canSelectFolders,\n                canSelectMany: options.canSelectMany,\n                filters: options.filters\n            } as OpenFileDialogProps;\n\n            const result = await this.fileDialogService.showOpenDialog(dialogProps, rootStat);\n            if (Array.isArray(result)) {\n                return result.map(uri => uri.path.toString());\n            } else {\n                return result ? [result].map(uri => uri.path.toString()) : undefined;\n            }\n        } catch (error) {\n            console.error(error);\n        }\n\n        return undefined;\n    }\n\n    async $showSaveDialog(options: SaveDialogOptionsMain): Promise<string | undefined> {\n        const rootStat = await this.getRootStat(options.defaultUri ? options.defaultUri : undefined);\n\n        // File name field should be empty unless the URI is a file\n        let fileNameValue = '';\n        if (options.defaultUri) {\n            let defaultURIStat: FileStat | undefined;\n            try {\n                defaultURIStat = await this.fileService.resolve(new URI(options.defaultUri));\n            } catch { }\n            if (defaultURIStat && !defaultURIStat.isDirectory || !defaultURIStat) {\n                fileNameValue = new URI(options.defaultUri).path.base;\n            }\n        }\n\n        try {\n            // Create save file dialog props\n            const dialogProps = {\n                title: options.title ?? nls.localizeByDefault('Save'),\n                saveLabel: options.saveLabel,\n                filters: options.filters,\n                inputValue: fileNameValue\n            } as SaveFileDialogProps;\n\n            const result = await this.fileDialogService.showSaveDialog(dialogProps, rootStat);\n            if (result) {\n                return result.path.toString();\n            }\n            return undefined;\n        } catch (error) {\n            console.error(error);\n        }\n\n        return undefined;\n    }\n\n    async $showUploadDialog(options: UploadDialogOptionsMain): Promise<string[] | undefined> {\n        const rootStat = await this.getRootStat(options.defaultUri);\n\n        // Fail if root not fount\n        if (!rootStat) {\n            throw new Error('Failed to resolve base directory where files should be uploaded');\n        }\n\n        const uploadResult = await this.uploadService.upload(rootStat.resource.toString());\n\n        if (uploadResult) {\n            return uploadResult.uploaded;\n        }\n\n        return undefined;\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\nimport { injectable } from '@theia/core/shared/inversify';\nimport { Message } from '@theia/core/shared/@phosphor/messaging';\nimport { codiconArray, Key } from '@theia/core/lib/browser';\nimport { AbstractDialog } from '@theia/core/lib/browser/dialogs';\nimport '../../../../src/main/browser/dialogs/style/modal-notification.css';\nimport { MainMessageItem, MainMessageOptions } from '../../../common/plugin-api-rpc';\nimport { FrontendApplicationConfigProvider } from '@theia/core/lib/browser/frontend-application-config-provider';\nimport { nls } from '@theia/core/lib/common/nls';\n\nexport enum MessageType {\n    Error = 'error',\n    Warning = 'warning',\n    Info = 'info'\n}\n\nconst NOTIFICATION = 'modal-Notification';\nconst ICON = 'icon';\nconst TEXT = 'text';\nconst DETAIL = 'detail';\n\n@injectable()\nexport class ModalNotification extends AbstractDialog<string | undefined> {\n\n    protected actionTitle: string | undefined;\n\n    constructor() {\n        super({ title: FrontendApplicationConfigProvider.get().applicationName });\n    }\n\n    protected override onCloseRequest(msg: Message): void {\n        this.actionTitle = undefined;\n        this.accept();\n    }\n\n    get value(): string | undefined {\n        return this.actionTitle;\n    }\n\n    showDialog(messageType: MessageType, text: string, options: MainMessageOptions, actions: MainMessageItem[]): Promise<string | undefined> {\n        this.contentNode.appendChild(this.createMessageNode(messageType, text, options, actions));\n        return this.open();\n    }\n\n    protected createMessageNode(messageType: MessageType, text: string, options: MainMessageOptions, actions: MainMessageItem[]): HTMLElement {\n        const messageNode = document.createElement('div');\n        messageNode.classList.add(NOTIFICATION);\n\n        const iconContainer = messageNode.appendChild(document.createElement('div'));\n        iconContainer.classList.add(ICON);\n        const iconElement = iconContainer.appendChild(document.createElement('i'));\n        iconElement.classList.add(...this.toIconClass(messageType), messageType.toString());\n\n        const textContainer = messageNode.appendChild(document.createElement('div'));\n        textContainer.classList.add(TEXT);\n        const textElement = textContainer.appendChild(document.createElement('p'));\n        textElement.textContent = text;\n\n        if (options.detail) {\n            const detailContainer = textContainer.appendChild(document.createElement('div'));\n            detailContainer.classList.add(DETAIL);\n            const detailElement = detailContainer.appendChild(document.createElement('p'));\n            detailElement.textContent = options.detail;\n        }\n\n        actions.forEach((action: MainMessageItem, index: number) => {\n            const button = index === 0\n                ? this.appendAcceptButton(action.title)\n                : this.createButton(action.title);\n            button.classList.add('main');\n            this.controlPanel.appendChild(button);\n            this.addKeyListener(button,\n                Key.ENTER,\n                () => {\n                    this.actionTitle = action.title;\n                    this.accept();\n                },\n                'click');\n        });\n        if (actions.length <= 0) {\n            this.appendAcceptButton();\n        } else if (!actions.some(action => action.isCloseAffordance === true)) {\n            this.appendCloseButton(nls.localizeByDefault('Close'));\n        }\n\n        return messageNode;\n    }\n\n    protected toIconClass(icon: MessageType): string[] {\n        if (icon === MessageType.Error) {\n            return codiconArray('error');\n        }\n        if (icon === MessageType.Warning) {\n            return codiconArray('warning');\n        }\n        return codiconArray('info');\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { interfaces } from '@theia/core/shared/inversify';\nimport * as monaco from '@theia/monaco-editor-core';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport {\n    MAIN_RPC_CONTEXT,\n    EditorsAndDocumentsExt,\n    EditorsAndDocumentsDelta,\n    ModelAddedData,\n    TextEditorAddData,\n    EditorPosition\n} from '../../common/plugin-api-rpc';\nimport { Disposable } from '@theia/core/lib/common/disposable';\nimport { EditorModelService } from './text-editor-model-service';\nimport { MonacoEditorModel } from '@theia/monaco/lib/browser/monaco-editor-model';\nimport { MonacoEditor } from '@theia/monaco/lib/browser/monaco-editor';\nimport { TextEditorMain } from './text-editor-main';\nimport { DisposableCollection, Emitter } from '@theia/core';\nimport { EditorManager, EditorWidget } from '@theia/editor/lib/browser';\n\nexport class EditorsAndDocumentsMain implements Disposable {\n\n    private readonly proxy: EditorsAndDocumentsExt;\n\n    private readonly stateComputer: EditorAndDocumentStateComputer;\n    private readonly textEditors = new Map<string, TextEditorMain>();\n\n    private readonly modelService: EditorModelService;\n    private readonly editorService: EditorManager;\n\n    private readonly onTextEditorAddEmitter = new Emitter<TextEditorMain[]>();\n    private readonly onTextEditorRemoveEmitter = new Emitter<string[]>();\n    private readonly onDocumentAddEmitter = new Emitter<MonacoEditorModel[]>();\n    private readonly onDocumentRemoveEmitter = new Emitter<monaco.Uri[]>();\n\n    readonly onTextEditorAdd = this.onTextEditorAddEmitter.event;\n    readonly onTextEditorRemove = this.onTextEditorRemoveEmitter.event;\n    readonly onDocumentAdd = this.onDocumentAddEmitter.event;\n    readonly onDocumentRemove = this.onDocumentRemoveEmitter.event;\n\n    private readonly toDispose = new DisposableCollection(\n        Disposable.create(() => this.textEditors.clear())\n    );\n\n    constructor(rpc: RPCProtocol, container: interfaces.Container) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.EDITORS_AND_DOCUMENTS_EXT);\n\n        this.editorService = container.get(EditorManager);\n        this.modelService = container.get(EditorModelService);\n\n        this.stateComputer = new EditorAndDocumentStateComputer(d => this.onDelta(d), this.editorService, this.modelService);\n        this.toDispose.push(this.stateComputer);\n        this.toDispose.push(this.onTextEditorAddEmitter);\n        this.toDispose.push(this.onTextEditorRemoveEmitter);\n        this.toDispose.push(this.onDocumentAddEmitter);\n        this.toDispose.push(this.onDocumentRemoveEmitter);\n    }\n\n    listen(): void {\n        this.stateComputer.listen();\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    private onDelta(delta: EditorAndDocumentStateDelta): void {\n        const removedEditors = new Array<string>();\n        const addedEditors = new Array<TextEditorMain>();\n\n        const removedDocuments = delta.removedDocuments.map(d => d.textEditorModel.uri);\n\n        for (const editor of delta.addedEditors) {\n            const textEditorMain = new TextEditorMain(editor.id, editor.editor.getControl().getModel()!, editor.editor);\n            this.textEditors.set(editor.id, textEditorMain);\n            this.toDispose.push(textEditorMain);\n            addedEditors.push(textEditorMain);\n        }\n\n        for (const { id } of delta.removedEditors) {\n            const textEditorMain = this.textEditors.get(id);\n            if (textEditorMain) {\n                textEditorMain.dispose();\n                this.textEditors.delete(id);\n                removedEditors.push(id);\n            }\n        }\n\n        const deltaExt: EditorsAndDocumentsDelta = {};\n        let empty = true;\n\n        if (delta.newActiveEditor !== undefined) {\n            empty = false;\n            deltaExt.newActiveEditor = delta.newActiveEditor;\n        }\n        if (removedDocuments.length > 0) {\n            empty = false;\n            deltaExt.removedDocuments = removedDocuments;\n        }\n        if (removedEditors.length > 0) {\n            empty = false;\n            deltaExt.removedEditors = removedEditors;\n        }\n        if (delta.addedDocuments.length > 0) {\n            empty = false;\n            deltaExt.addedDocuments = delta.addedDocuments.map(d => this.toModelAddData(d));\n        }\n        if (delta.addedEditors.length > 0) {\n            empty = false;\n            deltaExt.addedEditors = addedEditors.map(e => this.toTextEditorAddData(e));\n        }\n\n        if (!empty) {\n            this.proxy.$acceptEditorsAndDocumentsDelta(deltaExt);\n            this.onDocumentRemoveEmitter.fire(removedDocuments);\n            this.onDocumentAddEmitter.fire(delta.addedDocuments);\n            this.onTextEditorRemoveEmitter.fire(removedEditors);\n            this.onTextEditorAddEmitter.fire(addedEditors);\n        }\n    }\n\n    private toModelAddData(model: MonacoEditorModel): ModelAddedData {\n        return {\n            uri: model.textEditorModel.uri,\n            versionId: model.textEditorModel.getVersionId(),\n            lines: model.textEditorModel.getLinesContent(),\n            languageId: model.getLanguageId(),\n            EOL: model.textEditorModel.getEOL(),\n            modeId: model.languageId,\n            isDirty: model.dirty\n        };\n    }\n\n    private toTextEditorAddData(textEditor: TextEditorMain): TextEditorAddData {\n        const properties = textEditor.getProperties();\n        return {\n            id: textEditor.getId(),\n            documentUri: textEditor.getModel().uri,\n            options: properties!.options,\n            selections: properties!.selections,\n            visibleRanges: properties!.visibleRanges,\n            editorPosition: this.findEditorPosition(textEditor)\n        };\n\n    }\n\n    private findEditorPosition(editor: TextEditorMain): EditorPosition | undefined {\n        return EditorPosition.ONE; // TODO: fix this when Theia has support splitting editors\n    }\n\n    getEditor(id: string): TextEditorMain | undefined {\n        return this.textEditors.get(id);\n    }\n\n    saveAll(includeUntitled?: boolean): Promise<boolean> {\n        return this.modelService.saveAll(includeUntitled);\n    }\n\n    hideEditor(id: string): Promise<void> {\n        for (const editorWidget of this.editorService.all) {\n            const monacoEditor = MonacoEditor.get(editorWidget);\n            if (monacoEditor) {\n                if (id === new EditorSnapshot(monacoEditor).id) {\n                    editorWidget.close();\n                    break;\n                }\n            }\n        }\n        return Promise.resolve();\n    }\n}\n\nclass EditorAndDocumentStateComputer implements Disposable {\n    private currentState: EditorAndDocumentState | undefined;\n    private readonly editors = new Map<string, DisposableCollection>();\n    private readonly toDispose = new DisposableCollection(\n        Disposable.create(() => this.currentState = undefined)\n    );\n\n    constructor(\n        private callback: (delta: EditorAndDocumentStateDelta) => void,\n        private readonly editorService: EditorManager,\n        private readonly modelService: EditorModelService\n    ) { }\n\n    listen(): void {\n        if (this.toDispose.disposed) {\n            return;\n        }\n        this.toDispose.push(this.editorService.onCreated(widget => {\n            this.onTextEditorAdd(widget);\n            this.update();\n        }));\n        this.toDispose.push(this.editorService.onCurrentEditorChanged(() => this.update()));\n        this.toDispose.push(this.modelService.onModelAdded(this.onModelAdded, this));\n        this.toDispose.push(this.modelService.onModelRemoved(() => this.update()));\n\n        for (const widget of this.editorService.all) {\n            this.onTextEditorAdd(widget);\n        }\n        this.update();\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    private onModelAdded(model: MonacoEditorModel): void {\n        if (!this.currentState) {\n            this.update();\n            return;\n        }\n        this.currentState = new EditorAndDocumentState(\n            this.currentState.documents.add(model),\n            this.currentState.editors,\n            this.currentState.activeEditor);\n\n        this.callback(new EditorAndDocumentStateDelta(\n            [],\n            [model],\n            [],\n            [],\n            undefined,\n            undefined\n        ));\n    }\n\n    private onTextEditorAdd(widget: EditorWidget): void {\n        const editor = MonacoEditor.get(widget);\n        if (!editor) {\n            return;\n        }\n        const id = editor.getControl().getId();\n        const toDispose = new DisposableCollection(\n            editor.onDispose(() => this.onTextEditorRemove(editor)),\n            Disposable.create(() => this.editors.delete(id))\n        );\n        this.editors.set(id, toDispose);\n        this.toDispose.push(toDispose);\n    }\n\n    private onTextEditorRemove(e: MonacoEditor): void {\n        const toDispose = this.editors.get(e.getControl().getId());\n        if (toDispose) {\n            toDispose.dispose();\n            this.update();\n        }\n    }\n\n    private update(): void {\n        const models = new Set<MonacoEditorModel>();\n        for (const model of this.modelService.getModels()) {\n            models.add(model);\n        }\n\n        let activeId: string | null = null;\n        const activeEditor = MonacoEditor.getCurrent(this.editorService);\n\n        const editors = new Map<string, EditorSnapshot>();\n        for (const widget of this.editorService.all) {\n            const editor = MonacoEditor.get(widget);\n            // VS Code tracks only visible widgets\n            if (!editor || !widget.isVisible) {\n                continue;\n            }\n            const model = editor.getControl().getModel();\n            if (model && !model.isDisposed()) {\n                const editorSnapshot = new EditorSnapshot(editor);\n                editors.set(editorSnapshot.id, editorSnapshot);\n                if (activeEditor === editor) {\n                    activeId = editorSnapshot.id;\n                }\n            }\n        }\n\n        const newState = new EditorAndDocumentState(models, editors, activeId);\n        const delta = EditorAndDocumentState.compute(this.currentState, newState);\n        if (!delta.isEmpty) {\n            this.currentState = newState;\n            this.callback(delta);\n        }\n    }\n\n}\n\nclass EditorAndDocumentStateDelta {\n    readonly isEmpty: boolean;\n\n    constructor(\n        readonly removedDocuments: MonacoEditorModel[],\n        readonly addedDocuments: MonacoEditorModel[],\n        readonly removedEditors: EditorSnapshot[],\n        readonly addedEditors: EditorSnapshot[],\n        readonly oldActiveEditor: string | null | undefined,\n        readonly newActiveEditor: string | null | undefined\n    ) {\n        this.isEmpty = this.removedDocuments.length === 0\n            && this.addedDocuments.length === 0\n            && this.addedEditors.length === 0\n            && this.removedEditors.length === 0\n            && this.newActiveEditor === this.oldActiveEditor;\n    }\n}\n\nclass EditorAndDocumentState {\n\n    constructor(\n        readonly documents: Set<MonacoEditorModel>,\n        readonly editors: Map<string, EditorSnapshot>,\n        readonly activeEditor: string | null | undefined) {\n    }\n\n    static compute(before: EditorAndDocumentState | undefined, after: EditorAndDocumentState): EditorAndDocumentStateDelta {\n        if (!before) {\n            return new EditorAndDocumentStateDelta(\n                [],\n                Array.from(after.documents),\n                [],\n                Array.from(after.editors.values()),\n                undefined,\n                after.activeEditor\n            );\n        }\n\n        const documentDelta = Delta.ofSets(before.documents, after.documents);\n        const editorDelta = Delta.ofMaps(before.editors, after.editors);\n        const oldActiveEditor = before.activeEditor !== after.activeEditor ? before.activeEditor : undefined;\n        const newActiveEditor = before.activeEditor !== after.activeEditor ? after.activeEditor : undefined;\n        return new EditorAndDocumentStateDelta(\n            documentDelta.removed,\n            documentDelta.added,\n            editorDelta.removed,\n            editorDelta.added,\n            oldActiveEditor,\n            newActiveEditor\n        );\n    }\n}\n\nclass EditorSnapshot {\n    readonly id: string;\n    constructor(readonly editor: MonacoEditor) {\n        this.id = `${editor.getControl().getId()},${editor.getControl().getModel()!.id}`;\n    }\n}\n\nnamespace Delta {\n\n    export function ofSets<T>(before: Set<T>, after: Set<T>): { removed: T[], added: T[] } {\n        const removed: T[] = [];\n        const added: T[] = [];\n        before.forEach(element => {\n            if (!after.has(element)) {\n                removed.push(element);\n            }\n        });\n        after.forEach(element => {\n            if (!before.has(element)) {\n                added.push(element);\n            }\n        });\n        return { removed, added };\n    }\n\n    export function ofMaps<K, V>(before: Map<K, V>, after: Map<K, V>): { removed: V[], added: V[] } {\n        const removed: V[] = [];\n        const added: V[] = [];\n        before.forEach((value, index) => {\n            if (!after.has(index)) {\n                removed.push(value);\n            }\n        });\n        after.forEach((value, index) => {\n            if (!before.has(index)) {\n                added.push(value);\n            }\n        });\n        return { removed, added };\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { EnvVariablesServer } from '@theia/core/lib/common/env-variables';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport { EnvMain } from '../../common/plugin-api-rpc';\nimport { QueryParameters } from '../../common/env';\nimport { isWindows, isOSX } from '@theia/core';\nimport { OperatingSystem } from '../../plugin/types-impl';\n\nexport class EnvMainImpl implements EnvMain {\n    private envVariableServer: EnvVariablesServer;\n\n    constructor(rpc: RPCProtocol, container: interfaces.Container) {\n        this.envVariableServer = container.get(EnvVariablesServer);\n    }\n\n    $getEnvVariable(envVarName: string): Promise<string | undefined> {\n        return this.envVariableServer.getValue(envVarName).then(result => result ? result.value : undefined);\n    }\n\n    async $getClientOperatingSystem(): Promise<OperatingSystem> {\n        if (isWindows) {\n            return OperatingSystem.Windows;\n        }\n        if (isOSX) {\n            return OperatingSystem.OSX;\n        }\n        return OperatingSystem.Linux;\n    }\n}\n\n/**\n * Returns query parameters from current page.\n */\nexport function getQueryParameters(): QueryParameters {\n    const queryParameters: QueryParameters = {};\n    if (window.location.search !== '') {\n        const queryParametersString = window.location.search.substring(1); // remove question mark\n        const params = queryParametersString.split('&');\n        for (const pair of params) {\n            if (pair === '') {\n                continue;\n            }\n\n            const keyValue = pair.split('=');\n            let key: string = keyValue[0];\n            let value: string = keyValue[1] ? keyValue[1] : '';\n            try {\n                key = decodeURIComponent(key);\n                if (value !== '') {\n                    value = decodeURIComponent(value);\n                }\n            } catch (error) {\n                // skip malformed URI sequence\n                continue;\n            }\n\n            const existedValue = queryParameters[key];\n            if (existedValue) {\n                if (existedValue instanceof Array) {\n                    existedValue.push(value);\n                } else {\n                    // existed value is string\n                    queryParameters[key] = [existedValue, value];\n                }\n            } else {\n                queryParameters[key] = value;\n            }\n        }\n    }\n    return queryParameters;\n}\n","// *****************************************************************************\n// Copyright (C) 2020 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n// based on https://github.com/microsoft/vscode/blob/04c36be045a94fee58e5f8992d3e3fd980294a84/src/vs/workbench/api/browser/mainThreadFileSystem.ts\n\n/* eslint-disable max-len */\n/* eslint-disable @typescript-eslint/tslint/config */\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport { URI } from '@theia/core/shared/vscode-uri';\nimport { interfaces } from '@theia/core/shared/inversify';\nimport CoreURI from '@theia/core/lib/common/uri';\nimport { BinaryBuffer } from '@theia/core/lib/common/buffer';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\nimport { Event, Emitter } from '@theia/core/lib/common/event';\nimport { MAIN_RPC_CONTEXT, FileSystemMain, FileSystemExt, IFileChangeDto } from '../../common/plugin-api-rpc';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport { UriComponents } from '../../common/uri-components';\nimport {\n    FileSystemProviderCapabilities, Stat, FileType, FileSystemProviderErrorCode, FileOverwriteOptions, FileDeleteOptions, FileOpenOptions, FileWriteOptions, WatchOptions,\n    FileSystemProviderWithFileReadWriteCapability, FileSystemProviderWithOpenReadWriteCloseCapability, FileSystemProviderWithFileFolderCopyCapability,\n    FileStat, FileChange, FileOperationError, FileOperationResult\n} from '@theia/filesystem/lib/common/files';\nimport { FileService } from '@theia/filesystem/lib/browser/file-service';\n\ntype IDisposable = Disposable;\n\nexport class FileSystemMainImpl implements FileSystemMain, Disposable {\n\n    private readonly _proxy: FileSystemExt;\n    private readonly _fileProvider = new Map<number, RemoteFileSystemProvider>();\n    private readonly _fileService: FileService;\n    private readonly _disposables = new DisposableCollection();\n\n    constructor(rpc: RPCProtocol, container: interfaces.Container) {\n        this._proxy = rpc.getProxy(MAIN_RPC_CONTEXT.FILE_SYSTEM_EXT);\n        this._fileService = container.get(FileService);\n\n        for (const { scheme, capabilities } of this._fileService.listCapabilities()) {\n            this._proxy.$acceptProviderInfos(scheme, capabilities);\n        }\n\n        this._disposables.push(this._fileService.onDidChangeFileSystemProviderRegistrations(e => this._proxy.$acceptProviderInfos(e.scheme, e.provider?.capabilities)));\n        this._disposables.push(this._fileService.onDidChangeFileSystemProviderCapabilities(e => this._proxy.$acceptProviderInfos(e.scheme, e.provider.capabilities)));\n        this._disposables.push(Disposable.create(() => this._fileProvider.forEach(value => value.dispose())));\n        this._disposables.push(Disposable.create(() => this._fileProvider.clear()));\n    }\n\n    dispose(): void {\n        this._disposables.dispose();\n    }\n\n    $registerFileSystemProvider(handle: number, scheme: string, capabilities: FileSystemProviderCapabilities): void {\n        this._fileProvider.set(handle, new RemoteFileSystemProvider(this._fileService, scheme, capabilities, handle, this._proxy));\n    }\n\n    $unregisterProvider(handle: number): void {\n        const provider = this._fileProvider.get(handle);\n        if (provider) {\n            provider.dispose();\n            this._fileProvider.delete(handle);\n        }\n    }\n\n    $onFileSystemChange(handle: number, changes: IFileChangeDto[]): void {\n        const fileProvider = this._fileProvider.get(handle);\n        if (!fileProvider) {\n            throw new Error('Unknown file provider');\n        }\n        fileProvider.$onFileSystemChange(changes);\n    }\n\n    // --- consumer fs, vscode.workspace.fs\n\n    $stat(uri: UriComponents): Promise<Stat> {\n        return this._fileService.resolve(new CoreURI(URI.revive(uri)), { resolveMetadata: true }).then(stat => ({\n            ctime: stat.ctime,\n            mtime: stat.mtime,\n            size: stat.size,\n            type: FileStat.asFileType(stat)\n        })).catch(FileSystemMainImpl._handleError);\n    }\n\n    $readdir(uri: UriComponents): Promise<[string, FileType][]> {\n        return this._fileService.resolve(new CoreURI(URI.revive(uri)), { resolveMetadata: false }).then(stat => {\n            if (!stat.isDirectory) {\n                const err = new Error(stat.name);\n                err.name = FileSystemProviderErrorCode.FileNotADirectory;\n                throw err;\n            }\n            return !stat.children ? [] : stat.children.map(child => [child.name, FileStat.asFileType(child)] as [string, FileType]);\n        }).catch(FileSystemMainImpl._handleError);\n    }\n\n    $readFile(uri: UriComponents): Promise<BinaryBuffer> {\n        return this._fileService.readFile(new CoreURI(URI.revive(uri))).then(file => file.value).catch(FileSystemMainImpl._handleError);\n    }\n\n    $writeFile(uri: UriComponents, content: BinaryBuffer): Promise<void> {\n        return this._fileService.writeFile(new CoreURI(URI.revive(uri)), content)\n            .then(() => undefined).catch(FileSystemMainImpl._handleError);\n    }\n\n    $rename(source: UriComponents, target: UriComponents, opts: FileOverwriteOptions): Promise<void> {\n        return this._fileService.move(new CoreURI(URI.revive(source)), new CoreURI(URI.revive(target)), {\n            ...opts,\n            fromUserGesture: false\n        }).then(() => undefined).catch(FileSystemMainImpl._handleError);\n    }\n\n    $copy(source: UriComponents, target: UriComponents, opts: FileOverwriteOptions): Promise<void> {\n        return this._fileService.copy(new CoreURI(URI.revive(source)), new CoreURI(URI.revive(target)), {\n            ...opts,\n            fromUserGesture: false\n        }).then(() => undefined).catch(FileSystemMainImpl._handleError);\n    }\n\n    $mkdir(uri: UriComponents): Promise<void> {\n        return this._fileService.createFolder(new CoreURI(URI.revive(uri)), { fromUserGesture: false })\n            .then(() => undefined).catch(FileSystemMainImpl._handleError);\n    }\n\n    $delete(uri: UriComponents, opts: FileDeleteOptions): Promise<void> {\n        return this._fileService.delete(new CoreURI(URI.revive(uri)), opts).catch(FileSystemMainImpl._handleError);\n    }\n\n    private static _handleError(err: any): never {\n        if (err instanceof FileOperationError) {\n            switch (err.fileOperationResult) {\n                case FileOperationResult.FILE_NOT_FOUND:\n                    err.name = FileSystemProviderErrorCode.FileNotFound;\n                    break;\n                case FileOperationResult.FILE_IS_DIRECTORY:\n                    err.name = FileSystemProviderErrorCode.FileIsADirectory;\n                    break;\n                case FileOperationResult.FILE_PERMISSION_DENIED:\n                    err.name = FileSystemProviderErrorCode.NoPermissions;\n                    break;\n                case FileOperationResult.FILE_MOVE_CONFLICT:\n                    err.name = FileSystemProviderErrorCode.FileExists;\n                    break;\n            }\n        }\n\n        throw err;\n    }\n\n}\n\nclass RemoteFileSystemProvider implements FileSystemProviderWithFileReadWriteCapability, FileSystemProviderWithOpenReadWriteCloseCapability, FileSystemProviderWithFileFolderCopyCapability {\n\n    private readonly _onDidChange = new Emitter<readonly FileChange[]>();\n    private readonly _registration: IDisposable;\n\n    readonly onDidChangeFile: Event<readonly FileChange[]> = this._onDidChange.event;\n    readonly onFileWatchError: Event<void> = new Emitter<void>().event;  // dummy, never fired\n\n    readonly capabilities: FileSystemProviderCapabilities;\n    readonly onDidChangeCapabilities: Event<void> = Event.None;\n\n    constructor(\n        fileService: FileService,\n        scheme: string,\n        capabilities: FileSystemProviderCapabilities,\n        private readonly _handle: number,\n        private readonly _proxy: FileSystemExt\n    ) {\n        this.capabilities = capabilities;\n        this._registration = fileService.registerProvider(scheme, this);\n    }\n\n    dispose(): void {\n        this._registration.dispose();\n        this._onDidChange.dispose();\n    }\n\n    watch(resource: CoreURI, opts: WatchOptions) {\n        const session = Math.random();\n        this._proxy.$watch(this._handle, session, resource['codeUri'], opts);\n        return Disposable.create(() => {\n            this._proxy.$unwatch(this._handle, session);\n        });\n    }\n\n    $onFileSystemChange(changes: IFileChangeDto[]): void {\n        this._onDidChange.fire(changes.map(RemoteFileSystemProvider._createFileChange));\n    }\n\n    private static _createFileChange(dto: IFileChangeDto): FileChange {\n        return { resource: new CoreURI(URI.revive(dto.resource)), type: dto.type };\n    }\n\n    // --- forwarding calls\n\n    stat(resource: CoreURI): Promise<Stat> {\n        return this._proxy.$stat(this._handle, resource['codeUri']).then(undefined, err => {\n            throw err;\n        });\n    }\n\n    readFile(resource: CoreURI): Promise<Uint8Array> {\n        return this._proxy.$readFile(this._handle, resource['codeUri']).then(buffer => buffer.buffer);\n    }\n\n    writeFile(resource: CoreURI, content: Uint8Array, opts: FileWriteOptions): Promise<void> {\n        return this._proxy.$writeFile(this._handle, resource['codeUri'], BinaryBuffer.wrap(content), opts);\n    }\n\n    delete(resource: CoreURI, opts: FileDeleteOptions): Promise<void> {\n        return this._proxy.$delete(this._handle, resource['codeUri'], opts);\n    }\n\n    mkdir(resource: CoreURI): Promise<void> {\n        return this._proxy.$mkdir(this._handle, resource['codeUri']);\n    }\n\n    readdir(resource: CoreURI): Promise<[string, FileType][]> {\n        return this._proxy.$readdir(this._handle, resource['codeUri']);\n    }\n\n    rename(resource: CoreURI, target: CoreURI, opts: FileOverwriteOptions): Promise<void> {\n        return this._proxy.$rename(this._handle, resource['codeUri'], target['codeUri'], opts);\n    }\n\n    copy(resource: CoreURI, target: CoreURI, opts: FileOverwriteOptions): Promise<void> {\n        return this._proxy.$copy(this._handle, resource['codeUri'], target['codeUri'], opts);\n    }\n\n    open(resource: CoreURI, opts: FileOpenOptions): Promise<number> {\n        return this._proxy.$open(this._handle, resource['codeUri'], opts);\n    }\n\n    close(fd: number): Promise<void> {\n        return this._proxy.$close(this._handle, fd);\n    }\n\n    read(fd: number, pos: number, data: Uint8Array, offset: number, length: number): Promise<number> {\n        return this._proxy.$read(this._handle, fd, pos, length).then(readData => {\n            data.set(readData.buffer, offset);\n            return readData.byteLength;\n        });\n    }\n\n    write(fd: number, pos: number, data: Uint8Array, offset: number, length: number): Promise<number> {\n        return this._proxy.$write(this._handle, fd, pos, BinaryBuffer.wrap(data).slice(offset, offset + length));\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { injectable, inject } from '@theia/core/shared/inversify';\nimport { PluginContribution, Keybinding as PluginKeybinding } from '../../../common';\nimport { Keybinding } from '@theia/core/lib/common/keybinding';\nimport { KeybindingRegistry } from '@theia/core/lib/browser/keybinding';\nimport { OS } from '@theia/core/lib/common/os';\nimport { Disposable } from '@theia/core/lib/common/disposable';\nimport { DisposableCollection } from '@theia/core';\n\n@injectable()\nexport class KeybindingsContributionPointHandler {\n\n    @inject(KeybindingRegistry)\n    private readonly keybindingRegistry: KeybindingRegistry;\n\n    handle(contributions: PluginContribution): Disposable {\n        if (!contributions || !contributions.keybindings) {\n            return Disposable.NULL;\n        }\n        const toDispose = new DisposableCollection();\n        for (const raw of contributions.keybindings) {\n            const keybinding = this.toKeybinding(raw);\n            if (keybinding) {\n                toDispose.push(this.keybindingRegistry.registerKeybinding(keybinding));\n            }\n        }\n        return toDispose;\n    }\n\n    protected toKeybinding(pluginKeybinding: PluginKeybinding): Keybinding | undefined {\n        const keybinding = this.toOSKeybinding(pluginKeybinding);\n        if (!keybinding) {\n            return undefined;\n        }\n        const { command, when, args } = pluginKeybinding;\n        return { keybinding, command, when, args };\n    }\n\n    protected toOSKeybinding(pluginKeybinding: PluginKeybinding): string | undefined {\n        let keybinding: string | undefined;\n        const os = OS.type();\n        if (os === OS.Type.Windows) {\n            keybinding = pluginKeybinding.win;\n        } else if (os === OS.Type.OSX) {\n            keybinding = pluginKeybinding.mac;\n        } else {\n            keybinding = pluginKeybinding.linux;\n        }\n        return keybinding || pluginKeybinding.keybinding;\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2020 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { LabelServiceMain } from '../../common/plugin-api-rpc';\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\nimport { DefaultUriLabelProviderContribution, LabelProviderContribution } from '@theia/core/lib/browser';\nimport { ContributionProvider } from '@theia/core/lib/common';\nimport { ResourceLabelFormatter } from '@theia/core/lib/common/label-protocol';\n\nexport class LabelServiceMainImpl implements LabelServiceMain {\n    private readonly resourceLabelFormatters = new Map<number, Disposable>();\n    private readonly contributionProvider: ContributionProvider<LabelProviderContribution>;\n\n    constructor(container: interfaces.Container) {\n        this.contributionProvider = container.getNamed(ContributionProvider, LabelProviderContribution);\n    }\n\n    $registerResourceLabelFormatter(handle: number, formatter: ResourceLabelFormatter): void {\n        // Dynamically registered formatters should have priority over those contributed via package.json\n        formatter.priority = true;\n        const disposables: DisposableCollection = new DisposableCollection();\n        for (const contribution of this.contributionProvider.getContributions()) {\n            if (contribution instanceof DefaultUriLabelProviderContribution) {\n                disposables.push(contribution.registerFormatter(formatter));\n            }\n        }\n        this.resourceLabelFormatters.set(handle, disposables);\n    }\n\n    $unregisterResourceLabelFormatter(handle: number): void {\n        const toDispose = this.resourceLabelFormatters.get(handle);\n        if (toDispose) {\n            toDispose.dispose();\n        }\n        this.resourceLabelFormatters.delete(handle);\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n// Method `$changeLanguage` copied and modified\n// from https://github.com/microsoft/vscode/blob/e9c50663154c369a06355ce752b447af5b580dc3/src/vs/workbench/api/browser/mainThreadLanguages.ts#L30-L42\n\nimport {\n    LanguagesMain,\n    SerializedLanguageConfiguration,\n    SerializedRegExp,\n    SerializedIndentationRule,\n    SerializedOnEnterRule,\n    MAIN_RPC_CONTEXT,\n    LanguagesExt,\n    WorkspaceEditDto,\n    WorkspaceTextEditDto,\n    WorkspaceFileEditDto,\n    PluginInfo,\n    LanguageStatus as LanguageStatusDTO,\n    InlayHintDto,\n    IdentifiableInlineCompletions\n} from '../../common/plugin-api-rpc';\nimport { injectable, inject } from '@theia/core/shared/inversify';\nimport {\n    SerializedDocumentFilter, MarkerData, Range, RelatedInformation,\n    MarkerSeverity, DocumentLink, WorkspaceSymbolParams, CodeAction, CompletionDto,\n    CodeActionProviderDocumentation, InlayHint, InlayHintLabelPart, CodeActionContext, DocumentDropEditProviderMetadata\n} from '../../common/plugin-api-rpc-model';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport { MonacoLanguages, WorkspaceSymbolProvider } from '@theia/monaco/lib/browser/monaco-languages';\nimport { URI } from '@theia/core/lib/common/uri';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\nimport { Emitter, Event } from '@theia/core/lib/common/event';\nimport { ProblemManager } from '@theia/markers/lib/browser';\nimport * as vst from '@theia/core/shared/vscode-languageserver-protocol';\nimport * as theia from '@theia/plugin';\nimport { UriComponents } from '../../common/uri-components';\nimport { CancellationToken } from '@theia/core/lib/common';\nimport { CallHierarchyService, CallHierarchyServiceProvider, CallHierarchyItem } from '@theia/callhierarchy/lib/browser';\nimport { toItemHierarchyDefinition, toUriComponents, fromItemHierarchyDefinition, fromPosition, toCaller, toCallee } from './hierarchy/hierarchy-types-converters';\nimport { TypeHierarchyService, TypeHierarchyServiceProvider } from '@theia/typehierarchy/lib/browser';\nimport { Position, DocumentUri, DiagnosticTag } from '@theia/core/shared/vscode-languageserver-protocol';\nimport { ObjectIdentifier } from '../../common/object-identifier';\nimport { mixin } from '../../common/types';\nimport { relative } from '../../common/paths-util';\nimport { decodeSemanticTokensDto } from '../../common/semantic-tokens-dto';\nimport * as monaco from '@theia/monaco-editor-core';\nimport { ExtensionIdentifier } from '@theia/monaco-editor-core/esm/vs/platform/extensions/common/extensions';\nimport { StandaloneServices } from '@theia/monaco-editor-core/esm/vs/editor/standalone/browser/standaloneServices';\nimport { IMarkerService } from '@theia/monaco-editor-core/esm/vs/platform/markers/common/markers';\nimport * as MonacoLanguageSelector from '@theia/monaco-editor-core/esm/vs/editor/common/languageSelector';\nimport * as MonacoPath from '@theia/monaco-editor-core/esm/vs/base/common/path';\nimport { IRelativePattern } from '@theia/monaco-editor-core/esm/vs/base/common/glob';\nimport { EditorLanguageStatusService, LanguageStatus as EditorLanguageStatus } from '@theia/editor/lib/browser/language-status/editor-language-status-service';\nimport { LanguageSelector, RelativePattern } from '@theia/editor/lib/common/language-selector';\nimport { ILanguageFeaturesService } from '@theia/monaco-editor-core/esm/vs/editor/common/services/languageFeatures';\nimport {\n    DocumentOnDropEdit,\n    DocumentOnDropEditProvider,\n    EvaluatableExpression,\n    EvaluatableExpressionProvider,\n    InlineValue,\n    InlineValueContext,\n    InlineValuesProvider\n} from '@theia/monaco-editor-core/esm/vs/editor/common/languages';\nimport { ITextModel } from '@theia/monaco-editor-core/esm/vs/editor/common/model';\nimport { CodeActionTriggerKind, SnippetString } from '../../plugin/types-impl';\nimport { DataTransfer } from './data-transfer/data-transfer-type-converters';\nimport { VSDataTransfer } from '@theia/monaco-editor-core/esm/vs/base/common/dataTransfer';\nimport { FileUploadService } from '@theia/filesystem/lib/browser/file-upload-service';\n\n/**\n * @monaco-uplift The public API declares these functions as (languageId: string, service).\n * Confirm that the functions delegate to a handler that accepts a LanguageSelector rather than just a string.\n * Relevant code in node_modules/@theia/monaco-editor-core/src/vs/editor/standalone/browser/standaloneLanguages.ts\n */\ninterface RegistrationFunction<T> {\n    (languageId: MonacoLanguageSelector.LanguageSelector, service: T): Disposable;\n}\n\n@injectable()\nexport class LanguagesMainImpl implements LanguagesMain, Disposable {\n\n    @inject(MonacoLanguages)\n    private readonly monacoLanguages: MonacoLanguages;\n\n    @inject(ProblemManager)\n    private readonly problemManager: ProblemManager;\n\n    @inject(CallHierarchyServiceProvider)\n    private readonly callHierarchyServiceContributionRegistry: CallHierarchyServiceProvider;\n\n    @inject(TypeHierarchyServiceProvider)\n    private readonly typeHierarchyServiceContributionRegistry: TypeHierarchyServiceProvider;\n\n    @inject(EditorLanguageStatusService)\n    protected readonly languageStatusService: EditorLanguageStatusService;\n\n    @inject(FileUploadService)\n    protected readonly fileUploadService: FileUploadService;\n\n    private readonly proxy: LanguagesExt;\n    private readonly services = new Map<number, Disposable>();\n    private readonly toDispose = new DisposableCollection();\n\n    constructor(@inject(RPCProtocol) rpc: RPCProtocol) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.LANGUAGES_EXT);\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    $getLanguages(): Promise<string[]> {\n        return Promise.resolve(monaco.languages.getLanguages().map(l => l.id));\n    }\n\n    $changeLanguage(resource: UriComponents, languageId: string): Promise<void> {\n        const uri = monaco.Uri.revive(resource);\n        const model = monaco.editor.getModel(uri);\n        if (!model) {\n            return Promise.reject(new Error('Invalid uri'));\n        }\n        const langId = monaco.languages.getEncodedLanguageId(languageId);\n        if (!langId) {\n            return Promise.reject(new Error(`Unknown language ID: ${languageId}`));\n        }\n        monaco.editor.setModelLanguage(model, languageId);\n        return Promise.resolve(undefined);\n    }\n\n    protected register(handle: number, service: Disposable): void {\n        this.services.set(handle, service);\n        this.toDispose.push(Disposable.create(() => this.$unregister(handle)));\n    }\n\n    $unregister(handle: number): void {\n        const disposable = this.services.get(handle);\n        if (disposable) {\n            this.services.delete(handle);\n            disposable.dispose();\n        }\n    }\n\n    $setLanguageConfiguration(handle: number, languageId: string, configuration: SerializedLanguageConfiguration): void {\n        const config: monaco.languages.LanguageConfiguration = {\n            comments: configuration.comments,\n            brackets: configuration.brackets,\n            wordPattern: reviveRegExp(configuration.wordPattern),\n            indentationRules: reviveIndentationRule(configuration.indentationRules),\n            onEnterRules: reviveOnEnterRules(configuration.onEnterRules),\n        };\n\n        this.register(handle, monaco.languages.setLanguageConfiguration(languageId, config));\n    }\n\n    $registerCompletionSupport(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[], triggerCharacters: string[], supportsResolveDetails: boolean): void {\n        this.register(handle,\n            (monaco.languages.registerCompletionItemProvider as RegistrationFunction<monaco.languages.CompletionItemProvider>)(this.toLanguageSelector(selector), {\n                triggerCharacters,\n                provideCompletionItems: (model, position, context, token) => this.provideCompletionItems(handle, model, position, context, token),\n                resolveCompletionItem: supportsResolveDetails\n                    ? (suggestion, token) => Promise.resolve(this.resolveCompletionItem(handle, suggestion, token))\n                    : undefined\n            }));\n    }\n\n    protected provideCompletionItems(handle: number, model: monaco.editor.ITextModel, position: monaco.Position,\n        context: monaco.languages.CompletionContext, token: monaco.CancellationToken): monaco.languages.ProviderResult<monaco.languages.CompletionList> {\n        return this.proxy.$provideCompletionItems(handle, model.uri, position, context, token).then(result => {\n            if (!result) {\n                return undefined;\n            }\n            return {\n                suggestions: result.completions.map(c => Object.assign(c, {\n                    range: c.range || result.defaultRange\n                })),\n                incomplete: result.incomplete,\n                dispose: () => this.proxy.$releaseCompletionItems(handle, result.id)\n            };\n        });\n    }\n\n    protected resolveCompletionItem(handle: number,\n        item: monaco.languages.CompletionItem, token: monaco.CancellationToken): monaco.languages.ProviderResult<monaco.languages.CompletionItem> {\n        const { parentId, id } = item as CompletionDto;\n        return this.proxy.$resolveCompletionItem(handle, [parentId, id], token).then(resolved => {\n            if (resolved) {\n                mixin(item, resolved, true);\n            }\n            return item;\n        });\n    }\n\n    $registerDefinitionProvider(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[]): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const definitionProvider = this.createDefinitionProvider(handle);\n        this.register(handle, (monaco.languages.registerDefinitionProvider as RegistrationFunction<monaco.languages.DefinitionProvider>)(languageSelector, definitionProvider));\n    }\n\n    $registerDeclarationProvider(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[]): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const declarationProvider = this.createDeclarationProvider(handle);\n        this.register(handle, (monaco.languages.registerDeclarationProvider as RegistrationFunction<monaco.languages.DeclarationProvider>)(languageSelector, declarationProvider));\n    }\n\n    $registerReferenceProvider(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[]): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const referenceProvider = this.createReferenceProvider(handle);\n        this.register(handle, (monaco.languages.registerReferenceProvider as RegistrationFunction<monaco.languages.ReferenceProvider>)(languageSelector, referenceProvider));\n    }\n\n    protected createReferenceProvider(handle: number): monaco.languages.ReferenceProvider {\n        return {\n            provideReferences: (model, position, context, token) => this.provideReferences(handle, model, position, context, token)\n        };\n    }\n\n    protected provideReferences(handle: number, model: monaco.editor.ITextModel, position: monaco.Position,\n        context: monaco.languages.ReferenceContext, token: monaco.CancellationToken): monaco.languages.ProviderResult<monaco.languages.Location[]> {\n        return this.proxy.$provideReferences(handle, model.uri, position, context, token).then(result => {\n            if (!result) {\n                return undefined;\n            }\n\n            if (Array.isArray(result)) {\n                const references: monaco.languages.Location[] = [];\n                for (const item of result) {\n                    references.push({ ...item, uri: monaco.Uri.revive(item.uri) });\n                }\n                return references;\n            }\n\n            return undefined;\n        });\n    }\n\n    $registerSignatureHelpProvider(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[], metadata: theia.SignatureHelpProviderMetadata): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const signatureHelpProvider = this.createSignatureHelpProvider(handle, metadata);\n        this.register(handle, (monaco.languages.registerSignatureHelpProvider as RegistrationFunction<monaco.languages.SignatureHelpProvider>)\n            (languageSelector, signatureHelpProvider));\n    }\n\n    $clearDiagnostics(id: string): void {\n        for (const uri of this.problemManager.getUris()) {\n            this.problemManager.setMarkers(new URI(uri), id, []);\n        }\n    }\n\n    $changeDiagnostics(id: string, delta: [string, MarkerData[]][]): void {\n        for (const [uriString, markers] of delta) {\n            const uri = new URI(uriString);\n            this.problemManager.setMarkers(uri, id, markers.map(reviveMarker));\n        }\n    }\n\n    $registerImplementationProvider(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[]): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const implementationProvider = this.createImplementationProvider(handle);\n        this.register(handle, (monaco.languages.registerImplementationProvider as RegistrationFunction<monaco.languages.ImplementationProvider>)\n            (languageSelector, implementationProvider));\n    }\n\n    protected createImplementationProvider(handle: number): monaco.languages.ImplementationProvider {\n        return {\n            provideImplementation: (model, position, token) => this.provideImplementation(handle, model, position, token)\n        };\n    }\n\n    protected provideImplementation(handle: number, model: monaco.editor.ITextModel,\n        position: monaco.Position, token: monaco.CancellationToken): monaco.languages.ProviderResult<monaco.languages.Definition> {\n        return this.proxy.$provideImplementation(handle, model.uri, position, token).then(result => {\n            if (!result) {\n                return undefined;\n            }\n\n            if (Array.isArray(result)) {\n                // using DefinitionLink because Location is mandatory part of DefinitionLink\n                const definitionLinks: monaco.languages.LocationLink[] = [];\n                for (const item of result) {\n                    definitionLinks.push({ ...item, uri: monaco.Uri.revive(item.uri) });\n                }\n                return definitionLinks;\n            } else {\n                // single Location\n                return <monaco.languages.Location>{\n                    uri: monaco.Uri.revive(result.uri),\n                    range: result.range\n                };\n            }\n        });\n    }\n\n    $registerTypeDefinitionProvider(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[]): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const typeDefinitionProvider = this.createTypeDefinitionProvider(handle);\n        this.register(handle, (monaco.languages.registerTypeDefinitionProvider as RegistrationFunction<monaco.languages.TypeDefinitionProvider>)\n            (languageSelector, typeDefinitionProvider));\n    }\n\n    protected createTypeDefinitionProvider(handle: number): monaco.languages.TypeDefinitionProvider {\n        return {\n            provideTypeDefinition: (model, position, token) => this.provideTypeDefinition(handle, model, position, token)\n        };\n    }\n\n    protected provideTypeDefinition(handle: number, model: monaco.editor.ITextModel,\n        position: monaco.Position, token: monaco.CancellationToken): monaco.languages.ProviderResult<monaco.languages.Definition> {\n        return this.proxy.$provideTypeDefinition(handle, model.uri, position, token).then(result => {\n            if (!result) {\n                return undefined;\n            }\n\n            if (Array.isArray(result)) {\n                // using DefinitionLink because Location is mandatory part of DefinitionLink\n                const definitionLinks: monaco.languages.LocationLink[] = [];\n                for (const item of result) {\n                    definitionLinks.push({ ...item, uri: monaco.Uri.revive(item.uri) });\n                }\n                return definitionLinks;\n            } else {\n                // single Location\n                return <monaco.languages.Location>{\n                    uri: monaco.Uri.revive(result.uri),\n                    range: result.range\n                };\n            }\n        });\n    }\n\n    $registerHoverProvider(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[]): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const hoverProvider = this.createHoverProvider(handle);\n        this.register(handle, (monaco.languages.registerHoverProvider as RegistrationFunction<monaco.languages.HoverProvider>)(languageSelector, hoverProvider));\n    }\n\n    protected createHoverProvider(handle: number): monaco.languages.HoverProvider {\n        return {\n            provideHover: (model, position, token) => this.provideHover(handle, model, position, token)\n        };\n    }\n\n    protected provideHover(handle: number, model: monaco.editor.ITextModel, position: monaco.Position,\n        token: monaco.CancellationToken): monaco.languages.ProviderResult<monaco.languages.Hover> {\n        return this.proxy.$provideHover(handle, model.uri, position, token);\n    }\n\n    $registerEvaluatableExpressionProvider(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[]): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const evaluatableExpressionProvider = this.createEvaluatableExpressionProvider(handle);\n        this.register(handle,\n            (StandaloneServices.get(ILanguageFeaturesService).evaluatableExpressionProvider.register as RegistrationFunction<EvaluatableExpressionProvider>)\n                (languageSelector, evaluatableExpressionProvider));\n    }\n\n    protected createEvaluatableExpressionProvider(handle: number): EvaluatableExpressionProvider {\n        return {\n            provideEvaluatableExpression: (model, position, token) => this.provideEvaluatableExpression(handle, model, position, token)\n        };\n    }\n\n    protected provideEvaluatableExpression(handle: number, model: ITextModel, position: monaco.Position,\n        token: monaco.CancellationToken): monaco.languages.ProviderResult<EvaluatableExpression | undefined> {\n        return this.proxy.$provideEvaluatableExpression(handle, model.uri, position, token);\n    }\n\n    $registerInlineValuesProvider(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[]): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const inlineValuesProvider = this.createInlineValuesProvider(handle);\n        this.register(handle,\n            (StandaloneServices.get(ILanguageFeaturesService).inlineValuesProvider.register as RegistrationFunction<InlineValuesProvider>)\n                (languageSelector, inlineValuesProvider));\n    }\n\n    protected createInlineValuesProvider(handle: number): InlineValuesProvider {\n        return {\n            provideInlineValues: (model, range, context, token) => this.provideInlineValues(handle, model, range, context, token)\n        };\n    }\n\n    protected provideInlineValues(handle: number, model: ITextModel, range: Range,\n        context: InlineValueContext, token: monaco.CancellationToken): monaco.languages.ProviderResult<InlineValue[] | undefined> {\n        return this.proxy.$provideInlineValues(handle, model.uri, range, context, token);\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    $emitInlineValuesEvent(eventHandle: number, event?: any): void {\n        const obj = this.services.get(eventHandle);\n        if (obj instanceof Emitter) {\n            obj.fire(event);\n        }\n    }\n\n    $registerDocumentHighlightProvider(handle: number, _pluginInfo: PluginInfo, selector: SerializedDocumentFilter[]): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const documentHighlightProvider = this.createDocumentHighlightProvider(handle);\n        this.register(handle, (monaco.languages.registerDocumentHighlightProvider as RegistrationFunction<monaco.languages.DocumentHighlightProvider>)\n            (languageSelector, documentHighlightProvider));\n    }\n\n    protected createDocumentHighlightProvider(handle: number): monaco.languages.DocumentHighlightProvider {\n        return {\n            provideDocumentHighlights: (model, position, token) => this.provideDocumentHighlights(handle, model, position, token)\n        };\n    }\n\n    protected provideDocumentHighlights(handle: number, model: monaco.editor.ITextModel, position: monaco.Position,\n        token: monaco.CancellationToken): monaco.languages.ProviderResult<monaco.languages.DocumentHighlight[]> {\n        return this.proxy.$provideDocumentHighlights(handle, model.uri, position, token).then(result => {\n            if (!result) {\n                return undefined;\n            }\n\n            if (Array.isArray(result)) {\n                const highlights: monaco.languages.DocumentHighlight[] = [];\n                for (const item of result) {\n                    highlights.push(\n                        {\n                            ...item,\n                            kind: (item.kind ? item.kind : monaco.languages.DocumentHighlightKind.Text)\n                        });\n                }\n                return highlights;\n            }\n\n            return undefined;\n        });\n    }\n\n    $registerWorkspaceSymbolProvider(handle: number, pluginInfo: PluginInfo): void {\n        const workspaceSymbolProvider = this.createWorkspaceSymbolProvider(handle);\n        this.register(handle, this.monacoLanguages.registerWorkspaceSymbolProvider(workspaceSymbolProvider));\n    }\n\n    protected createWorkspaceSymbolProvider(handle: number): WorkspaceSymbolProvider {\n        return {\n            provideWorkspaceSymbols: (params, token) => this.provideWorkspaceSymbols(handle, params, token),\n            resolveWorkspaceSymbol: (symbol, token) => this.resolveWorkspaceSymbol(handle, symbol, token)\n        };\n    }\n\n    protected provideWorkspaceSymbols(handle: number, params: WorkspaceSymbolParams, token: monaco.CancellationToken): Thenable<vst.SymbolInformation[]> {\n        return this.proxy.$provideWorkspaceSymbols(handle, params.query, token);\n    }\n\n    protected resolveWorkspaceSymbol(handle: number, symbol: vst.SymbolInformation, token: monaco.CancellationToken): Thenable<vst.SymbolInformation | undefined> {\n        return this.proxy.$resolveWorkspaceSymbol(handle, symbol, token);\n    }\n\n    $registerDocumentLinkProvider(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[]): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const linkProvider = this.createLinkProvider(handle);\n        this.register(handle, (monaco.languages.registerLinkProvider as RegistrationFunction<monaco.languages.LinkProvider>)(languageSelector, linkProvider));\n    }\n\n    protected createLinkProvider(handle: number): monaco.languages.LinkProvider {\n        return {\n            provideLinks: async (model, token) => this.provideLinks(handle, model, token),\n            resolveLink: async (link, token) => this.resolveLink(handle, link, token)\n        };\n    }\n\n    protected async provideLinks(handle: number, model: monaco.editor.ITextModel,\n        token: monaco.CancellationToken): Promise<monaco.languages.ProviderResult<monaco.languages.ILinksList>> {\n        const links = await this.proxy.$provideDocumentLinks(handle, model.uri, token);\n        if (!links) {\n            return undefined;\n        }\n        return {\n            links: links.map(link => this.toMonacoLink(link)),\n            dispose: () => {\n                if (links && Array.isArray(links)) {\n                    this.proxy.$releaseDocumentLinks(handle, links.map(link => ObjectIdentifier.of(link)));\n                }\n            }\n        };\n    }\n\n    protected async resolveLink(handle: number, link: monaco.languages.ILink,\n        token: monaco.CancellationToken): Promise<monaco.languages.ProviderResult<monaco.languages.ILink>> {\n        const resolved = await this.proxy.$resolveDocumentLink(handle, link, token);\n        return resolved && this.toMonacoLink(resolved);\n    }\n\n    protected toMonacoLink(link: DocumentLink): monaco.languages.ILink {\n        return {\n            ...link,\n            url: !!link.url && typeof link.url !== 'string' ? monaco.Uri.revive(link.url) : link.url\n        };\n    }\n\n    $registerCodeLensSupport(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[], eventHandle: number): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const lensProvider = this.createCodeLensProvider(handle);\n\n        if (typeof eventHandle === 'number') {\n            const emitter = new Emitter<monaco.languages.CodeLensProvider>();\n            this.register(eventHandle, emitter);\n            lensProvider.onDidChange = emitter.event;\n        }\n\n        this.register(handle, (monaco.languages.registerCodeLensProvider as RegistrationFunction<monaco.languages.CodeLensProvider>)(languageSelector, lensProvider));\n    }\n\n    protected createCodeLensProvider(handle: number): monaco.languages.CodeLensProvider {\n        return {\n            provideCodeLenses: async (model, token) => this.provideCodeLenses(handle, model, token),\n            resolveCodeLens: (model, codeLens, token) => this.resolveCodeLens(handle, model, codeLens, token)\n        };\n    }\n\n    protected async provideCodeLenses(handle: number, model: monaco.editor.ITextModel,\n        token: monaco.CancellationToken): Promise<monaco.languages.ProviderResult<monaco.languages.CodeLensList>> {\n        const lenses = await this.proxy.$provideCodeLenses(handle, model.uri, token);\n        if (!lenses) {\n            return undefined;\n        }\n        return {\n            lenses,\n            dispose: () => {\n                if (lenses && Array.isArray(lenses)) {\n                    this.proxy.$releaseCodeLenses(handle, lenses.map(symbol => ObjectIdentifier.of(symbol)));\n                }\n            }\n        };\n    }\n\n    protected resolveCodeLens(handle: number, model: monaco.editor.ITextModel,\n        codeLens: monaco.languages.CodeLens, token: monaco.CancellationToken): monaco.languages.ProviderResult<monaco.languages.CodeLens> {\n        return this.proxy.$resolveCodeLens(handle, model.uri, codeLens, token);\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    $emitCodeLensEvent(eventHandle: number, event?: any): void {\n        const obj = this.services.get(eventHandle);\n        if (obj instanceof Emitter) {\n            obj.fire(event);\n        }\n    }\n\n    $registerOutlineSupport(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[], displayName?: string): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const symbolProvider = this.createDocumentSymbolProvider(handle, displayName);\n        this.register(handle, (monaco.languages.registerDocumentSymbolProvider as RegistrationFunction<monaco.languages.DocumentSymbolProvider>)(languageSelector, symbolProvider));\n    }\n\n    protected createDocumentSymbolProvider(handle: number, displayName?: string): monaco.languages.DocumentSymbolProvider {\n        return {\n            displayName,\n            provideDocumentSymbols: (model, token) => this.provideDocumentSymbols(handle, model, token)\n        };\n    }\n\n    protected provideDocumentSymbols(handle: number, model: monaco.editor.ITextModel,\n        token: monaco.CancellationToken): monaco.languages.ProviderResult<monaco.languages.DocumentSymbol[]> {\n        return this.proxy.$provideDocumentSymbols(handle, model.uri, token);\n    }\n\n    protected createDefinitionProvider(handle: number): monaco.languages.DefinitionProvider {\n        return {\n            provideDefinition: (model, position, token) => this.provideDefinition(handle, model, position, token)\n        };\n    }\n\n    protected createDeclarationProvider(handle: number): monaco.languages.DeclarationProvider {\n        return {\n            provideDeclaration: (model, position, token) => this.provideDeclaration(handle, model, position, token)\n        };\n    }\n\n    protected provideDeclaration(handle: number, model: monaco.editor.ITextModel, position: monaco.Position,\n        token: monaco.CancellationToken): monaco.languages.ProviderResult<monaco.languages.Definition> {\n        return this.proxy.$provideDeclaration(handle, model.uri, position, token).then(result => {\n            if (!result) {\n                return undefined;\n            }\n\n            if (Array.isArray(result)) {\n                // using DefinitionLink because Location is mandatory part of DefinitionLink\n                const definitionLinks: monaco.languages.LocationLink[] = [];\n                for (const item of result) {\n                    definitionLinks.push({ ...item, uri: monaco.Uri.revive(item.uri) });\n                }\n                return definitionLinks;\n            } else {\n                // single Location\n                return <monaco.languages.Location>{\n                    uri: monaco.Uri.revive(result.uri),\n                    range: result.range\n                };\n            }\n        });\n    }\n\n    protected provideDefinition(handle: number, model: monaco.editor.ITextModel,\n        position: monaco.Position, token: monaco.CancellationToken): monaco.languages.ProviderResult<monaco.languages.Definition> {\n        return this.proxy.$provideDefinition(handle, model.uri, position, token).then(result => {\n            if (!result) {\n                return undefined;\n            }\n\n            if (Array.isArray(result)) {\n                // using DefinitionLink because Location is mandatory part of DefinitionLink\n                const definitionLinks: monaco.languages.LocationLink[] = [];\n                for (const item of result) {\n                    definitionLinks.push({ ...item, uri: monaco.Uri.revive(item.uri) });\n                }\n                return definitionLinks;\n            } else {\n                // single Location\n                return <monaco.languages.Location>{\n                    uri: monaco.Uri.revive(result.uri),\n                    range: result.range\n                };\n            }\n        });\n    }\n\n    protected createSignatureHelpProvider(handle: number, metadata: theia.SignatureHelpProviderMetadata): monaco.languages.SignatureHelpProvider {\n        return {\n            signatureHelpTriggerCharacters: metadata.triggerCharacters,\n            signatureHelpRetriggerCharacters: metadata.retriggerCharacters,\n            provideSignatureHelp: async (model, position, token, context) => this.provideSignatureHelp(handle, model, position, token, context)\n        };\n    }\n\n    protected async provideSignatureHelp(handle: number, model: monaco.editor.ITextModel,\n        position: monaco.Position, token: monaco.CancellationToken,\n        context: monaco.languages.SignatureHelpContext): Promise<monaco.languages.ProviderResult<monaco.languages.SignatureHelpResult>> {\n        const value = await this.proxy.$provideSignatureHelp(handle, model.uri, position, context, token);\n        if (!value) {\n            return undefined;\n        }\n        return {\n            value,\n            dispose: () => {\n                if (typeof value.id === 'number') {\n                    this.proxy.$releaseSignatureHelp(handle, value.id);\n                }\n            }\n        };\n    }\n\n    $registerDocumentFormattingSupport(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[]): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const documentFormattingEditSupport = this.createDocumentFormattingSupport(handle, pluginInfo);\n        this.register(handle, (monaco.languages.registerDocumentFormattingEditProvider as RegistrationFunction<monaco.languages.DocumentFormattingEditProvider>)\n            (languageSelector, documentFormattingEditSupport));\n    }\n\n    createDocumentFormattingSupport(handle: number, pluginInfo: PluginInfo): monaco.languages.DocumentFormattingEditProvider {\n        const provider: monaco.languages.DocumentFormattingEditProvider & { extensionId: ExtensionIdentifier } = {\n            extensionId: new ExtensionIdentifier(pluginInfo.id),\n            displayName: pluginInfo.name,\n            provideDocumentFormattingEdits: (model, options, token) =>\n                this.provideDocumentFormattingEdits(handle, model, options, token)\n        };\n\n        return provider;\n    }\n\n    protected provideDocumentFormattingEdits(handle: number, model: monaco.editor.ITextModel,\n        options: monaco.languages.FormattingOptions, token: monaco.CancellationToken): monaco.languages.ProviderResult<monaco.languages.TextEdit[]> {\n        return this.proxy.$provideDocumentFormattingEdits(handle, model.uri, options, token);\n    }\n\n    $registerRangeFormattingSupport(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[]): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const rangeFormattingEditProvider = this.createRangeFormattingSupport(handle, pluginInfo);\n        this.register(handle, (monaco.languages.registerDocumentRangeFormattingEditProvider as RegistrationFunction<monaco.languages.DocumentRangeFormattingEditProvider>)\n            (languageSelector, rangeFormattingEditProvider));\n    }\n\n    createRangeFormattingSupport(handle: number, pluginInfo: PluginInfo): monaco.languages.DocumentRangeFormattingEditProvider {\n        const provider: monaco.languages.DocumentRangeFormattingEditProvider & { extensionId: ExtensionIdentifier } = {\n            extensionId: new ExtensionIdentifier(pluginInfo.id),\n            displayName: pluginInfo.name,\n            provideDocumentRangeFormattingEdits: (model, range: Range, options, token) =>\n                this.provideDocumentRangeFormattingEdits(handle, model, range, options, token)\n        };\n\n        return provider;\n    }\n\n    protected provideDocumentRangeFormattingEdits(handle: number, model: monaco.editor.ITextModel,\n        range: Range, options: monaco.languages.FormattingOptions, token: monaco.CancellationToken): monaco.languages.ProviderResult<monaco.languages.TextEdit[]> {\n        return this.proxy.$provideDocumentRangeFormattingEdits(handle, model.uri, range, options, token);\n    }\n\n    $registerOnTypeFormattingProvider(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[], autoFormatTriggerCharacters: string[]): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const onTypeFormattingProvider = this.createOnTypeFormattingProvider(handle, autoFormatTriggerCharacters);\n        this.register(handle, (monaco.languages.registerOnTypeFormattingEditProvider as RegistrationFunction<monaco.languages.OnTypeFormattingEditProvider>)\n            (languageSelector, onTypeFormattingProvider));\n    }\n\n    protected createOnTypeFormattingProvider(\n        handle: number,\n        autoFormatTriggerCharacters: string[]\n    ): monaco.languages.OnTypeFormattingEditProvider {\n        return {\n            autoFormatTriggerCharacters,\n            provideOnTypeFormattingEdits: (model, position, ch, options, token) => this.provideOnTypeFormattingEdits(handle, model, position, ch, options, token)\n        };\n    }\n\n    protected provideOnTypeFormattingEdits(handle: number, model: monaco.editor.ITextModel, position: monaco.Position,\n        ch: string, options: monaco.languages.FormattingOptions, token: monaco.CancellationToken): monaco.languages.ProviderResult<monaco.languages.TextEdit[]> {\n        return this.proxy.$provideOnTypeFormattingEdits(handle, model.uri, position, ch, options, token);\n    }\n\n    $registerDocumentDropEditProvider(handle: number, selector: SerializedDocumentFilter[], metadata?: DocumentDropEditProviderMetadata): void {\n        this.register(\n            handle,\n            StandaloneServices\n                .get(ILanguageFeaturesService)\n                .documentOnDropEditProvider\n                .register(selector, this.createDocumentDropEditProvider(handle, metadata))\n        );\n    }\n\n    createDocumentDropEditProvider(handle: number, _metadata?: DocumentDropEditProviderMetadata): DocumentOnDropEditProvider {\n        return {\n            // @monaco-uplift id and dropMimeTypes should be supported by the monaco drop editor provider after 1.82.0\n            // id?: string;\n            // dropMimeTypes: metadata?.dropMimeTypes ?? ['*/*'],\n            provideDocumentOnDropEdits: async (model, position, dataTransfer, token) => this.provideDocumentDropEdits(handle, model, position, dataTransfer, token)\n        };\n    }\n\n    protected async provideDocumentDropEdits(handle: number, model: ITextModel, position: monaco.IPosition,\n        dataTransfer: VSDataTransfer, token: CancellationToken): Promise<DocumentOnDropEdit | undefined> {\n        await this.fileUploadService.upload(new URI(), { source: dataTransfer, leaveInTemp: true });\n        const edit = await this.proxy.$provideDocumentDropEdits(handle, model.uri, position, await DataTransfer.toDataTransferDTO(dataTransfer), token);\n        if (edit) {\n            return {\n                // @monaco-uplift label and yieldTo should be supported by monaco after 1.82.0. The implementation relies on a copy of the plugin data\n                // label: label: edit.label ?? localize('defaultDropLabel', \"Drop using '{0}' extension\", this._extension.displayName || this._extension.name),,\n                // yieldTo: edit.yieldTo?.map(yTo => {\n                //      return 'mimeType' in yTo ? yTo : { providerId: DocumentOnDropEditAdapter.toInternalProviderId(yTo.extensionId, yTo.providerId) };\n                // }),\n                insertText: edit.insertText instanceof SnippetString ? { snippet: edit.insertText.value } : edit.insertText,\n                additionalEdit: toMonacoWorkspaceEdit(edit?.additionalEdit)\n            };\n        }\n    }\n\n    $registerFoldingRangeProvider(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[], eventHandle: number | undefined): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const provider = this.createFoldingRangeProvider(handle);\n\n        if (typeof eventHandle === 'number') {\n            const emitter = new Emitter<monaco.languages.FoldingRangeProvider>();\n            this.services.set(eventHandle, emitter);\n            provider.onDidChange = emitter.event;\n        }\n\n        this.register(handle, (monaco.languages.registerFoldingRangeProvider as RegistrationFunction<monaco.languages.FoldingRangeProvider>)(languageSelector, provider));\n    }\n\n    createFoldingRangeProvider(handle: number): monaco.languages.FoldingRangeProvider {\n        return {\n            provideFoldingRanges: (model, context, token) => this.provideFoldingRanges(handle, model, context, token)\n        };\n    }\n\n    $emitFoldingRangeEvent(eventHandle: number, event?: unknown): void {\n        const obj = this.services.get(eventHandle);\n        if (obj instanceof Emitter) {\n            obj.fire(event);\n        }\n    }\n\n    protected provideFoldingRanges(handle: number, model: monaco.editor.ITextModel,\n        context: monaco.languages.FoldingContext, token: monaco.CancellationToken): monaco.languages.ProviderResult<monaco.languages.FoldingRange[]> {\n        return this.proxy.$provideFoldingRange(handle, model.uri, context, token);\n    }\n\n    $registerSelectionRangeProvider(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[]): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const provider = this.createSelectionRangeProvider(handle);\n        this.register(handle, (monaco.languages.registerSelectionRangeProvider as RegistrationFunction<monaco.languages.SelectionRangeProvider>)(languageSelector, provider));\n    }\n\n    protected createSelectionRangeProvider(handle: number): monaco.languages.SelectionRangeProvider {\n        return {\n            provideSelectionRanges: (model, positions, token) => this.provideSelectionRanges(handle, model, positions, token)\n        };\n    }\n\n    protected provideSelectionRanges(handle: number, model: monaco.editor.ITextModel,\n        positions: monaco.Position[], token: monaco.CancellationToken): monaco.languages.ProviderResult<monaco.languages.SelectionRange[][]> {\n        return this.proxy.$provideSelectionRanges(handle, model.uri, positions, token);\n    }\n\n    $registerDocumentColorProvider(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[]): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const colorProvider = this.createColorProvider(handle);\n        this.register(handle, (monaco.languages.registerColorProvider as RegistrationFunction<monaco.languages.DocumentColorProvider>)(languageSelector, colorProvider));\n    }\n\n    createColorProvider(handle: number): monaco.languages.DocumentColorProvider {\n        return {\n            provideDocumentColors: (model, token) => this.provideDocumentColors(handle, model, token),\n            provideColorPresentations: (model, colorInfo, token) => this.provideColorPresentations(handle, model, colorInfo, token)\n        };\n    }\n\n    protected provideDocumentColors(handle: number, model: monaco.editor.ITextModel,\n        token: monaco.CancellationToken): monaco.languages.ProviderResult<monaco.languages.IColorInformation[]> {\n        return this.proxy.$provideDocumentColors(handle, model.uri, token).then(documentColors =>\n            documentColors.map(documentColor => {\n                const [red, green, blue, alpha] = documentColor.color;\n                const color = {\n                    red: red,\n                    green: green,\n                    blue: blue,\n                    alpha: alpha\n                };\n\n                return {\n                    color,\n                    range: documentColor.range\n                };\n            })\n        );\n    }\n\n    protected provideColorPresentations(handle: number, model: monaco.editor.ITextModel,\n        colorInfo: monaco.languages.IColorInformation, token: monaco.CancellationToken): monaco.languages.ProviderResult<monaco.languages.IColorPresentation[]> {\n        return this.proxy.$provideColorPresentations(handle, model.uri, {\n            color: [\n                colorInfo.color.red,\n                colorInfo.color.green,\n                colorInfo.color.blue,\n                colorInfo.color.alpha\n            ],\n            range: colorInfo.range\n        }, token);\n    }\n\n    $registerInlayHintsProvider(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[], displayName?: string, eventHandle?: number): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const inlayHintsProvider = this.createInlayHintsProvider(handle);\n        if (typeof eventHandle === 'number') {\n            const emitter = new Emitter<void>();\n            this.register(eventHandle, emitter);\n            inlayHintsProvider.onDidChangeInlayHints = emitter.event;\n        }\n        this.register(handle, (monaco.languages.registerInlayHintsProvider as RegistrationFunction<monaco.languages.InlayHintsProvider>)(languageSelector, inlayHintsProvider));\n\n    }\n\n    createInlayHintsProvider(handle: number): monaco.languages.InlayHintsProvider {\n        return {\n            provideInlayHints: async (model: monaco.editor.ITextModel, range: Range, token: monaco.CancellationToken): Promise<monaco.languages.InlayHintList | undefined> => {\n                const result = await this.proxy.$provideInlayHints(handle, model.uri, range, token);\n                if (!result) {\n                    return;\n                }\n                return {\n                    hints: result.hints.map(hint => reviveHint(hint)),\n                    dispose: () => {\n                        if (typeof result.cacheId === 'number') {\n                            this.proxy.$releaseInlayHints(handle, result.cacheId);\n                        }\n                    }\n                };\n            },\n            resolveInlayHint: async (hint, token): Promise<monaco.languages.InlayHint | undefined> => {\n                const dto: InlayHintDto = hint;\n                if (typeof dto.cacheId !== 'number') {\n                    return hint;\n                }\n                const result = await this.proxy.$resolveInlayHint(handle, dto.cacheId, token);\n                if (token.isCancellationRequested) {\n                    return undefined;\n                }\n                if (!result) {\n                    return hint;\n                }\n                return {\n                    ...hint,\n                    tooltip: result.tooltip,\n                    label: reviveInlayLabel(result.label)\n                };\n            },\n        };\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    $emitInlayHintsEvent(eventHandle: number, event?: any): void {\n        const obj = this.services.get(eventHandle);\n        if (obj instanceof Emitter) {\n            obj.fire(event);\n        }\n    }\n\n    $registerInlineCompletionsSupport(handle: number, selector: SerializedDocumentFilter[]): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const provider: monaco.languages.InlineCompletionsProvider<IdentifiableInlineCompletions> = {\n            provideInlineCompletions: async (\n                model: monaco.editor.ITextModel,\n                position: monaco.Position,\n                context: monaco.languages.InlineCompletionContext,\n                token: CancellationToken\n            ): Promise<IdentifiableInlineCompletions | undefined> => this.proxy.$provideInlineCompletions(handle, model.uri, position, context, token),\n            freeInlineCompletions: (completions: IdentifiableInlineCompletions): void => {\n                this.proxy.$freeInlineCompletionsList(handle, completions.pid);\n            }\n        };\n        this.register(handle, (monaco.languages.registerInlineCompletionsProvider as RegistrationFunction<monaco.languages.InlineCompletionsProvider>)(languageSelector, provider));\n    }\n\n    $registerQuickFixProvider(\n        handle: number,\n        pluginInfo: PluginInfo,\n        selector: SerializedDocumentFilter[],\n        providedCodeActionKinds?: string[],\n        documentation?: CodeActionProviderDocumentation\n    ): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const quickFixProvider: monaco.languages.CodeActionProvider = {\n            provideCodeActions: (model, range, context, token) => {\n                const markers = StandaloneServices.get(IMarkerService)\n                    .read({ resource: model.uri })\n                    .filter(m => monaco.Range.areIntersectingOrTouching(m, range)) as monaco.editor.IMarkerData[];\n                return this.provideCodeActions(handle, model, range, { ...context, markers }, token);\n            },\n            resolveCodeAction: (codeAction, token) => this.resolveCodeAction(handle, codeAction, token)\n        };\n        this.register(handle, (monaco.languages.registerCodeActionProvider as RegistrationFunction<monaco.languages.CodeActionProvider>)(languageSelector, quickFixProvider));\n    }\n\n    protected async provideCodeActions(\n        handle: number,\n        model: monaco.editor.ITextModel,\n        rangeOrSelection: Range,\n        context: monaco.languages.CodeActionContext,\n        token: monaco.CancellationToken\n    ): Promise<monaco.languages.CodeActionList | undefined> {\n        const actions = await this.proxy.$provideCodeActions(handle, model.uri, rangeOrSelection, this.toModelCodeActionContext(context), token);\n        if (!actions) {\n            return undefined;\n        }\n        return {\n            actions: actions.map(a => toMonacoAction(a)),\n            dispose: () => this.proxy.$releaseCodeActions(handle, actions.map(a => a.cacheId))\n        };\n    }\n\n    protected toModelCodeActionContext(context: monaco.languages.CodeActionContext): CodeActionContext {\n        return {\n            ...context,\n            trigger: this.toCodeActionTriggerKind(context.trigger)\n        };\n    }\n\n    toCodeActionTriggerKind(type: monaco.languages.CodeActionTriggerType): CodeActionTriggerKind {\n        switch (type) {\n            case monaco.languages.CodeActionTriggerType.Auto:\n                return CodeActionTriggerKind.Automatic;\n            case monaco.languages.CodeActionTriggerType.Invoke:\n                return CodeActionTriggerKind.Invoke;\n        }\n    }\n\n    protected async resolveCodeAction(handle: number, codeAction: monaco.languages.CodeAction, token: monaco.CancellationToken): Promise<monaco.languages.CodeAction> {\n        // The cacheId is kept in toMonacoAction when converting a received CodeAction DTO to a monaco code action\n        const cacheId = (codeAction as CodeAction).cacheId;\n        if (cacheId !== undefined) {\n            const resolvedEdit = await this.proxy.$resolveCodeAction(handle, cacheId, token);\n            codeAction.edit = resolvedEdit && toMonacoWorkspaceEdit(resolvedEdit);\n        }\n        return codeAction;\n    }\n\n    $registerRenameProvider(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[], supportsResolveLocation: boolean): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const renameProvider = this.createRenameProvider(handle, supportsResolveLocation);\n        this.register(handle, (monaco.languages.registerRenameProvider as RegistrationFunction<monaco.languages.RenameProvider>)(languageSelector, renameProvider));\n    }\n\n    protected createRenameProvider(handle: number, supportsResolveLocation: boolean): monaco.languages.RenameProvider {\n        return {\n            provideRenameEdits: (model, position, newName, token) => this.provideRenameEdits(handle, model, position, newName, token)\n            ,\n            resolveRenameLocation: supportsResolveLocation\n                ? (model, position, token) =>\n                    this.resolveRenameLocation(handle, model, position, token)\n                : undefined\n        };\n    }\n\n    protected provideRenameEdits(handle: number, model: monaco.editor.ITextModel,\n        position: monaco.Position, newName: string, token: monaco.CancellationToken): monaco.languages.ProviderResult<monaco.languages.WorkspaceEdit & monaco.languages.Rejection> {\n        return this.proxy.$provideRenameEdits(handle, model.uri, position, newName, token).then(toMonacoWorkspaceEdit);\n    }\n\n    $registerCallHierarchyProvider(handle: number, selector: SerializedDocumentFilter[]): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const callHierarchyService = this.createCallHierarchyService(handle, languageSelector);\n        this.register(handle, this.callHierarchyServiceContributionRegistry.add(callHierarchyService));\n    }\n\n    protected createCallHierarchyService(handle: number, language: LanguageSelector): CallHierarchyService {\n        return {\n            selector: language,\n            getRootDefinition: (uri: DocumentUri, position: Position, cancellationToken: CancellationToken) =>\n                this.proxy.$provideRootDefinition(handle, toUriComponents(uri), fromPosition(position), cancellationToken)\n                    .then(def => {\n                        if (!def) { return undefined; }\n                        const defs = Array.isArray(def) ? def : [def];\n                        return { dispose: () => this.proxy.$releaseCallHierarchy(handle, defs[0]?._sessionId), items: defs.map(item => toItemHierarchyDefinition(item)) };\n                    }),\n            getCallers:\n                (\n                    definition: CallHierarchyItem,\n                    cancellationToken: CancellationToken\n                ) => this.proxy.$provideCallers(handle, fromItemHierarchyDefinition(definition), cancellationToken)\n                    .then(result => {\n                        if (!result) {\n                            return undefined!;\n                        }\n\n                        if (Array.isArray(result)) {\n                            return result.map(toCaller);\n                        }\n\n                        return undefined!;\n                    }),\n\n            getCallees:\n                (\n                    definition: CallHierarchyItem,\n                    cancellationToken: CancellationToken\n                ) => this.proxy.$provideCallees(handle, fromItemHierarchyDefinition(definition), cancellationToken)\n                    .then(result => {\n                        if (!result) {\n                            return undefined;\n                        }\n                        if (Array.isArray(result)) {\n                            return result.map(toCallee);\n                        }\n\n                        return undefined;\n                    })\n        };\n    }\n\n    protected resolveRenameLocation(handle: number, model: monaco.editor.ITextModel,\n        position: monaco.Position, token: monaco.CancellationToken): monaco.languages.ProviderResult<monaco.languages.RenameLocation> {\n        return this.proxy.$resolveRenameLocation(handle, model.uri, position, token);\n    }\n\n    // --- type hierarchy\n    $registerTypeHierarchyProvider(handle: number, selector: SerializedDocumentFilter[]): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const typeHierarchyService = this.createTypeHierarchyService(handle, languageSelector);\n        this.register(handle, this.typeHierarchyServiceContributionRegistry.add(typeHierarchyService));\n    }\n\n    protected createTypeHierarchyService(handle: number, language: LanguageSelector): TypeHierarchyService {\n        return {\n            selector: language,\n            prepareSession: (uri: DocumentUri, position: Position, cancellationToken: CancellationToken) =>\n                this.proxy.$prepareTypeHierarchy(handle, toUriComponents(uri), fromPosition(position), cancellationToken)\n                    .then(result => {\n                        if (!result) {\n                            return undefined;\n                        }\n                        const items = Array.isArray(result) ? result : [result];\n                        return {\n                            dispose: () => this.proxy.$releaseTypeHierarchy(handle, items[0]?._sessionId),\n                            items: items.map(item => toItemHierarchyDefinition(item))\n                        };\n                    }),\n            provideSuperTypes: (sessionId, itemId, cancellationToken: CancellationToken) => this.proxy.$provideSuperTypes(handle, sessionId, itemId, cancellationToken)\n                .then(results => {\n                    if (!results) {\n                        return undefined;\n                    }\n\n                    if (Array.isArray(results)) {\n                        return results.map(toItemHierarchyDefinition);\n                    }\n\n                    return undefined;\n                }),\n            provideSubTypes: async (sessionId, itemId, cancellationToken: CancellationToken) => this.proxy.$provideSubTypes(handle, sessionId, itemId, cancellationToken)\n                .then(results => {\n                    if (!results) {\n                        return undefined;\n                    }\n\n                    if (Array.isArray(results)) {\n                        return results.map(toItemHierarchyDefinition);\n                    }\n\n                    return undefined;\n                })\n        };\n    }\n\n    // --- semantic tokens\n    $registerDocumentSemanticTokensProvider(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[], legend: theia.SemanticTokensLegend,\n        eventHandle: number | undefined): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        let event: Event<void> | undefined = undefined;\n        if (typeof eventHandle === 'number') {\n            const emitter = new Emitter<void>();\n            this.register(eventHandle, emitter);\n            event = emitter.event;\n        }\n        const provider = this.createDocumentSemanticTokensProvider(handle, legend, event);\n        this.register(handle, (monaco.languages.registerDocumentSemanticTokensProvider as RegistrationFunction<monaco.languages.DocumentSemanticTokensProvider>)\n            (languageSelector, provider));\n    }\n\n    protected createDocumentSemanticTokensProvider(handle: number, legend: theia.SemanticTokensLegend, event?: Event<void>): monaco.languages.DocumentSemanticTokensProvider {\n        return {\n            releaseDocumentSemanticTokens: resultId => {\n                if (resultId) {\n                    this.proxy.$releaseDocumentSemanticTokens(handle, parseInt(resultId, 10));\n                }\n            },\n            getLegend: () => legend,\n            provideDocumentSemanticTokens: async (model, lastResultId, token) => {\n                const nLastResultId = lastResultId ? parseInt(lastResultId, 10) : 0;\n                const encodedDto = await this.proxy.$provideDocumentSemanticTokens(handle, model.uri, nLastResultId, token);\n                if (!encodedDto) {\n                    return null;\n                }\n                if (token.isCancellationRequested) {\n                    return null;\n                }\n                const dto = decodeSemanticTokensDto(encodedDto);\n                if (dto.type === 'full') {\n                    return {\n                        resultId: String(dto.id),\n                        data: dto.data\n                    };\n                }\n                return {\n                    resultId: String(dto.id),\n                    edits: dto.deltas\n                };\n            }\n        };\n    }\n\n    $emitDocumentSemanticTokensEvent(eventHandle: number): void {\n        const obj = this.services.get(eventHandle);\n        if (obj instanceof Emitter) {\n            obj.fire(undefined);\n        }\n    }\n\n    $registerDocumentRangeSemanticTokensProvider(handle: number, pluginInfo: PluginInfo, selector: SerializedDocumentFilter[], legend: theia.SemanticTokensLegend): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const provider = this.createDocumentRangeSemanticTokensProvider(handle, legend);\n        this.register(handle, (monaco.languages.registerDocumentRangeSemanticTokensProvider as RegistrationFunction<monaco.languages.DocumentRangeSemanticTokensProvider>)\n            (languageSelector, provider));\n    }\n\n    protected createDocumentRangeSemanticTokensProvider(handle: number, legend: theia.SemanticTokensLegend): monaco.languages.DocumentRangeSemanticTokensProvider {\n        return {\n            getLegend: () => legend,\n            provideDocumentRangeSemanticTokens: async (model, range, token) => {\n                const encodedDto = await this.proxy.$provideDocumentRangeSemanticTokens(handle, model.uri, range, token);\n                if (!encodedDto) {\n                    return null;\n                }\n                if (token.isCancellationRequested) {\n                    return null;\n                }\n                const dto = decodeSemanticTokensDto(encodedDto);\n                if (dto.type === 'full') {\n                    return {\n                        resultId: String(dto.id),\n                        data: dto.data\n                    };\n                }\n                throw new Error('Unexpected');\n            }\n        };\n    }\n\n    // --- suggest\n\n    protected toLanguageSelector(filters: SerializedDocumentFilter[]): MonacoLanguageSelector.LanguageSelector & LanguageSelector {\n        return filters.map(filter => {\n            let pattern: string | (IRelativePattern & RelativePattern) | undefined;\n            if (typeof filter.pattern === 'string') {\n                pattern = filter.pattern;\n            } else if (filter.pattern) {\n                pattern = {\n                    base: MonacoPath.normalize(filter.pattern.baseUri.toString()),\n                    pattern: filter.pattern.pattern,\n                    pathToRelative: relative\n                };\n            }\n            return {\n                language: filter.language,\n                scheme: filter.scheme,\n                pattern\n            };\n        });\n    }\n\n    // --- linked editing range\n\n    $registerLinkedEditingRangeProvider(handle: number, selector: SerializedDocumentFilter[]): void {\n        const languageSelector = this.toLanguageSelector(selector);\n        const linkedEditingRangeProvider = this.createLinkedEditingRangeProvider(handle);\n        this.register(handle,\n            (monaco.languages.registerLinkedEditingRangeProvider as RegistrationFunction<monaco.languages.LinkedEditingRangeProvider>)(languageSelector, linkedEditingRangeProvider)\n        );\n    }\n\n    protected createLinkedEditingRangeProvider(handle: number): monaco.languages.LinkedEditingRangeProvider {\n        return {\n            provideLinkedEditingRanges: async (model: monaco.editor.ITextModel, position: monaco.Position, token: CancellationToken):\n                Promise<monaco.languages.LinkedEditingRanges | undefined> => {\n                const res = await this.proxy.$provideLinkedEditingRanges(handle, model.uri, position, token);\n                if (res) {\n                    return {\n                        ranges: res.ranges,\n                        wordPattern: reviveRegExp(res.wordPattern)\n                    };\n                }\n                return undefined;\n            }\n        };\n    };\n\n    // -- Language status\n\n    $setLanguageStatus(handle: number, status: LanguageStatusDTO): void {\n        const internal: EditorLanguageStatus = { ...status, selector: this.toLanguageSelector(status.selector) };\n        this.languageStatusService.setLanguageStatusItem(handle, internal);\n    };\n\n    $removeLanguageStatus(handle: number): void {\n        this.languageStatusService.removeLanguageStatusItem(handle);\n    };\n}\n\nfunction reviveMarker(marker: MarkerData): vst.Diagnostic {\n    const monacoMarker: vst.Diagnostic = {\n        code: marker.code,\n        severity: reviveSeverity(marker.severity),\n        range: reviveRange(marker.startLineNumber, marker.startColumn, marker.endLineNumber, marker.endColumn),\n        message: marker.message,\n        source: marker.source,\n        relatedInformation: undefined\n    };\n\n    if (marker.relatedInformation) {\n        monacoMarker.relatedInformation = marker.relatedInformation.map(reviveRelated);\n    }\n\n    if (marker.tags) {\n        monacoMarker.tags = marker.tags.map(reviveTag);\n    }\n\n    return monacoMarker;\n}\n\nfunction reviveSeverity(severity: MarkerSeverity): vst.DiagnosticSeverity {\n    switch (severity) {\n        case MarkerSeverity.Error: return vst.DiagnosticSeverity.Error;\n        case MarkerSeverity.Warning: return vst.DiagnosticSeverity.Warning;\n        case MarkerSeverity.Info: return vst.DiagnosticSeverity.Information;\n        case MarkerSeverity.Hint: return vst.DiagnosticSeverity.Hint;\n    }\n}\n\nfunction reviveRange(startLine: number, startColumn: number, endLine: number, endColumn: number): vst.Range {\n    // note: language server range is 0-based, marker is 1-based, so need to deduct 1 here\n    return {\n        start: {\n            line: startLine - 1,\n            character: startColumn - 1\n        },\n        end: {\n            line: endLine - 1,\n            character: endColumn - 1\n        }\n    };\n}\n\nfunction reviveRelated(related: RelatedInformation): vst.DiagnosticRelatedInformation {\n    return {\n        message: related.message,\n        location: {\n            uri: related.resource,\n            range: reviveRange(related.startLineNumber, related.startColumn, related.endLineNumber, related.endColumn)\n        }\n    };\n}\n\nfunction reviveTag(tag: DiagnosticTag): vst.DiagnosticTag {\n    switch (tag) {\n        case 1: return DiagnosticTag.Unnecessary;\n        case 2: return DiagnosticTag.Deprecated;\n    }\n}\n\nfunction reviveRegExp(regExp?: SerializedRegExp): RegExp | undefined {\n    if (typeof regExp === 'undefined' || regExp === null) {\n        return undefined;\n    }\n    return new RegExp(regExp.pattern, regExp.flags);\n}\n\nfunction reviveIndentationRule(indentationRule?: SerializedIndentationRule): monaco.languages.IndentationRule | undefined {\n    if (typeof indentationRule === 'undefined' || indentationRule === null) {\n        return undefined;\n    }\n    return {\n        increaseIndentPattern: reviveRegExp(indentationRule.increaseIndentPattern)!,\n        decreaseIndentPattern: reviveRegExp(indentationRule.decreaseIndentPattern)!,\n        indentNextLinePattern: reviveRegExp(indentationRule.indentNextLinePattern),\n        unIndentedLinePattern: reviveRegExp(indentationRule.unIndentedLinePattern),\n    };\n}\n\nfunction reviveOnEnterRule(onEnterRule: SerializedOnEnterRule): monaco.languages.OnEnterRule {\n    return {\n        beforeText: reviveRegExp(onEnterRule.beforeText)!,\n        afterText: reviveRegExp(onEnterRule.afterText),\n        previousLineText: reviveRegExp(onEnterRule.previousLineText),\n        action: onEnterRule.action,\n    };\n}\n\nfunction reviveOnEnterRules(onEnterRules?: SerializedOnEnterRule[]): monaco.languages.OnEnterRule[] | undefined {\n    if (typeof onEnterRules === 'undefined' || onEnterRules === null) {\n        return undefined;\n    }\n    return onEnterRules.map(reviveOnEnterRule);\n}\n\nfunction reviveInlayLabel(label: string | InlayHintLabelPart[]): string | monaco.languages.InlayHintLabelPart[] {\n    let monacoLabel: string | monaco.languages.InlayHintLabelPart[];\n    if (typeof label === 'string') {\n        monacoLabel = label;\n    } else {\n        const parts: monaco.languages.InlayHintLabelPart[] = [];\n        for (const part of label) {\n            const result: monaco.languages.InlayHintLabelPart = {\n                ...part,\n                location: !!part.location ? { range: part.location?.range, uri: monaco.Uri.revive(part.location.uri) } : undefined\n            };\n            parts.push(result);\n        }\n        monacoLabel = parts;\n    }\n    return monacoLabel;\n}\n\nfunction reviveHint(hint: InlayHint): monaco.languages.InlayHint {\n    return {\n        ...hint,\n        label: reviveInlayLabel(hint.label)\n    };\n}\n\nfunction toMonacoAction(action: CodeAction): monaco.languages.CodeAction {\n    return {\n        ...action,\n        diagnostics: action.diagnostics ? action.diagnostics.map(m => toMonacoMarkerData(m)) : undefined,\n        disabled: action.disabled?.reason,\n        edit: action.edit ? toMonacoWorkspaceEdit(action.edit) : undefined\n    };\n}\n\nfunction toMonacoMarkerData(marker: MarkerData): monaco.editor.IMarkerData {\n    return {\n        ...marker,\n        relatedInformation: marker.relatedInformation\n            ? marker.relatedInformation.map(i => toMonacoRelatedInformation(i))\n            : undefined\n    };\n}\n\nfunction toMonacoRelatedInformation(relatedInfo: RelatedInformation): monaco.editor.IRelatedInformation {\n    return {\n        ...relatedInfo,\n        resource: monaco.Uri.parse(relatedInfo.resource)\n    };\n}\n\nexport function toMonacoWorkspaceEdit(data: WorkspaceEditDto | undefined): monaco.languages.WorkspaceEdit {\n    return {\n        edits: (data && data.edits || []).map(edit => {\n            if (WorkspaceTextEditDto.is(edit)) {\n                return <monaco.languages.IWorkspaceTextEdit>{\n                    resource: monaco.Uri.revive(edit.resource),\n                    textEdit: edit.textEdit,\n                    metadata: edit.metadata\n                };\n            } else {\n                const fileEdit = edit as WorkspaceFileEditDto;\n                return <monaco.languages.IWorkspaceFileEdit>{\n                    newResource: monaco.Uri.revive(fileEdit.newResource),\n                    oldResource: monaco.Uri.revive(fileEdit.oldResource),\n                    options: fileEdit.options,\n                    metadata: fileEdit.metadata\n                };\n            }\n            // TODO implement WorkspaceNotebookCellEditDto\n        })\n    };\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { nls } from '@theia/core';\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { LocalizationMain } from '../../common/plugin-api-rpc';\nimport { LanguagePackBundle, LanguagePackService } from '../../common/language-pack-service';\n\nexport class LocalizationMainImpl implements LocalizationMain {\n\n    private readonly languagePackService: LanguagePackService;\n\n    constructor(container: interfaces.Container) {\n        this.languagePackService = container.get(LanguagePackService);\n    }\n\n    async $fetchBundle(id: string): Promise<LanguagePackBundle | undefined> {\n        const bundle = await this.languagePackService.getBundle(id, nls.locale ?? nls.defaultLocale);\n        return bundle;\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { CommandRegistryMainImpl } from './command-registry-main';\nimport { PreferenceRegistryMainImpl } from './preference-registry-main';\nimport { QuickOpenMainImpl } from './quick-open-main';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport { PLUGIN_RPC_CONTEXT, LanguagesMainFactory, OutputChannelRegistryFactory, MAIN_RPC_CONTEXT } from '../../common/plugin-api-rpc';\nimport { MessageRegistryMainImpl } from './message-registry-main';\nimport { WindowStateMain } from './window-state-main';\nimport { WorkspaceMainImpl } from './workspace-main';\nimport { StatusBarMessageRegistryMainImpl } from './status-bar-message-registry-main';\nimport { EnvMainImpl } from './env-main';\nimport { EditorsAndDocumentsMain } from './editors-and-documents-main';\nimport { TerminalServiceMainImpl } from './terminal-main';\nimport { DialogsMainImpl } from './dialogs-main';\nimport { TreeViewsMainImpl } from './view/tree-views-main';\nimport { NotificationMainImpl } from './notification-main';\nimport { ConnectionImpl } from '../../common/connection';\nimport { WebviewsMainImpl } from './webviews-main';\nimport { TasksMainImpl } from './tasks-main';\nimport { StorageMainImpl } from './plugin-storage';\nimport { DebugMainImpl } from './debug/debug-main';\nimport { FileSystemMainImpl } from './file-system-main-impl';\nimport { ScmMainImpl } from './scm-main';\nimport { DecorationsMainImpl } from './decorations/decorations-main';\nimport { ClipboardMainImpl } from './clipboard-main';\nimport { DocumentsMainImpl } from './documents-main';\nimport { TextEditorsMainImpl } from './text-editors-main';\nimport { EditorManager } from '@theia/editor/lib/browser';\nimport { EditorModelService } from './text-editor-model-service';\nimport { OpenerService } from '@theia/core/lib/browser/opener-service';\nimport { ApplicationShell } from '@theia/core/lib/browser/shell/application-shell';\nimport { MonacoBulkEditService } from '@theia/monaco/lib/browser/monaco-bulk-edit-service';\nimport { MonacoEditorService } from '@theia/monaco/lib/browser/monaco-editor-service';\nimport { MainFileSystemEventService } from './main-file-system-event-service';\nimport { LabelServiceMainImpl } from './label-service-main';\nimport { TimelineMainImpl } from './timeline-main';\nimport { AuthenticationMainImpl } from './authentication-main';\nimport { ThemingMainImpl } from './theming-main';\nimport { CommentsMainImp } from './comments/comments-main';\nimport { CustomEditorsMainImpl } from './custom-editors/custom-editors-main';\nimport { SecretsMainImpl } from './secrets-main';\nimport { WebviewViewsMainImpl } from './webview-views/webview-views-main';\nimport { MonacoLanguages } from '@theia/monaco/lib/browser/monaco-languages';\nimport { UntitledResourceResolver } from '@theia/core/lib/common/resource';\nimport { ThemeService } from '@theia/core/lib/browser/theming';\nimport { TabsMainImpl } from './tabs/tabs-main';\nimport { NotebooksMainImpl } from './notebooks/notebooks-main';\nimport { NotebookService } from '@theia/notebook/lib/browser';\nimport { LocalizationMainImpl } from './localization-main';\nimport { NotebookRenderersMainImpl } from './notebooks/notebook-renderers-main';\nimport { HostedPluginSupport } from '../../hosted/browser/hosted-plugin';\nimport { NotebookEditorsMainImpl } from './notebooks/notebook-editors-main';\nimport { NotebookDocumentsMainImpl } from './notebooks/notebook-documents-main';\nimport { NotebookKernelsMainImpl } from './notebooks/notebook-kernels-main';\nimport { NotebooksAndEditorsMain } from './notebooks/notebook-documents-and-editors-main';\nimport { TestingMainImpl } from './test-main';\n\nexport function setUpPluginApi(rpc: RPCProtocol, container: interfaces.Container): void {\n    const authenticationMain = new AuthenticationMainImpl(rpc, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.AUTHENTICATION_MAIN, authenticationMain);\n\n    const commandRegistryMain = new CommandRegistryMainImpl(rpc, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.COMMAND_REGISTRY_MAIN, commandRegistryMain);\n\n    const quickOpenMain = new QuickOpenMainImpl(rpc, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.QUICK_OPEN_MAIN, quickOpenMain);\n\n    const workspaceMain = new WorkspaceMainImpl(rpc, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.WORKSPACE_MAIN, workspaceMain);\n\n    const dialogsMain = new DialogsMainImpl(rpc, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.DIALOGS_MAIN, dialogsMain);\n\n    const messageRegistryMain = new MessageRegistryMainImpl(container);\n    rpc.set(PLUGIN_RPC_CONTEXT.MESSAGE_REGISTRY_MAIN, messageRegistryMain);\n\n    const preferenceRegistryMain = new PreferenceRegistryMainImpl(rpc, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.PREFERENCE_REGISTRY_MAIN, preferenceRegistryMain);\n\n    const editorsAndDocuments = new EditorsAndDocumentsMain(rpc, container);\n\n    const modelService = container.get(EditorModelService);\n    const editorManager = container.get(EditorManager);\n    const openerService = container.get<OpenerService>(OpenerService);\n    const shell = container.get(ApplicationShell);\n    const untitledResourceResolver = container.get(UntitledResourceResolver);\n    const languageService = container.get(MonacoLanguages);\n    const documentsMain = new DocumentsMainImpl(editorsAndDocuments, modelService, rpc, editorManager, openerService, shell, untitledResourceResolver, languageService);\n    rpc.set(PLUGIN_RPC_CONTEXT.DOCUMENTS_MAIN, documentsMain);\n\n    const notebookService = container.get(NotebookService);\n    const pluginSupport = container.get(HostedPluginSupport);\n    rpc.set(PLUGIN_RPC_CONTEXT.NOTEBOOKS_MAIN, new NotebooksMainImpl(rpc, notebookService, pluginSupport));\n    rpc.set(PLUGIN_RPC_CONTEXT.NOTEBOOK_RENDERERS_MAIN, new NotebookRenderersMainImpl(rpc, container));\n    const notebookEditorsMain = new NotebookEditorsMainImpl(rpc, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.NOTEBOOK_EDITORS_MAIN, notebookEditorsMain);\n    const notebookDocumentsMain = new NotebookDocumentsMainImpl(rpc, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.NOTEBOOK_DOCUMENTS_MAIN, notebookDocumentsMain);\n    rpc.set(PLUGIN_RPC_CONTEXT.NOTEBOOK_DOCUMENTS_AND_EDITORS_MAIN, new NotebooksAndEditorsMain(rpc, container, notebookDocumentsMain, notebookEditorsMain));\n    rpc.set(PLUGIN_RPC_CONTEXT.NOTEBOOK_KERNELS_MAIN, new NotebookKernelsMainImpl(rpc, container));\n\n    const bulkEditService = container.get(MonacoBulkEditService);\n    const monacoEditorService = container.get(MonacoEditorService);\n    const editorsMain = new TextEditorsMainImpl(editorsAndDocuments, documentsMain, rpc, bulkEditService, monacoEditorService);\n    rpc.set(PLUGIN_RPC_CONTEXT.TEXT_EDITORS_MAIN, editorsMain);\n\n    // start listening only after all clients are subscribed to events\n    editorsAndDocuments.listen();\n\n    const statusBarMessageRegistryMain = new StatusBarMessageRegistryMainImpl(container);\n    rpc.set(PLUGIN_RPC_CONTEXT.STATUS_BAR_MESSAGE_REGISTRY_MAIN, statusBarMessageRegistryMain);\n\n    const envMain = new EnvMainImpl(rpc, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.ENV_MAIN, envMain);\n\n    const notificationMain = new NotificationMainImpl(rpc, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.NOTIFICATION_MAIN, notificationMain);\n\n    const testingMain = new TestingMainImpl(rpc, container, commandRegistryMain);\n    rpc.set(PLUGIN_RPC_CONTEXT.TESTING_MAIN, testingMain);\n\n    const terminalMain = new TerminalServiceMainImpl(rpc, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.TERMINAL_MAIN, terminalMain);\n\n    const treeViewsMain = new TreeViewsMainImpl(rpc, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.TREE_VIEWS_MAIN, treeViewsMain);\n\n    const outputChannelRegistryFactory: OutputChannelRegistryFactory = container.get(OutputChannelRegistryFactory);\n    const outputChannelRegistryMain = outputChannelRegistryFactory();\n    rpc.set(PLUGIN_RPC_CONTEXT.OUTPUT_CHANNEL_REGISTRY_MAIN, outputChannelRegistryMain);\n\n    const languagesMainFactory: LanguagesMainFactory = container.get(LanguagesMainFactory);\n    const languagesMain = languagesMainFactory(rpc);\n    rpc.set(PLUGIN_RPC_CONTEXT.LANGUAGES_MAIN, languagesMain);\n\n    const webviewsMain = new WebviewsMainImpl(rpc, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.WEBVIEWS_MAIN, webviewsMain);\n\n    const customEditorsMain = new CustomEditorsMainImpl(rpc, container, webviewsMain);\n    rpc.set(PLUGIN_RPC_CONTEXT.CUSTOM_EDITORS_MAIN, customEditorsMain);\n\n    const webviewViewsMain = new WebviewViewsMainImpl(rpc, container, webviewsMain);\n    rpc.set(PLUGIN_RPC_CONTEXT.WEBVIEW_VIEWS_MAIN, webviewViewsMain);\n\n    const storageMain = new StorageMainImpl(container);\n    rpc.set(PLUGIN_RPC_CONTEXT.STORAGE_MAIN, storageMain);\n\n    const connectionMain = new ConnectionImpl(rpc.getProxy(MAIN_RPC_CONTEXT.CONNECTION_EXT));\n    rpc.set(PLUGIN_RPC_CONTEXT.CONNECTION_MAIN, connectionMain);\n\n    const tasksMain = new TasksMainImpl(rpc, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.TASKS_MAIN, tasksMain);\n\n    const debugMain = new DebugMainImpl(rpc, connectionMain, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.DEBUG_MAIN, debugMain);\n\n    const fs = new FileSystemMainImpl(rpc, container);\n    const fsEventService = new MainFileSystemEventService(rpc, container);\n    const disposeFS = fs.dispose.bind(fs);\n    fs.dispose = () => {\n        fsEventService.dispose();\n        disposeFS();\n    };\n\n    rpc.set(PLUGIN_RPC_CONTEXT.FILE_SYSTEM_MAIN, fs);\n\n    const scmMain = new ScmMainImpl(rpc, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.SCM_MAIN, scmMain);\n\n    const secretsMain = new SecretsMainImpl(rpc, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.SECRETS_MAIN, secretsMain);\n\n    const decorationsMain = new DecorationsMainImpl(rpc, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.DECORATIONS_MAIN, decorationsMain);\n\n    const windowMain = new WindowStateMain(rpc, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.WINDOW_MAIN, windowMain);\n\n    const clipboardMain = new ClipboardMainImpl(container);\n    rpc.set(PLUGIN_RPC_CONTEXT.CLIPBOARD_MAIN, clipboardMain);\n\n    const labelServiceMain = new LabelServiceMainImpl(container);\n    rpc.set(PLUGIN_RPC_CONTEXT.LABEL_SERVICE_MAIN, labelServiceMain);\n\n    const timelineMain = new TimelineMainImpl(rpc, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.TIMELINE_MAIN, timelineMain);\n\n    const themingMain = new ThemingMainImpl(rpc, container.get(ThemeService));\n    rpc.set(PLUGIN_RPC_CONTEXT.THEMING_MAIN, themingMain);\n\n    const commentsMain = new CommentsMainImp(rpc, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.COMMENTS_MAIN, commentsMain);\n\n    const tabsMain = new TabsMainImpl(rpc, container);\n    rpc.set(PLUGIN_RPC_CONTEXT.TABS_MAIN, tabsMain);\n\n    const localizationMain = new LocalizationMainImpl(container);\n    rpc.set(PLUGIN_RPC_CONTEXT.LOCALIZATION_MAIN, localizationMain);\n}\n","// *****************************************************************************\n// Copyright (C) 2020 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n// based on https://github.com/microsoft/vscode/blob/04c36be045a94fee58e5f8992d3e3fd980294a84/src/vs/workbench/api/browser/mainThreadFileSystemEventService.ts\n\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport { MAIN_RPC_CONTEXT, FileSystemEvents } from '../../common/plugin-api-rpc';\nimport { DisposableCollection } from '@theia/core/lib/common/disposable';\nimport { FileService } from '@theia/filesystem/lib/browser/file-service';\nimport { FileChangeType } from '@theia/filesystem/lib/common/files';\n\nexport class MainFileSystemEventService {\n\n    private readonly toDispose = new DisposableCollection();\n\n    constructor(\n        rpc: RPCProtocol,\n        container: interfaces.Container\n    ) {\n        const proxy = rpc.getProxy(MAIN_RPC_CONTEXT.ExtHostFileSystemEventService);\n        const fileService = container.get(FileService);\n\n        this.toDispose.push(fileService.onDidFilesChange(event => {\n            // file system events - (changes the editor and others make)\n            const events: FileSystemEvents = {\n                created: [],\n                changed: [],\n                deleted: []\n            };\n            for (const change of event.changes) {\n                switch (change.type) {\n                    case FileChangeType.ADDED:\n                        events.created.push(change.resource['codeUri']);\n                        break;\n                    case FileChangeType.UPDATED:\n                        events.changed.push(change.resource['codeUri']);\n                        break;\n                    case FileChangeType.DELETED:\n                        events.deleted.push(change.resource['codeUri']);\n                        break;\n                }\n            }\n\n            proxy.$onFileEvent(events);\n        }));\n\n        // BEFORE file operation\n        fileService.addFileOperationParticipant({\n            participate: (target, source, operation, timeout, token) => proxy.$onWillRunFileOperation(operation, target['codeUri'], source?.['codeUri'], timeout, token)\n        });\n\n        // AFTER file operation\n        this.toDispose.push(fileService.onDidRunUserOperation(e => proxy.$onDidRunFileOperation(e.operation, e.target['codeUri'], e.source?.['codeUri'])));\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport { inject, injectable, optional } from '@theia/core/shared/inversify';\nimport { MenuPath, CommandRegistry, Disposable, DisposableCollection, ActionMenuNode, MenuCommandAdapterRegistry, Emitter, nls } from '@theia/core';\nimport { MenuModelRegistry } from '@theia/core/lib/common';\nimport { TabBarToolbarRegistry } from '@theia/core/lib/browser/shell/tab-bar-toolbar';\nimport { DeployedPlugin, IconUrl, Menu } from '../../../common';\nimport { ScmWidget } from '@theia/scm/lib/browser/scm-widget';\nimport { QuickCommandService } from '@theia/core/lib/browser';\nimport {\n    CodeEditorWidgetUtil, codeToTheiaMappings, ContributionPoint,\n    PLUGIN_EDITOR_TITLE_MENU, PLUGIN_EDITOR_TITLE_RUN_MENU, PLUGIN_SCM_TITLE_MENU, PLUGIN_VIEW_TITLE_MENU\n} from './vscode-theia-menu-mappings';\nimport { PluginMenuCommandAdapter, ReferenceCountingSet } from './plugin-menu-command-adapter';\nimport { ContextKeyExpr } from '@theia/monaco-editor-core/esm/vs/platform/contextkey/common/contextkey';\nimport { ContextKeyService } from '@theia/core/lib/browser/context-key-service';\nimport { PluginSharedStyle } from '../plugin-shared-style';\nimport { ThemeIcon } from '@theia/monaco-editor-core/esm/vs/platform/theme/common/themeService';\n\n@injectable()\nexport class MenusContributionPointHandler {\n\n    @inject(MenuModelRegistry) private readonly menuRegistry: MenuModelRegistry;\n    @inject(CommandRegistry) private readonly commands: CommandRegistry;\n    @inject(TabBarToolbarRegistry) private readonly tabBarToolbar: TabBarToolbarRegistry;\n    @inject(CodeEditorWidgetUtil) private readonly codeEditorWidgetUtil: CodeEditorWidgetUtil;\n    @inject(PluginMenuCommandAdapter) protected readonly commandAdapter: PluginMenuCommandAdapter;\n    @inject(MenuCommandAdapterRegistry) protected readonly commandAdapterRegistry: MenuCommandAdapterRegistry;\n    @inject(ContextKeyService) protected readonly contextKeyService: ContextKeyService;\n    @inject(PluginSharedStyle) protected readonly style: PluginSharedStyle;\n    @inject(QuickCommandService) @optional()\n    private readonly quickCommandService: QuickCommandService;\n\n    protected readonly titleContributionContextKeys = new ReferenceCountingSet();\n    protected readonly onDidChangeTitleContributionEmitter = new Emitter<void>();\n\n    private initialized = false;\n    private initialize(): void {\n        this.initialized = true;\n        this.commandAdapterRegistry.registerAdapter(this.commandAdapter);\n        this.tabBarToolbar.registerMenuDelegate(PLUGIN_EDITOR_TITLE_MENU, widget => this.codeEditorWidgetUtil.is(widget));\n        this.tabBarToolbar.registerItem({\n            id: this.tabBarToolbar.toElementId(PLUGIN_EDITOR_TITLE_RUN_MENU), menuPath: PLUGIN_EDITOR_TITLE_RUN_MENU,\n            icon: 'debug-alt', text: nls.localizeByDefault('Run or Debug...'),\n            command: '', group: 'navigation', isVisible: widget => this.codeEditorWidgetUtil.is(widget)\n        });\n        this.tabBarToolbar.registerMenuDelegate(PLUGIN_SCM_TITLE_MENU, widget => widget instanceof ScmWidget);\n        this.tabBarToolbar.registerMenuDelegate(PLUGIN_VIEW_TITLE_MENU, widget => !this.codeEditorWidgetUtil.is(widget));\n        this.tabBarToolbar.registerItem({ id: 'plugin-menu-contribution-title-contribution', command: '_never_', onDidChange: this.onDidChangeTitleContributionEmitter.event });\n        this.contextKeyService.onDidChange(event => {\n            if (event.affects(this.titleContributionContextKeys)) {\n                this.onDidChangeTitleContributionEmitter.fire();\n            }\n        });\n    }\n\n    private getMatchingMenu(contributionPoint: ContributionPoint): MenuPath[] | undefined {\n        return codeToTheiaMappings.get(contributionPoint);\n    }\n\n    handle(plugin: DeployedPlugin): Disposable {\n        const allMenus = plugin.contributes?.menus;\n        if (!allMenus) {\n            return Disposable.NULL;\n        }\n        if (!this.initialized) {\n            this.initialize();\n        }\n        const toDispose = new DisposableCollection();\n        const submenus = plugin.contributes?.submenus ?? [];\n        for (const submenu of submenus) {\n            const iconClass = submenu.icon && this.toIconClass(submenu.icon, toDispose);\n            this.menuRegistry.registerIndependentSubmenu(submenu.id, submenu.label, iconClass ? { iconClass } : undefined);\n        }\n\n        for (const [contributionPoint, items] of Object.entries(allMenus)) {\n            for (const item of items) {\n                try {\n                    if (contributionPoint === 'commandPalette') {\n                        toDispose.push(this.registerCommandPaletteAction(item));\n                    } else {\n                        this.checkTitleContribution(contributionPoint, item, toDispose);\n                        const targets = this.getMatchingMenu(contributionPoint as ContributionPoint) ?? [contributionPoint];\n                        const { group, order } = this.parseGroup(item.group);\n                        const { submenu, command } = item;\n                        if (submenu) {\n                            targets.forEach(target => toDispose.push(this.menuRegistry.linkSubmenu(target, submenu!, { order, when: item.when }, group)));\n                        } else if (command) {\n                            toDispose.push(this.commandAdapter.addCommand(command));\n                            targets.forEach(target => {\n                                const node = new ActionMenuNode({\n                                    commandId: command,\n                                    when: item.when,\n                                    order,\n                                }, this.commands);\n                                const parent = this.menuRegistry.getMenuNode(target, group);\n                                toDispose.push(parent.addNode(node));\n                            });\n                        }\n                    }\n                } catch (error) {\n                    console.warn(`Failed to register a menu item for plugin ${plugin.metadata.model.id} contributed to ${contributionPoint}`, item, error);\n                }\n            }\n        }\n\n        return toDispose;\n    }\n\n    private parseGroup(rawGroup?: string): { group?: string, order?: string } {\n        if (!rawGroup) { return {}; }\n        const separatorIndex = rawGroup.lastIndexOf('@');\n        if (separatorIndex > -1) {\n            return { group: rawGroup.substring(0, separatorIndex), order: rawGroup.substring(separatorIndex + 1) || undefined };\n        }\n        return { group: rawGroup };\n    }\n\n    private registerCommandPaletteAction(menu: Menu): Disposable {\n        if (menu.command && menu.when) {\n            return this.quickCommandService.pushCommandContext(menu.command, menu.when);\n        }\n        return Disposable.NULL;\n    }\n\n    protected checkTitleContribution(contributionPoint: ContributionPoint | string, contribution: { when?: string }, toDispose: DisposableCollection): void {\n        if (contribution.when && contributionPoint.endsWith('title')) {\n            const expression = ContextKeyExpr.deserialize(contribution.when);\n            if (expression) {\n                for (const key of expression.keys()) {\n                    this.titleContributionContextKeys.add(key);\n                    toDispose.push(Disposable.create(() => this.titleContributionContextKeys.delete(key)));\n                }\n                toDispose.push(Disposable.create(() => this.onDidChangeTitleContributionEmitter.fire()));\n            }\n        }\n    }\n\n    protected toIconClass(url: IconUrl, toDispose: DisposableCollection): string | undefined {\n        if (typeof url === 'string') {\n            const asThemeIcon = ThemeIcon.fromString(url);\n            if (asThemeIcon) {\n                return ThemeIcon.asClassName(asThemeIcon);\n            }\n        }\n        const reference = this.style.toIconClass(url);\n        toDispose.push(reference);\n        return reference.object.iconClass;\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2022 Ericsson and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { CommandRegistry, Disposable, MenuCommandAdapter, MenuPath, SelectionService, UriSelection } from '@theia/core';\nimport { ResourceContextKey } from '@theia/core/lib/browser/resource-context-key';\nimport { inject, injectable, postConstruct } from '@theia/core/shared/inversify';\nimport { URI as CodeUri } from '@theia/core/shared/vscode-uri';\nimport { TreeWidgetSelection } from '@theia/core/lib/browser/tree/tree-widget-selection';\nimport { ScmRepository } from '@theia/scm/lib/browser/scm-repository';\nimport { ScmService } from '@theia/scm/lib/browser/scm-service';\nimport { TimelineItem } from '@theia/timeline/lib/common/timeline-model';\nimport { ScmCommandArg, TimelineCommandArg, TreeViewItemReference } from '../../../common';\nimport { PluginScmProvider, PluginScmResource, PluginScmResourceGroup } from '../scm-main';\nimport { TreeViewWidget } from '../view/tree-view-widget';\nimport { CodeEditorWidgetUtil, codeToTheiaMappings, ContributionPoint } from './vscode-theia-menu-mappings';\nimport { TAB_BAR_TOOLBAR_CONTEXT_MENU } from '@theia/core/lib/browser/shell/tab-bar-toolbar';\n\nexport type ArgumentAdapter = (...args: unknown[]) => unknown[];\n\nexport class ReferenceCountingSet<T> {\n    protected readonly references: Map<T, number>;\n    constructor(initialMembers?: Iterable<T>) {\n        this.references = new Map();\n        if (initialMembers) {\n            for (const member of initialMembers) {\n                this.add(member);\n            }\n        }\n    }\n\n    add(newMember: T): ReferenceCountingSet<T> {\n        const value = this.references.get(newMember) ?? 0;\n        this.references.set(newMember, value + 1);\n        return this;\n    }\n\n    /** @returns true if the deletion results in the removal of the element from the set */\n    delete(member: T): boolean {\n        const value = this.references.get(member);\n        if (value === undefined) { } else if (value <= 1) {\n            this.references.delete(member);\n            return true;\n        } else {\n            this.references.set(member, value - 1);\n        }\n        return false;\n    }\n\n    has(maybeMember: T): boolean {\n        return this.references.has(maybeMember);\n    }\n}\n\n@injectable()\nexport class PluginMenuCommandAdapter implements MenuCommandAdapter {\n    @inject(CommandRegistry) protected readonly commandRegistry: CommandRegistry;\n    @inject(CodeEditorWidgetUtil) protected readonly codeEditorUtil: CodeEditorWidgetUtil;\n    @inject(ScmService) protected readonly scmService: ScmService;\n    @inject(SelectionService) protected readonly selectionService: SelectionService;\n    @inject(ResourceContextKey) protected readonly resourceContextKey: ResourceContextKey;\n\n    protected readonly commands = new ReferenceCountingSet<string>();\n    protected readonly argumentAdapters = new Map<string, ArgumentAdapter>();\n    protected readonly separator = ':)(:';\n\n    @postConstruct()\n    protected init(): void {\n        const toCommentArgs: ArgumentAdapter = (...args) => this.toCommentArgs(...args);\n        const firstArgOnly: ArgumentAdapter = (...args) => [args[0]];\n        const noArgs: ArgumentAdapter = () => [];\n        const toScmArgs: ArgumentAdapter = (...args) => this.toScmArgs(...args);\n        const selectedResource = () => this.getSelectedResources();\n        const widgetURI: ArgumentAdapter = widget => this.codeEditorUtil.is(widget) ? [this.codeEditorUtil.getResourceUri(widget)] : [];\n        (<Array<[ContributionPoint, ArgumentAdapter | undefined]>>[\n            ['comments/comment/context', toCommentArgs],\n            ['comments/comment/title', toCommentArgs],\n            ['comments/commentThread/context', toCommentArgs],\n            ['debug/callstack/context', firstArgOnly],\n            ['debug/variables/context', firstArgOnly],\n            ['debug/toolBar', noArgs],\n            ['editor/context', selectedResource],\n            ['editor/title', widgetURI],\n            ['editor/title/context', selectedResource],\n            ['editor/title/run', widgetURI],\n            ['explorer/context', selectedResource],\n            ['scm/resourceFolder/context', toScmArgs],\n            ['scm/resourceGroup/context', toScmArgs],\n            ['scm/resourceState/context', toScmArgs],\n            ['scm/title', () => [this.toScmArg(this.scmService.selectedRepository)]],\n            ['timeline/item/context', (...args) => this.toTimelineArgs(...args)],\n            ['view/item/context', (...args) => this.toTreeArgs(...args)],\n            ['view/title', noArgs],\n        ]).forEach(([contributionPoint, adapter]) => {\n            if (adapter) {\n                const paths = codeToTheiaMappings.get(contributionPoint);\n                if (paths) {\n                    paths.forEach(path => this.addArgumentAdapter(path, adapter));\n                }\n            }\n        });\n        this.addArgumentAdapter(TAB_BAR_TOOLBAR_CONTEXT_MENU, widgetURI);\n    }\n\n    canHandle(menuPath: MenuPath, command: string, ...commandArgs: unknown[]): number {\n        if (this.commands.has(command) && this.getArgumentAdapterForMenu(menuPath)) {\n            return 500;\n        }\n        return -1;\n    }\n\n    executeCommand(menuPath: MenuPath, command: string, ...commandArgs: unknown[]): Promise<unknown> {\n        const argumentAdapter = this.getAdapterOrThrow(menuPath);\n        return this.commandRegistry.executeCommand(command, ...argumentAdapter(...commandArgs));\n    }\n\n    isVisible(menuPath: MenuPath, command: string, ...commandArgs: unknown[]): boolean {\n        const argumentAdapter = this.getAdapterOrThrow(menuPath);\n        return this.commandRegistry.isVisible(command, ...argumentAdapter(...commandArgs));\n    }\n\n    isEnabled(menuPath: MenuPath, command: string, ...commandArgs: unknown[]): boolean {\n        const argumentAdapter = this.getAdapterOrThrow(menuPath);\n        return this.commandRegistry.isEnabled(command, ...argumentAdapter(...commandArgs));\n    }\n\n    isToggled(menuPath: MenuPath, command: string, ...commandArgs: unknown[]): boolean {\n        const argumentAdapter = this.getAdapterOrThrow(menuPath);\n        return this.commandRegistry.isToggled(command, ...argumentAdapter(...commandArgs));\n    }\n\n    protected getAdapterOrThrow(menuPath: MenuPath): ArgumentAdapter {\n        const argumentAdapter = this.getArgumentAdapterForMenu(menuPath);\n        if (!argumentAdapter) {\n            throw new Error('PluginMenuCommandAdapter attempted to execute command for unregistered menu: ' + JSON.stringify(menuPath));\n        }\n        return argumentAdapter;\n    }\n\n    addCommand(commandId: string): Disposable {\n        this.commands.add(commandId);\n        return Disposable.create(() => this.commands.delete(commandId));\n    }\n\n    protected getArgumentAdapterForMenu(menuPath: MenuPath): ArgumentAdapter | undefined {\n        return this.argumentAdapters.get(menuPath.join(this.separator));\n    }\n\n    protected addArgumentAdapter(menuPath: MenuPath, adapter: ArgumentAdapter): void {\n        this.argumentAdapters.set(menuPath.join(this.separator), adapter);\n    }\n\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n\n    protected toCommentArgs(...args: any[]): any[] {\n        const arg = args[0];\n        if ('text' in arg) {\n            if ('commentUniqueId' in arg) {\n                return [{\n                    commentControlHandle: arg.thread.controllerHandle,\n                    commentThreadHandle: arg.thread.commentThreadHandle,\n                    text: arg.text,\n                    commentUniqueId: arg.commentUniqueId\n                }];\n            }\n            return [{\n                commentControlHandle: arg.thread.controllerHandle,\n                commentThreadHandle: arg.thread.commentThreadHandle,\n                text: arg.text\n            }];\n        }\n        return [{\n            commentControlHandle: arg.thread.controllerHandle,\n            commentThreadHandle: arg.thread.commentThreadHandle,\n            commentUniqueId: arg.commentUniqueId\n        }];\n    }\n\n    protected toScmArgs(...args: any[]): any[] {\n        const scmArgs: any[] = [];\n        for (const arg of args) {\n            const scmArg = this.toScmArg(arg);\n            if (scmArg) {\n                scmArgs.push(scmArg);\n            }\n        }\n        return scmArgs;\n    }\n\n    protected toScmArg(arg: any): ScmCommandArg | undefined {\n        if (arg instanceof ScmRepository && arg.provider instanceof PluginScmProvider) {\n            return {\n                sourceControlHandle: arg.provider.handle\n            };\n        }\n        if (arg instanceof PluginScmResourceGroup) {\n            return {\n                sourceControlHandle: arg.provider.handle,\n                resourceGroupHandle: arg.handle\n            };\n        }\n        if (arg instanceof PluginScmResource) {\n            return {\n                sourceControlHandle: arg.group.provider.handle,\n                resourceGroupHandle: arg.group.handle,\n                resourceStateHandle: arg.handle\n            };\n        }\n    }\n\n    protected toTimelineArgs(...args: any[]): any[] {\n        const timelineArgs: any[] = [];\n        const arg = args[0];\n        timelineArgs.push(this.toTimelineArg(arg));\n        timelineArgs.push(CodeUri.parse(arg.uri));\n        timelineArgs.push(arg.source ?? '');\n        return timelineArgs;\n    }\n\n    protected toTimelineArg(arg: TimelineItem): TimelineCommandArg {\n        return {\n            timelineHandle: arg.handle,\n            source: arg.source,\n            uri: arg.uri\n        };\n    }\n\n    protected toTreeArgs(...args: any[]): any[] {\n        const treeArgs: any[] = [];\n        for (const arg of args) {\n            if (TreeViewItemReference.is(arg)) {\n                treeArgs.push(arg);\n            } else if (Array.isArray(arg)) {\n                treeArgs.push(arg.filter(TreeViewItemReference.is));\n            }\n        }\n        return treeArgs;\n    }\n\n    protected getSelectedResources(): [CodeUri | TreeViewItemReference | undefined, CodeUri[] | undefined] {\n        const selection = this.selectionService.selection;\n        const resourceKey = this.resourceContextKey.get();\n        const resourceUri = resourceKey ? CodeUri.parse(resourceKey) : undefined;\n        const firstMember = TreeWidgetSelection.is(selection) && selection.source instanceof TreeViewWidget && selection[0]\n            ? selection.source.toTreeViewItemReference(selection[0])\n            : UriSelection.getUri(selection)?.['codeUri'] ?? resourceUri;\n        const secondMember = TreeWidgetSelection.is(selection)\n            ? UriSelection.getUris(selection).map(uri => uri['codeUri'])\n            : undefined;\n        return [firstMember, secondMember];\n    }\n    /* eslint-enable @typescript-eslint/no-explicit-any */\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { MessageService } from '@theia/core/lib/common/message-service';\nimport { MessageRegistryMain, MainMessageType, MainMessageOptions, MainMessageItem } from '../../common/plugin-api-rpc';\nimport { ModalNotification, MessageType } from './dialogs/modal-notification';\n\nexport class MessageRegistryMainImpl implements MessageRegistryMain {\n    private readonly messageService: MessageService;\n\n    constructor(container: interfaces.Container) {\n        this.messageService = container.get(MessageService);\n    }\n\n    async $showMessage(type: MainMessageType, message: string, options: MainMessageOptions, actions: MainMessageItem[]): Promise<number | undefined> {\n        const action = await this.doShowMessage(type, message, options, actions);\n        const handle = action\n            ? actions.map(a => a.title).indexOf(action)\n            : undefined;\n        return handle === undefined && options.modal ? options.onCloseActionHandle : handle;\n    }\n\n    protected async doShowMessage(type: MainMessageType, message: string, options: MainMessageOptions, actions: MainMessageItem[]): Promise<string | undefined> {\n        if (options.modal) {\n            const messageType = type === MainMessageType.Error ? MessageType.Error :\n                type === MainMessageType.Warning ? MessageType.Warning :\n                    MessageType.Info;\n            const modalNotification = new ModalNotification();\n            return modalNotification.showDialog(messageType, message, options, actions);\n        }\n        switch (type) {\n            case MainMessageType.Info:\n                return this.messageService.info(message, ...actions.map(a => a.title));\n            case MainMessageType.Warning:\n                return this.messageService.warn(message, ...actions.map(a => a.title));\n            case MainMessageType.Error:\n                return this.messageService.error(message, ...actions.map(a => a.title));\n        }\n        throw new Error(`Message type '${type}' is not supported yet!`);\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable, DisposableCollection } from '@theia/core';\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { UriComponents } from '@theia/core/lib/common/uri';\nimport { NotebookEditorWidget, NotebookService, NotebookEditorWidgetService } from '@theia/notebook/lib/browser';\nimport { NotebookModel } from '@theia/notebook/lib/browser/view-model/notebook-model';\nimport { MAIN_RPC_CONTEXT, NotebookDocumentsAndEditorsDelta, NotebookDocumentsAndEditorsMain, NotebookModelAddedData, NotebooksExt } from '../../../common';\nimport { RPCProtocol } from '../../../common/rpc-protocol';\nimport { NotebookDto } from './notebook-dto';\nimport { WidgetManager } from '@theia/core/lib/browser';\nimport { NotebookEditorsMainImpl } from './notebook-editors-main';\nimport { NotebookDocumentsMainImpl } from './notebook-documents-main';\nimport { diffMaps, diffSets } from '../../../common/collections';\nimport { Mutex } from 'async-mutex';\n\ninterface NotebookAndEditorDelta {\n    removedDocuments: UriComponents[];\n    addedDocuments: NotebookModel[];\n    removedEditors: string[];\n    addedEditors: NotebookEditorWidget[];\n    newActiveEditor?: string | null;\n    visibleEditors?: string[];\n}\n\nclass NotebookAndEditorState {\n    static delta(before: NotebookAndEditorState | undefined, after: NotebookAndEditorState): NotebookAndEditorDelta {\n        if (!before) {\n            return {\n                addedDocuments: [...after.documents],\n                removedDocuments: [],\n                addedEditors: [...after.textEditors.values()],\n                removedEditors: [],\n                visibleEditors: [...after.visibleEditors].map(editor => editor[0])\n            };\n        }\n        const documentDelta = diffSets(before.documents, after.documents);\n        const editorDelta = diffMaps(before.textEditors, after.textEditors);\n\n        const newActiveEditor = before.activeEditor !== after.activeEditor ? after.activeEditor : undefined;\n        const visibleEditorDelta = diffMaps(before.visibleEditors, after.visibleEditors);\n\n        return {\n            addedDocuments: documentDelta.added,\n            removedDocuments: documentDelta.removed.map(e => e.uri.toComponents()),\n            addedEditors: editorDelta.added,\n            removedEditors: editorDelta.removed.map(removed => removed.id),\n            newActiveEditor: newActiveEditor,\n            visibleEditors: visibleEditorDelta.added.length === 0 && visibleEditorDelta.removed.length === 0\n                ? undefined\n                : [...after.visibleEditors].map(editor => editor[0])\n        };\n    }\n\n    constructor(\n        readonly documents: Set<NotebookModel>,\n        readonly textEditors: Map<string, NotebookEditorWidget>,\n        readonly activeEditor: string | null | undefined,\n        readonly visibleEditors: Map<string, NotebookEditorWidget>\n    ) {\n        //\n    }\n}\n\nexport class NotebooksAndEditorsMain implements NotebookDocumentsAndEditorsMain {\n\n    protected readonly proxy: NotebooksExt;\n    protected readonly disposables = new DisposableCollection();\n\n    protected readonly editorListeners = new Map<string, Disposable[]>();\n\n    protected currentState?: NotebookAndEditorState;\n    protected readonly updateMutex = new Mutex();\n\n    protected readonly notebookService: NotebookService;\n    protected readonly notebookEditorService: NotebookEditorWidgetService;\n    protected readonly WidgetManager: WidgetManager;\n\n    constructor(\n        rpc: RPCProtocol,\n        container: interfaces.Container,\n        protected readonly notebookDocumentsMain: NotebookDocumentsMainImpl,\n        protected readonly notebookEditorsMain: NotebookEditorsMainImpl\n    ) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.NOTEBOOKS_EXT);\n\n        this.notebookService = container.get(NotebookService);\n        this.notebookEditorService = container.get(NotebookEditorWidgetService);\n        this.WidgetManager = container.get(WidgetManager);\n\n        this.notebookService.onDidAddNotebookDocument(async () => this.updateState(), this, this.disposables);\n        this.notebookService.onDidRemoveNotebookDocument(async () => this.updateState(), this, this.disposables);\n        // this.WidgetManager.onActiveEditorChanged(() => this.updateState(), this, this.disposables);\n        this.notebookEditorService.onDidAddNotebookEditor(async editor => this.handleEditorAdd(editor), this, this.disposables);\n        this.notebookEditorService.onDidRemoveNotebookEditor(async editor => this.handleEditorRemove(editor), this, this.disposables);\n        this.notebookEditorService.onDidChangeFocusedEditor(async editor => this.updateState(editor), this, this.disposables);\n    }\n\n    dispose(): void {\n        this.notebookDocumentsMain.dispose();\n        this.notebookEditorsMain.dispose();\n        this.disposables.dispose();\n        this.editorListeners.forEach(listeners => listeners.forEach(listener => listener.dispose()));\n    }\n\n    private async handleEditorAdd(editor: NotebookEditorWidget): Promise<void> {\n        const listeners = this.editorListeners.get(editor.id);\n        const disposable = editor.onDidChangeModel(() => this.updateState());\n        if (listeners) {\n            listeners.push(disposable);\n        } else {\n            this.editorListeners.set(editor.id, [disposable]);\n        }\n        await this.updateState();\n    }\n\n    private handleEditorRemove(editor: NotebookEditorWidget): void {\n        const listeners = this.editorListeners.get(editor.id);\n        listeners?.forEach(listener => listener.dispose());\n        this.editorListeners.delete(editor.id);\n        this.updateState();\n    }\n\n    private async updateState(focusedEditor?: NotebookEditorWidget): Promise<void> {\n        await this.updateMutex.runExclusive(async () => this.doUpdateState(focusedEditor));\n    }\n\n    private async doUpdateState(focusedEditor?: NotebookEditorWidget): Promise<void> {\n\n        const editors = new Map<string, NotebookEditorWidget>();\n        const visibleEditorsMap = new Map<string, NotebookEditorWidget>();\n\n        for (const editor of this.notebookEditorService.listNotebookEditors()) {\n            if (editor.model) {\n                editors.set(editor.id, editor);\n            }\n        }\n\n        const activeNotebookEditor = this.notebookEditorService.focusedEditor;\n        let activeEditor: string | null = null;\n        if (activeNotebookEditor) {\n            activeEditor = activeNotebookEditor.id;\n        } else if (focusedEditor?.model) {\n            activeEditor = focusedEditor.id;\n        }\n        if (activeEditor && !editors.has(activeEditor)) {\n            activeEditor = null;\n        }\n\n        const notebookEditors = this.WidgetManager.getWidgets(NotebookEditorWidget.ID) as NotebookEditorWidget[];\n        for (const notebookEditor of notebookEditors) {\n            if (notebookEditor?.model && editors.has(notebookEditor.id) && notebookEditor.isVisible) {\n                visibleEditorsMap.set(notebookEditor.id, notebookEditor);\n            }\n        }\n\n        const newState = new NotebookAndEditorState(\n            new Set(this.notebookService.listNotebookDocuments()),\n            editors,\n            activeEditor, visibleEditorsMap);\n        await this.onDelta(NotebookAndEditorState.delta(this.currentState, newState));\n        this.currentState = newState;\n    }\n\n    private async onDelta(delta: NotebookAndEditorDelta): Promise<void> {\n        if (NotebooksAndEditorsMain._isDeltaEmpty(delta)) {\n            return;\n        }\n\n        const dto: NotebookDocumentsAndEditorsDelta = {\n            removedDocuments: delta.removedDocuments,\n            removedEditors: delta.removedEditors,\n            newActiveEditor: delta.newActiveEditor,\n            visibleEditors: delta.visibleEditors,\n            addedDocuments: delta.addedDocuments.map(NotebooksAndEditorsMain.asModelAddData),\n            // addedEditors: delta.addedEditors.map(this.asEditorAddData, this),\n        };\n\n        // send to extension FIRST\n        await this.proxy.$acceptDocumentsAndEditorsDelta(dto);\n\n        // handle internally\n        this.notebookEditorsMain.handleEditorsRemoved(delta.removedEditors);\n        this.notebookDocumentsMain.handleNotebooksRemoved(delta.removedDocuments);\n        this.notebookDocumentsMain.handleNotebooksAdded(delta.addedDocuments);\n        this.notebookEditorsMain.handleEditorsAdded(delta.addedEditors);\n    }\n\n    private static _isDeltaEmpty(delta: NotebookAndEditorDelta): boolean {\n        if (delta.addedDocuments !== undefined && delta.addedDocuments.length > 0) {\n            return false;\n        }\n        if (delta.removedDocuments !== undefined && delta.removedDocuments.length > 0) {\n            return false;\n        }\n        if (delta.addedEditors !== undefined && delta.addedEditors.length > 0) {\n            return false;\n        }\n        if (delta.removedEditors !== undefined && delta.removedEditors.length > 0) {\n            return false;\n        }\n        if (delta.visibleEditors !== undefined && delta.visibleEditors.length > 0) {\n            return false;\n        }\n        if (delta.newActiveEditor !== undefined) {\n            return false;\n        }\n        return true;\n    }\n\n    private static asModelAddData(e: NotebookModel): NotebookModelAddedData {\n        return {\n            viewType: e.viewType,\n            uri: e.uri.toComponents(),\n            metadata: e.metadata,\n            versionId: 1, // TODO implement versionID support\n            cells: e.cells.map(NotebookDto.toNotebookCellDto)\n        };\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { DisposableCollection } from '@theia/core';\nimport { URI, UriComponents } from '@theia/core/lib/common/uri';\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { NotebookModelResolverService } from '@theia/notebook/lib/browser';\nimport { NotebookModel } from '@theia/notebook/lib/browser/view-model/notebook-model';\nimport { NotebookCellsChangeType } from '@theia/notebook/lib/common';\nimport { MAIN_RPC_CONTEXT, NotebookCellDto, NotebookCellsChangedEventDto, NotebookDataDto, NotebookDocumentsExt, NotebookDocumentsMain } from '../../../common';\nimport { RPCProtocol } from '../../../common/rpc-protocol';\nimport { NotebookDto } from './notebook-dto';\n\nexport class NotebookDocumentsMainImpl implements NotebookDocumentsMain {\n\n    private readonly disposables = new DisposableCollection();\n\n    private readonly proxy: NotebookDocumentsExt;\n    private readonly documentEventListenersMapping = new Map<string, DisposableCollection>();\n\n    private readonly notebookModelResolverService: NotebookModelResolverService;\n\n    constructor(\n        rpc: RPCProtocol,\n        container: interfaces.Container\n    ) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.NOTEBOOK_DOCUMENTS_EXT);\n        this.notebookModelResolverService = container.get(NotebookModelResolverService);\n\n        // forward dirty and save events\n        this.disposables.push(this.notebookModelResolverService.onDidChangeDirty(model => this.proxy.$acceptDirtyStateChanged(model.uri.toComponents(), model.isDirty())));\n        this.disposables.push(this.notebookModelResolverService.onDidSaveNotebook(e => this.proxy.$acceptModelSaved(e)));\n\n    }\n\n    dispose(): void {\n        this.disposables.dispose();\n        // this.modelReferenceCollection.dispose();\n        this.documentEventListenersMapping.forEach(value => value.dispose());\n    }\n\n    handleNotebooksAdded(notebooks: readonly NotebookModel[]): void {\n\n        for (const textModel of notebooks) {\n            const disposableStore = new DisposableCollection();\n            disposableStore.push(textModel.onDidChangeContent(event => {\n\n                const eventDto: NotebookCellsChangedEventDto = {\n                    versionId: 1, // TODO implement version ID support\n                    rawEvents: []\n                };\n\n                for (const e of event.rawEvents) {\n\n                    switch (e.kind) {\n                        case NotebookCellsChangeType.ModelChange:\n                            eventDto.rawEvents.push({\n                                kind: e.kind,\n                                changes: e.changes.map(diff =>\n                                    [diff[0], diff[1], diff[2].map(NotebookDto.toNotebookCellDto)] as [number, number, NotebookCellDto[]])\n                            });\n                            break;\n                        case NotebookCellsChangeType.Move:\n                            eventDto.rawEvents.push({\n                                kind: e.kind,\n                                index: e.index,\n                                length: e.length,\n                                newIdx: e.newIdx,\n                            });\n                            break;\n                        case NotebookCellsChangeType.Output:\n                            eventDto.rawEvents.push({\n                                kind: e.kind,\n                                index: e.index,\n                                outputs: e.outputs.map(NotebookDto.toNotebookOutputDto)\n                            });\n                            break;\n                        case NotebookCellsChangeType.OutputItem:\n                            eventDto.rawEvents.push({\n                                kind: e.kind,\n                                index: e.index,\n                                outputId: e.outputId,\n                                outputItems: e.outputItems.map(NotebookDto.toNotebookOutputItemDto),\n                                append: e.append\n                            });\n                            break;\n                        case NotebookCellsChangeType.ChangeCellLanguage:\n                        case NotebookCellsChangeType.ChangeCellContent:\n                        case NotebookCellsChangeType.ChangeCellMetadata:\n                        case NotebookCellsChangeType.ChangeCellInternalMetadata:\n                            eventDto.rawEvents.push(e);\n                            break;\n                    }\n                }\n\n                const hasDocumentMetadataChangeEvent = event.rawEvents.find(e => e.kind === NotebookCellsChangeType.ChangeDocumentMetadata);\n\n                // using the model resolver service to know if the model is dirty or not.\n                // assuming this is the first listener it can mean that at first the model\n                // is marked as dirty and that another event is fired\n                this.proxy.$acceptModelChanged(\n                    textModel.uri.toComponents(),\n                    eventDto,\n                    textModel.isDirty(),\n                    hasDocumentMetadataChangeEvent ? textModel.metadata : undefined\n                );\n            }));\n\n            this.documentEventListenersMapping.set(textModel.uri.toString(), disposableStore);\n        }\n    }\n\n    handleNotebooksRemoved(uris: UriComponents[]): void {\n        for (const uri of uris) {\n            this.documentEventListenersMapping.get(uri.toString())?.dispose();\n            this.documentEventListenersMapping.delete(uri.toString());\n        }\n    }\n\n    async $tryCreateNotebook(options: { viewType: string; content?: NotebookDataDto }): Promise<UriComponents> {\n        const ref = await this.notebookModelResolverService.resolveUntitledResource({ untitledResource: undefined }, options.viewType);\n\n        // untitled notebooks are disposed when they get saved. we should not hold a reference\n        // to such a disposed notebook and therefore dispose the reference as well\n        // ref.onWillDispose(() => {\n        //     ref.dispose();\n        // });\n\n        // untitled notebooks are dirty by default\n        this.proxy.$acceptDirtyStateChanged(ref.uri.toComponents(), true);\n\n        // apply content changes... slightly HACKY -> this triggers a change event\n        // if (options.content) {\n        //     const data = NotebookDto.fromNotebookDataDto(options.content);\n        //     ref.notebook.reset(data.cells, data.metadata, ref.object.notebook.transientOptions);\n        // }\n        return ref.uri.toComponents();\n    }\n\n    async $tryOpenNotebook(uriComponents: UriComponents): Promise<UriComponents> {\n        const uri = URI.fromComponents(uriComponents);\n        return uri.toComponents();\n    }\n\n    async $trySaveNotebook(uriComponents: UriComponents): Promise<boolean> {\n        const uri = URI.fromComponents(uriComponents);\n\n        const ref = await this.notebookModelResolverService.resolve(uri);\n        await ref.save({});\n        ref.dispose();\n        return true;\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { OS } from '@theia/core';\nimport * as notebookCommon from '@theia/notebook/lib/common';\nimport { NotebookCellModel } from '@theia/notebook/lib/browser/view-model/notebook-cell-model';\nimport * as rpc from '../../../common';\n\nexport namespace NotebookDto {\n\n    export function toNotebookOutputItemDto(item: notebookCommon.CellOutputItem): rpc.NotebookOutputItemDto {\n        return {\n            mime: item.mime,\n            valueBytes: item.data\n        };\n    }\n\n    export function toNotebookOutputDto(output: notebookCommon.CellOutput): rpc.NotebookOutputDto {\n        return {\n            outputId: output.outputId,\n            metadata: output.metadata,\n            items: output.outputs.map(toNotebookOutputItemDto)\n        };\n    }\n\n    export function toNotebookCellDataDto(cell: notebookCommon.CellData): rpc.NotebookCellDataDto {\n        return {\n            cellKind: cell.cellKind,\n            language: cell.language,\n            source: cell.source,\n            internalMetadata: cell.internalMetadata,\n            metadata: cell.metadata,\n            outputs: cell.outputs.map(toNotebookOutputDto)\n        };\n    }\n\n    export function toNotebookDataDto(data: notebookCommon.NotebookData): rpc.NotebookDataDto {\n        return {\n            metadata: data.metadata,\n            cells: data.cells.map(toNotebookCellDataDto)\n        };\n    }\n\n    export function fromNotebookOutputItemDto(item: rpc.NotebookOutputItemDto): notebookCommon.CellOutputItem {\n        return {\n            mime: item.mime,\n            data: item.valueBytes\n        };\n    }\n\n    export function fromNotebookOutputDto(output: rpc.NotebookOutputDto): notebookCommon.CellOutput {\n        return {\n            outputId: output.outputId,\n            metadata: output.metadata,\n            outputs: output.items.map(fromNotebookOutputItemDto)\n        };\n    }\n\n    export function fromNotebookCellDataDto(cell: rpc.NotebookCellDataDto): notebookCommon.CellData {\n        return {\n            cellKind: cell.cellKind,\n            language: cell.language,\n            source: cell.source,\n            outputs: cell.outputs.map(fromNotebookOutputDto),\n            metadata: cell.metadata,\n            internalMetadata: cell.internalMetadata\n        };\n    }\n\n    export function fromNotebookDataDto(data: rpc.NotebookDataDto): notebookCommon.NotebookData {\n        return {\n            metadata: data.metadata,\n            cells: data.cells.map(fromNotebookCellDataDto)\n        };\n    }\n\n    export function toNotebookCellDto(cell: NotebookCellModel): rpc.NotebookCellDto {\n        const eol = OS.backend.EOL;\n        return {\n            handle: cell.handle,\n            uri: cell.uri.toComponents(),\n            source: cell.text.split(eol),\n            eol,\n            language: cell.language,\n            cellKind: cell.cellKind,\n            outputs: cell.outputs.map(toNotebookOutputDto),\n            metadata: cell.metadata,\n            internalMetadata: cell.internalMetadata,\n        };\n    }\n\n    // export function fromCellExecuteUpdateDto(data: extHostProtocol.ICellExecuteUpdateDto): ICellExecuteUpdate {\n    //     if (data.editType === CellExecutionUpdateType.Output) {\n    //         return {\n    //             editType: data.editType,\n    //             cellHandle: data.cellHandle,\n    //             append: data.append,\n    //             outputs: data.outputs.map(fromNotebookOutputDto)\n    //         };\n    //     } else if (data.editType === CellExecutionUpdateType.OutputItems) {\n    //         return {\n    //             editType: data.editType,\n    //             append: data.append,\n    //             outputId: data.outputId,\n    //             items: data.items.map(fromNotebookOutputItemDto)\n    //         };\n    //     } else {\n    //         return data;\n    //     }\n    // }\n\n    // export function fromCellExecuteCompleteDto(data: extHostProtocol.ICellExecutionCompleteDto): ICellExecutionComplete {\n    //     return data;\n    // }\n\n    // export function fromCellEditOperationDto(edit: extHostProtocol.ICellEditOperationDto): notebookCommon.ICellEditOperation {\n    //     if (edit.editType === notebookCommon.CellEditType.Replace) {\n    //         return {\n    //             editType: edit.editType,\n    //             index: edit.index,\n    //             count: edit.count,\n    //             cells: edit.cells.map(fromNotebookCellDataDto)\n    //         };\n    //     } else {\n    //         return edit;\n    //     }\n    // }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { UriComponents, URI } from '@theia/core/lib/common/uri';\nimport { CellRange } from '@theia/notebook/lib/common';\nimport { NotebookEditorWidget } from '@theia/notebook/lib/browser';\nimport { MAIN_RPC_CONTEXT, NotebookDocumentShowOptions, NotebookEditorRevealType, NotebookEditorsExt, NotebookEditorsMain } from '../../../common';\nimport { RPCProtocol } from '../../../common/rpc-protocol';\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { open, OpenerService } from '@theia/core/lib/browser';\n\nexport class NotebookEditorsMainImpl implements NotebookEditorsMain {\n\n    protected readonly proxy: NotebookEditorsExt;\n    protected readonly openerService: OpenerService;\n\n    protected readonly mainThreadEditors = new Map<string, NotebookEditorWidget>();\n\n    constructor(\n        rpc: RPCProtocol,\n        container: interfaces.Container\n    ) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.NOTEBOOK_EDITORS_EXT);\n        this.openerService = container.get(OpenerService);\n    }\n\n    async $tryShowNotebookDocument(uriComponents: UriComponents, viewType: string, options: NotebookDocumentShowOptions): Promise<string> {\n        const editor = await open(this.openerService, URI.fromComponents(uriComponents), {});\n        return (editor as NotebookEditorWidget).id;\n    }\n    $tryRevealRange(id: string, range: CellRange, revealType: NotebookEditorRevealType): Promise<void> {\n        throw new Error('Method not implemented.');\n    }\n    $trySetSelections(id: string, range: CellRange[]): void {\n        throw new Error('Method not implemented.');\n    }\n\n    handleEditorsAdded(editors: readonly NotebookEditorWidget[]): void {\n        for (const editor of editors) {\n            this.mainThreadEditors.set(editor.id, editor);\n        }\n    }\n\n    handleEditorsRemoved(editorIds: readonly string[]): void {\n        for (const id of editorIds) {\n            this.mainThreadEditors.get(id)?.dispose();\n            this.mainThreadEditors.delete(id);\n        }\n    }\n\n    dispose(): void {\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken, Disposable, Emitter, Event, URI } from '@theia/core';\nimport { UriComponents } from '@theia/core/lib/common/uri';\nimport { LanguageService } from '@theia/core/lib/browser/language-service';\nimport { CellExecuteUpdateDto, CellExecutionCompleteDto, MAIN_RPC_CONTEXT, NotebookKernelDto, NotebookKernelsExt, NotebookKernelsMain } from '../../../common';\nimport { RPCProtocol } from '../../../common/rpc-protocol';\nimport { CellExecution, NotebookExecutionStateService, NotebookKernelChangeEvent, NotebookKernelService, NotebookService } from '@theia/notebook/lib/browser';\nimport { combinedDisposable } from '@theia/monaco-editor-core/esm/vs/base/common/lifecycle';\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { NotebookKernelSourceAction } from '@theia/notebook/lib/common';\nimport { NotebookDto } from '../../../plugin/type-converters';\n\nabstract class NotebookKernel {\n    private readonly onDidChangeEmitter = new Emitter<NotebookKernelChangeEvent>();\n    private readonly preloads: { uri: URI; provides: readonly string[] }[];\n    readonly onDidChange: Event<NotebookKernelChangeEvent> = this.onDidChangeEmitter.event;\n\n    readonly id: string;\n    readonly viewType: string;\n    readonly extensionId: string;\n\n    implementsInterrupt: boolean;\n    label: string;\n    description?: string;\n    detail?: string;\n    supportedLanguages: string[];\n    implementsExecutionOrder: boolean;\n    localResourceRoot: URI;\n\n    public get preloadUris(): URI[] {\n        return this.preloads.map(p => p.uri);\n    }\n\n    public get preloadProvides(): string[] {\n        return this.preloads.map(p => p.provides).flat();\n    }\n\n    constructor(data: NotebookKernelDto, private languageService: LanguageService) {\n        this.id = data.id;\n        this.viewType = data.notebookType;\n        this.extensionId = data.extensionId;\n\n        this.implementsInterrupt = data.supportsInterrupt ?? false;\n        this.label = data.label;\n        this.description = data.description;\n        this.detail = data.detail;\n        this.supportedLanguages = (data.supportedLanguages && data.supportedLanguages.length > 0) ? data.supportedLanguages : languageService.languages.map(lang => lang.id);\n        this.implementsExecutionOrder = data.supportsExecutionOrder ?? false;\n        this.preloads = data.preloads?.map(u => ({ uri: URI.fromComponents(u.uri), provides: u.provides })) ?? [];\n    }\n\n    update(data: Partial<NotebookKernelDto>): void {\n\n        const event: NotebookKernelChangeEvent = Object.create(null);\n        if (data.label !== undefined) {\n            this.label = data.label;\n            event.label = true;\n        }\n        if (data.description !== undefined) {\n            this.description = data.description;\n            event.description = true;\n        }\n        if (data.detail !== undefined) {\n            this.detail = data.detail;\n            event.detail = true;\n        }\n        if (data.supportedLanguages !== undefined) {\n            this.supportedLanguages = (data.supportedLanguages && data.supportedLanguages.length > 0) ?\n                data.supportedLanguages :\n                this.languageService.languages.map(lang => lang.id);\n            event.supportedLanguages = true;\n        }\n        if (data.supportsExecutionOrder !== undefined) {\n            this.implementsExecutionOrder = data.supportsExecutionOrder;\n            event.hasExecutionOrder = true;\n        }\n        if (data.supportsInterrupt !== undefined) {\n            this.implementsInterrupt = data.supportsInterrupt;\n            event.hasInterruptHandler = true;\n        }\n        this.onDidChangeEmitter.fire(event);\n    }\n\n    abstract executeNotebookCellsRequest(uri: URI, cellHandles: number[]): Promise<void>;\n    abstract cancelNotebookCellExecution(uri: URI, cellHandles: number[]): Promise<void>;\n}\n\nexport interface KernelSourceActionProvider {\n    readonly viewType: string;\n    onDidChangeSourceActions?: Event<void>;\n    provideKernelSourceActions(): Promise<NotebookKernelSourceAction[]>;\n}\n\nexport class NotebookKernelsMainImpl implements NotebookKernelsMain {\n\n    private readonly proxy: NotebookKernelsExt;\n\n    private readonly kernels = new Map<number, [kernel: NotebookKernel, registration: Disposable]>();\n\n    private readonly kernelDetectionTasks = new Map<number, [task: string, registration: Disposable]>();\n\n    private readonly kernelSourceActionProviders = new Map<number, [provider: KernelSourceActionProvider, registration: Disposable]>();\n    private readonly kernelSourceActionProvidersEventRegistrations = new Map<number, Disposable>();\n\n    private notebookKernelService: NotebookKernelService;\n    private notebookService: NotebookService;\n    private languageService: LanguageService;\n    private notebookExecutionStateService: NotebookExecutionStateService;\n\n    private readonly executions = new Map<number, CellExecution>();\n\n    constructor(\n        rpc: RPCProtocol,\n        container: interfaces.Container,\n    ) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.NOTEBOOK_KERNELS_EXT);\n\n        this.notebookKernelService = container.get(NotebookKernelService);\n        this.notebookExecutionStateService = container.get(NotebookExecutionStateService);\n        this.notebookService = container.get(NotebookService);\n        this.languageService = container.get(LanguageService);\n    }\n\n    $postMessage(handle: number, editorId: string | undefined, message: unknown): Promise<boolean> {\n        throw new Error('Method not implemented.');\n    }\n\n    async $addKernel(handle: number, data: NotebookKernelDto): Promise<void> {\n        const that = this;\n        const kernel = new class extends NotebookKernel {\n            async executeNotebookCellsRequest(uri: URI, handles: number[]): Promise<void> {\n                await that.proxy.$executeCells(handle, uri.toComponents(), handles);\n            }\n            async cancelNotebookCellExecution(uri: URI, handles: number[]): Promise<void> {\n                await that.proxy.$cancelCells(handle, uri.toComponents(), handles);\n            }\n        }(data, this.languageService);\n\n        const listener = this.notebookKernelService.onDidChangeSelectedKernel(e => {\n            if (e.oldKernel === kernel.id) {\n                this.proxy.$acceptNotebookAssociation(handle, e.notebook.toComponents(), false);\n            } else if (e.newKernel === kernel.id) {\n                this.proxy.$acceptNotebookAssociation(handle, e.notebook.toComponents(), true);\n            }\n        });\n\n        const registration = this.notebookKernelService.registerKernel(kernel);\n        this.kernels.set(handle, [kernel, combinedDisposable(listener, registration)]);\n\n    }\n\n    $updateKernel(handle: number, data: Partial<NotebookKernelDto>): void {\n        const tuple = this.kernels.get(handle);\n        if (tuple) {\n            tuple[0].update(data);\n        }\n    }\n\n    $removeKernel(handle: number): void {\n        const tuple = this.kernels.get(handle);\n        if (tuple) {\n            tuple[1].dispose();\n            this.kernels.delete(handle);\n        }\n    }\n\n    $updateNotebookPriority(handle: number, uri: UriComponents, value: number | undefined): void {\n        throw new Error('Method not implemented.');\n    }\n\n    $createExecution(handle: number, controllerId: string, uriComponents: UriComponents, cellHandle: number): void {\n        const uri = URI.fromComponents(uriComponents);\n        const notebook = this.notebookService.getNotebookEditorModel(uri);\n        if (!notebook) {\n            throw new Error(`Notebook not found: ${uri.toString()}`);\n        }\n\n        const kernel = this.notebookKernelService.getMatchingKernel(notebook);\n        if (!kernel.selected || kernel.selected.id !== controllerId) {\n            throw new Error(`Kernel is not selected: ${kernel.selected?.id} !== ${controllerId}`);\n        }\n        const execution = this.notebookExecutionStateService.getOrCreateCellExecution(uri, cellHandle);\n        execution.confirm();\n        this.executions.set(handle, execution);\n    }\n\n    $updateExecution(handle: number, updates: CellExecuteUpdateDto[]): void {\n        const execution = this.executions.get(handle);\n        execution?.update(updates.map(NotebookDto.fromCellExecuteUpdateDto));\n\n    }\n    $completeExecution(handle: number, data: CellExecutionCompleteDto): void {\n        try {\n            const execution = this.executions.get(handle);\n            execution?.complete(NotebookDto.fromCellExecuteCompleteDto(data));\n        } finally {\n            this.executions.delete(handle);\n        }\n\n    }\n\n    // TODO implement notebook execution (special api for executing full notebook instead of just cells)\n    $createNotebookExecution(handle: number, controllerId: string, uri: UriComponents): void {\n        throw new Error('Method not implemented.');\n    }\n    $beginNotebookExecution(handle: number): void {\n        throw new Error('Method not implemented.');\n    }\n    $completeNotebookExecution(handle: number): void {\n        throw new Error('Method not implemented.');\n    }\n\n    async $addKernelDetectionTask(handle: number, notebookType: string): Promise<void> {\n        const registration = this.notebookKernelService.registerNotebookKernelDetectionTask(notebookType);\n        this.kernelDetectionTasks.set(handle, [notebookType, registration]);\n    }\n    $removeKernelDetectionTask(handle: number): void {\n        const tuple = this.kernelDetectionTasks.get(handle);\n        if (tuple) {\n            tuple[1].dispose();\n            this.kernelDetectionTasks.delete(handle);\n        }\n    }\n    async $addKernelSourceActionProvider(handle: number, eventHandle: number, notebookType: string): Promise<void> {\n        const kernelSourceActionProvider: KernelSourceActionProvider = {\n            viewType: notebookType,\n            provideKernelSourceActions: async () => {\n                const actions = await this.proxy.$provideKernelSourceActions(handle, CancellationToken.None);\n\n                return actions.map(action => ({\n                    label: action.label,\n                    command: action.command,\n                    description: action.description,\n                    detail: action.detail,\n                    documentation: action.documentation,\n                }));\n            }\n        };\n\n        if (typeof eventHandle === 'number') {\n            const emitter = new Emitter<void>();\n            this.kernelSourceActionProvidersEventRegistrations.set(eventHandle, emitter);\n            kernelSourceActionProvider.onDidChangeSourceActions = emitter.event;\n        }\n\n        const registration = this.notebookKernelService.registerKernelSourceActionProvider(notebookType, kernelSourceActionProvider);\n        this.kernelSourceActionProviders.set(handle, [kernelSourceActionProvider, registration]);\n    }\n\n    $removeKernelSourceActionProvider(handle: number, eventHandle: number): void {\n        const tuple = this.kernelSourceActionProviders.get(handle);\n        if (tuple) {\n            tuple[1].dispose();\n            this.kernelSourceActionProviders.delete(handle);\n        }\n        if (typeof eventHandle === 'number') {\n            this.kernelSourceActionProvidersEventRegistrations.delete(eventHandle);\n        }\n    }\n    $emitNotebookKernelSourceActionsChangeEvent(eventHandle: number): void {\n    }\n\n    dispose(): void {\n        this.kernels.forEach(kernel => kernel[1].dispose());\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { DisposableCollection } from '@theia/core';\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { NotebookRendererMessagingService } from '@theia/notebook/lib/browser';\nimport { MAIN_RPC_CONTEXT, NotebookRenderersExt, NotebookRenderersMain } from '../../../common';\nimport { RPCProtocol } from '../../../common/rpc-protocol';\n\nexport class NotebookRenderersMainImpl implements NotebookRenderersMain {\n    private readonly proxy: NotebookRenderersExt;\n    private readonly rendererMessagingService: NotebookRendererMessagingService;\n\n    private readonly disposables = new DisposableCollection();\n\n    constructor(\n        rpc: RPCProtocol,\n        container: interfaces.Container\n    ) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.NOTEBOOK_RENDERERS_EXT);\n        this.rendererMessagingService = container.get(NotebookRendererMessagingService);\n        this.rendererMessagingService.onPostMessage(e => {\n            this.proxy.$postRendererMessage(e.editorId, e.rendererId, e.message);\n        });\n    }\n\n    $postMessage(editorId: string | undefined, rendererId: string, message: unknown): Promise<boolean> {\n        return this.rendererMessagingService.receiveMessage(editorId, rendererId, message);\n    }\n\n    dispose(): void {\n        this.disposables.dispose();\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { CancellationToken, DisposableCollection, Emitter } from '@theia/core';\nimport { BinaryBuffer } from '@theia/core/lib/common/buffer';\nimport { NotebookCellStatusBarItemList, NotebookCellStatusBarItemProvider, NotebookData, TransientOptions } from '@theia/notebook/lib/common';\nimport { NotebookService } from '@theia/notebook/lib/browser';\nimport { Disposable } from '@theia/plugin';\nimport { MAIN_RPC_CONTEXT, NotebooksExt, NotebooksMain } from '../../../common';\nimport { RPCProtocol } from '../../../common/rpc-protocol';\nimport { NotebookDto } from './notebook-dto';\nimport { UriComponents } from '@theia/core/lib/common/uri';\nimport { HostedPluginSupport } from '../../../hosted/browser/hosted-plugin';\n\nexport class NotebooksMainImpl implements NotebooksMain {\n\n    private readonly disposables = new DisposableCollection();\n\n    private readonly proxy: NotebooksExt;\n    private readonly notebookSerializer = new Map<number, Disposable>();\n    private readonly notebookCellStatusBarRegistrations = new Map<number, Disposable>();\n\n    constructor(\n        rpc: RPCProtocol,\n        private notebookService: NotebookService,\n        plugins: HostedPluginSupport\n    ) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.NOTEBOOKS_EXT);\n        notebookService.onWillUseNotebookSerializer(async event => plugins.activateByNotebookSerializer(event));\n        notebookService.markReady();\n    }\n\n    dispose(): void {\n        this.disposables.dispose();\n        for (const disposable of this.notebookSerializer.values()) {\n            disposable.dispose();\n        }\n    }\n\n    $registerNotebookSerializer(handle: number, viewType: string, options: TransientOptions): void {\n        const disposables = new DisposableCollection();\n\n        disposables.push(this.notebookService.registerNotebookSerializer(viewType, {\n            options,\n            toNotebook: async (data: BinaryBuffer): Promise<NotebookData> => {\n                const dto = await this.proxy.$dataToNotebook(handle, data, CancellationToken.None);\n                return NotebookDto.fromNotebookDataDto(dto);\n            },\n            fromNotebook: (data: NotebookData): Promise<BinaryBuffer> =>\n                this.proxy.$notebookToData(handle, NotebookDto.toNotebookDataDto(data), CancellationToken.None)\n\n        }));\n\n        this.notebookSerializer.set(handle, disposables);\n    }\n\n    $unregisterNotebookSerializer(handle: number): void {\n        this.notebookSerializer.get(handle)?.dispose();\n        this.notebookSerializer.delete(handle);\n    }\n\n    $emitCellStatusBarEvent(eventHandle: number): void {\n        const emitter = this.notebookCellStatusBarRegistrations.get(eventHandle);\n        if (emitter instanceof Emitter) {\n            emitter.fire(undefined);\n        }\n    }\n\n    async $registerNotebookCellStatusBarItemProvider(handle: number, eventHandle: number | undefined, viewType: string): Promise<void> {\n        const that = this;\n        const provider: NotebookCellStatusBarItemProvider = {\n            async provideCellStatusBarItems(uri: UriComponents, index: number, token: CancellationToken): Promise<NotebookCellStatusBarItemList | undefined> {\n                const result = await that.proxy.$provideNotebookCellStatusBarItems(handle, uri, index, token);\n                return {\n                    items: result?.items ?? [],\n                    dispose(): void {\n                        if (result) {\n                            that.proxy.$releaseNotebookCellStatusBarItems(result.cacheId);\n                        }\n                    }\n                };\n            },\n            viewType\n        };\n\n        if (typeof eventHandle === 'number') {\n            const emitter = new Emitter<void>();\n            this.notebookCellStatusBarRegistrations.set(eventHandle, emitter);\n            provider.onDidChangeStatusBarItems = emitter.event;\n        }\n\n        // const disposable = this._cellStatusBarService.registerCellStatusBarItemProvider(provider);\n        // this.notebookCellStatusBarRegistrations.set(handle, disposable);\n    }\n\n    async $unregisterNotebookCellStatusBarItemProvider(handle: number, eventHandle: number | undefined): Promise<void> {\n        // eslint-disable-next-line @typescript-eslint/no-shadow\n        const unregisterThing = (statusBarHandle: number) => {\n            const entry = this.notebookCellStatusBarRegistrations.get(statusBarHandle);\n            if (entry) {\n                this.notebookCellStatusBarRegistrations.get(statusBarHandle)?.dispose();\n                this.notebookCellStatusBarRegistrations.delete(statusBarHandle);\n            }\n        };\n        unregisterThing(handle);\n        if (typeof eventHandle === 'number') {\n            unregisterThing(eventHandle);\n        }\n    }\n}\n\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { NotificationExt, NotificationMain, MAIN_RPC_CONTEXT } from '../../common';\nimport { ProgressService, Progress, ProgressMessage } from '@theia/core/lib/common';\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\n\nexport class NotificationMainImpl implements NotificationMain, Disposable {\n    private readonly progressService: ProgressService;\n    private readonly progressMap = new Map<string, Progress>();\n    private readonly progress2Work = new Map<string, number>();\n    private readonly proxy: NotificationExt;\n\n    protected readonly toDispose = new DisposableCollection(\n        Disposable.create(() => { /* mark as not disposed */ })\n    );\n\n    constructor(rpc: RPCProtocol, container: interfaces.Container) {\n        this.progressService = container.get(ProgressService);\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.NOTIFICATION_EXT);\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    async $startProgress(options: NotificationMain.StartProgressOptions): Promise<string> {\n        const onDidCancel = () => {\n            // If the map does not contain current id, it has already stopped and should not be cancelled\n            if (this.progressMap.has(id)) {\n                this.proxy.$acceptProgressCanceled(id);\n            }\n        };\n\n        const progressMessage = this.mapOptions(options);\n        const progress = await this.progressService.showProgress(progressMessage, onDidCancel);\n        const id = progress.id;\n        this.progressMap.set(id, progress);\n        this.progress2Work.set(id, 0);\n        if (this.toDispose.disposed) {\n            this.$stopProgress(id);\n        } else {\n            this.toDispose.push(Disposable.create(() => this.$stopProgress(id)));\n        }\n        return id;\n    }\n    protected mapOptions(options: NotificationMain.StartProgressOptions): ProgressMessage {\n        const { title, location, cancellable } = options;\n        return { text: title, options: { location, cancelable: cancellable } };\n    }\n\n    $stopProgress(id: string): void {\n        const progress = this.progressMap.get(id);\n\n        if (progress) {\n            this.progressMap.delete(id);\n            this.progress2Work.delete(id);\n            progress.cancel();\n        }\n    }\n\n    $updateProgress(id: string, item: NotificationMain.ProgressReport): void {\n        const progress = this.progressMap.get(id);\n        if (!progress) {\n            return;\n        }\n        const done = Math.min((this.progress2Work.get(id) || 0) + (item.increment || 0), 100);\n        this.progress2Work.set(id, done);\n        progress.report({ message: item.message, work: done ? { done, total: 100 } : undefined });\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { injectable, inject, named } from '@theia/core/shared/inversify';\nimport { ITokenTypeMap, IEmbeddedLanguagesMap } from 'vscode-textmate';\nimport { StandardTokenType } from 'vscode-textmate/release/encodedTokenAttributes';\nimport { TextmateRegistry, getEncodedLanguageId, MonacoTextmateService, GrammarDefinition } from '@theia/monaco/lib/browser/textmate';\nimport { MenusContributionPointHandler } from './menus/menus-contribution-handler';\nimport { PluginViewRegistry } from './view/plugin-view-registry';\nimport { PluginCustomEditorRegistry } from './custom-editors/plugin-custom-editor-registry';\nimport {\n    PluginContribution, IndentationRules, FoldingRules, ScopeMap, DeployedPlugin,\n    GrammarsContribution, EnterAction, OnEnterRule, RegExpOptions, IconContribution, PluginPackage\n} from '../../common';\nimport {\n    DefaultUriLabelProviderContribution,\n    LabelProviderContribution,\n    PreferenceSchemaProvider\n} from '@theia/core/lib/browser';\nimport { DefaultOverridesPreferenceSchemaId, PreferenceLanguageOverrideService, PreferenceSchema, PreferenceSchemaProperties } from '@theia/core/lib/browser/preferences';\nimport { KeybindingsContributionPointHandler } from './keybindings/keybindings-contribution-handler';\nimport { MonacoSnippetSuggestProvider } from '@theia/monaco/lib/browser/monaco-snippet-suggest-provider';\nimport { PluginSharedStyle } from './plugin-shared-style';\nimport { CommandRegistry, Command, CommandHandler } from '@theia/core/lib/common/command';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\nimport { Emitter } from '@theia/core/lib/common/event';\nimport { TaskDefinitionRegistry, ProblemMatcherRegistry, ProblemPatternRegistry } from '@theia/task/lib/browser';\nimport { NotebookRendererRegistry, NotebookTypeRegistry } from '@theia/notebook/lib/browser';\nimport { PluginDebugService } from './debug/plugin-debug-service';\nimport { DebugSchemaUpdater } from '@theia/debug/lib/browser/debug-schema-updater';\nimport { MonacoThemingService } from '@theia/monaco/lib/browser/monaco-theming-service';\nimport { ColorRegistry } from '@theia/core/lib/browser/color-registry';\nimport { PluginIconService } from './plugin-icon-service';\nimport { PluginIconThemeService } from './plugin-icon-theme-service';\nimport { ContributionProvider } from '@theia/core/lib/common';\nimport * as monaco from '@theia/monaco-editor-core';\nimport { ThemeIcon } from '@theia/monaco-editor-core/esm/vs/platform/theme/common/themeService';\nimport { ContributedTerminalProfileStore, TerminalProfileStore } from '@theia/terminal/lib/browser/terminal-profile-service';\nimport { TerminalWidget } from '@theia/terminal/lib/browser/base/terminal-widget';\nimport { TerminalService } from '@theia/terminal/lib/browser/base/terminal-service';\nimport { PluginTerminalRegistry } from './plugin-terminal-registry';\nimport { ContextKeyService } from '@theia/core/lib/browser/context-key-service';\n\n@injectable()\nexport class PluginContributionHandler {\n\n    private injections = new Map<string, string[]>();\n\n    @inject(TextmateRegistry)\n    private readonly grammarsRegistry: TextmateRegistry;\n\n    @inject(PluginViewRegistry)\n    private readonly viewRegistry: PluginViewRegistry;\n\n    @inject(PluginCustomEditorRegistry)\n    private readonly customEditorRegistry: PluginCustomEditorRegistry;\n\n    @inject(MenusContributionPointHandler)\n    private readonly menusContributionHandler: MenusContributionPointHandler;\n\n    @inject(PreferenceSchemaProvider)\n    private readonly preferenceSchemaProvider: PreferenceSchemaProvider;\n\n    @inject(PreferenceLanguageOverrideService)\n    private readonly preferenceOverrideService: PreferenceLanguageOverrideService;\n\n    @inject(MonacoTextmateService)\n    private readonly monacoTextmateService: MonacoTextmateService;\n\n    @inject(KeybindingsContributionPointHandler)\n    private readonly keybindingsContributionHandler: KeybindingsContributionPointHandler;\n\n    @inject(MonacoSnippetSuggestProvider)\n    protected readonly snippetSuggestProvider: MonacoSnippetSuggestProvider;\n\n    @inject(CommandRegistry)\n    protected readonly commands: CommandRegistry;\n\n    @inject(PluginSharedStyle)\n    protected readonly style: PluginSharedStyle;\n\n    @inject(TaskDefinitionRegistry)\n    protected readonly taskDefinitionRegistry: TaskDefinitionRegistry;\n\n    @inject(ProblemMatcherRegistry)\n    protected readonly problemMatcherRegistry: ProblemMatcherRegistry;\n\n    @inject(ProblemPatternRegistry)\n    protected readonly problemPatternRegistry: ProblemPatternRegistry;\n\n    @inject(PluginDebugService)\n    protected readonly debugService: PluginDebugService;\n\n    @inject(DebugSchemaUpdater)\n    protected readonly debugSchema: DebugSchemaUpdater;\n\n    @inject(MonacoThemingService)\n    protected readonly monacoThemingService: MonacoThemingService;\n\n    @inject(ColorRegistry)\n    protected readonly colors: ColorRegistry;\n\n    @inject(PluginIconService)\n    protected readonly iconService: PluginIconService;\n\n    @inject(PluginIconThemeService)\n    protected readonly iconThemeService: PluginIconThemeService;\n\n    @inject(TerminalService)\n    protected readonly terminalService: TerminalService;\n\n    @inject(PluginTerminalRegistry)\n    protected readonly pluginTerminalRegistry: PluginTerminalRegistry;\n\n    @inject(ContributedTerminalProfileStore)\n    protected readonly contributedProfileStore: TerminalProfileStore;\n\n    @inject(NotebookTypeRegistry)\n    protected readonly notebookTypeRegistry: NotebookTypeRegistry;\n\n    @inject(NotebookRendererRegistry)\n    protected readonly notebookRendererRegistry: NotebookRendererRegistry;\n\n    @inject(ContributionProvider) @named(LabelProviderContribution)\n    protected readonly contributionProvider: ContributionProvider<LabelProviderContribution>;\n\n    @inject(ContextKeyService)\n    protected readonly contextKeyService: ContextKeyService;\n\n    protected readonly commandHandlers = new Map<string, CommandHandler['execute'] | undefined>();\n\n    protected readonly onDidRegisterCommandHandlerEmitter = new Emitter<string>();\n    readonly onDidRegisterCommandHandler = this.onDidRegisterCommandHandlerEmitter.event;\n\n    /**\n     * Always synchronous in order to simplify handling disconnections.\n     * @throws never, loading of each contribution should handle errors\n     * in order to avoid preventing loading of other contributions or extensions\n     */\n    handleContributions(clientId: string, plugin: DeployedPlugin): Disposable {\n        const contributions = plugin.contributes;\n        if (!contributions) {\n            return Disposable.NULL;\n        }\n        const toDispose = new DisposableCollection(Disposable.create(() => { /* mark as not disposed */ }));\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        const logError = (message: string, ...args: any[]) => console.error(`[${clientId}][${plugin.metadata.model.id}]: ${message}`, ...args);\n        const logWarning = (message: string, ...args: any[]) => console.warn(`[${clientId}][${plugin.metadata.model.id}]: ${message}`, ...args);\n        const pushContribution = (id: string, contribute: () => Disposable) => {\n            if (toDispose.disposed) {\n                return;\n            }\n            try {\n                toDispose.push(contribute());\n            } catch (e) {\n                logError(`Failed to load '${id}' contribution.`, e);\n            }\n        };\n\n        const configuration = contributions.configuration;\n        if (configuration) {\n            for (const config of configuration) {\n                pushContribution('configuration', () => this.preferenceSchemaProvider.setSchema(config));\n            }\n        }\n\n        const configurationDefaults = contributions.configurationDefaults;\n        if (configurationDefaults) {\n            pushContribution('configurationDefaults', () => this.updateDefaultOverridesSchema(configurationDefaults));\n        }\n\n        const languages = contributions.languages;\n        if (languages && languages.length) {\n            for (const lang of languages) {\n                // it is not possible to unregister a language\n                monaco.languages.register({\n                    id: lang.id,\n                    aliases: lang.aliases,\n                    extensions: lang.extensions,\n                    filenamePatterns: lang.filenamePatterns,\n                    filenames: lang.filenames,\n                    firstLine: lang.firstLine,\n                    mimetypes: lang.mimetypes\n                });\n                const langConfiguration = lang.configuration;\n                if (langConfiguration) {\n                    pushContribution(`language.${lang.id}.configuration`, () => monaco.languages.setLanguageConfiguration(lang.id, {\n                        wordPattern: this.createRegex(langConfiguration.wordPattern),\n                        autoClosingPairs: langConfiguration.autoClosingPairs,\n                        brackets: langConfiguration.brackets,\n                        comments: langConfiguration.comments,\n                        folding: this.convertFolding(langConfiguration.folding),\n                        surroundingPairs: langConfiguration.surroundingPairs,\n                        indentationRules: this.convertIndentationRules(langConfiguration.indentationRules),\n                        onEnterRules: this.convertOnEnterRules(langConfiguration.onEnterRules),\n                    }));\n                }\n            }\n        }\n\n        const grammars = contributions.grammars;\n        if (grammars && grammars.length) {\n            const grammarsWithLanguage: GrammarsContribution[] = [];\n            for (const grammar of grammars) {\n                if (grammar.injectTo) {\n                    for (const injectScope of grammar.injectTo) {\n                        pushContribution(`grammar.injectTo.${injectScope}`, () => {\n                            const injections = this.injections.get(injectScope) || [];\n                            injections.push(grammar.scope);\n                            this.injections.set(injectScope, injections);\n                            return Disposable.create(() => {\n                                const index = injections.indexOf(grammar.scope);\n                                if (index !== -1) {\n                                    injections.splice(index, 1);\n                                }\n                            });\n                        });\n                    }\n                }\n                if (grammar.language) {\n                    // processing is deferred.\n                    grammarsWithLanguage.push(grammar);\n                }\n                pushContribution(`grammar.textmate.scope.${grammar.scope}`, () => this.grammarsRegistry.registerTextmateGrammarScope(grammar.scope, {\n                    async getGrammarDefinition(): Promise<GrammarDefinition> {\n                        return {\n                            format: grammar.format,\n                            content: grammar.grammar || '',\n                            location: grammar.grammarLocation\n                        };\n                    },\n                    getInjections: (scopeName: string) =>\n                        this.injections.get(scopeName)!\n                }));\n            }\n            // load grammars on next tick to await registration of languages from all plugins in current tick\n            // see https://github.com/eclipse-theia/theia/issues/6907#issuecomment-578600243\n            setTimeout(() => {\n                for (const grammar of grammarsWithLanguage) {\n                    const language = grammar.language!;\n                    pushContribution(`grammar.language.${language}.scope`, () => this.grammarsRegistry.mapLanguageIdToTextmateGrammar(language, grammar.scope));\n                    pushContribution(`grammar.language.${language}.configuration`, () => this.grammarsRegistry.registerGrammarConfiguration(language, {\n                        embeddedLanguages: this.convertEmbeddedLanguages(grammar.embeddedLanguages, logWarning),\n                        tokenTypes: this.convertTokenTypes(grammar.tokenTypes),\n                        balancedBracketSelectors: grammar.balancedBracketScopes ?? ['*'],\n                        unbalancedBracketSelectors: grammar.balancedBracketScopes,\n                    }));\n                }\n                // activate grammars only once everything else is loaded.\n                // see https://github.com/eclipse-theia/theia-cpp-extensions/issues/100#issuecomment-610643866\n                setTimeout(() => {\n                    for (const grammar of grammarsWithLanguage) {\n                        const language = grammar.language!;\n                        pushContribution(`grammar.language.${language}.activation`,\n                            () => this.monacoTextmateService.activateLanguage(language)\n                        );\n                    }\n                });\n            });\n        }\n\n        pushContribution('commands', () => this.registerCommands(contributions));\n        pushContribution('menus', () => this.menusContributionHandler.handle(plugin));\n        pushContribution('keybindings', () => this.keybindingsContributionHandler.handle(contributions));\n\n        if (contributions.customEditors) {\n            for (const customEditor of contributions.customEditors) {\n                pushContribution(`customEditors.${customEditor.viewType}`,\n                    () => this.customEditorRegistry.registerCustomEditor(customEditor)\n                );\n            }\n        }\n\n        if (contributions.viewsContainers) {\n            for (const location in contributions.viewsContainers) {\n                if (contributions.viewsContainers!.hasOwnProperty(location)) {\n                    for (const viewContainer of contributions.viewsContainers[location]) {\n                        pushContribution(`viewContainers.${viewContainer.id}`,\n                            () => this.viewRegistry.registerViewContainer(location, viewContainer)\n                        );\n                    }\n                }\n            }\n        }\n        if (contributions.views) {\n            // eslint-disable-next-line guard-for-in\n            for (const location in contributions.views) {\n                for (const view of contributions.views[location]) {\n                    pushContribution(`views.${view.id}`,\n                        () => this.viewRegistry.registerView(location, view)\n                    );\n                }\n            }\n        }\n\n        if (contributions.viewsWelcome) {\n            for (const [index, viewWelcome] of contributions.viewsWelcome.entries()) {\n                pushContribution(`viewsWelcome.${viewWelcome.view}.${index}`,\n                    () => this.viewRegistry.registerViewWelcome(viewWelcome)\n                );\n            }\n        }\n\n        if (contributions.snippets) {\n            for (const snippet of contributions.snippets) {\n                pushContribution(`snippets.${snippet.uri}`, () => this.snippetSuggestProvider.fromURI(snippet.uri, {\n                    language: snippet.language,\n                    source: snippet.source\n                }));\n            }\n        }\n\n        if (contributions.themes && contributions.themes.length) {\n            const pending = {};\n            for (const theme of contributions.themes) {\n                pushContribution(`themes.${theme.uri}`, () => this.monacoThemingService.register(theme, pending));\n            }\n        }\n\n        if (contributions.iconThemes && contributions.iconThemes.length) {\n            for (const iconTheme of contributions.iconThemes) {\n                pushContribution(`iconThemes.${iconTheme.uri}`, () => this.iconThemeService.register(iconTheme, plugin));\n            }\n        }\n\n        if (contributions.icons && contributions.icons.length) {\n            for (const icon of contributions.icons) {\n                const defaultIcon = icon.defaults;\n                let key: string;\n                if (IconContribution.isIconDefinition(defaultIcon)) {\n                    key = defaultIcon.location;\n                } else {\n                    key = defaultIcon.id;\n                }\n                pushContribution(`icons.${key}`, () => this.iconService.register(icon, plugin));\n            }\n        }\n\n        const colors = contributions.colors;\n        if (colors) {\n            pushContribution('colors', () => this.colors.register(...colors));\n        }\n\n        if (contributions.taskDefinitions) {\n            for (const taskDefinition of contributions.taskDefinitions) {\n                pushContribution(`taskDefinitions.${taskDefinition.taskType}`,\n                    () => this.taskDefinitionRegistry.register(taskDefinition)\n                );\n            }\n        }\n\n        if (contributions.problemPatterns) {\n            for (const problemPattern of contributions.problemPatterns) {\n                pushContribution(`problemPatterns.${problemPattern.name || problemPattern.regexp}`,\n                    () => this.problemPatternRegistry.register(problemPattern)\n                );\n            }\n        }\n\n        if (contributions.problemMatchers) {\n            for (const problemMatcher of contributions.problemMatchers) {\n                pushContribution(`problemMatchers.${problemMatcher.label}`,\n                    () => this.problemMatcherRegistry.register(problemMatcher)\n                );\n            }\n        }\n\n        if (contributions.debuggers && contributions.debuggers.length) {\n            toDispose.push(Disposable.create(() => this.debugSchema.update()));\n            for (const contribution of contributions.debuggers) {\n                pushContribution(`debuggers.${contribution.type}`,\n                    () => this.debugService.registerDebugger(contribution)\n                );\n            }\n            this.debugSchema.update();\n        }\n\n        if (contributions.resourceLabelFormatters) {\n            for (const formatter of contributions.resourceLabelFormatters) {\n                for (const contribution of this.contributionProvider.getContributions()) {\n                    if (contribution instanceof DefaultUriLabelProviderContribution) {\n                        pushContribution(`resourceLabelFormatters.${formatter.scheme}`,\n                            () => contribution.registerFormatter(formatter)\n                        );\n                    }\n                }\n            }\n        }\n\n        const self = this;\n        if (contributions.terminalProfiles) {\n            for (const profile of contributions.terminalProfiles) {\n                pushContribution(`terminalProfiles.${profile.id}`, () => {\n                    this.contributedProfileStore.registerTerminalProfile(profile.title, {\n                        async start(): Promise<TerminalWidget> {\n                            const terminalId = await self.pluginTerminalRegistry.start(profile.id);\n                            const result = self.terminalService.getById(terminalId);\n                            if (!result) {\n                                throw new Error(`Error starting terminal from profile ${profile.id}`);\n                            }\n                            return result;\n\n                        }\n                    });\n                    return Disposable.create(() => {\n                        this.contributedProfileStore.unregisterTerminalProfile(profile.id);\n                    });\n                });\n            }\n        }\n\n        if (contributions.notebooks) {\n            for (const notebook of contributions.notebooks) {\n                pushContribution(`notebook.${notebook.type}`,\n                    () => this.notebookTypeRegistry.registerNotebookType(notebook)\n                );\n            }\n        }\n\n        if (contributions.notebookRenderer) {\n            for (const renderer of contributions.notebookRenderer) {\n                pushContribution(`notebookRenderer.${renderer.id}`,\n                    () => this.notebookRendererRegistry.registerNotebookRenderer(renderer, PluginPackage.toPluginUrl(plugin.metadata.model, ''))\n                );\n            }\n        }\n\n        return toDispose;\n    }\n\n    protected registerCommands(contribution: PluginContribution): Disposable {\n        if (!contribution.commands) {\n            return Disposable.NULL;\n        }\n        const toDispose = new DisposableCollection();\n        for (const { iconUrl, themeIcon, command, category, title, originalTitle, enablement } of contribution.commands) {\n            const reference = iconUrl && this.style.toIconClass(iconUrl);\n            const icon = themeIcon && ThemeIcon.fromString(themeIcon);\n            let iconClass;\n            if (reference) {\n                toDispose.push(reference);\n                iconClass = reference.object.iconClass;\n            } else if (icon) {\n                iconClass = ThemeIcon.asClassName(icon);\n            }\n            toDispose.push(this.registerCommand({ id: command, category, label: title, originalLabel: originalTitle, iconClass }, enablement));\n        }\n        return toDispose;\n    }\n\n    registerCommand(command: Command, enablement?: string): Disposable {\n        if (this.hasCommand(command.id)) {\n            console.warn(`command '${command.id}' already registered`);\n            return Disposable.NULL;\n        }\n\n        const commandHandler: CommandHandler = {\n            execute: async (...args) => {\n                const handler = this.commandHandlers.get(command.id);\n                if (!handler) {\n                    throw new Error(`command '${command.id}' not found`);\n                }\n                return handler(...args);\n            },\n            // Always enabled - a command can be executed programmatically or via the commands palette.\n            isEnabled: () => {\n                if (enablement) {\n                    return this.contextKeyService.match(enablement);\n                }\n                return true;\n            },\n            // Visibility rules are defined via the `menus` contribution point.\n            isVisible(): boolean { return true; }\n        };\n\n        if (enablement) {\n            const contextKeys = this.contextKeyService.parseKeys(enablement);\n            if (contextKeys && contextKeys.size > 0) {\n                commandHandler.onDidChangeEnabled = (listener: () => void) => this.contextKeyService.onDidChange(e => {\n                    if (e.affects(contextKeys)) {\n                        listener();\n                    }\n                });\n            }\n        }\n\n        const toDispose = new DisposableCollection();\n        if (this.commands.getCommand(command.id)) {\n            // overriding built-in command, i.e. `type` by the VSCodeVim extension\n            toDispose.push(this.commands.registerHandler(command.id, commandHandler));\n        } else {\n            toDispose.push(this.commands.registerCommand(command, commandHandler));\n        }\n        this.commandHandlers.set(command.id, undefined);\n        toDispose.push(Disposable.create(() => this.commandHandlers.delete(command.id)));\n        return toDispose;\n    }\n\n    registerCommandHandler(id: string, execute: CommandHandler['execute']): Disposable {\n        if (this.hasCommandHandler(id)) {\n            console.warn(`command handler '${id}' already registered`);\n            return Disposable.NULL;\n        }\n\n        this.commandHandlers.set(id, execute);\n        this.onDidRegisterCommandHandlerEmitter.fire(id);\n        return Disposable.create(() => this.commandHandlers.set(id, undefined));\n    }\n\n    hasCommand(id: string): boolean {\n        return this.commandHandlers.has(id);\n    }\n\n    hasCommandHandler(id: string): boolean {\n        return !!this.commandHandlers.get(id);\n    }\n\n    protected updateDefaultOverridesSchema(configurationDefaults: PreferenceSchemaProperties): Disposable {\n        const defaultOverrides: PreferenceSchema = {\n            id: DefaultOverridesPreferenceSchemaId,\n            title: 'Default Configuration Overrides',\n            properties: {}\n        };\n        // eslint-disable-next-line guard-for-in\n        for (const key in configurationDefaults) {\n            const defaultValue = configurationDefaults[key];\n            if (this.preferenceOverrideService.testOverrideValue(key, defaultValue)) {\n                // language specific override\n                defaultOverrides.properties[key] = {\n                    type: 'object',\n                    default: defaultValue,\n                    description: `Configure editor settings to be overridden for ${key} language.`\n                };\n            } else {\n                // regular configuration override\n                defaultOverrides.properties[key] = {\n                    default: defaultValue,\n                    description: `Configure default setting for ${key}.`\n                };\n            }\n        }\n        if (Object.keys(defaultOverrides.properties).length) {\n            return this.preferenceSchemaProvider.setSchema(defaultOverrides);\n        }\n        return Disposable.NULL;\n    }\n\n    private createRegex(value: string | RegExpOptions | undefined): RegExp | undefined {\n        if (typeof value === 'string') {\n            return new RegExp(value, '');\n        }\n        if (typeof value == 'undefined') {\n            return undefined;\n        }\n        return new RegExp(value.pattern, value.flags);\n    }\n\n    private convertIndentationRules(rules?: IndentationRules): monaco.languages.IndentationRule | undefined {\n        if (!rules) {\n            return undefined;\n        }\n        return {\n            decreaseIndentPattern: this.createRegex(rules.decreaseIndentPattern)!,\n            increaseIndentPattern: this.createRegex(rules.increaseIndentPattern)!,\n            indentNextLinePattern: this.createRegex(rules.indentNextLinePattern),\n            unIndentedLinePattern: this.createRegex(rules.unIndentedLinePattern)\n        };\n    }\n\n    private convertFolding(folding?: FoldingRules): monaco.languages.FoldingRules | undefined {\n        if (!folding) {\n            return undefined;\n        }\n        const result: monaco.languages.FoldingRules = {\n            offSide: folding.offSide\n        };\n\n        if (folding.markers) {\n            result.markers = {\n                end: this.createRegex(folding.markers.end)!,\n                start: this.createRegex(folding.markers.start)!\n            };\n        }\n\n        return result;\n    }\n\n    private convertTokenTypes(tokenTypes?: ScopeMap): ITokenTypeMap | undefined {\n        if (typeof tokenTypes === 'undefined' || tokenTypes === null) {\n            return undefined;\n        }\n        const result = Object.create(null);\n        const scopes = Object.keys(tokenTypes);\n        const len = scopes.length;\n        for (let i = 0; i < len; i++) {\n            const scope = scopes[i];\n            const tokenType = tokenTypes[scope];\n            switch (tokenType) {\n                case 'string':\n                    result[scope] = StandardTokenType.String;\n                    break;\n                case 'other':\n                    result[scope] = StandardTokenType.Other;\n                    break;\n                case 'comment':\n                    result[scope] = StandardTokenType.Comment;\n                    break;\n            }\n        }\n        return result;\n    }\n\n    private convertEmbeddedLanguages(languages: ScopeMap | undefined, logWarning: (warning: string) => void): IEmbeddedLanguagesMap | undefined {\n        if (typeof languages === 'undefined' || languages === null) {\n            return undefined;\n        }\n        const result = Object.create(null);\n        const scopes = Object.keys(languages);\n        const len = scopes.length;\n        for (let i = 0; i < len; i++) {\n            const scope = scopes[i];\n            const langId = languages[scope];\n            result[scope] = getEncodedLanguageId(langId);\n            if (!result[scope]) {\n                logWarning(`Language for '${scope}' not found.`);\n            }\n        }\n        return result;\n    }\n\n    private convertOnEnterRules(onEnterRules?: OnEnterRule[]): monaco.languages.OnEnterRule[] | undefined {\n        if (!onEnterRules) {\n            return undefined;\n        }\n\n        const result: monaco.languages.OnEnterRule[] = [];\n        for (const onEnterRule of onEnterRules) {\n            const rule: monaco.languages.OnEnterRule = {\n                beforeText: this.createRegex(onEnterRule.beforeText)!,\n                afterText: this.createRegex(onEnterRule.afterText),\n                previousLineText: this.createRegex(onEnterRule.previousLineText),\n                action: this.createEnterAction(onEnterRule.action),\n            };\n            result.push(rule);\n        }\n\n        return result;\n    }\n\n    private createEnterAction(action: EnterAction): monaco.languages.EnterAction {\n        let indentAction: monaco.languages.IndentAction;\n        switch (action.indent) {\n            case 'indent':\n                indentAction = monaco.languages.IndentAction.Indent;\n                break;\n            case 'indentOutdent':\n                indentAction = monaco.languages.IndentAction.IndentOutdent;\n                break;\n            case 'outdent':\n                indentAction = monaco.languages.IndentAction.Outdent;\n                break;\n            default:\n                indentAction = monaco.languages.IndentAction.None;\n                break;\n        }\n        return { indentAction, appendText: action.appendText, removeText: action.removeText };\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 Ericsson and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { asCSSPropertyValue } from '@theia/monaco-editor-core/esm/vs/base/browser/dom';\nimport { Endpoint } from '@theia/core/lib/browser';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\nimport { getIconRegistry } from '@theia/monaco-editor-core/esm/vs/platform/theme/common/iconRegistry';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { URI } from '@theia/core/shared/vscode-uri';\nimport { IconFontDefinition, IconContribution as Icon } from '@theia/core/lib/browser/icon-registry';\nimport { MonacoIconRegistry } from '@theia/monaco/lib/browser/monaco-icon-registry';\nimport * as path from 'path';\nimport { IconContribution, DeployedPlugin, IconDefinition } from '../../common/plugin-protocol';\nimport { IThemeService } from '@theia/monaco-editor-core/esm/vs/platform/theme/common/themeService';\nimport { UnthemedProductIconTheme } from '@theia/monaco-editor-core/esm/vs/platform/theme/browser/iconsStyleSheet';\n\n@injectable()\nexport class PluginIconService implements Disposable {\n\n    @inject(MonacoIconRegistry)\n    protected readonly iconRegistry: MonacoIconRegistry;\n\n    protected readonly toDispose = new DisposableCollection();\n\n    styleSheet: string = '';\n    styleElement: HTMLStyleElement;\n\n    register(contribution: IconContribution, plugin: DeployedPlugin): Disposable {\n        const defaultIcon = contribution.defaults;\n        if (IconContribution.isIconDefinition(defaultIcon)) {\n            this.registerFontIcon(contribution, defaultIcon);\n        } else {\n            this.registerRegularIcon(contribution, defaultIcon.id);\n        }\n        this.updateStyle(contribution);\n        return Disposable.NULL;\n    }\n\n    updateStyle(contribution: IconContribution): void {\n        this.updateStyleElement();\n        const css = this.getCSS(contribution);\n        if (css) {\n            this.styleElement.innerText = css;\n        }\n        const toRemoveStyleElement = Disposable.create(() => this.styleElement.remove());\n        this.toDispose.push(toRemoveStyleElement);\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    protected registerFontIcon(contribution: IconContribution, defaultIcon: IconDefinition): void {\n        const location = defaultIcon.location;\n        const format = getFileExtension(location);\n        const fontId = getFontId(contribution.extensionId, location);\n        const definition = this.iconRegistry.registerIconFont(fontId, { src: [{ location: URI.file(location), format }] });\n        this.iconRegistry.registerIcon(contribution.id, {\n            fontCharacter: defaultIcon.fontCharacter,\n            font: {\n                id: fontId,\n                definition\n            }\n        }, contribution.description);\n    }\n\n    protected registerRegularIcon(contribution: IconContribution, defaultIconId: string): void {\n        this.iconRegistry.registerIcon(contribution.id, { id: defaultIconId }, contribution.description);\n    }\n\n    protected updateStyleElement(): void {\n        if (!this.styleElement) {\n            const styleElement = document.createElement('style');\n            styleElement.type = 'text/css';\n            styleElement.media = 'screen';\n            styleElement.id = 'contributedIconsStyles';\n            document.head.appendChild(styleElement);\n            this.styleElement = styleElement;\n        }\n    }\n    protected getCSS(iconContribution: IconContribution, themeService?: IThemeService): string | undefined {\n        const iconRegistry = getIconRegistry();\n        const productIconTheme = themeService ? themeService.getProductIconTheme() : new UnthemedProductIconTheme();\n        const usedFontIds: { [id: string]: IconFontDefinition } = {};\n        const formatIconRule = (contribution: Icon): string | undefined => {\n            const definition = productIconTheme.getIcon(contribution);\n            if (!definition) {\n                return undefined;\n            }\n            const fontContribution = definition.font;\n            if (fontContribution) {\n                usedFontIds[fontContribution.id] = fontContribution.definition;\n                return `.codicon-${contribution.id}:before { content: '${definition.fontCharacter}'; font-family: ${asCSSPropertyValue(iconContribution.extensionId)}; }`;\n            }\n            // default font (codicon)\n            return `.codicon-${contribution.id}:before { content: '${definition.fontCharacter}'; }`;\n        };\n\n        const rules = [];\n        for (const contribution of iconRegistry.getIcons()) {\n            const rule = formatIconRule(contribution);\n            if (rule) {\n                rules.push(rule);\n            }\n        }\n        for (const id in usedFontIds) {\n            if (id) {\n                const definition = usedFontIds[id];\n                const fontWeight = definition.weight ? `font-weight: ${definition.weight};` : '';\n                const fontStyle = definition.style ? `font-style: ${definition.style};` : '';\n                const src = definition.src.map(icon =>\n                    `${this.toPluginUrl(iconContribution.extensionId, getIconRelativePath(icon.location.path))} format('${icon.format}')`)\n                    .join(', ');\n                rules.push(`@font-face { src: ${src}; font-family: ${asCSSPropertyValue(iconContribution.extensionId)};${fontWeight}${fontStyle} font-display: block; }`);\n            }\n        }\n        return rules.join('\\n');\n    }\n\n    protected toPluginUrl(id: string, relativePath: string): string {\n        return `url('${new Endpoint({\n            path: `hostedPlugin/${this.formatExtensionId(id)}/${encodeURIComponent(relativePath)}`\n        }).getRestUrl().toString()}')`;\n    }\n\n    protected formatExtensionId(id: string): string {\n        return id.replace(/\\W/g, '_');\n    }\n}\n\nfunction getIconRelativePath(iconPath: string): string {\n    const index = iconPath.indexOf('extension');\n    return index === -1 ? '' : iconPath.substring(index + 'extension'.length + 1);\n}\n\nfunction getFontId(extensionId: string, fontPath: string): string {\n    return path.join(extensionId, fontPath);\n}\n\nfunction getFileExtension(filePath: string): string {\n    const index = filePath.lastIndexOf('.');\n    return index === -1 ? '' : filePath.substring(index + 1);\n}\n","// *****************************************************************************\n// Copyright (C) 2019 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n// some code is copied and modified from:\n// https://github.com/microsoft/vscode/blob/7cf4cca47aa025a590fc939af54932042302be63/src/vs/workbench/services/themes/browser/fileIconThemeData.ts\n\nimport debounce = require('@theia/core/shared/lodash.debounce');\nimport * as jsoncparser from 'jsonc-parser';\nimport { injectable, inject, postConstruct } from '@theia/core/shared/inversify';\nimport { IconThemeService, IconTheme, IconThemeDefinition } from '@theia/core/lib/browser/icon-theme-service';\nimport { IconThemeContribution, DeployedPlugin, UiTheme, getPluginId } from '../../common/plugin-protocol';\nimport URI from '@theia/core/lib/common/uri';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\nimport { Emitter } from '@theia/core/lib/common/event';\nimport { RecursivePartial } from '@theia/core/lib/common/types';\nimport { LabelProviderContribution, DidChangeLabelEvent, LabelProvider, URIIconReference } from '@theia/core/lib/browser/label-provider';\nimport { ThemeType } from '@theia/core/lib/common/theme';\nimport { FileStatNode, DirNode } from '@theia/filesystem/lib/browser';\nimport { WorkspaceRootNode } from '@theia/navigator/lib/browser/navigator-tree';\nimport { Endpoint } from '@theia/core/lib/browser/endpoint';\nimport { FileService } from '@theia/filesystem/lib/browser/file-service';\nimport { FileStat, FileChangeType } from '@theia/filesystem/lib/common/files';\nimport { WorkspaceService } from '@theia/workspace/lib/browser';\nimport { StandaloneServices } from '@theia/monaco-editor-core/esm/vs/editor/standalone/browser/standaloneServices';\nimport { ILanguageService } from '@theia/monaco-editor-core/esm/vs/editor/common/languages/language';\n\nexport interface PluginIconDefinition {\n    iconPath: string;\n    fontColor: string;\n    fontCharacter: string;\n    fontSize: string;\n    fontId: string;\n}\n\nexport interface PluginFontDefinition {\n    id: string;\n    weight: string;\n    style: string;\n    size: string;\n    src: { path: string; format: string; }[];\n}\n\nexport interface PluginIconsAssociation {\n    folder?: string;\n    file?: string;\n    folderExpanded?: string;\n    rootFolder?: string;\n    rootFolderExpanded?: string;\n    folderNames?: { [folderName: string]: string; };\n    folderNamesExpanded?: { [folderName: string]: string; };\n    fileExtensions?: { [extension: string]: string; };\n    fileNames?: { [fileName: string]: string; };\n    languageIds?: { [languageId: string]: string; };\n}\n\nexport interface PluginIconDefinitions {\n    [key: string]: PluginIconDefinition\n}\n\nexport interface PluginIconThemeDocument extends PluginIconsAssociation {\n    iconDefinitions: PluginIconDefinitions;\n    fonts: PluginFontDefinition[];\n    light?: PluginIconsAssociation;\n    highContrast?: PluginIconsAssociation;\n    hidesExplorerArrows?: boolean;\n}\n\nexport const PluginIconThemeFactory = Symbol('PluginIconThemeFactory');\nexport type PluginIconThemeFactory = (definition: PluginIconThemeDefinition) => PluginIconTheme;\n\n@injectable()\nexport class PluginIconThemeDefinition implements IconThemeDefinition, IconThemeContribution {\n    id: string;\n    label: string;\n    description?: string;\n    uri: string;\n    uiTheme?: UiTheme;\n    pluginId: string;\n    packageUri: string;\n    hasFileIcons?: boolean;\n    hasFolderIcons?: boolean;\n    hidesExplorerArrows?: boolean;\n}\n\n@injectable()\nexport class PluginIconTheme extends PluginIconThemeDefinition implements IconTheme, Disposable {\n\n    @inject(FileService)\n    protected readonly fileService: FileService;\n\n    @inject(LabelProvider)\n    protected readonly labelProvider: LabelProvider;\n\n    @inject(PluginIconThemeDefinition)\n    protected readonly definition: PluginIconThemeDefinition;\n\n    @inject(WorkspaceService)\n    protected readonly workspaceService: WorkspaceService;\n\n    protected readonly onDidChangeEmitter = new Emitter<DidChangeLabelEvent>();\n    readonly onDidChange = this.onDidChangeEmitter.event;\n\n    protected readonly toDeactivate = new DisposableCollection();\n    protected readonly toUnload = new DisposableCollection();\n    protected readonly toDisposeStyleElement = new DisposableCollection();\n    protected readonly toDispose = new DisposableCollection(\n        this.toDeactivate, this.toDisposeStyleElement, this.toUnload, this.onDidChangeEmitter\n    );\n\n    protected packageRootUri: URI;\n    protected locationUri: URI;\n\n    protected styleSheetContent: string | undefined;\n    protected readonly icons = new Set<string>();\n\n    @postConstruct()\n    protected init(): void {\n        Object.assign(this, this.definition);\n        this.packageRootUri = new URI(this.packageUri);\n        this.locationUri = new URI(this.uri).parent;\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    protected fireDidChange(): void {\n        this.onDidChangeEmitter.fire({ affects: () => true });\n    }\n\n    activate(): Disposable {\n        if (!this.toDeactivate.disposed) {\n            return this.toDeactivate;\n        }\n        this.toDeactivate.push(Disposable.create(() => this.fireDidChange()));\n        this.doActivate();\n        return this.toDeactivate;\n    }\n\n    protected async doActivate(): Promise<void> {\n        await this.load();\n        this.updateStyleElement();\n    }\n\n    protected updateStyleElement(): void {\n        this.toDisposeStyleElement.dispose();\n        if (this.toDeactivate.disposed || !this.styleSheetContent) {\n            return;\n        }\n        const styleElement = document.createElement('style');\n        styleElement.type = 'text/css';\n        styleElement.className = 'theia-icon-theme';\n        styleElement.innerText = this.styleSheetContent;\n        document.head.appendChild(styleElement);\n        const toRemoveStyleElement = Disposable.create(() => styleElement.remove());\n        this.toDisposeStyleElement.push(toRemoveStyleElement);\n        this.toDeactivate.push(toRemoveStyleElement);\n        this.fireDidChange();\n    }\n\n    protected reload = debounce(() => {\n        this.toUnload.dispose();\n        this.doActivate();\n    }, 50);\n\n    /**\n     * This should be aligned with\n     * https://github.com/microsoft/vscode/blob/7cf4cca47aa025a590fc939af54932042302be63/src/vs/workbench/services/themes/browser/fileIconThemeData.ts#L201\n     */\n    protected async load(): Promise<void> {\n        if (this.styleSheetContent !== undefined) {\n            return;\n        }\n        this.styleSheetContent = '';\n        this.toUnload.push(Disposable.create(() => {\n            this.styleSheetContent = undefined;\n            this.hasFileIcons = undefined;\n            this.hasFolderIcons = undefined;\n            this.hidesExplorerArrows = undefined;\n            this.icons.clear();\n        }));\n\n        const uri = new URI(this.uri);\n        const result = await this.fileService.read(uri);\n        const content = result.value;\n        const json: RecursivePartial<PluginIconThemeDocument> = jsoncparser.parse(content, undefined, { disallowComments: false });\n        this.hidesExplorerArrows = !!json.hidesExplorerArrows;\n\n        const toUnwatch = this.fileService.watch(uri);\n        if (this.toUnload.disposed) {\n            toUnwatch.dispose();\n        } else {\n            this.toUnload.push(toUnwatch);\n            this.toUnload.push(this.fileService.onDidFilesChange(e => {\n                if (e.contains(uri, FileChangeType.ADDED) || e.contains(uri, FileChangeType.UPDATED)) {\n                    this.reload();\n                }\n            }));\n        }\n\n        const iconDefinitions = json.iconDefinitions;\n        if (!iconDefinitions) {\n            return;\n        }\n        const definitionSelectors = new Map<string, string[]>();\n        const acceptSelector = (themeType: ThemeType, definitionId: string, ...icons: string[]) => {\n            if (!iconDefinitions[definitionId]) {\n                return;\n            }\n            let selector = '';\n            for (const icon of icons) {\n                if (icon) {\n                    selector += '.' + icon;\n                    this.icons.add(icon);\n                }\n            }\n            if (!selector) {\n                return;\n            }\n            const selectors = definitionSelectors.get(definitionId) || [];\n            if (themeType !== 'dark') {\n                selector = '.theia-' + themeType + ' ' + selector;\n            }\n            selectors.push(selector + '::before');\n            definitionSelectors.set(definitionId, selectors);\n        };\n        this.collectSelectors(json, acceptSelector.bind(undefined, 'dark'));\n        if (json.light) {\n            this.collectSelectors(json.light, acceptSelector.bind(undefined, 'light'));\n        }\n        if (json.highContrast) {\n            this.collectSelectors(json.highContrast, acceptSelector.bind(undefined, 'hc'));\n        }\n\n        if (!this.icons.size) {\n            return;\n        }\n\n        const fonts = json.fonts;\n        if (Array.isArray(fonts)) {\n            for (const font of fonts) {\n                if (font) {\n                    let src = '';\n                    if (Array.isArray(font.src)) {\n                        for (const srcLocation of font.src) {\n                            if (srcLocation && srcLocation.path) {\n                                const cssUrl = this.toCSSUrl(srcLocation.path);\n                                if (cssUrl) {\n                                    if (src) {\n                                        src += ', ';\n                                    }\n                                    src += `${cssUrl} format('${srcLocation.format}')`;\n                                }\n                            }\n                        }\n                    }\n                    if (src) {\n                        this.styleSheetContent += `@font-face {\n    src: ${src};\n    font-family: '${font.id}';\n    font-weight: ${font.weight};\n    font-style: ${font.style};\n}\n`;\n                    }\n                }\n            }\n            const firstFont = fonts[0];\n            if (firstFont && firstFont.id) {\n                this.styleSheetContent += `.${this.fileIcon}::before, .${this.folderIcon}::before, .${this.rootFolderIcon}::before {\n    font-family: '${firstFont.id}';\n    font-size: ${firstFont.size || '150%'};\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    vertical-align: top;\n}\n`;\n            }\n        }\n\n        for (const definitionId of definitionSelectors.keys()) {\n            const iconDefinition = iconDefinitions[definitionId];\n            const selectors = definitionSelectors.get(definitionId);\n            if (selectors && iconDefinition) {\n                const cssUrl = this.toCSSUrl(iconDefinition.iconPath);\n                if (cssUrl) {\n                    this.styleSheetContent += `${selectors.join(', ')} {\n    content: ' ';\n    background-image: ${cssUrl};\n    background-size: 16px;\n    background-position: left center;\n    background-repeat: no-repeat;\n}\n`;\n                }\n                if (iconDefinition.fontCharacter || iconDefinition.fontColor) {\n                    let body = '';\n                    if (iconDefinition.fontColor) {\n                        body += ` color: ${iconDefinition.fontColor};`;\n                    }\n                    if (iconDefinition.fontCharacter) {\n                        body += ` content: '${iconDefinition.fontCharacter}';`;\n                    }\n                    if (iconDefinition.fontSize) {\n                        body += ` font-size: ${iconDefinition.fontSize};`;\n                    }\n                    if (iconDefinition.fontId) {\n                        body += ` font-family: ${iconDefinition.fontId};`;\n                    }\n                    this.styleSheetContent += `${selectors.join(', ')} {${body} }\\n`;\n                }\n            }\n        }\n    }\n\n    protected toCSSUrl(iconPath: string | undefined): string | undefined {\n        if (!iconPath) {\n            return undefined;\n        }\n        const iconUri = this.locationUri.resolve(iconPath);\n        const relativePath = this.packageRootUri.path.relative(iconUri.path.normalize());\n        return relativePath && `url('${new Endpoint({\n            path: `hostedPlugin/${this.pluginId}/${encodeURIComponent(relativePath.normalize().toString())}`\n        }).getRestUrl().toString()}')`;\n    }\n\n    protected escapeCSS(value: string): string {\n        value = value.replace(/[^\\-a-zA-Z0-9]/g, '-');\n        if (value.charAt(0).match(/[0-9\\-]/)) {\n            value = '-' + value;\n        }\n        return value;\n    }\n\n    protected readonly fileIcon = 'theia-plugin-file-icon';\n    protected readonly folderIcon = 'theia-plugin-folder-icon';\n    protected readonly folderExpandedIcon = 'theia-plugin-folder-expanded-icon';\n    protected readonly rootFolderIcon = 'theia-plugin-root-folder-icon';\n    protected readonly rootFolderExpandedIcon = 'theia-plugin-root-folder-expanded-icon';\n    protected folderNameIcon(folderName: string): string {\n        return 'theia-plugin-' + this.escapeCSS(folderName.toLowerCase()) + '-folder-name-icon';\n    }\n    protected expandedFolderNameIcon(folderName: string): string {\n        return 'theia-plugin-' + this.escapeCSS(folderName.toLowerCase()) + '-expanded-folder-name-icon';\n    }\n    protected fileNameIcon(fileName: string): string[] {\n        fileName = fileName.toLowerCase();\n        const extIndex = fileName.indexOf('.');\n        const icons = extIndex !== -1 ? this.fileExtensionIcon(fileName.substring(extIndex + 1)) : [];\n        icons.unshift('theia-plugin-' + this.escapeCSS(fileName) + '-file-name-icon');\n        return icons;\n    }\n    protected fileExtensionIcon(fileExtension: string): string[] {\n        fileExtension = fileExtension.toString();\n        const icons = [];\n        const segments = fileExtension.split('.');\n        if (segments.length) {\n            if (segments.length) {\n                for (let i = 0; i < segments.length; i++) {\n                    icons.push('theia-plugin-' + this.escapeCSS(segments.slice(i).join('.')) + '-ext-file-icon');\n                }\n                icons.push('theia-plugin-ext-file-icon'); // extra segment to increase file-ext score\n            }\n        }\n        return icons;\n    }\n    protected languageIcon(languageId: string): string {\n        return 'theia-plugin-' + this.escapeCSS(languageId) + '-lang-file-icon';\n    }\n\n    protected collectSelectors(\n        associations: RecursivePartial<PluginIconsAssociation>,\n        accept: (definitionId: string, ...icons: string[]) => void\n    ): void {\n        if (associations.folder) {\n            accept(associations.folder, this.folderIcon);\n            if (associations.folderExpanded === undefined) {\n                // Use the same icon for expanded state (issue #12727). Check for\n                // undefined folderExpanded property to allow for\n                // \"folderExpanded\": null in case a developer really wants that\n                accept(associations.folder, this.folderExpandedIcon);\n            }\n            this.hasFolderIcons = true;\n        }\n        if (associations.folderExpanded) {\n            accept(associations.folderExpanded, this.folderExpandedIcon);\n            this.hasFolderIcons = true;\n        }\n        const rootFolder = associations.rootFolder || associations.folder;\n        if (rootFolder) {\n            accept(rootFolder, this.rootFolderIcon);\n            this.hasFolderIcons = true;\n        }\n        const rootFolderExpanded = associations.rootFolderExpanded || associations.folderExpanded;\n        if (rootFolderExpanded) {\n            accept(rootFolderExpanded, this.rootFolderExpandedIcon);\n            this.hasFolderIcons = true;\n        }\n        if (associations.file) {\n            accept(associations.file, this.fileIcon);\n            this.hasFileIcons = true;\n        }\n        const folderNames = associations.folderNames;\n        if (folderNames) {\n            // eslint-disable-next-line guard-for-in\n            for (const folderName in folderNames) {\n                accept(folderNames[folderName]!, this.folderNameIcon(folderName), this.folderIcon);\n                this.hasFolderIcons = true;\n            }\n        }\n        const folderNamesExpanded = associations.folderNamesExpanded;\n        if (folderNamesExpanded) {\n            // eslint-disable-next-line guard-for-in\n            for (const folderName in folderNamesExpanded) {\n                accept(folderNamesExpanded[folderName]!, this.expandedFolderNameIcon(folderName), this.folderExpandedIcon);\n                this.hasFolderIcons = true;\n            }\n        }\n        const languageIds = associations.languageIds;\n        if (languageIds) {\n            if (!languageIds.jsonc && languageIds.json) {\n                languageIds.jsonc = languageIds.json;\n            }\n            // eslint-disable-next-line guard-for-in\n            for (const languageId in languageIds) {\n                accept(languageIds[languageId]!, this.languageIcon(languageId), this.fileIcon);\n                this.hasFileIcons = true;\n            }\n        }\n        const fileExtensions = associations.fileExtensions;\n        if (fileExtensions) {\n            // eslint-disable-next-line guard-for-in\n            for (const fileExtension in fileExtensions) {\n                accept(fileExtensions[fileExtension]!, ...this.fileExtensionIcon(fileExtension), this.fileIcon);\n                this.hasFileIcons = true;\n            }\n        }\n        const fileNames = associations.fileNames;\n        if (fileNames) {\n            // eslint-disable-next-line guard-for-in\n            for (const fileName in fileNames) {\n                accept(fileNames[fileName]!, ...this.fileNameIcon(fileName), this.fileIcon);\n                this.hasFileIcons = true;\n            }\n        }\n    }\n\n    /**\n     * This should be aligned with\n     * https://github.com/microsoft/vscode/blob/7cf4cca47aa025a590fc939af54932042302be63/src/vs/editor/common/services/getIconClasses.ts#L5\n     */\n    getIcon(element: URI | URIIconReference | FileStat | FileStatNode | WorkspaceRootNode): string {\n        let icon = '';\n        for (const className of this.getClassNames(element)) {\n            if (this.icons.has(className)) {\n                if (icon) {\n                    icon += ' ';\n                }\n                icon += className;\n            }\n        }\n        return icon;\n    }\n\n    protected getClassNames(element: URI | URIIconReference | FileStat | FileStatNode | WorkspaceRootNode): string[] {\n        if (WorkspaceRootNode.is(element)) {\n            const name = this.labelProvider.getName(element);\n            if (element.expanded) {\n                return [this.rootFolderExpandedIcon, this.expandedFolderNameIcon(name)];\n            }\n            return [this.rootFolderIcon, this.folderNameIcon(name)];\n        }\n        if (DirNode.is(element)) {\n            if (element.expanded) {\n                const name = this.labelProvider.getName(element);\n                return [this.folderExpandedIcon, this.expandedFolderNameIcon(name)];\n            }\n            return this.getFolderClassNames(element);\n        }\n        if (FileStatNode.is(element)) {\n            return this.getFileClassNames(element, element.fileStat.resource.toString());\n        }\n        if (FileStat.is(element)) {\n            if (element.isDirectory) {\n                return this.getFolderClassNames(element);\n            }\n            return this.getFileClassNames(element, element.resource.toString());\n        }\n        if (URIIconReference.is(element)) {\n            if (element.id === 'folder') {\n                return this.getFolderClassNames(element);\n            }\n            return this.getFileClassNames(element, element.uri && element.uri.toString());\n        }\n        return this.getFileClassNames(element, element.toString());\n    }\n\n    protected getFolderClassNames(element: object): string[] {\n        const name = this.labelProvider.getName(element);\n        return [this.folderIcon, this.folderNameIcon(name)];\n    }\n\n    protected getFileClassNames(element: object, uri?: string): string[] {\n        const name = this.labelProvider.getName(element);\n        const classNames = this.fileNameIcon(name);\n        if (uri) {\n            const parsedURI = new URI(uri);\n            const isRoot = this.workspaceService.getWorkspaceRootUri(new URI(uri))?.isEqual(parsedURI);\n            if (isRoot) {\n                classNames.unshift(this.rootFolderIcon);\n            } else {\n                classNames.unshift(this.fileIcon);\n            }\n            const language = StandaloneServices.get(ILanguageService).createByFilepathOrFirstLine(parsedURI['codeUri']);\n            classNames.push(this.languageIcon(language.languageId));\n        }\n        return classNames;\n    }\n\n}\n\n@injectable()\nexport class PluginIconThemeService implements LabelProviderContribution {\n\n    @inject(IconThemeService)\n    protected readonly iconThemeService: IconThemeService;\n\n    @inject(PluginIconThemeFactory)\n    protected readonly iconThemeFactory: PluginIconThemeFactory;\n\n    protected readonly onDidChangeEmitter = new Emitter<DidChangeLabelEvent>();\n    readonly onDidChange = this.onDidChangeEmitter.event;\n\n    protected fireDidChange(): void {\n        this.onDidChangeEmitter.fire({ affects: () => true });\n    }\n\n    register(contribution: IconThemeContribution, plugin: DeployedPlugin): Disposable {\n        const pluginId = getPluginId(plugin.metadata.model);\n        const packageUri = plugin.metadata.model.packageUri;\n        const iconTheme = this.iconThemeFactory({\n            id: contribution.id,\n            label: contribution.label || new URI(contribution.uri).path.base,\n            description: contribution.description,\n            uri: contribution.uri,\n            uiTheme: contribution.uiTheme,\n            pluginId,\n            packageUri\n        });\n        return new DisposableCollection(\n            iconTheme,\n            iconTheme.onDidChange(() => this.fireDidChange()),\n            this.iconThemeService.register(iconTheme)\n        );\n    }\n\n    canHandle(element: object): number {\n        const current = this.iconThemeService.getDefinition(this.iconThemeService.current);\n        if (current instanceof PluginIconTheme && (\n            (element instanceof URI && element.scheme === 'file') || URIIconReference.is(element) || FileStat.is(element) || FileStatNode.is(element)\n        )) {\n            return Number.MAX_SAFE_INTEGER;\n        }\n        return 0;\n    }\n\n    getIcon(element: URI | URIIconReference | FileStat | FileStatNode | WorkspaceRootNode): string | undefined {\n        const current = this.iconThemeService.getDefinition(this.iconThemeService.current);\n        if (current instanceof PluginIconTheme) {\n            return current.getIcon(element);\n        }\n        return undefined;\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { StorageMain } from '../../common/plugin-api-rpc';\nimport { PluginServer, PluginStorageKind } from '../../common/plugin-protocol';\nimport { KeysToAnyValues, KeysToKeysToAnyValue } from '../../common/types';\nimport { WorkspaceService } from '@theia/workspace/lib/browser/workspace-service';\n\nexport class StorageMainImpl implements StorageMain {\n\n    private readonly pluginServer: PluginServer;\n    private readonly workspaceService: WorkspaceService;\n\n    constructor(container: interfaces.Container) {\n        this.pluginServer = container.get(PluginServer);\n        this.workspaceService = container.get(WorkspaceService);\n    }\n\n    $set(key: string, value: KeysToAnyValues, isGlobal: boolean): Promise<boolean> {\n        return this.pluginServer.setStorageValue(key, value, this.toKind(isGlobal));\n    }\n\n    $get(key: string, isGlobal: boolean): Promise<KeysToAnyValues> {\n        return this.pluginServer.getStorageValue(key, this.toKind(isGlobal));\n    }\n\n    $getAll(isGlobal: boolean): Promise<KeysToKeysToAnyValue> {\n        return this.pluginServer.getAllStorageValues(this.toKind(isGlobal));\n    }\n\n    protected toKind(isGlobal: boolean): PluginStorageKind {\n        if (isGlobal) {\n            return undefined;\n        }\n        return {\n            workspace: this.workspaceService.workspace?.resource.toString(),\n            roots: this.workspaceService.tryGetRoots().map(root => root.resource.toString())\n        };\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2022 STMicroelectronics and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { injectable } from '@theia/core/shared/inversify';\n\n@injectable()\nexport class PluginTerminalRegistry {\n\n    startCallback: (id: string) => Promise<string>;\n\n    start(profileId: string): Promise<string> {\n        return this.startCallback(profileId);\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport {\n    PreferenceService,\n    PreferenceServiceImpl,\n    PreferenceScope,\n    PreferenceProviderProvider\n} from '@theia/core/lib/browser/preferences';\nimport { interfaces } from '@theia/core/shared/inversify';\nimport {\n    MAIN_RPC_CONTEXT,\n    PreferenceRegistryExt,\n    PreferenceRegistryMain,\n    PreferenceData,\n    PreferenceChangeExt,\n} from '../../common/plugin-api-rpc';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport { ConfigurationTarget } from '../../plugin/types-impl';\nimport { WorkspaceService } from '@theia/workspace/lib/browser';\nimport { FileStat } from '@theia/filesystem/lib/common/files';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\n\nexport function getPreferences(preferenceProviderProvider: PreferenceProviderProvider, rootFolders: FileStat[]): PreferenceData {\n    const folders = rootFolders.map(root => root.resource.toString());\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return PreferenceScope.getScopes().reduce((result: { [key: number]: any }, scope: PreferenceScope) => {\n        result[scope] = {};\n        const provider = preferenceProviderProvider(scope);\n        if (scope === PreferenceScope.Folder) {\n            for (const f of folders) {\n                const folderPrefs = provider.getPreferences(f);\n                result[scope][f] = folderPrefs;\n            }\n        } else {\n            result[scope] = provider.getPreferences();\n        }\n        return result;\n    }, {} as PreferenceData);\n}\n\nexport class PreferenceRegistryMainImpl implements PreferenceRegistryMain, Disposable {\n    private readonly proxy: PreferenceRegistryExt;\n    private readonly preferenceService: PreferenceService;\n\n    protected readonly toDispose = new DisposableCollection();\n\n    constructor(prc: RPCProtocol, container: interfaces.Container) {\n        this.proxy = prc.getProxy(MAIN_RPC_CONTEXT.PREFERENCE_REGISTRY_EXT);\n        this.preferenceService = container.get(PreferenceService);\n        const preferenceProviderProvider = container.get<PreferenceProviderProvider>(PreferenceProviderProvider);\n        const preferenceServiceImpl = container.get(PreferenceServiceImpl);\n        const workspaceService = container.get(WorkspaceService);\n\n        this.toDispose.push(preferenceServiceImpl.onPreferencesChanged(changes => {\n            // it HAS to be synchronous to propagate changes before update/remove response\n\n            const roots = workspaceService.tryGetRoots();\n            const data = getPreferences(preferenceProviderProvider, roots);\n            const eventData = Object.values(changes).map<PreferenceChangeExt>(({ scope, newValue, domain, preferenceName }) => {\n                const extScope = scope === PreferenceScope.User ? undefined : domain?.[0];\n                return { preferenceName, newValue, scope: extScope };\n            });\n            this.proxy.$acceptConfigurationChanged(data, eventData);\n        }));\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    async $updateConfigurationOption(target: boolean | ConfigurationTarget | undefined, key: string, value: any, resource?: string, withLanguageOverride?: boolean): Promise<void> {\n        const scope = this.parseConfigurationTarget(target, resource);\n        const effectiveKey = this.getEffectiveKey(key, scope, withLanguageOverride, resource);\n        await this.preferenceService.set(effectiveKey, value, scope, resource);\n    }\n\n    async $removeConfigurationOption(target: boolean | ConfigurationTarget | undefined, key: string, resource?: string, withLanguageOverride?: boolean): Promise<void> {\n        const scope = this.parseConfigurationTarget(target, resource);\n        const effectiveKey = this.getEffectiveKey(key, scope, withLanguageOverride, resource);\n        await this.preferenceService.set(effectiveKey, undefined, scope, resource);\n    }\n\n    private parseConfigurationTarget(target?: boolean | ConfigurationTarget, resource?: string): PreferenceScope {\n        if (typeof target === 'boolean') {\n            return target ? PreferenceScope.User : PreferenceScope.Workspace;\n        }\n        switch (target) {\n            case ConfigurationTarget.Global:\n                return PreferenceScope.User;\n            case ConfigurationTarget.Workspace:\n                return PreferenceScope.Workspace;\n            case ConfigurationTarget.WorkspaceFolder:\n                return PreferenceScope.Folder;\n            default:\n                return resource ? PreferenceScope.Folder : PreferenceScope.Workspace;\n        }\n    }\n\n    // If the caller does not set `withLanguageOverride = true`, we have to check whether the setting exists with that override already.\n    protected getEffectiveKey(key: string, scope: PreferenceScope, withLanguageOverride?: boolean, resource?: string): string {\n        if (withLanguageOverride) { return key; }\n        const overridden = this.preferenceService.overriddenPreferenceName(key);\n        if (!overridden) { return key; }\n        const value = this.preferenceService.inspectInScope(key, scope, resource, withLanguageOverride);\n        return value === undefined ? overridden.preferenceName : key;\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport { InputBoxOptions } from '@theia/plugin';\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport {\n    QuickOpenExt,\n    QuickOpenMain,\n    MAIN_RPC_CONTEXT,\n    TransferInputBox,\n    TransferQuickPickItems,\n    TransferQuickInput,\n    TransferQuickInputButton,\n    TransferQuickPickItemValue\n} from '../../common/plugin-api-rpc';\nimport {\n    InputOptions,\n    PickOptions,\n    QuickInputButton,\n    QuickInputButtonHandle,\n    QuickInputService\n} from '@theia/core/lib/browser';\nimport { DisposableCollection, Disposable } from '@theia/core/lib/common/disposable';\nimport { CancellationToken } from '@theia/core/lib/common/cancellation';\nimport { MonacoQuickInputService } from '@theia/monaco/lib/browser/monaco-quick-input-service';\nimport { QuickInputButtons } from '../../plugin/types-impl';\nimport { getIconPathOrClass } from '../../plugin/quick-open';\nimport * as monaco from '@theia/monaco-editor-core';\nimport { IQuickPickItem, IQuickInput } from '@theia/monaco-editor-core/esm/vs/base/parts/quickinput/common/quickInput';\nimport { ThemeIcon } from '@theia/monaco-editor-core/esm/vs/platform/theme/common/themeService';\n\nexport interface QuickInputSession {\n    input: IQuickInput;\n    handlesToItems: Map<number, TransferQuickPickItems>;\n}\n\nexport class QuickOpenMainImpl implements QuickOpenMain, Disposable {\n\n    private quickInputService: QuickInputService;\n    private proxy: QuickOpenExt;\n    private delegate: MonacoQuickInputService;\n    private readonly items: Record<number, {\n        resolve(items: TransferQuickPickItems[]): void;\n        reject(error: Error): void;\n    }> = {};\n\n    protected readonly toDispose = new DisposableCollection();\n\n    constructor(rpc: RPCProtocol, container: interfaces.Container) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.QUICK_OPEN_EXT);\n        this.delegate = container.get(MonacoQuickInputService);\n        this.quickInputService = container.get(QuickInputService);\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    async $show(instance: number, options: PickOptions<TransferQuickPickItemValue>, token: CancellationToken): Promise<number | number[] | undefined> {\n        const contents = new Promise<TransferQuickPickItems[]>((resolve, reject) => {\n            this.items[instance] = { resolve, reject };\n        });\n\n        options = {\n            ...options,\n            onDidFocus: (el: any) => {\n                if (el) {\n                    this.proxy.$onItemSelected((<TransferQuickPickItems>el).handle);\n                }\n            }\n        };\n\n        const result = await this.delegate.pick<TransferQuickPickItemValue>(contents, options, token);\n\n        if (Array.isArray(result)) {\n            return result.map(({ handle }) => handle);\n        } else if (result) {\n            return result.handle;\n        }\n        return undefined;\n    }\n\n    $setItems(instance: number, items: TransferQuickPickItems[]): Promise<any> {\n        if (this.items[instance]) {\n            this.items[instance].resolve(items);\n            delete this.items[instance];\n        }\n        return Promise.resolve();\n    }\n\n    $setError(instance: number, error: Error): Promise<void> {\n        if (this.items[instance]) {\n            this.items[instance].reject(error);\n            delete this.items[instance];\n        }\n        return Promise.resolve();\n    }\n\n    $input(options: InputBoxOptions, validateInput: boolean, token: CancellationToken): Promise<string | undefined> {\n        const inputOptions: InputOptions = Object.create(null);\n\n        if (options) {\n            inputOptions.title = options.title;\n            inputOptions.password = options.password;\n            inputOptions.placeHolder = options.placeHolder;\n            inputOptions.valueSelection = options.valueSelection;\n            inputOptions.prompt = options.prompt;\n            inputOptions.value = options.value;\n            inputOptions.ignoreFocusLost = options.ignoreFocusOut;\n        }\n\n        if (validateInput) {\n            inputOptions.validateInput = (val: string) => this.proxy.$validateInput(val);\n        }\n\n        return this.quickInputService?.input(inputOptions, token);\n    }\n\n    async $showInputBox(options: TransferInputBox, validateInput: boolean): Promise<string | undefined> {\n        return new Promise<string | undefined>((resolve, reject) => {\n            const sessionId = options.id;\n            const toDispose = new DisposableCollection();\n\n            const inputBox = this.quickInputService?.createInputBox();\n            inputBox.prompt = options.prompt;\n            inputBox.placeholder = options.placeHolder;\n            inputBox.value = options.value;\n            if (options.busy) {\n                inputBox.busy = options.busy;\n            }\n            if (options.enabled) {\n                inputBox.enabled = options.enabled;\n            }\n            inputBox.ignoreFocusOut = options.ignoreFocusOut;\n            inputBox.contextKey = options.contextKey;\n            if (options.password) {\n                inputBox.password = options.password;\n            }\n            inputBox.step = options.step;\n            inputBox.title = options.title;\n            inputBox.description = options.description;\n            inputBox.totalSteps = options.totalSteps;\n            inputBox.buttons = options.buttons ? this.convertToQuickInputButtons(options.buttons) : [];\n            inputBox.validationMessage = options.validationMessage;\n            if (validateInput) {\n                options.validateInput = (val: string) => {\n                    this.proxy.$validateInput(val);\n                };\n            }\n\n            toDispose.push(inputBox.onDidAccept(() => {\n                this.proxy.$acceptOnDidAccept(sessionId);\n                resolve(inputBox.value);\n            }));\n            toDispose.push(inputBox.onDidChangeValue((value: string) => {\n                this.proxy.$acceptDidChangeValue(sessionId, value);\n                inputBox.validationMessage = options.validateInput(value);\n            }));\n            toDispose.push(inputBox.onDidTriggerButton((button: any) => {\n                this.proxy.$acceptOnDidTriggerButton(sessionId, button);\n            }));\n\n            toDispose.push(inputBox.onDidHide(() => {\n                if (toDispose.disposed) {\n                    return;\n                }\n                this.proxy.$acceptOnDidHide(sessionId);\n                toDispose.dispose();\n                resolve(undefined);\n            }));\n            this.toDispose.push(toDispose);\n\n            inputBox.show();\n        });\n    }\n\n    private sessions = new Map<number, QuickInputSession>();\n\n    $createOrUpdate(params: TransferQuickInput): Promise<void> {\n        const sessionId = params.id;\n        let session: QuickInputSession;\n        const candidate = this.sessions.get(sessionId);\n        if (!candidate) {\n            if (params.type === 'quickPick') {\n                const quickPick = this.quickInputService.createQuickPick();\n                quickPick.onDidAccept(() => {\n                    this.proxy.$acceptOnDidAccept(sessionId);\n                });\n                quickPick.onDidChangeActive((items: Array<IQuickPickItem>) => {\n                    this.proxy.$onDidChangeActive(sessionId, items.map(item => (item as TransferQuickPickItems).handle));\n                });\n                quickPick.onDidChangeSelection((items: Array<IQuickPickItem>) => {\n                    this.proxy.$onDidChangeSelection(sessionId, items.map(item => (item as TransferQuickPickItems).handle));\n                });\n                quickPick.onDidTriggerButton((button: QuickInputButtonHandle) => {\n                    this.proxy.$acceptOnDidTriggerButton(sessionId, button);\n                });\n                quickPick.onDidTriggerItemButton(e => {\n                    this.proxy.$onDidTriggerItemButton(sessionId, (e.item as TransferQuickPickItems).handle, (e.button as TransferQuickPickItems).handle);\n                });\n                quickPick.onDidChangeValue((value: string) => {\n                    this.proxy.$acceptDidChangeValue(sessionId, value);\n                });\n                quickPick.onDidHide(() => {\n                    this.proxy.$acceptOnDidHide(sessionId);\n                });\n                session = {\n                    input: quickPick,\n                    handlesToItems: new Map()\n                };\n            } else {\n                const inputBox = this.quickInputService.createInputBox();\n                inputBox.onDidAccept(() => {\n                    this.proxy.$acceptOnDidAccept(sessionId);\n                });\n                inputBox.onDidTriggerButton((button: QuickInputButtonHandle) => {\n                    this.proxy.$acceptOnDidTriggerButton(sessionId, button);\n                });\n                inputBox.onDidChangeValue((value: string) => {\n                    this.proxy.$acceptDidChangeValue(sessionId, value);\n                });\n                inputBox.onDidHide(() => {\n                    this.proxy.$acceptOnDidHide(sessionId);\n                });\n                session = {\n                    input: inputBox,\n                    handlesToItems: new Map()\n                };\n            }\n            this.sessions.set(sessionId, session);\n        } else {\n            session = candidate;\n        }\n        if (session) {\n            const { input, handlesToItems } = session;\n            for (const param in params) {\n                if (param === 'id' || param === 'type') {\n                    continue;\n                }\n                if (param === 'visible') {\n                    if (params.visible) {\n                        input.show();\n                    } else {\n                        input.hide();\n                    }\n                } else if (param === 'items') {\n                    handlesToItems.clear();\n                    params[param].forEach((item: TransferQuickPickItems) => {\n                        handlesToItems.set(item.handle, item);\n                    });\n                    (input as any)[param] = params[param];\n                } else if (param === 'activeItems' || param === 'selectedItems') {\n                    (input as any)[param] = params[param]\n                        .filter((handle: number) => handlesToItems.has(handle))\n                        .map((handle: number) => handlesToItems.get(handle));\n                } else if (param === 'buttons') {\n                    (input as any)[param] = params.buttons!.map(button => {\n                        if (button.handle === -1) {\n                            return this.quickInputService.backButton;\n                        }\n                        const { iconPath, tooltip, handle } = button;\n                        if ('id' in iconPath) {\n                            return {\n                                iconClass: ThemeIcon.asClassName(iconPath),\n                                tooltip,\n                                handle\n                            };\n                        } else {\n                            const monacoIconPath = (iconPath as unknown as { light: monaco.Uri, dark: monaco.Uri });\n                            return {\n                                iconPath: {\n                                    dark: monaco.Uri.revive(monacoIconPath.dark),\n                                    light: monacoIconPath.light && monaco.Uri.revive(monacoIconPath.light)\n                                },\n                                tooltip,\n                                handle\n                            };\n                        }\n                    });\n                } else {\n                    (input as any)[param] = params[param];\n                }\n            }\n        }\n\n        return Promise.resolve(undefined);\n    }\n\n    $hide(): void {\n        this.delegate.hide();\n    }\n\n    $dispose(sessionId: number): Promise<void> {\n        const session = this.sessions.get(sessionId);\n        if (session) {\n            session.input.dispose();\n            this.sessions.delete(sessionId);\n        }\n        return Promise.resolve(undefined);\n    }\n\n    private convertToQuickInputButtons(buttons: Array<TransferQuickInputButton>): Array<QuickInputButton> {\n        return buttons.map((button, i) => ({\n            ...getIconPathOrClass(button),\n            tooltip: button.tooltip,\n            handle: button === QuickInputButtons.Back ? -1 : i,\n        } as QuickInputButton));\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2019-2021 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n// code copied and modified from https://github.com/microsoft/vscode/blob/1.52.1/src/vs/workbench/api/browser/mainThreadSCM.ts\n\nimport {\n    MAIN_RPC_CONTEXT,\n    ScmExt,\n    SourceControlGroupFeatures,\n    ScmMain,\n    SourceControlProviderFeatures,\n    ScmRawResourceSplices, ScmRawResourceGroup\n} from '../../common/plugin-api-rpc';\nimport { ScmProvider, ScmResource, ScmResourceDecorations, ScmResourceGroup, ScmCommand } from '@theia/scm/lib/browser/scm-provider';\nimport { ScmRepository } from '@theia/scm/lib/browser/scm-repository';\nimport { ScmService } from '@theia/scm/lib/browser/scm-service';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { Emitter, Event } from '@theia/core/lib/common/event';\nimport { DisposableCollection } from '@theia/core/lib/common/disposable';\nimport URI from '@theia/core/lib/common/uri';\nimport { URI as vscodeURI } from '@theia/core/shared/vscode-uri';\nimport { Splice } from '../../common/arrays';\nimport { UriComponents } from '../../common/uri-components';\nimport { ColorRegistry } from '@theia/core/lib/browser/color-registry';\nimport { PluginSharedStyle } from './plugin-shared-style';\nimport { ThemeIcon } from '@theia/monaco-editor-core/esm/vs/platform/theme/common/themeService';\nimport { IconUrl } from '../../common';\n\nexport class PluginScmResourceGroup implements ScmResourceGroup {\n\n    readonly resources: ScmResource[] = [];\n\n    private readonly onDidSpliceEmitter = new Emitter<Splice<ScmResource>>();\n    readonly onDidSplice = this.onDidSpliceEmitter.event;\n\n    get hideWhenEmpty(): boolean { return !!this.features.hideWhenEmpty; }\n\n    private readonly onDidChangeEmitter = new Emitter<void>();\n    readonly onDidChange: Event<void> = this.onDidChangeEmitter.event;\n\n    constructor(\n        readonly handle: number,\n        public provider: PluginScmProvider,\n        public features: SourceControlGroupFeatures,\n        public label: string,\n        public id: string\n    ) { }\n\n    splice(start: number, deleteCount: number, toInsert: ScmResource[]): void {\n        this.resources.splice(start, deleteCount, ...toInsert);\n        this.onDidSpliceEmitter.fire({ start, deleteCount, toInsert });\n    }\n\n    updateGroup(features: SourceControlGroupFeatures): void {\n        this.features = { ...this.features, ...features };\n        this.onDidChangeEmitter.fire();\n    }\n\n    updateGroupLabel(label: string): void {\n        this.label = label;\n        this.onDidChangeEmitter.fire();\n    }\n\n    dispose(): void { }\n}\n\nexport class PluginScmResource implements ScmResource {\n\n    constructor(\n        private readonly proxy: ScmExt,\n        private readonly sourceControlHandle: number,\n        private readonly groupHandle: number,\n        readonly handle: number,\n        readonly sourceUri: URI,\n        readonly group: PluginScmResourceGroup,\n        readonly decorations: ScmResourceDecorations,\n        readonly contextValue: string | undefined,\n        readonly command: ScmCommand | undefined\n    ) { }\n\n    open(): Promise<void> {\n        return this.proxy.$executeResourceCommand(this.sourceControlHandle, this.groupHandle, this.handle);\n    }\n}\n\nexport class PluginScmProvider implements ScmProvider {\n\n    private _id = this.contextValue;\n    get id(): string { return this._id; }\n\n    readonly groups: PluginScmResourceGroup[] = [];\n    private readonly groupsByHandle: { [handle: number]: PluginScmResourceGroup; } = Object.create(null);\n\n    private readonly onDidChangeResourcesEmitter = new Emitter<void>();\n    readonly onDidChangeResources: Event<void> = this.onDidChangeResourcesEmitter.event;\n\n    private features: SourceControlProviderFeatures = {};\n\n    get handle(): number { return this._handle; }\n    get label(): string { return this._label; }\n    get rootUri(): string { return this._rootUri ? this._rootUri.toString() : ''; }\n    get contextValue(): string { return this._contextValue; }\n\n    get commitTemplate(): string { return this.features.commitTemplate || ''; }\n    get acceptInputCommand(): ScmCommand | undefined {\n        const command = this.features.acceptInputCommand;\n        if (command) {\n            const scmCommand: ScmCommand = command;\n            scmCommand.command = command.id;\n            return scmCommand;\n        }\n    }\n    get statusBarCommands(): ScmCommand[] | undefined {\n        const commands = this.features.statusBarCommands;\n        return commands?.map(command => {\n            const scmCommand: ScmCommand = command;\n            scmCommand.command = command.id;\n            return scmCommand;\n        });\n    }\n    get count(): number | undefined { return this.features.count; }\n\n    private readonly onDidChangeCommitTemplateEmitter = new Emitter<string>();\n    readonly onDidChangeCommitTemplate: Event<string> = this.onDidChangeCommitTemplateEmitter.event;\n\n    private readonly onDidChangeStatusBarCommandsEmitter = new Emitter<ScmCommand[]>();\n    get onDidChangeStatusBarCommands(): Event<ScmCommand[]> { return this.onDidChangeStatusBarCommandsEmitter.event; }\n\n    private readonly onDidChangeEmitter = new Emitter<void>();\n    readonly onDidChange: Event<void> = this.onDidChangeEmitter.event;\n\n    constructor(\n        private readonly proxy: ScmExt,\n        private readonly colors: ColorRegistry,\n        private readonly sharedStyle: PluginSharedStyle,\n        private readonly _handle: number,\n        private readonly _contextValue: string,\n        private readonly _label: string,\n        private readonly _rootUri: vscodeURI | undefined,\n        private disposables: DisposableCollection\n    ) { }\n\n    updateSourceControl(features: SourceControlProviderFeatures): void {\n        this.features = { ...this.features, ...features };\n        this.onDidChangeEmitter.fire();\n\n        if (typeof features.commitTemplate !== 'undefined') {\n            this.onDidChangeCommitTemplateEmitter.fire(this.commitTemplate!);\n        }\n\n        if (typeof features.statusBarCommands !== 'undefined') {\n            this.onDidChangeStatusBarCommandsEmitter.fire(this.statusBarCommands!);\n        }\n    }\n\n    registerGroups(resourceGroups: ScmRawResourceGroup[]): void {\n        const groups = resourceGroups.map(resourceGroup => {\n            const { handle, id, label, features } = resourceGroup;\n            const group = new PluginScmResourceGroup(\n                handle,\n                this,\n                features,\n                label,\n                id\n            );\n\n            this.groupsByHandle[handle] = group;\n            return group;\n        });\n\n        this.groups.splice(this.groups.length, 0, ...groups);\n    }\n\n    updateGroup(handle: number, features: SourceControlGroupFeatures): void {\n        const group = this.groupsByHandle[handle];\n\n        if (!group) {\n            return;\n        }\n\n        group.updateGroup(features);\n    }\n\n    updateGroupLabel(handle: number, label: string): void {\n        const group = this.groupsByHandle[handle];\n\n        if (!group) {\n            return;\n        }\n\n        group.updateGroupLabel(label);\n    }\n\n    spliceGroupResourceStates(splices: ScmRawResourceSplices[]): void {\n        for (const splice of splices) {\n            const groupHandle = splice.handle;\n            const groupSlices = splice.splices;\n            const group = this.groupsByHandle[groupHandle];\n\n            if (!group) {\n                console.warn(`SCM group ${groupHandle} not found in provider ${this.label}`);\n                continue;\n            }\n\n            // reverse the splices sequence in order to apply them correctly\n            groupSlices.reverse();\n\n            for (const groupSlice of groupSlices) {\n                const { start, deleteCount, rawResources } = groupSlice;\n                const resources = rawResources.map(rawResource => {\n                    const { handle, sourceUri, icons, tooltip, strikeThrough, faded, contextValue, command } = rawResource;\n                    const icon = this.toIconClass(icons[0]);\n                    const iconDark = this.toIconClass(icons[1]) || icon;\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    const colorVariable = (rawResource as any).colorId && this.colors.toCssVariableName((rawResource as any).colorId);\n                    const decorations = {\n                        icon,\n                        iconDark,\n                        tooltip,\n                        strikeThrough,\n                        // TODO remove the letter and colorId fields when the FileDecorationProvider is applied, see https://github.com/eclipse-theia/theia/pull/8911\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        letter: (rawResource as any).letter || '',\n                        color: colorVariable && `var(${colorVariable})`,\n                        faded\n                    } as ScmResourceDecorations;\n\n                    return new PluginScmResource(\n                        this.proxy,\n                        this.handle,\n                        groupHandle,\n                        handle,\n                        new URI(vscodeURI.revive(sourceUri)),\n                        group,\n                        decorations,\n                        contextValue || undefined,\n                        command\n                    );\n                });\n\n                group.splice(start, deleteCount, resources);\n            }\n        }\n\n        this.onDidChangeResourcesEmitter.fire();\n    }\n\n    private toIconClass(icon: IconUrl | ThemeIcon | undefined): string | undefined {\n        if (!icon) {\n            return undefined;\n        }\n        if (ThemeIcon.isThemeIcon(icon)) {\n            return ThemeIcon.asClassName(icon);\n        }\n        const reference = this.sharedStyle.toIconClass(icon);\n        this.disposables.push(reference);\n        return reference.object.iconClass;\n    }\n\n    unregisterGroup(handle: number): void {\n        const group = this.groupsByHandle[handle];\n\n        if (!group) {\n            return;\n        }\n\n        delete this.groupsByHandle[handle];\n        this.groups.splice(this.groups.indexOf(group), 1);\n    }\n\n    dispose(): void { }\n}\n\nexport class ScmMainImpl implements ScmMain {\n\n    private readonly proxy: ScmExt;\n    private readonly scmService: ScmService;\n    private repositories = new Map<number, ScmRepository>();\n    private repositoryDisposables = new Map<number, DisposableCollection>();\n    private readonly disposables = new DisposableCollection();\n    private readonly colors: ColorRegistry;\n    private readonly sharedStyle: PluginSharedStyle;\n\n    constructor(rpc: RPCProtocol, container: interfaces.Container) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.SCM_EXT);\n        this.scmService = container.get(ScmService);\n        this.colors = container.get(ColorRegistry);\n        this.sharedStyle = container.get(PluginSharedStyle);\n    }\n\n    dispose(): void {\n        this.repositories.forEach(r => r.dispose());\n        this.repositories.clear();\n\n        this.repositoryDisposables.forEach(d => d.dispose());\n        this.repositoryDisposables.clear();\n\n        this.disposables.dispose();\n    }\n\n    async $registerSourceControl(handle: number, id: string, label: string, rootUri: UriComponents | undefined): Promise<void> {\n        const provider = new PluginScmProvider(this.proxy, this.colors, this.sharedStyle, handle, id, label, rootUri ? vscodeURI.revive(rootUri) : undefined, this.disposables);\n        const repository = this.scmService.registerScmProvider(provider, {\n            input: {\n                validator: async value => {\n                    const result = await this.proxy.$validateInput(handle, value, value.length);\n                    return result && { message: result[0], type: result[1] };\n                }\n            }\n        }\n        );\n        this.repositories.set(handle, repository);\n\n        const disposables = new DisposableCollection(\n            this.scmService.onDidChangeSelectedRepository(r => {\n                if (r === repository) {\n                    this.proxy.$setSelectedSourceControl(handle);\n                }\n            }),\n            repository.input.onDidChange(() => this.proxy.$onInputBoxValueChange(handle, repository.input.value))\n        );\n\n        if (this.scmService.selectedRepository === repository) {\n            setTimeout(() => this.proxy.$setSelectedSourceControl(handle), 0);\n        }\n\n        if (repository.input.value) {\n            setTimeout(() => this.proxy.$onInputBoxValueChange(handle, repository.input.value), 0);\n        }\n\n        this.repositoryDisposables.set(handle, disposables);\n    }\n\n    async $updateSourceControl(handle: number, features: SourceControlProviderFeatures): Promise<void> {\n        const repository = this.repositories.get(handle);\n\n        if (!repository) {\n            return;\n        }\n\n        const provider = repository.provider as PluginScmProvider;\n        provider.updateSourceControl(features);\n    }\n\n    async $unregisterSourceControl(handle: number): Promise<void> {\n        const repository = this.repositories.get(handle);\n\n        if (!repository) {\n            return;\n        }\n\n        this.repositoryDisposables.get(handle)!.dispose();\n        this.repositoryDisposables.delete(handle);\n\n        repository.dispose();\n        this.repositories.delete(handle);\n    }\n\n    $registerGroups(sourceControlHandle: number, groups: ScmRawResourceGroup[], splices: ScmRawResourceSplices[]): void {\n        const repository = this.repositories.get(sourceControlHandle);\n\n        if (!repository) {\n            return;\n        }\n\n        const provider = repository.provider as PluginScmProvider;\n        provider.registerGroups(groups);\n        provider.spliceGroupResourceStates(splices);\n    }\n\n    $updateGroup(sourceControlHandle: number, groupHandle: number, features: SourceControlGroupFeatures): void {\n        const repository = this.repositories.get(sourceControlHandle);\n\n        if (!repository) {\n            return;\n        }\n\n        const provider = repository.provider as PluginScmProvider;\n        provider.updateGroup(groupHandle, features);\n    }\n\n    $updateGroupLabel(sourceControlHandle: number, groupHandle: number, label: string): void {\n        const repository = this.repositories.get(sourceControlHandle);\n\n        if (!repository) {\n            return;\n        }\n\n        const provider = repository.provider as PluginScmProvider;\n        provider.updateGroupLabel(groupHandle, label);\n    }\n\n    $spliceResourceStates(sourceControlHandle: number, splices: ScmRawResourceSplices[]): void {\n        const repository = this.repositories.get(sourceControlHandle);\n\n        if (!repository) {\n            return;\n        }\n\n        const provider = repository.provider as PluginScmProvider;\n        provider.spliceGroupResourceStates(splices);\n    }\n\n    $unregisterGroup(sourceControlHandle: number, handle: number): void {\n        const repository = this.repositories.get(sourceControlHandle);\n\n        if (!repository) {\n            return;\n        }\n\n        const provider = repository.provider as PluginScmProvider;\n        provider.unregisterGroup(handle);\n    }\n\n    $setInputBoxValue(sourceControlHandle: number, value: string): void {\n        const repository = this.repositories.get(sourceControlHandle);\n\n        if (!repository) {\n            return;\n        }\n\n        repository.input.value = value;\n    }\n\n    $setInputBoxPlaceholder(sourceControlHandle: number, placeholder: string): void {\n        const repository = this.repositories.get(sourceControlHandle);\n\n        if (!repository) {\n            return;\n        }\n\n        repository.input.placeholder = placeholder;\n    }\n\n    $setInputBoxVisible(sourceControlHandle: number, visible: boolean): void {\n        const repository = this.repositories.get(sourceControlHandle);\n\n        if (!repository) {\n            return;\n        }\n\n        repository.input.visible = visible;\n    }\n\n    $setInputBoxEnabled(sourceControlHandle: number, enabled: boolean): void {\n        const repository = this.repositories.get(sourceControlHandle);\n\n        if (!repository) {\n            return;\n        }\n\n        repository.input.enabled = enabled;\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2021 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n// code copied and modified from https://github.com/microsoft/vscode/blob/1.55.2/src/vs/workbench/api/browser/mainThreadSecretState.ts\n\nimport { SecretsExt, SecretsMain } from '../../common/plugin-api-rpc';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { MAIN_RPC_CONTEXT } from '../../common';\nimport { CredentialsService } from '@theia/core/lib/browser/credentials-service';\n\nexport class SecretsMainImpl implements SecretsMain {\n\n    private readonly proxy: SecretsExt;\n    private readonly credentialsService: CredentialsService;\n\n    constructor(rpc: RPCProtocol, container: interfaces.Container) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.SECRETS_EXT);\n        this.credentialsService = container.get(CredentialsService);\n        this.credentialsService.onDidChangePassword(e => {\n            const extensionId = e.service.substring(window.location.hostname.length + 1);\n            this.proxy.$onDidChangePassword({ extensionId, key: e.account });\n        });\n    }\n\n    private static getFullKey(extensionId: string): string {\n        return `${window.location.hostname}-${extensionId}`;\n    }\n\n    async $getPassword(extensionId: string, key: string): Promise<string | undefined> {\n        const fullKey = SecretsMainImpl.getFullKey(extensionId);\n        const passwordData = await this.credentialsService.getPassword(fullKey, key);\n\n        if (passwordData) {\n            try {\n                const data = JSON.parse(passwordData);\n                if (data.extensionId === extensionId) {\n                    return data.content;\n                }\n            } catch (e) {\n                throw new Error('Cannot get password');\n            }\n        }\n\n        return undefined;\n    }\n\n    async $setPassword(extensionId: string, key: string, value: string): Promise<void> {\n        const fullKey = SecretsMainImpl.getFullKey(extensionId);\n        const passwordData = JSON.stringify({\n            extensionId,\n            content: value\n        });\n        return this.credentialsService.setPassword(fullKey, key, passwordData);\n    }\n\n    async $deletePassword(extensionId: string, key: string): Promise<void> {\n        try {\n            const fullKey = SecretsMainImpl.getFullKey(extensionId);\n            await this.credentialsService.deletePassword(fullKey, key);\n        } catch (e) {\n            throw new Error('Cannot delete password');\n        }\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\nimport * as types from '../../plugin/types-impl';\nimport { StatusBarMessageRegistryMain } from '../../common/plugin-api-rpc';\nimport { StatusBar, StatusBarAlignment, StatusBarEntry } from '@theia/core/lib/browser/status-bar/status-bar';\nimport { ColorRegistry } from '@theia/core/lib/browser/color-registry';\nimport { MarkdownString } from '@theia/core/lib/common/markdown-rendering';\n\nexport class StatusBarMessageRegistryMainImpl implements StatusBarMessageRegistryMain, Disposable {\n    private readonly delegate: StatusBar;\n    private readonly entries = new Map<string, StatusBarEntry>();\n    private readonly toDispose = new DisposableCollection(\n        Disposable.create(() => { /* mark as not disposed */ })\n    );\n\n    protected readonly colorRegistry: ColorRegistry;\n\n    constructor(container: interfaces.Container) {\n        this.delegate = container.get(StatusBar);\n        this.colorRegistry = container.get(ColorRegistry);\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    async $setMessage(id: string,\n        name: string | undefined,\n        text: string | undefined,\n        priority: number,\n        alignment: number,\n        color: string | undefined,\n        backgroundColor: string | undefined,\n        tooltip: string | MarkdownString | undefined,\n        command: string | undefined,\n        accessibilityInformation: types.AccessibilityInformation,\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        args: any[] | undefined): Promise<void> {\n        const ariaLabel = accessibilityInformation?.label;\n        const role = accessibilityInformation?.role;\n\n        const entry = {\n            name,\n            text: text || '',\n            ariaLabel,\n            role,\n            priority,\n            alignment: alignment === types.StatusBarAlignment.Left ? StatusBarAlignment.LEFT : StatusBarAlignment.RIGHT,\n            color: color && (this.colorRegistry.getCurrentColor(color) || color),\n            // In contrast to color, the backgroundColor must be a theme color. Thus, do not hand in the plain string if it cannot be resolved.\n            backgroundColor: backgroundColor && (this.colorRegistry.getCurrentColor(backgroundColor)),\n            tooltip,\n            command,\n            accessibilityInformation,\n            args\n        };\n\n        this.entries.set(id, entry);\n        await this.delegate.setElement(id, entry);\n        if (this.toDispose.disposed) {\n            this.$dispose(id);\n        } else {\n            this.toDispose.push(Disposable.create(() => this.$dispose(id)));\n        }\n    }\n\n    $dispose(id: string): void {\n        const entry = this.entries.get(id);\n        if (entry) {\n            this.entries.delete(id);\n            this.delegate.removeElement(id);\n        }\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2022 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { ApplicationShell, PINNED_CLASS, Saveable, TabBar, Title, ViewContainer, Widget } from '@theia/core/lib/browser';\nimport { AnyInputDto, MAIN_RPC_CONTEXT, TabDto, TabGroupDto, TabInputKind, TabModelOperationKind, TabsExt, TabsMain } from '../../../common/plugin-api-rpc';\nimport { RPCProtocol } from '../../../common/rpc-protocol';\nimport { EditorPreviewWidget } from '@theia/editor-preview/lib/browser/editor-preview-widget';\nimport { Disposable } from '@theia/core/shared/vscode-languageserver-protocol';\nimport { MonacoDiffEditor } from '@theia/monaco/lib/browser/monaco-diff-editor';\nimport { toUriComponents } from '../hierarchy/hierarchy-types-converters';\nimport { TerminalWidget } from '@theia/terminal/lib/browser/base/terminal-widget';\nimport { DisposableCollection } from '@theia/core';\n\ninterface TabInfo {\n    tab: TabDto;\n    tabIndex: number;\n    group: TabGroupDto;\n}\n\nexport class TabsMainImpl implements TabsMain, Disposable {\n\n    private readonly proxy: TabsExt;\n    private tabGroupModel = new Map<TabBar<Widget>, TabGroupDto>();\n    private tabInfoLookup = new Map<Title<Widget>, TabInfo>();\n\n    private applicationShell: ApplicationShell;\n\n    private disposableTabBarListeners: DisposableCollection = new DisposableCollection();\n    private toDisposeOnDestroy: DisposableCollection = new DisposableCollection();\n\n    private groupIdCounter = 0;\n    private currentActiveGroup: TabGroupDto;\n\n    private tabGroupChanged: boolean = false;\n\n    constructor(\n        rpc: RPCProtocol,\n        container: interfaces.Container\n    ) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.TABS_EXT);\n\n        this.applicationShell = container.get(ApplicationShell);\n        this.createTabsModel();\n\n        const tabBars = this.applicationShell.mainPanel.tabBars();\n        for (let tabBar; tabBar = tabBars.next();) {\n            this.attachListenersToTabBar(tabBar);\n        }\n\n        this.toDisposeOnDestroy.push(\n            this.applicationShell.mainPanelRenderer.onDidCreateTabBar(tabBar => {\n                this.attachListenersToTabBar(tabBar);\n                this.onTabGroupCreated(tabBar);\n            })\n        );\n\n        this.connectToSignal(this.toDisposeOnDestroy, this.applicationShell.mainPanel.widgetAdded, (mainPanel, widget) => {\n            if (this.tabGroupChanged || this.tabGroupModel.size === 0) {\n                this.tabGroupChanged = false;\n                this.createTabsModel();\n                // tab Open event is done in backend\n            } else {\n                const tabBar = mainPanel.findTabBar(widget.title)!;\n                const oldTabInfo = this.tabInfoLookup.get(widget.title);\n                const group = this.tabGroupModel.get(tabBar);\n                if (group !== oldTabInfo?.group) {\n                    if (oldTabInfo) {\n                        this.onTabClosed(oldTabInfo, widget.title);\n                    }\n\n                    this.onTabCreated(tabBar, { index: tabBar.titles.indexOf(widget.title), title: widget.title });\n                }\n            }\n        });\n\n        this.connectToSignal(this.toDisposeOnDestroy, this.applicationShell.mainPanel.widgetRemoved, (mainPanel, widget) => {\n            if (!(widget instanceof TabBar)) {\n                const tabInfo = this.getOrRebuildModel(this.tabInfoLookup, widget.title)!;\n                this.onTabClosed(tabInfo, widget.title);\n                if (this.tabGroupChanged) {\n                    this.tabGroupChanged = false;\n                    this.createTabsModel();\n                }\n            }\n        });\n    }\n\n    protected createTabsModel(): void {\n        const newTabGroupModel = new Map<TabBar<Widget>, TabGroupDto>();\n        this.tabInfoLookup.clear();\n        this.disposableTabBarListeners.dispose();\n        this.applicationShell.mainAreaTabBars.forEach(tabBar => {\n            this.attachListenersToTabBar(tabBar);\n            const groupDto = this.createTabGroupDto(tabBar);\n            tabBar.titles.forEach((title, index) => this.tabInfoLookup.set(title, { group: groupDto, tab: groupDto.tabs[index], tabIndex: index }));\n            newTabGroupModel.set(tabBar, groupDto);\n        });\n        if (newTabGroupModel.size > 0 && Array.from(newTabGroupModel.values()).indexOf(this.currentActiveGroup) < 0) {\n            this.currentActiveGroup = this.tabInfoLookup.get(this.applicationShell.mainPanel.currentTitle!)?.group ?? newTabGroupModel.values().next().value;\n            this.currentActiveGroup.isActive = true;\n        }\n        this.tabGroupModel = newTabGroupModel;\n        this.proxy.$acceptEditorTabModel(Array.from(this.tabGroupModel.values()));\n    }\n\n    protected createTabDto(tabTitle: Title<Widget>, groupId: number): TabDto {\n        const widget = tabTitle.owner;\n        return {\n            id: this.createTabId(tabTitle, groupId),\n            label: tabTitle.label,\n            input: this.evaluateTabDtoInput(widget),\n            isActive: tabTitle.owner.isVisible,\n            isPinned: tabTitle.className.includes(PINNED_CLASS),\n            isDirty: Saveable.isDirty(widget),\n            isPreview: widget instanceof EditorPreviewWidget && widget.isPreview\n        };\n    }\n\n    protected createTabId(tabTitle: Title<Widget>, groupId: number): string {\n        return `${groupId}~${tabTitle.owner.id}`;\n    }\n\n    protected createTabGroupDto(tabBar: TabBar<Widget>): TabGroupDto {\n        const oldDto = this.tabGroupModel.get(tabBar);\n        const groupId = oldDto?.groupId ?? this.groupIdCounter++;\n        const tabs = tabBar.titles.map(title => this.createTabDto(title, groupId));\n        return {\n            groupId,\n            tabs,\n            isActive: false,\n            viewColumn: 1\n        };\n    }\n\n    protected attachListenersToTabBar(tabBar: TabBar<Widget> | undefined): void {\n        if (!tabBar) {\n            return;\n        }\n        tabBar.titles.forEach(title => {\n            this.connectToSignal(this.disposableTabBarListeners, title.changed, this.onTabTitleChanged);\n        });\n\n        this.connectToSignal(this.disposableTabBarListeners, tabBar.tabMoved, this.onTabMoved);\n        this.connectToSignal(this.disposableTabBarListeners, tabBar.disposed, this.onTabGroupClosed);\n    }\n\n    protected evaluateTabDtoInput(widget: Widget): AnyInputDto {\n        if (widget instanceof EditorPreviewWidget) {\n            if (widget.editor instanceof MonacoDiffEditor) {\n                return {\n                    kind: TabInputKind.TextDiffInput,\n                    original: toUriComponents(widget.editor.originalModel.uri),\n                    modified: toUriComponents(widget.editor.modifiedModel.uri)\n                };\n            } else {\n                return {\n                    kind: TabInputKind.TextInput,\n                    uri: toUriComponents(widget.editor.uri.toString())\n                };\n            }\n            // TODO notebook support when implemented\n        } else if (widget instanceof ViewContainer) {\n            return {\n                kind: TabInputKind.WebviewEditorInput,\n                viewType: widget.id\n            };\n        } else if (widget instanceof TerminalWidget) {\n            return {\n                kind: TabInputKind.TerminalEditorInput\n            };\n        }\n\n        return { kind: TabInputKind.UnknownInput };\n    }\n\n    protected connectToSignal<T>(disposableList: DisposableCollection, signal: { connect(listener: T, context: unknown): void, disconnect(listener: T): void }, listener: T): void {\n        signal.connect(listener, this);\n        disposableList.push(Disposable.create(() => signal.disconnect(listener)));\n    }\n\n    protected tabDtosEqual(a: TabDto, b: TabDto): boolean {\n        return a.isActive === b.isActive &&\n            a.isDirty === b.isDirty &&\n            a.isPinned === b.isPinned &&\n            a.isPreview === b.isPreview &&\n            a.id === b.id;\n    }\n\n    protected getOrRebuildModel<T, R>(map: Map<T, R>, key: T): R {\n        // something broke so we rebuild the model\n        let item = map.get(key);\n        if (!item) {\n            this.createTabsModel();\n            item = map.get(key)!;\n        }\n        return item;\n    }\n\n    // #region event listeners\n    private onTabCreated(tabBar: TabBar<Widget>, args: TabBar.ITabActivateRequestedArgs<Widget>): void {\n        const group = this.getOrRebuildModel(this.tabGroupModel, tabBar);\n        this.connectToSignal(this.disposableTabBarListeners, args.title.changed, this.onTabTitleChanged);\n        const tabDto = this.createTabDto(args.title, group.groupId);\n        this.tabInfoLookup.set(args.title, { group, tab: tabDto, tabIndex: args.index });\n        group.tabs.splice(args.index, 0, tabDto);\n        this.proxy.$acceptTabOperation({\n            kind: TabModelOperationKind.TAB_OPEN,\n            index: args.index,\n            tabDto,\n            groupId: group.groupId\n        });\n    }\n\n    private onTabTitleChanged(title: Title<Widget>): void {\n        const tabInfo = this.getOrRebuildModel(this.tabInfoLookup, title);\n        if (!tabInfo) {\n            return;\n        }\n        const oldTabDto = tabInfo.tab;\n        const newTabDto = this.createTabDto(title, tabInfo.group.groupId);\n        if (newTabDto.isActive && !tabInfo.group.isActive) {\n            tabInfo.group.isActive = true;\n            this.currentActiveGroup.isActive = false;\n            this.currentActiveGroup = tabInfo.group;\n            this.proxy.$acceptTabGroupUpdate(tabInfo.group);\n        }\n        if (!this.tabDtosEqual(oldTabDto, newTabDto)) {\n            tabInfo.group.tabs[tabInfo.tabIndex] = newTabDto;\n            tabInfo.tab = newTabDto;\n            this.proxy.$acceptTabOperation({\n                kind: TabModelOperationKind.TAB_UPDATE,\n                index: tabInfo.tabIndex,\n                tabDto: newTabDto,\n                groupId: tabInfo.group.groupId\n            });\n        }\n    }\n\n    private onTabClosed(tabInfo: TabInfo, title: Title<Widget>): void {\n        tabInfo.group.tabs.splice(tabInfo.tabIndex, 1);\n        this.tabInfoLookup.delete(title);\n        this.updateTabIndices(tabInfo, tabInfo.tabIndex);\n        this.proxy.$acceptTabOperation({\n            kind: TabModelOperationKind.TAB_CLOSE,\n            index: tabInfo.tabIndex,\n            tabDto: this.createTabDto(title, tabInfo.group.groupId),\n            groupId: tabInfo.group.groupId\n        });\n    }\n\n    private onTabMoved(tabBar: TabBar<Widget>, args: TabBar.ITabMovedArgs<Widget>): void {\n        const tabInfo = this.getOrRebuildModel(this.tabInfoLookup, args.title)!;\n        tabInfo.tabIndex = args.toIndex;\n        const tabDto = this.createTabDto(args.title, tabInfo.group.groupId);\n        tabInfo.group.tabs.splice(args.fromIndex, 1);\n        tabInfo.group.tabs.splice(args.toIndex, 0, tabDto);\n        this.updateTabIndices(tabInfo, args.fromIndex);\n        this.proxy.$acceptTabOperation({\n            kind: TabModelOperationKind.TAB_MOVE,\n            index: args.toIndex,\n            tabDto,\n            groupId: tabInfo.group.groupId,\n            oldIndex: args.fromIndex\n        });\n    }\n\n    private onTabGroupCreated(tabBar: TabBar<Widget>): void {\n        this.tabGroupChanged = true;\n    }\n\n    private onTabGroupClosed(tabBar: TabBar<Widget>): void {\n        this.tabGroupChanged = true;\n    }\n    // #endregion\n\n    // #region Messages received from Ext Host\n    $moveTab(tabId: string, index: number, viewColumn: number, preserveFocus?: boolean): void {\n        return;\n    }\n\n    updateTabIndices(tabInfo: TabInfo, startIndex: number): void {\n        for (const tab of this.tabInfoLookup.values()) {\n            if (tab.group === tabInfo.group && tab.tabIndex >= startIndex) {\n                tab.tabIndex = tab.group.tabs.indexOf(tab.tab);\n            }\n        }\n    }\n\n    async $closeTab(tabIds: string[], preserveFocus?: boolean): Promise<boolean> {\n        const widgets: Widget[] = [];\n        for (const tabId of tabIds) {\n            const cleanedId = tabId.substring(tabId.indexOf('~') + 1);\n            const widget = this.applicationShell.getWidgetById(cleanedId);\n            if (widget) {\n                widgets.push(widget);\n            }\n        }\n        await this.applicationShell.closeMany(widgets);\n        return true;\n    }\n\n    async $closeGroup(groupIds: number[], preserveFocus?: boolean): Promise<boolean> {\n        for (const groupId of groupIds) {\n            tabGroupModel: for (const [bar, groupDto] of this.tabGroupModel) {\n                if (groupDto.groupId === groupId) {\n                    this.applicationShell.closeTabs(bar);\n                    break tabGroupModel;\n                }\n            }\n        }\n        return true;\n    }\n    // #endregion\n\n    dispose(): void {\n        this.toDisposeOnDestroy.dispose();\n        this.disposableTabBarListeners.dispose();\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport {\n    TasksMain,\n    MAIN_RPC_CONTEXT,\n    TaskExecutionDto,\n    TasksExt,\n    TaskDto,\n    TaskPresentationOptionsDTO\n} from '../../common/plugin-api-rpc';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common';\nimport { TaskProviderRegistry, TaskResolverRegistry, TaskProvider, TaskResolver } from '@theia/task/lib/browser/task-contribution';\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { TaskInfo, TaskExitedEvent, TaskConfiguration, TaskOutputPresentation, RevealKind, PanelKind } from '@theia/task/lib/common/task-protocol';\nimport { TaskWatcher } from '@theia/task/lib/common/task-watcher';\nimport { TaskService } from '@theia/task/lib/browser/task-service';\nimport { TaskDefinitionRegistry } from '@theia/task/lib/browser';\n\nconst revealKindMap = new Map<number | RevealKind, RevealKind | number>(\n    [\n        [1, RevealKind.Always],\n        [2, RevealKind.Silent],\n        [3, RevealKind.Never],\n        [RevealKind.Always, 1],\n        [RevealKind.Silent, 2],\n        [RevealKind.Never, 3]\n    ]\n);\n\nconst panelKindMap = new Map<number | PanelKind, PanelKind | number>(\n    [\n        [1, PanelKind.Shared],\n        [2, PanelKind.Dedicated],\n        [3, PanelKind.New],\n        [PanelKind.Shared, 1],\n        [PanelKind.Dedicated, 2],\n        [PanelKind.New, 3]\n    ]\n);\n\nexport class TasksMainImpl implements TasksMain, Disposable {\n    private readonly proxy: TasksExt;\n    private readonly taskProviderRegistry: TaskProviderRegistry;\n    private readonly taskResolverRegistry: TaskResolverRegistry;\n    private readonly taskWatcher: TaskWatcher;\n    private readonly taskService: TaskService;\n    private readonly taskDefinitionRegistry: TaskDefinitionRegistry;\n\n    private readonly taskProviders = new Map<number, Disposable>();\n    private readonly toDispose = new DisposableCollection();\n\n    constructor(rpc: RPCProtocol, container: interfaces.Container) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.TASKS_EXT);\n        this.taskProviderRegistry = container.get(TaskProviderRegistry);\n        this.taskResolverRegistry = container.get(TaskResolverRegistry);\n        this.taskWatcher = container.get(TaskWatcher);\n        this.taskService = container.get(TaskService);\n        this.taskDefinitionRegistry = container.get(TaskDefinitionRegistry);\n\n        this.toDispose.push(this.taskWatcher.onTaskCreated((event: TaskInfo) => {\n            this.proxy.$onDidStartTask({\n                id: event.taskId,\n                task: this.fromTaskConfiguration(event.config)\n            }, event.terminalId!);\n        }));\n\n        this.toDispose.push(this.taskWatcher.onTaskExit((event: TaskExitedEvent) => {\n            this.proxy.$onDidEndTask(event.taskId);\n        }));\n\n        this.toDispose.push(this.taskWatcher.onDidStartTaskProcess((event: TaskInfo) => {\n            if (event.processId !== undefined) {\n                this.proxy.$onDidStartTaskProcess(event.processId, {\n                    id: event.taskId,\n                    task: this.fromTaskConfiguration(event.config)\n                });\n            }\n        }));\n\n        this.toDispose.push(this.taskWatcher.onDidEndTaskProcess((event: TaskExitedEvent) => {\n            if (event.code !== undefined) {\n                this.proxy.$onDidEndTaskProcess(event.code, event.taskId);\n            }\n        }));\n\n        // Inform proxy about running tasks form previous session\n        this.$taskExecutions().then(executions => {\n            if (executions.length > 0) {\n                this.proxy.$initLoadedTasks(executions);\n            }\n        });\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    $registerTaskProvider(handle: number, type: string): void {\n        const taskProvider = this.createTaskProvider(handle);\n        const taskResolver = this.createTaskResolver(handle);\n\n        const toDispose = new DisposableCollection(\n            this.taskProviderRegistry.register(type, taskProvider, handle),\n            this.taskResolverRegistry.registerTaskResolver(type, taskResolver),\n            Disposable.create(() => this.taskProviders.delete(handle))\n        );\n        this.taskProviders.set(handle, toDispose);\n        this.toDispose.push(toDispose);\n    }\n\n    $unregister(handle: number): void {\n        const disposable = this.taskProviders.get(handle);\n        if (disposable) {\n            disposable.dispose();\n        }\n    }\n\n    async $fetchTasks(taskVersion: string | undefined, taskType: string | undefined): Promise<TaskDto[]> {\n        if (taskVersion && !taskVersion.startsWith('2.')) { // Theia does not support 1.x or earlier task versions\n            return [];\n        }\n\n        const token: number = this.taskService.startUserAction();\n        const [configured, provided] = await Promise.all([\n            this.taskService.getConfiguredTasks(token),\n            this.taskService.getProvidedTasks(token)\n        ]);\n        const result: TaskDto[] = [];\n        for (const tasks of [configured, provided]) {\n            for (const task of tasks) {\n                if (!taskType || (!!this.taskDefinitionRegistry.getDefinition(task) ? task._source === taskType : task.type === taskType)) {\n                    result.push(this.fromTaskConfiguration(task));\n                }\n            }\n        }\n        return result;\n    }\n\n    async $executeTask(taskDto: TaskDto): Promise<TaskExecutionDto | undefined> {\n        const taskConfig = this.toTaskConfiguration(taskDto);\n        const taskInfo = await this.taskService.runTask(taskConfig);\n        if (taskInfo) {\n            return {\n                id: taskInfo.taskId,\n                task: this.fromTaskConfiguration(taskInfo.config)\n            };\n        }\n    }\n\n    async $taskExecutions(): Promise<{\n        id: number;\n        task: TaskDto;\n    }[]> {\n        const runningTasks = await this.taskService.getRunningTasks();\n        return runningTasks.map(taskInfo => ({\n            id: taskInfo.taskId,\n            task: this.fromTaskConfiguration(taskInfo.config)\n        }));\n    }\n\n    $terminateTask(id: number): void {\n        this.taskService.kill(id);\n    }\n\n    async $customExecutionComplete(id: number, exitCode: number | undefined): Promise<void> {\n        this.taskService.customExecutionComplete(id, exitCode);\n    }\n\n    protected createTaskProvider(handle: number): TaskProvider {\n        return {\n            provideTasks: () =>\n                this.proxy.$provideTasks(handle).then(tasks =>\n                    tasks.map(taskDto =>\n                        this.toTaskConfiguration(taskDto)\n                    )\n                )\n        };\n    }\n\n    protected createTaskResolver(handle: number): TaskResolver {\n        return {\n            resolveTask: taskConfig =>\n                this.proxy.$resolveTask(handle, this.fromTaskConfiguration(taskConfig)).then(task =>\n                    this.toTaskConfiguration(task)\n                )\n        };\n    }\n\n    protected toTaskConfiguration(taskDto: TaskDto): TaskConfiguration {\n        const { group, presentation, scope, source, runOptions, ...common } = taskDto ?? {};\n        const partialConfig: Partial<TaskConfiguration> = {};\n        if (presentation) {\n            partialConfig.presentation = this.convertTaskPresentation(presentation);\n        }\n        if (group) {\n            partialConfig.group = {\n                kind: group.kind,\n                isDefault: group.isDefault\n            };\n        }\n        return {\n            ...common,\n            ...partialConfig,\n            runOptions,\n            _scope: scope,\n            _source: source,\n        };\n    }\n\n    protected fromTaskConfiguration(task: TaskConfiguration): TaskDto {\n        const { group, presentation, _scope, _source, ...common } = task;\n        const partialDto: Partial<TaskDto> = {};\n        if (presentation) {\n            partialDto.presentation = this.convertTaskPresentation(presentation);\n        }\n        if (group === 'build' || group === 'test') {\n            partialDto.group = {\n                kind: group,\n                isDefault: false\n            };\n        } else if (typeof group === 'object') {\n            partialDto.group = group;\n        }\n        return {\n            ...common,\n            ...partialDto,\n            scope: _scope,\n            source: _source,\n        };\n    }\n\n    private convertTaskPresentation(presentationFrom: undefined): undefined;\n    private convertTaskPresentation(presentationFrom: TaskOutputPresentation): TaskPresentationOptionsDTO;\n    private convertTaskPresentation(presentationFrom: TaskPresentationOptionsDTO): TaskOutputPresentation;\n    private convertTaskPresentation(\n        presentationFrom: TaskOutputPresentation | TaskPresentationOptionsDTO | undefined\n    ): TaskOutputPresentation | TaskPresentationOptionsDTO | undefined {\n        if (presentationFrom) {\n            const { reveal, panel, ...common } = presentationFrom;\n            const presentationTo: Partial<TaskOutputPresentation | TaskPresentationOptionsDTO> = {};\n            if (reveal) {\n                presentationTo.reveal = revealKindMap.get(reveal);\n            }\n            if (panel) {\n                presentationTo.panel = panelKindMap.get(panel)!;\n            }\n            return {\n                ...common,\n                ...presentationTo,\n            };\n        }\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { ApplicationShell, WidgetOpenerOptions } from '@theia/core/lib/browser';\nimport { TerminalEditorLocationOptions, TerminalOptions } from '@theia/plugin';\nimport { TerminalLocation, TerminalWidget } from '@theia/terminal/lib/browser/base/terminal-widget';\nimport { TerminalService } from '@theia/terminal/lib/browser/base/terminal-service';\nimport { TerminalServiceMain, TerminalServiceExt, MAIN_RPC_CONTEXT } from '../../common/plugin-api-rpc';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\nimport { SerializableEnvironmentVariableCollection, ShellTerminalServerProxy } from '@theia/terminal/lib/common/shell-terminal-protocol';\nimport { TerminalLink, TerminalLinkProvider } from '@theia/terminal/lib/browser/terminal-link-provider';\nimport { URI } from '@theia/core/lib/common/uri';\nimport { getIconClass } from '../../plugin/terminal-ext';\nimport { PluginTerminalRegistry } from './plugin-terminal-registry';\nimport { CancellationToken } from '@theia/core';\nimport { HostedPluginSupport } from '../../hosted/browser/hosted-plugin';\n\n/**\n * Plugin api service allows working with terminal emulator.\n */\nexport class TerminalServiceMainImpl implements TerminalServiceMain, TerminalLinkProvider, Disposable {\n\n    private readonly terminals: TerminalService;\n    private readonly pluginTerminalRegistry: PluginTerminalRegistry;\n    private readonly hostedPluginSupport: HostedPluginSupport;\n    private readonly shell: ApplicationShell;\n    private readonly extProxy: TerminalServiceExt;\n    private readonly shellTerminalServer: ShellTerminalServerProxy;\n    private readonly terminalLinkProviders: string[] = [];\n\n    private readonly toDispose = new DisposableCollection();\n\n    constructor(rpc: RPCProtocol, container: interfaces.Container) {\n        this.terminals = container.get(TerminalService);\n        this.pluginTerminalRegistry = container.get(PluginTerminalRegistry);\n        this.hostedPluginSupport = container.get(HostedPluginSupport);\n        this.shell = container.get(ApplicationShell);\n        this.shellTerminalServer = container.get(ShellTerminalServerProxy);\n        this.extProxy = rpc.getProxy(MAIN_RPC_CONTEXT.TERMINAL_EXT);\n        this.toDispose.push(this.terminals.onDidCreateTerminal(terminal => this.trackTerminal(terminal)));\n        for (const terminal of this.terminals.all) {\n            this.trackTerminal(terminal);\n        }\n        this.toDispose.push(this.terminals.onDidChangeCurrentTerminal(() => this.updateCurrentTerminal()));\n        this.updateCurrentTerminal();\n\n        this.shellTerminalServer.getEnvVarCollections().then(collections => this.extProxy.$initEnvironmentVariableCollections(collections));\n\n        this.pluginTerminalRegistry.startCallback = id => this.startProfile(id);\n\n        container.bind(TerminalLinkProvider).toDynamicValue(() => this);\n    }\n\n    async startProfile(id: string): Promise<string> {\n        await this.hostedPluginSupport.activateByTerminalProfile(id);\n        return this.extProxy.$startProfile(id, CancellationToken.None);\n    }\n\n    $setEnvironmentVariableCollection(persistent: boolean, extensionIdentifier: string, rootUri: string, collection: SerializableEnvironmentVariableCollection): void {\n        if (collection) {\n            this.shellTerminalServer.setCollection(extensionIdentifier, rootUri, persistent, collection, collection.description);\n        } else {\n            this.shellTerminalServer.deleteCollection(extensionIdentifier);\n        }\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    protected updateCurrentTerminal(): void {\n        const { currentTerminal } = this.terminals;\n        this.extProxy.$currentTerminalChanged(currentTerminal && currentTerminal.id);\n    }\n\n    protected async trackTerminal(terminal: TerminalWidget): Promise<void> {\n        let name = terminal.title.label;\n        this.extProxy.$terminalCreated(terminal.id, name);\n        const updateTitle = () => {\n            if (name !== terminal.title.label) {\n                name = terminal.title.label;\n                this.extProxy.$terminalNameChanged(terminal.id, name);\n            }\n        };\n        terminal.title.changed.connect(updateTitle);\n        this.toDispose.push(Disposable.create(() => terminal.title.changed.disconnect(updateTitle)));\n\n        const updateProcessId = () => terminal.processId.then(\n            processId => this.extProxy.$terminalOpened(terminal.id, processId, terminal.terminalId, terminal.dimensions.cols, terminal.dimensions.rows),\n            () => {/* no-op */ }\n        );\n        updateProcessId();\n        this.toDispose.push(terminal.onDidOpen(() => updateProcessId()));\n        this.toDispose.push(terminal.onTerminalDidClose(term => this.extProxy.$terminalClosed(term.id, term.exitStatus)));\n        this.toDispose.push(terminal.onSizeChanged(({ cols, rows }) => {\n            this.extProxy.$terminalSizeChanged(terminal.id, cols, rows);\n        }));\n        this.toDispose.push(terminal.onData(data => {\n            this.extProxy.$terminalOnInput(terminal.id, data);\n            this.extProxy.$terminalStateChanged(terminal.id);\n        }));\n    }\n\n    $write(id: string, data: string): void {\n        const terminal = this.terminals.getById(id);\n        if (!terminal) {\n            return;\n        }\n        terminal.write(data);\n    }\n\n    $resize(id: string, cols: number, rows: number): void {\n        const terminal = this.terminals.getById(id);\n        if (!terminal) {\n            return;\n        }\n        terminal.resize(cols, rows);\n    }\n\n    async $createTerminal(id: string, options: TerminalOptions, parentId?: string, isPseudoTerminal?: boolean): Promise<string> {\n        const terminal = await this.terminals.newTerminal({\n            id,\n            title: options.name,\n            iconClass: getIconClass(options),\n            shellPath: options.shellPath,\n            shellArgs: options.shellArgs,\n            cwd: options.cwd ? new URI(options.cwd) : undefined,\n            env: options.env,\n            strictEnv: options.strictEnv,\n            destroyTermOnClose: true,\n            useServerTitle: false,\n            attributes: options.attributes,\n            hideFromUser: options.hideFromUser,\n            location: this.getTerminalLocation(options, parentId),\n            isPseudoTerminal,\n            isTransient: options.isTransient\n        });\n        if (options.message) {\n            terminal.writeLine(options.message);\n        }\n        terminal.start();\n        return terminal.id;\n    }\n\n    protected getTerminalLocation(options: TerminalOptions, parentId?: string): TerminalLocation | TerminalEditorLocationOptions | { parentTerminal: string; } | undefined {\n        if (typeof options.location === 'number' && Object.values(TerminalLocation).includes(options.location)) {\n            return options.location;\n        } else if (options.location && typeof options.location === 'object') {\n            if ('parentTerminal' in options.location) {\n                if (!parentId) {\n                    throw new Error('parentTerminal is set but no parentId is provided');\n                }\n                return { 'parentTerminal': parentId };\n            } else {\n                return options.location;\n            }\n        }\n\n        return undefined;\n    }\n\n    $sendText(id: string, text: string, addNewLine?: boolean): void {\n        const terminal = this.terminals.getById(id);\n        if (terminal) {\n            text = text.replace(/\\r?\\n/g, '\\r');\n            if (addNewLine && text.charAt(text.length - 1) !== '\\r') {\n                text += '\\r';\n            }\n            terminal.sendText(text);\n        }\n    }\n\n    $show(id: string, preserveFocus?: boolean): void {\n        const terminal = this.terminals.getById(id);\n        if (terminal) {\n            const options: WidgetOpenerOptions = {};\n            if (preserveFocus) {\n                options.mode = 'reveal';\n            }\n            this.terminals.open(terminal, options);\n        }\n    }\n\n    $hide(id: string): void {\n        const terminal = this.terminals.getById(id);\n        if (terminal && terminal.isVisible) {\n            const area = this.shell.getAreaFor(terminal);\n            if (area) {\n                this.shell.collapsePanel(area);\n            }\n        }\n    }\n\n    $dispose(id: string): void {\n        const terminal = this.terminals.getById(id);\n        if (terminal) {\n            terminal.dispose();\n        }\n    }\n\n    $setName(id: string, name: string): void {\n        this.terminals.getById(id)?.setTitle(name);\n    }\n\n    $sendTextByTerminalId(id: number, text: string, addNewLine?: boolean): void {\n        const terminal = this.terminals.getByTerminalId(id);\n        if (terminal) {\n            text = text.replace(/\\r?\\n/g, '\\r');\n            if (addNewLine && text.charAt(text.length - 1) !== '\\r') {\n                text += '\\r';\n            }\n            terminal.sendText(text);\n        }\n    }\n    $writeByTerminalId(id: number, data: string): void {\n        const terminal = this.terminals.getByTerminalId(id);\n        if (!terminal) {\n            return;\n        }\n        terminal.write(data);\n    }\n    $resizeByTerminalId(id: number, cols: number, rows: number): void {\n        const terminal = this.terminals.getByTerminalId(id);\n        if (!terminal) {\n            return;\n        }\n        terminal.resize(cols, rows);\n    }\n    $showByTerminalId(id: number, preserveFocus?: boolean): void {\n        const terminal = this.terminals.getByTerminalId(id);\n        if (terminal) {\n            const options: WidgetOpenerOptions = {};\n            if (preserveFocus) {\n                options.mode = 'reveal';\n            }\n            this.terminals.open(terminal, options);\n        }\n    }\n    $hideByTerminalId(id: number): void {\n        const terminal = this.terminals.getByTerminalId(id);\n        if (terminal && terminal.isVisible) {\n            const area = this.shell.getAreaFor(terminal);\n            if (area) {\n                this.shell.collapsePanel(area);\n            }\n        }\n    }\n    $disposeByTerminalId(id: number, waitOnExit?: boolean | string): void {\n        const terminal = this.terminals.getByTerminalId(id);\n        if (terminal) {\n            if (waitOnExit) {\n                terminal.waitOnExit(waitOnExit);\n                return;\n            }\n            terminal.dispose();\n        }\n    }\n\n    $setNameByTerminalId(id: number, name: string): void {\n        this.terminals.getByTerminalId(id)?.setTitle(name);\n    }\n\n    async $registerTerminalLinkProvider(providerId: string): Promise<void> {\n        this.terminalLinkProviders.push(providerId);\n    }\n\n    async $unregisterTerminalLinkProvider(providerId: string): Promise<void> {\n        const index = this.terminalLinkProviders.indexOf(providerId);\n        if (index > -1) {\n            this.terminalLinkProviders.splice(index, 1);\n        }\n    }\n\n    async provideLinks(line: string, terminal: TerminalWidget, cancellationToken?: CancellationToken | undefined): Promise<TerminalLink[]> {\n        if (this.terminalLinkProviders.length < 1) {\n            return [];\n        }\n        const links = await this.extProxy.$provideTerminalLinks(line, terminal.id, cancellationToken ?? CancellationToken.None);\n        return links.map(link => ({ ...link, handle: () => this.extProxy.$handleTerminalLink(link) }));\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2023 ST Microelectronics, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { SimpleObservableCollection, TreeCollection, observableProperty } from '@theia/test/lib/common/collections';\nimport {\n    TestController, TestItem, TestOutputItem, TestRun, TestRunProfile, TestService, TestState, TestStateChangedEvent\n} from '@theia/test/lib/browser/test-service';\nimport { AccumulatingTreeDeltaEmitter, CollectionDelta, DeltaKind, TreeDelta, TreeDeltaBuilder } from '@theia/test/lib/common/tree-delta';\nimport { Emitter, Location, Range } from '@theia/core/shared/vscode-languageserver-protocol';\nimport { Range as PluginRange, Location as PluginLocation } from '../../common/plugin-api-rpc-model';\nimport { MarkdownString } from '@theia/core/lib/common/markdown-rendering';\nimport { CancellationToken, Disposable, Event, URI } from '@theia/core';\nimport { MAIN_RPC_CONTEXT, TestControllerUpdate, TestingExt, TestingMain } from '../../common';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { TestExecutionState, TestItemDTO, TestItemReference, TestOutputDTO, TestRunDTO, TestRunProfileDTO, TestStateChangeDTO } from '../../common/test-types';\nimport { TestRunProfileKind } from '../../plugin/types-impl';\nimport { CommandRegistryMainImpl } from './command-registry-main';\n\nexport class TestItemCollection extends TreeCollection<string, TestItemImpl, TestItemImpl | TestControllerImpl> {\n    override add(item: TestItemImpl): TestItemImpl | undefined {\n        item.realParent = this.owner;\n        return super.add(item);\n    }\n}\n\nexport class TestItemImpl implements TestItem {\n    update(value: Partial<TestItemDTO>): void {\n        if ('label' in value) {\n            this.label = value.label!;\n        }\n\n        if ('range' in value) {\n            this.range = convertRange(value.range);\n        }\n\n        if ('sortKey' in value) {\n            this.sortKey = value.sortKey!;\n        }\n\n        if ('tags' in value) {\n            this.tags = value.tags!;\n        }\n        if ('busy' in value) {\n            this.busy = value.busy!;\n        }\n        if ('sortKey' in value) {\n            this.sortKey = value.sortKey;\n        }\n        if ('canResolveChildren' in value) {\n            this.canResolveChildren = value.canResolveChildren!;\n        }\n        if ('description' in value) {\n            this.description = value.description;\n        }\n\n        if ('error' in value) {\n            this.error = value.error;\n        }\n    }\n\n    constructor(readonly uri: URI, readonly id: string) {\n        this.items = new TestItemCollection(this, (v: TestItemImpl) => v.path, (v: TestItemImpl) => v.deltaBuilder);\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    protected notifyPropertyChange(property: keyof TestItemImpl, value: any): void {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const val: any = {};\n        val[property] = value;\n        if (this.path) {\n            this.deltaBuilder?.reportChanged(this.path, val);\n        }\n    }\n\n    _deltaBuilder: TreeDeltaBuilder<string, TestItemImpl> | undefined;\n    get deltaBuilder(): TreeDeltaBuilder<string, TestItemImpl> | undefined {\n        if (this._deltaBuilder) {\n            return this._deltaBuilder;\n        } else if (this.realParent) {\n            this._deltaBuilder = this.realParent.deltaBuilder;\n            return this._deltaBuilder;\n        } else {\n            return undefined;\n        }\n    }\n\n    _path: string[] | undefined;\n\n    get path(): string[] {\n        if (this._path) {\n            return this._path;\n        } else if (this.realParent instanceof TestItemImpl) {\n            this._path = [...this.realParent.path, this.id];\n            return this._path;\n        } else {\n            return [this.id];\n        }\n    };\n\n    get parent(): TestItem | undefined {\n        const realParent = this.realParent;\n        if (realParent instanceof TestItemImpl) {\n            return realParent;\n        }\n        return undefined;\n    }\n\n    private _parent?: TestItemImpl | TestControllerImpl;\n    get realParent(): TestItemImpl | TestControllerImpl | undefined {\n        return this._parent;\n    }\n\n    set realParent(v: TestItemImpl | TestControllerImpl | undefined) {\n        this.iterate(item => {\n            item._path = undefined;\n            return true;\n        });\n        this._parent = v;\n    }\n\n    get controller(): TestControllerImpl | undefined {\n        return this.realParent?.controller;\n    }\n\n    protected iterate(toDo: (v: TestItemImpl) => boolean): boolean {\n        if (toDo(this)) {\n            for (let i = 0; i < this.items.values.length; i++) {\n                if (!this.items.values[i].iterate(toDo)) {\n                    return false;\n                }\n            }\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    @observableProperty('notifyPropertyChange')\n    label: string = '';\n\n    @observableProperty('notifyPropertyChange')\n    range?: Range;\n\n    @observableProperty('notifyPropertyChange')\n    sortKey?: string | undefined;\n\n    @observableProperty('notifyPropertyChange')\n    tags: string[] = [];\n\n    @observableProperty('notifyPropertyChange')\n    busy: boolean = false;\n\n    @observableProperty('notifyPropertyChange')\n    canResolveChildren: boolean = false;\n\n    @observableProperty('notifyPropertyChange')\n    description?: string | undefined;\n\n    @observableProperty('notifyPropertyChange')\n    error?: string | MarkdownString | undefined;\n\n    items: TestItemCollection;\n    get tests(): readonly TestItemImpl[] {\n        return this.items.values;\n    }\n\n    resolveChildren(): void {\n        if (this.canResolveChildren) {\n            this.controller?.resolveChildren(this);\n        }\n    }\n}\n\nfunction itemToPath(item: TestItem): string[] {\n    if (!(item instanceof TestItemImpl)) {\n        throw new Error(`Not a TestItemImpl: ${item.id}`);\n    }\n    return item.path;\n}\n\nclass TestRunProfileImpl implements TestRunProfile {\n\n    label: string;\n    isDefault: boolean;\n    tag: string;\n    canConfigure: boolean;\n\n    update(update: Partial<TestRunProfileDTO>): void {\n        if ('label' in update) {\n            this.label = update.label!;\n        }\n\n        if ('isDefault' in update) {\n            this.isDefault = update.isDefault!;\n        }\n\n        if ('tag' in update) {\n            this.tag = update.tag!;\n        }\n\n        if ('canConfigure' in update) {\n            this.canConfigure = update.canConfigure!;\n        }\n\n    }\n\n    constructor(\n        private proxy: TestingExt,\n        private controllerId: string,\n        readonly id: string,\n        readonly kind: TestRunProfileKind,\n        label: string,\n        isDefault: boolean,\n        tag: string) {\n\n        this.label = label;\n        this.isDefault = isDefault;\n        this.tag = tag;\n    }\n\n    configure(): void {\n        this.proxy.$onConfigureRunProfile(this.controllerId, this.id);\n    }\n\n    run(name: string, included: TestItem[], excluded: TestItem[]): void {\n        this.proxy.$onRunControllerTests([{\n            controllerId: this.controllerId,\n            name,\n            profileId: this.id,\n            includedTests: included.map(item => itemToPath(item)),\n            excludedTests: excluded.map(item => itemToPath(item))\n        }]);\n    }\n}\n\nclass TestRunImpl implements TestRun {\n    private testStates: Map<TestItem, TestState> = new Map();\n    private outputIndices: Map<TestItem, number[]> = new Map();\n    private outputs: TestOutputItem[] = [];\n    private onDidChangePropertyEmitter = new Emitter<{ name?: string; isRunning?: boolean; }>();\n    onDidChangeProperty: Event<{ name?: string; isRunning?: boolean; }> = this.onDidChangePropertyEmitter.event;\n\n    constructor(readonly controller: TestControllerImpl, readonly proxy: TestingExt, readonly id: string, name: string) {\n        this.name = name;\n        this.isRunning = false;\n    }\n\n    @observableProperty('notifyPropertyChange')\n    isRunning: boolean;\n\n    @observableProperty('notifyPropertyChange')\n    name: string;\n\n    ended(): void {\n        const stateEvents: TestStateChangedEvent[] = [];\n        this.testStates.forEach((state, item) => {\n            if (state.state <= TestExecutionState.Running) {\n                stateEvents.push({\n                    oldState: state,\n                    newState: undefined,\n                    test: item\n                });\n                this.testStates.delete(item);\n            }\n        });\n        if (stateEvents.length > 0) {\n            this.onDidChangeTestStateEmitter.fire(stateEvents);\n        }\n        this.isRunning = false;\n    }\n\n    protected notifyPropertyChange(property: 'name' | 'isRunning', value: unknown): void {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const val: any = {};\n        val[property] = value;\n        this.onDidChangePropertyEmitter.fire(val);\n    }\n\n    cancel(): void {\n        this.proxy.$onCancelTestRun(this.controller.id, this.id);\n    }\n\n    getTestState(item: TestItem): TestState | undefined {\n        return this.testStates.get(item);\n    }\n\n    private onDidChangeTestStateEmitter: Emitter<TestStateChangedEvent[]> = new Emitter();\n    onDidChangeTestState: Event<TestStateChangedEvent[]> = this.onDidChangeTestStateEmitter.event;\n\n    getOutput(item?: TestItem | undefined): readonly TestOutputItem[] {\n        if (!item) {\n            return this.outputs;\n        } else {\n            const indices = this.outputIndices.get(item);\n            if (!indices) {\n                return [];\n            } else {\n                return indices.map(index => this.outputs[index]);\n            }\n        }\n    }\n    private onDidChangeTestOutputEmitter: Emitter<[TestItem | undefined, TestOutputItem][]> = new Emitter();\n    onDidChangeTestOutput: Event<[TestItem | undefined, TestOutputItem][]> = this.onDidChangeTestOutputEmitter.event;\n\n    applyChanges(stateChanges: TestStateChangeDTO[], outputChanges: TestOutputDTO[]): void {\n        const stateEvents: TestStateChangedEvent[] = [];\n        stateChanges.forEach(change => {\n            const item = this.controller.findItem(change.itemPath);\n            if (item) {\n                const oldState = this.testStates.get(item);\n                this.testStates.set(item, change);\n                stateEvents.push({ test: item, oldState: oldState, newState: change });\n            }\n        });\n        const outputEvents: [TestItem | undefined, TestOutputItem][] = [];\n        outputChanges.forEach(change => {\n            const output = {\n                output: change.output,\n                location: convertLocation(change.location)\n            };\n            this.outputs.push(output);\n            let item = undefined;\n            if (change.itemPath) {\n                item = this.controller.findItem(change.itemPath);\n                if (item) {\n                    let indices = this.outputIndices.get(item);\n                    if (!indices) {\n                        indices = [];\n                        this.outputIndices.set(item, indices);\n                    }\n                    indices.push(this.outputs.length - 1);\n                }\n            }\n            outputEvents.push([item, output]);\n        });\n\n        this.onDidChangeTestStateEmitter.fire(stateEvents);\n        this.onDidChangeTestOutputEmitter.fire(outputEvents);\n    }\n\n    get items(): readonly TestItem[] {\n        return [...this.testStates.keys()];\n    }\n}\n\nfunction convertLocation(location: PluginLocation | undefined): Location | undefined {\n    if (!location) {\n        return undefined;\n    }\n    return {\n        uri: location.uri.toString(),\n        range: convertRange(location.range)\n    };\n}\n\ninterface TestCollectionHolder {\n    items: TestItemCollection;\n}\n\nfunction convertRange(range: PluginRange): Range;\nfunction convertRange(range: PluginRange | undefined): Range | undefined;\nfunction convertRange(range: PluginRange | undefined): Range | undefined {\n    if (range) {\n        return {\n            start: {\n                line: range.startLineNumber,\n                character: range.startColumn\n            }, end: {\n                line: range.endLineNumber,\n                character: range.endColumn\n\n            }\n        };\n    }\n    return undefined;\n\n}\n\nclass TestControllerImpl implements TestController {\n\n    private _profiles = new SimpleObservableCollection<TestRunProfileImpl>();\n    private _runs = new SimpleObservableCollection<TestRunImpl>();\n    readonly deltaBuilder = new AccumulatingTreeDeltaEmitter<string, TestItemImpl>(300);\n    canRefresh: boolean;\n    private canResolveChildren: boolean = false;\n    readonly items = new TestItemCollection(this, item => item.path, () => this.deltaBuilder);\n\n    constructor(private readonly proxy: TestingExt, readonly id: string, public label: string) {\n    }\n    refreshTests(token: CancellationToken): Promise<void> {\n        return this.proxy.$refreshTests(this.id, token);\n    }\n\n    applyDelta(diff: TreeDelta<string, TestItemDTO>[]): void {\n        this.applyDeltasToCollection(this, diff);\n    }\n\n    withProfile(profileId: string): TestRunProfileImpl {\n        const profile = this._profiles.values.find(p => p.id === profileId);\n        if (!profile) {\n            throw new Error(`No test profile ${profileId} found in controller with id ${this.id} found`);\n        }\n        return profile;\n\n    }\n\n    withRun(runId: string): TestRunImpl {\n        const run = this._runs.values.find(p => p.id === runId);\n        if (!run) {\n            throw new Error(`No test profile ${runId} found in controller with id ${this.id} found`);\n        }\n        return run;\n    }\n\n    protected applyDeltasToCollection(root: TestCollectionHolder, deltas: TreeDelta<string, TestItemDTO>[]): void {\n        deltas.forEach(delta => this.applyDeltaToCollection(root, delta));\n    }\n\n    protected applyDeltaToCollection(root: TestCollectionHolder, delta: TreeDelta<string, TestItemDTO>): void {\n        if (delta.type === DeltaKind.ADDED || delta.type === DeltaKind.REMOVED) {\n            const node = this.findNodeInRoot(root, delta.path.slice(0, delta.path.length - 1), 0);\n            if (node) {\n                if (delta.type === DeltaKind.ADDED) {\n                    node.items.add(this.createTestItem(delta.value! as TestItemDTO));\n                } else {\n                    node.items.remove(delta.path[delta.path.length - 1]);\n                }\n            }\n        } else {\n            const node = this.findNodeInRoot(root, delta.path, 0);\n            if (node) {\n                if (delta.type === DeltaKind.CHANGED) {\n                    (node as TestItemImpl).update(delta.value!);\n                }\n                if (delta.childDeltas) {\n                    this.applyDeltasToCollection(node, delta.childDeltas);\n                }\n            }\n        }\n    }\n\n    findItem(path: string[]): TestItemImpl | undefined {\n        if (path.length === 0) {\n            console.warn('looking for item with zero-path');\n            return undefined;\n        }\n        return this.findNodeInRoot(this, path, 0) as TestItemImpl;\n    }\n\n    protected findNodeInRoot(root: TestCollectionHolder, path: string[], startIndex: number): TestCollectionHolder | undefined {\n        if (startIndex >= path.length) {\n            return root;\n        }\n        const child = root.items.get(path[startIndex]);\n        if (!child) {\n            return undefined;\n        }\n        return this.findNodeInRoot(child, path, startIndex + 1);\n    }\n\n    protected createTestItem(value: TestItemDTO): TestItemImpl {\n        const item = new TestItemImpl(URI.fromComponents(value.uri!), value?.id!);\n\n        item.update(value);\n\n        value.children?.forEach(child => item.items.add(this.createTestItem(child)));\n\n        return item;\n    }\n\n    get controller(): TestControllerImpl {\n        return this;\n    }\n\n    get testRunProfiles(): readonly TestRunProfile[] {\n        return this._profiles.values;\n    }\n\n    update(change: Partial<TestControllerUpdate>): void {\n        if ('canRefresh' in change) {\n            this.canRefresh = change.canRefresh!;\n        }\n        if ('canResolve' in change) {\n            this.canResolveChildren = change.canResolve!;\n        }\n        if ('label' in change) {\n            this.label = change.label!;\n        }\n    }\n\n    addProfile(profile: TestRunProfileImpl): void {\n        this._profiles.add(profile);\n    }\n\n    addRun(runId: string, runName: string, isRunning: boolean): TestRunImpl {\n        const run = new TestRunImpl(this, this.proxy, runId, runName);\n        run.isRunning = isRunning;\n        this._runs.add(run);\n        return run;\n    }\n\n    onProfilesChanged: Event<CollectionDelta<TestRunProfile, TestRunProfile>> = this._profiles.onChanged;\n\n    removeProfile(profileId: string): void {\n        this._profiles.remove(this.withProfile(profileId));\n    }\n\n    get testRuns(): readonly TestRun[] {\n        return this._runs.values;\n    }\n    onRunsChanged: Event<CollectionDelta<TestRun, TestRun>> = this._runs.onChanged;\n\n    get tests(): readonly TestItemImpl[] {\n        return this.items.values;\n    }\n    onItemsChanged: Event<TreeDelta<string, TestItemImpl>[]> = this.deltaBuilder.onDidFlush;\n\n    resolveChildren(item: TestItem): void {\n        if (this.canResolveChildren) {\n            this.proxy.$onResolveChildren(this.id, itemToPath(item));\n        }\n    }\n\n    clearRuns(): void {\n        this._runs.clear();\n    }\n}\n\nexport class TestingMainImpl implements TestingMain {\n    private testService: TestService;\n    private controllerRegistrations = new Map<string, [TestControllerImpl, Disposable]>();\n    private proxy: TestingExt;\n    canRefresh: boolean;\n\n    constructor(rpc: RPCProtocol, container: interfaces.Container, commandRegistry: CommandRegistryMainImpl) {\n        this.testService = container.get(TestService);\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.TESTING_EXT);\n        commandRegistry.registerArgumentProcessor({\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            processArgument(arg: any): any {\n                if (arg instanceof TestItemImpl) {\n                    if (!arg.controller || !arg.path) {\n                        throw new Error(`Passing unattached test item ${arg.id} as a command argument`);\n                    }\n                    return TestItemReference.create(arg.controller.id, arg.path);\n                }\n                return arg;\n            }\n        });\n    }\n\n    $registerTestController(controllerId: string, label: string): void {\n        const controller = new TestControllerImpl(this.proxy, controllerId, label);\n        this.controllerRegistrations.set(controllerId, [controller, this.testService.registerTestController(controller)]);\n    }\n    $updateController(controllerId: string, patch: Partial<TestControllerUpdate>): void {\n        this.withController(controllerId).update(patch);\n    }\n\n    $unregisterTestController(controllerId: string): void {\n        const registered = this.controllerRegistrations.get(controllerId);\n        if (registered) {\n            this.controllerRegistrations.delete(controllerId);\n            registered[1].dispose();\n        }\n    }\n\n    private withController(controllerId: string): TestControllerImpl {\n        const registration = this.controllerRegistrations.get(controllerId);\n        if (!registration) {\n            throw new Error(`No test controller with id ${controllerId} found`);\n        }\n        return registration[0];\n    }\n\n    $notifyDelta(controllerId: string, diff: TreeDelta<string, TestItemDTO>[]): void {\n        this.withController(controllerId).applyDelta(diff);\n    }\n\n    $notifyTestRunProfileCreated(controllerId: string, profile: TestRunProfileDTO): void {\n        const registration = this.controllerRegistrations.get(controllerId);\n        if (!registration) {\n            throw new Error(`No test controller with id ${controllerId} found`);\n        }\n        registration[0].addProfile(new TestRunProfileImpl(this.proxy, controllerId, profile.id, profile.kind, profile.label, profile.isDefault, profile.tag));\n    }\n\n    $updateTestRunProfile(controllerId: string, profileId: string, update: Partial<TestRunProfileDTO>): void {\n        this.withController(controllerId).withProfile(profileId).update(update);\n    }\n    $removeTestRunProfile(controllerId: string, profileId: string): void {\n        this.withController(controllerId).removeProfile(profileId);\n    }\n    $notifyTestRunCreated(controllerId: string, run: TestRunDTO): void {\n        this.withController(controllerId).addRun(run.id, run.name, run.isRunning);\n    }\n    $notifyTestStateChanged(controllerId: string, runId: string, stateChanges: TestStateChangeDTO[], outputChanges: TestOutputDTO[]): void {\n        this.withController(controllerId).withRun(runId).applyChanges(stateChanges, outputChanges);\n    }\n\n    $notifyTestRunEnded(controllerId: string, runId: string): void {\n        this.withController(controllerId).withRun(runId).ended();\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2017 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport * as monaco from '@theia/monaco-editor-core';\nimport { StandaloneCodeEditor } from '@theia/monaco-editor-core/esm/vs/editor/standalone/browser/standaloneCodeEditor';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\nimport { MonacoEditor } from '@theia/monaco/lib/browser/monaco-editor';\nimport {\n    TextEditorConfiguration,\n    EditorChangedPropertiesData,\n    Selection,\n    TextEditorConfigurationUpdate,\n    TextEditorRevealType,\n    SingleEditOperation,\n    ApplyEditsOptions,\n    UndoStopOptions,\n    DecorationOptions\n} from '../../common/plugin-api-rpc';\nimport { Range } from '../../common/plugin-api-rpc-model';\nimport { Emitter, Event } from '@theia/core';\nimport { TextEditorCursorStyle, cursorStyleToString } from '../../common/editor-options';\nimport { TextEditorLineNumbersStyle, EndOfLine } from '../../plugin/types-impl';\n\nexport class TextEditorMain implements Disposable {\n\n    private properties: TextEditorPropertiesMain | undefined;\n    private editor: MonacoEditor | undefined;\n\n    private readonly onPropertiesChangedEmitter = new Emitter<EditorChangedPropertiesData>();\n\n    private readonly toDispose = new DisposableCollection(\n        Disposable.create(() => this.properties = undefined),\n        this.onPropertiesChangedEmitter\n    );\n\n    constructor(\n        private id: string,\n        private model: monaco.editor.IModel,\n        editor: MonacoEditor\n    ) {\n        this.toDispose.push(this.model.onDidChangeOptions(() =>\n            this.updateProperties(undefined)\n        ));\n        this.setEditor(editor);\n        this.updateProperties(undefined);\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    private updateProperties(source?: string): void {\n        this.setProperties(TextEditorPropertiesMain.readFromEditor(this.properties, this.model, this.editor!), source);\n    }\n\n    private setProperties(newProperties: TextEditorPropertiesMain, source: string | undefined): void {\n        const result = newProperties.generateDelta(this.properties, source);\n        this.properties = newProperties;\n        if (result) {\n            this.onPropertiesChangedEmitter.fire(result);\n        }\n    }\n\n    protected readonly toDisposeOnEditor = new DisposableCollection();\n\n    private setEditor(editor?: MonacoEditor): void {\n        if (this.editor === editor) {\n            return;\n        }\n        this.toDisposeOnEditor.dispose();\n        this.toDispose.push(this.toDisposeOnEditor);\n        this.editor = editor;\n        this.toDisposeOnEditor.push(Disposable.create(() => this.editor = undefined));\n\n        if (this.editor) {\n            const monacoEditor = this.editor.getControl();\n            this.toDisposeOnEditor.push(this.editor.onSelectionChanged(_ => {\n                this.updateProperties();\n            }));\n            this.toDisposeOnEditor.push(monacoEditor.onDidChangeModel(() => {\n                this.setEditor(undefined);\n            }));\n            this.toDisposeOnEditor.push(monacoEditor.onDidChangeCursorSelection(e => {\n                this.updateProperties(e.source);\n            }));\n            this.toDisposeOnEditor.push(monacoEditor.onDidChangeConfiguration(() => {\n                this.updateProperties();\n            }));\n            this.toDisposeOnEditor.push(monacoEditor.onDidLayoutChange(() => {\n                this.updateProperties();\n            }));\n            this.toDisposeOnEditor.push(monacoEditor.onDidScrollChange(() => {\n                this.updateProperties();\n            }));\n\n            this.updateProperties();\n\n        }\n    }\n\n    getId(): string {\n        return this.id;\n    }\n\n    getModel(): monaco.editor.IModel {\n        return this.model;\n    }\n\n    getProperties(): TextEditorPropertiesMain | undefined {\n        return this.properties;\n    }\n\n    get onPropertiesChangedEvent(): Event<EditorChangedPropertiesData> {\n        return this.onPropertiesChangedEmitter.event;\n    }\n\n    setSelections(selections: Selection[]): void {\n        if (this.editor) {\n            this.editor.getControl().setSelections(selections);\n            return;\n        }\n        const monacoSelections = selections.map(TextEditorMain.toMonacoSelections);\n        this.setProperties(new TextEditorPropertiesMain(monacoSelections, this.properties!.options, this.properties!.visibleRanges), undefined);\n    }\n\n    setConfiguration(newConfiguration: TextEditorConfigurationUpdate): void {\n        this.setIndentConfiguration(newConfiguration);\n\n        if (!this.editor) {\n            return;\n        }\n\n        if (newConfiguration.cursorStyle) {\n            const newCursorStyle = cursorStyleToString(newConfiguration.cursorStyle);\n            this.editor.getControl().updateOptions({\n                cursorStyle: newCursorStyle\n            });\n        }\n\n        if (typeof newConfiguration.lineNumbers !== 'undefined') {\n            let lineNumbers: 'on' | 'off' | 'relative';\n            switch (newConfiguration.lineNumbers) {\n                case TextEditorLineNumbersStyle.On:\n                    lineNumbers = 'on';\n                    break;\n                case TextEditorLineNumbersStyle.Relative:\n                    lineNumbers = 'relative';\n                    break;\n                default:\n                    lineNumbers = 'off';\n            }\n            this.editor.getControl().updateOptions({\n                lineNumbers: lineNumbers\n            });\n        }\n    }\n\n    private setIndentConfiguration(newConfiguration: TextEditorConfigurationUpdate): void {\n        if (newConfiguration.tabSize === 'auto' || newConfiguration.insertSpaces === 'auto') {\n\n            const creationOpts = this.model.getOptions();\n            let insertSpaces = creationOpts.insertSpaces;\n            let tabSize = creationOpts.tabSize;\n\n            if (newConfiguration.insertSpaces !== 'auto' && typeof newConfiguration.insertSpaces !== 'undefined') {\n                insertSpaces = newConfiguration.insertSpaces;\n            }\n\n            if (newConfiguration.tabSize !== 'auto' && typeof newConfiguration.tabSize !== 'undefined') {\n                tabSize = newConfiguration.tabSize;\n            }\n\n            this.model.detectIndentation(insertSpaces, tabSize);\n            return;\n        }\n\n        const newOpts: monaco.editor.ITextModelUpdateOptions = {};\n        if (typeof newConfiguration.insertSpaces !== 'undefined') {\n            newOpts.insertSpaces = newConfiguration.insertSpaces;\n        }\n        if (typeof newConfiguration.tabSize !== 'undefined') {\n            newOpts.tabSize = newConfiguration.tabSize;\n        }\n        this.model.updateOptions(newOpts);\n    }\n\n    revealRange(range: monaco.Range, revealType: TextEditorRevealType): void {\n        if (!this.editor) {\n            return;\n        }\n        switch (revealType) {\n            case TextEditorRevealType.Default:\n                this.editor.getControl().revealRange(range, monaco.editor.ScrollType.Smooth);\n                break;\n            case TextEditorRevealType.InCenter:\n                this.editor.getControl().revealRangeInCenter(range, monaco.editor.ScrollType.Smooth);\n                break;\n            case TextEditorRevealType.InCenterIfOutsideViewport:\n                this.editor.getControl().revealRangeInCenterIfOutsideViewport(range, monaco.editor.ScrollType.Smooth);\n                break;\n            case TextEditorRevealType.AtTop:\n                this.editor.getControl().revealRangeAtTop(range, monaco.editor.ScrollType.Smooth);\n                break;\n            default:\n                console.warn(`Unknown revealType: ${revealType}`);\n                break;\n        }\n    }\n\n    applyEdits(versionId: number, edits: SingleEditOperation[], opts: ApplyEditsOptions): boolean {\n        if (this.model.getVersionId() !== versionId) {\n            // model changed in the meantime\n            return false;\n        }\n\n        if (!this.editor) {\n            return false;\n        }\n\n        if (opts.setEndOfLine === EndOfLine.CRLF) {\n            this.model.setEOL(monaco.editor.EndOfLineSequence.CRLF);\n        } else if (opts.setEndOfLine === EndOfLine.LF) {\n            this.model.setEOL(monaco.editor.EndOfLineSequence.LF);\n        }\n\n        const editOperations: monaco.editor.IIdentifiedSingleEditOperation[] = [];\n        for (const edit of edits) {\n            const { range, text } = edit;\n            if (!range && !text) {\n                continue;\n            }\n            if (range && range.startLineNumber === range.endLineNumber && range.startColumn === range.endColumn && !edit.text) {\n                continue;\n            }\n\n            editOperations.push({\n                range: range ? monaco.Range.lift(range) : this.editor.getControl().getModel()!.getFullModelRange(),\n                /* eslint-disable-next-line no-null/no-null */\n                text: text || null,\n                forceMoveMarkers: edit.forceMoveMarkers\n            });\n        }\n\n        if (opts.undoStopBefore) {\n            this.editor.getControl().pushUndoStop();\n        }\n        this.editor.getControl().executeEdits('MainThreadTextEditor', editOperations);\n        if (opts.undoStopAfter) {\n            this.editor.getControl().pushUndoStop();\n        }\n        return true;\n    }\n\n    insertSnippet(template: string, ranges: Range[], opts: UndoStopOptions): boolean {\n        const snippetController: SnippetController2 | null | undefined = this.editor?.getControl().getContribution('snippetController2');\n\n        if (!snippetController || !this.editor) { return false; }\n\n        const selections = ranges.map(r => new monaco.Selection(r.startLineNumber, r.startColumn, r.endLineNumber, r.endColumn));\n        this.editor.getControl().setSelections(selections);\n        this.editor.focus();\n\n        snippetController.insert(template, 0, 0, opts.undoStopBefore, opts.undoStopAfter);\n\n        return true;\n    }\n\n    setDecorations(key: string, ranges: DecorationOptions[]): void {\n        if (!this.editor) {\n            return;\n        }\n        (this.editor.getControl() as unknown as StandaloneCodeEditor)\n            .setDecorationsByType('Plugin decorations', key, ranges.map(option => Object.assign(option, { color: undefined })));\n    }\n\n    setDecorationsFast(key: string, _ranges: number[]): void {\n        if (!this.editor) {\n            return;\n        }\n        const ranges: Range[] = [];\n        const len = Math.floor(_ranges.length / 4);\n        for (let i = 0; i < len; i++) {\n            ranges[i] = new monaco.Range(_ranges[4 * i], _ranges[4 * i + 1], _ranges[4 * i + 2], _ranges[4 * i + 3]);\n        }\n        (this.editor.getControl() as unknown as StandaloneCodeEditor).setDecorationsByTypeFast(key, ranges);\n    }\n\n    private static toMonacoSelections(selection: Selection): monaco.Selection {\n        return new monaco.Selection(selection.selectionStartLineNumber, selection.selectionStartColumn, selection.positionLineNumber, selection.positionColumn);\n    }\n}\n\n// TODO move to monaco typings!\ninterface SnippetController2 extends monaco.editor.IEditorContribution {\n    insert(template: string,\n        overwriteBefore: number, overwriteAfter: number,\n        undoStopBefore: boolean, undoStopAfter: boolean): void;\n    finish(): void;\n    cancel(): void;\n    dispose(): void;\n    prev(): void;\n    next(): void;\n}\n\nexport class TextEditorPropertiesMain {\n    constructor(\n        readonly selections: monaco.Selection[],\n        readonly options: TextEditorConfiguration,\n        readonly visibleRanges: monaco.Range[]\n    ) {\n    }\n\n    generateDelta(old: TextEditorPropertiesMain | undefined, source: string | undefined): EditorChangedPropertiesData | undefined {\n        const result: EditorChangedPropertiesData = {\n            options: undefined,\n            selections: undefined,\n            visibleRanges: undefined\n        };\n\n        if (!old || !TextEditorPropertiesMain.selectionsEqual(old.selections, this.selections)) {\n            result.selections = {\n                selections: this.selections,\n                source: source\n            };\n        }\n\n        if (!old || !TextEditorPropertiesMain.optionsEqual(old.options, this.options)) {\n            result.options = this.options;\n        }\n\n        if (!old || !TextEditorPropertiesMain.rangesEqual(old.visibleRanges, this.visibleRanges)) {\n            result.visibleRanges = this.visibleRanges;\n        }\n\n        if (result.selections || result.visibleRanges || result.options) {\n            return result;\n        }\n\n        return undefined;\n    }\n\n    static readFromEditor(prevProperties: TextEditorPropertiesMain | undefined, model: monaco.editor.IModel, editor: MonacoEditor): TextEditorPropertiesMain {\n        const selections = TextEditorPropertiesMain.getSelectionsFromEditor(prevProperties, editor);\n        const options = TextEditorPropertiesMain.getOptionsFromEditor(prevProperties, model, editor);\n        const visibleRanges = TextEditorPropertiesMain.getVisibleRangesFromEditor(prevProperties, editor);\n        return new TextEditorPropertiesMain(selections, options, visibleRanges);\n    }\n\n    private static getSelectionsFromEditor(prevProperties: TextEditorPropertiesMain | undefined, editor: MonacoEditor): monaco.Selection[] {\n        let result: monaco.Selection[] | undefined = undefined;\n        if (editor) {\n            result = editor.getControl().getSelections() || undefined;\n        }\n\n        if (!result && prevProperties) {\n            result = prevProperties.selections;\n        }\n\n        if (!result) {\n            result = [new monaco.Selection(1, 1, 1, 1)];\n        }\n        return result;\n    }\n\n    private static getOptionsFromEditor(prevProperties: TextEditorPropertiesMain | undefined, model: monaco.editor.IModel, editor: MonacoEditor): TextEditorConfiguration {\n        if (model.isDisposed()) {\n            return prevProperties!.options;\n        }\n\n        let cursorStyle: TextEditorCursorStyle;\n        let lineNumbers: TextEditorLineNumbersStyle;\n        if (editor) {\n            const editorOptions = editor.getControl().getOptions();\n            const lineNumbersOpts = editorOptions.get(monaco.editor.EditorOption.lineNumbers);\n            cursorStyle = editorOptions.get(monaco.editor.EditorOption.cursorStyle);\n            switch (lineNumbersOpts.renderType) {\n                case monaco.editor.RenderLineNumbersType.Off:\n                    lineNumbers = TextEditorLineNumbersStyle.Off;\n                    break;\n                case monaco.editor.RenderLineNumbersType.Relative:\n                    lineNumbers = TextEditorLineNumbersStyle.Relative;\n                    break;\n                default:\n                    lineNumbers = TextEditorLineNumbersStyle.On;\n                    break;\n            }\n        } else if (prevProperties) {\n            cursorStyle = prevProperties.options.cursorStyle;\n            lineNumbers = prevProperties.options.lineNumbers;\n        } else {\n            cursorStyle = TextEditorCursorStyle.Line;\n            lineNumbers = TextEditorLineNumbersStyle.On;\n        }\n\n        const modelOptions = model.getOptions();\n        return {\n            insertSpaces: modelOptions.insertSpaces,\n            tabSize: modelOptions.tabSize,\n            cursorStyle,\n            lineNumbers,\n        };\n    }\n\n    private static getVisibleRangesFromEditor(prevProperties: TextEditorPropertiesMain | undefined, editor: MonacoEditor): monaco.Range[] {\n        if (editor) {\n            return editor.getControl().getVisibleRanges();\n        }\n        return [];\n    }\n\n    private static selectionsEqual(a: monaco.Selection[], b: monaco.Selection[]): boolean {\n        if (a.length !== b.length) {\n            return false;\n        }\n        for (let i = 0; i < a.length; i++) {\n            if (!a[i].equalsSelection(b[i])) {\n                return false;\n            }\n        }\n        return true;\n    }\n\n    private static optionsEqual(a: TextEditorConfiguration, b: TextEditorConfiguration): boolean {\n        if (a && !b || !a && b) {\n            return false;\n        }\n        if (!a && !b) {\n            return true;\n        }\n        return (\n            a.tabSize === b.tabSize\n            && a.insertSpaces === b.insertSpaces\n            && a.cursorStyle === b.cursorStyle\n            && a.lineNumbers === b.lineNumbers\n        );\n    }\n\n    private static rangesEqual(a: monaco.Range[], b: monaco.Range[]): boolean {\n        if (a.length !== b.length) {\n            return false;\n        }\n        for (let i = 0; i < a.length; i++) {\n            if (!a[i].equalsRange(b[i])) {\n                return false;\n            }\n        }\n        return true;\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\nimport { Event, Emitter } from '@theia/core';\nimport { MonacoEditorModel, WillSaveMonacoModelEvent } from '@theia/monaco/lib/browser/monaco-editor-model';\nimport { injectable, inject } from '@theia/core/shared/inversify';\nimport { MonacoTextModelService } from '@theia/monaco/lib/browser/monaco-text-model-service';\nimport { MonacoWorkspace } from '@theia/monaco/lib/browser/monaco-workspace';\nimport { Schemes } from '../../common/uri-components';\nimport URI from '@theia/core/lib/common/uri';\nimport { Reference } from '@theia/core/lib/common/reference';\n\n@injectable()\nexport class EditorModelService {\n\n    private monacoModelService: MonacoTextModelService;\n    private modelModeChangedEmitter = new Emitter<{ model: MonacoEditorModel, oldModeId: string }>();\n    private onModelRemovedEmitter = new Emitter<MonacoEditorModel>();\n    private modelDirtyEmitter = new Emitter<MonacoEditorModel>();\n    private modelSavedEmitter = new Emitter<MonacoEditorModel>();\n    private onModelWillSavedEmitter = new Emitter<WillSaveMonacoModelEvent>();\n\n    readonly onModelDirtyChanged = this.modelDirtyEmitter.event;\n    readonly onModelSaved = this.modelSavedEmitter.event;\n    readonly onModelModeChanged = this.modelModeChangedEmitter.event;\n    readonly onModelRemoved = this.onModelRemovedEmitter.event;\n    readonly onModelWillSave = this.onModelWillSavedEmitter.event;\n\n    constructor(@inject(MonacoTextModelService) monacoModelService: MonacoTextModelService,\n        @inject(MonacoWorkspace) monacoWorkspace: MonacoWorkspace) {\n\n        this.monacoModelService = monacoModelService;\n        monacoModelService.models.forEach(model => this.modelCreated(model));\n        monacoModelService.onDidCreate(this.modelCreated, this);\n        monacoWorkspace.onDidCloseTextDocument(model => {\n            setTimeout(() => {\n                this.onModelRemovedEmitter.fire(model);\n            }, 1);\n        });\n    }\n\n    private modelCreated(model: MonacoEditorModel): void {\n        model.textEditorModel.onDidChangeLanguage(e => {\n            this.modelModeChangedEmitter.fire({ model, oldModeId: e.oldLanguage });\n        });\n\n        model.onDidSaveModel(_ => {\n            this.modelSavedEmitter.fire(model);\n        });\n\n        model.onDirtyChanged(_ => {\n            this.modelDirtyEmitter.fire(model);\n        });\n        model.onWillSaveModel(willSaveModelEvent => {\n            this.onModelWillSavedEmitter.fire(willSaveModelEvent);\n        });\n    }\n\n    get onModelAdded(): Event<MonacoEditorModel> {\n        return this.monacoModelService.onDidCreate;\n    }\n\n    getModels(): MonacoEditorModel[] {\n        return this.monacoModelService.models;\n    }\n\n    async saveAll(includeUntitled?: boolean): Promise<boolean> {\n        const saves = [];\n        for (const model of this.monacoModelService.models) {\n            const { uri } = model.textEditorModel;\n            if (model.dirty && (includeUntitled || uri.scheme !== Schemes.untitled)) {\n                saves.push((async () => {\n                    try {\n                        await model.save();\n                        return true;\n                    } catch (e) {\n                        console.error('Failed to save ', uri.toString(), e);\n                        return false;\n                    }\n                })());\n            }\n        }\n        const results = await Promise.all(saves);\n        return results.reduce((a, b) => a && b, true);\n    }\n\n    async createModelReference(uri: URI): Promise<Reference<MonacoEditorModel>> {\n        return this.monacoModelService.createModelReference(uri);\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { URI } from '@theia/core/shared/vscode-uri';\nimport {\n    TextEditorsMain,\n    MAIN_RPC_CONTEXT,\n    TextEditorsExt,\n    TextEditorConfigurationUpdate,\n    Selection,\n    TextEditorRevealType,\n    SingleEditOperation,\n    ApplyEditsOptions,\n    UndoStopOptions,\n    DecorationRenderOptions,\n    ThemeDecorationInstanceRenderOptions,\n    DecorationOptions,\n    WorkspaceEditDto,\n    DocumentsMain,\n    WorkspaceEditMetadataDto,\n} from '../../common/plugin-api-rpc';\nimport { Range, TextDocumentShowOptions } from '../../common/plugin-api-rpc-model';\nimport { EditorsAndDocumentsMain } from './editors-and-documents-main';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\nimport { TextEditorMain } from './text-editor-main';\nimport { disposed } from '../../common/errors';\nimport { toMonacoWorkspaceEdit } from './languages-main';\nimport { MonacoBulkEditService } from '@theia/monaco/lib/browser/monaco-bulk-edit-service';\nimport { MonacoEditorService } from '@theia/monaco/lib/browser/monaco-editor-service';\nimport { theiaUritoUriComponents, UriComponents } from '../../common/uri-components';\nimport { Endpoint } from '@theia/core/lib/browser/endpoint';\nimport * as monaco from '@theia/monaco-editor-core';\nimport { ResourceEdit } from '@theia/monaco-editor-core/esm/vs/editor/browser/services/bulkEditService';\nimport { IDecorationRenderOptions } from '@theia/monaco-editor-core/esm/vs/editor/common/editorCommon';\n\nexport class TextEditorsMainImpl implements TextEditorsMain, Disposable {\n\n    private readonly proxy: TextEditorsExt;\n    private readonly toDispose = new DisposableCollection();\n    private readonly editorsToDispose = new Map<string, DisposableCollection>();\n    private readonly fileEndpoint = new Endpoint({ path: 'file' }).getRestUrl();\n\n    constructor(\n        private readonly editorsAndDocuments: EditorsAndDocumentsMain,\n        private readonly documents: DocumentsMain,\n        rpc: RPCProtocol,\n        private readonly bulkEditService: MonacoBulkEditService,\n        private readonly monacoEditorService: MonacoEditorService,\n    ) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.TEXT_EDITORS_EXT);\n        this.toDispose.push(editorsAndDocuments);\n        this.toDispose.push(editorsAndDocuments.onTextEditorAdd(editors => editors.forEach(this.onTextEditorAdd, this)));\n        this.toDispose.push(editorsAndDocuments.onTextEditorRemove(editors => editors.forEach(this.onTextEditorRemove, this)));\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    private onTextEditorAdd(editor: TextEditorMain): void {\n        const id = editor.getId();\n        const toDispose = new DisposableCollection(\n            editor.onPropertiesChangedEvent(e => {\n                this.proxy.$acceptEditorPropertiesChanged(id, e);\n            }),\n            Disposable.create(() => this.editorsToDispose.delete(id))\n        );\n        this.editorsToDispose.set(id, toDispose);\n        this.toDispose.push(toDispose);\n    }\n\n    private onTextEditorRemove(id: string): void {\n        const disposables = this.editorsToDispose.get(id);\n        if (disposables) {\n            disposables.dispose();\n        }\n    }\n\n    $tryShowTextDocument(uri: UriComponents, options?: TextDocumentShowOptions): Promise<void> {\n        return this.documents.$tryShowDocument(uri, options);\n    }\n\n    $trySetOptions(id: string, options: TextEditorConfigurationUpdate): Promise<void> {\n        if (!this.editorsAndDocuments.getEditor(id)) {\n            return Promise.reject(disposed(`TextEditor: ${id}`));\n        }\n        this.editorsAndDocuments.getEditor(id)!.setConfiguration(options);\n        return Promise.resolve();\n    }\n\n    $trySetSelections(id: string, selections: Selection[]): Promise<void> {\n        if (!this.editorsAndDocuments.getEditor(id)) {\n            return Promise.reject(disposed(`TextEditor: ${id}`));\n        }\n        this.editorsAndDocuments.getEditor(id)!.setSelections(selections);\n        return Promise.resolve();\n    }\n\n    $tryRevealRange(id: string, range: Range, revealType: TextEditorRevealType): Promise<void> {\n        if (!this.editorsAndDocuments.getEditor(id)) {\n            return Promise.reject(disposed(`TextEditor(${id})`));\n        }\n\n        this.editorsAndDocuments.getEditor(id)!.revealRange(new monaco.Range(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn), revealType);\n        return Promise.resolve();\n    }\n\n    $tryApplyEdits(id: string, modelVersionId: number, edits: SingleEditOperation[], opts: ApplyEditsOptions): Promise<boolean> {\n        if (!this.editorsAndDocuments.getEditor(id)) {\n            return Promise.reject(disposed(`TextEditor(${id})`));\n        }\n\n        return Promise.resolve(this.editorsAndDocuments.getEditor(id)!.applyEdits(modelVersionId, edits, opts));\n    }\n\n    async $tryApplyWorkspaceEdit(dto: WorkspaceEditDto, metadata?: WorkspaceEditMetadataDto): Promise<boolean> {\n        const workspaceEdit = toMonacoWorkspaceEdit(dto);\n        try {\n            const edits = ResourceEdit.convert(workspaceEdit);\n            const { success } = await this.bulkEditService.apply(edits, { respectAutoSaveConfig: metadata?.isRefactoring });\n            return success;\n        } catch {\n            return false;\n        }\n    }\n\n    $tryInsertSnippet(id: string, template: string, ranges: Range[], opts: UndoStopOptions): Promise<boolean> {\n        if (!this.editorsAndDocuments.getEditor(id)) {\n            return Promise.reject(disposed(`TextEditor(${id})`));\n        }\n        return Promise.resolve(this.editorsAndDocuments.getEditor(id)!.insertSnippet(template, ranges, opts));\n    }\n\n    $registerTextEditorDecorationType(key: string, options: DecorationRenderOptions | IDecorationRenderOptions): void {\n        this.injectRemoteUris(options);\n        this.monacoEditorService.registerDecorationType('Plugin decoration', key, options as IDecorationRenderOptions);\n        this.toDispose.push(Disposable.create(() => this.$removeTextEditorDecorationType(key)));\n    }\n\n    protected injectRemoteUris(options: DecorationRenderOptions | ThemeDecorationInstanceRenderOptions): void {\n        if (options.before) {\n            options.before.contentIconPath = this.toRemoteUri(options.before.contentIconPath);\n        }\n        if (options.after) {\n            options.after.contentIconPath = this.toRemoteUri(options.after.contentIconPath);\n        }\n        if ('gutterIconPath' in options) {\n            options.gutterIconPath = this.toRemoteUri(options.gutterIconPath);\n        }\n        if ('dark' in options && options.dark) {\n            this.injectRemoteUris(options.dark);\n        }\n        if ('light' in options && options.light) {\n            this.injectRemoteUris(options.light);\n        }\n    }\n\n    protected toRemoteUri(uri?: UriComponents): UriComponents | undefined {\n        if (uri && uri.scheme === 'file') {\n            return theiaUritoUriComponents(this.fileEndpoint.withQuery(URI.revive(uri).toString()));\n        }\n        return uri;\n    }\n\n    $removeTextEditorDecorationType(key: string): void {\n        this.monacoEditorService.removeDecorationType(key);\n    }\n\n    $tryHideEditor(id: string): Promise<void> {\n        return this.editorsAndDocuments.hideEditor(id);\n    }\n\n    $trySetDecorations(id: string, key: string, ranges: DecorationOptions[]): Promise<void> {\n        if (!this.editorsAndDocuments.getEditor(id)) {\n            return Promise.reject(disposed(`TextEditor(${id})`));\n        }\n        this.editorsAndDocuments.getEditor(id)!.setDecorations(key, ranges);\n        return Promise.resolve();\n    }\n\n    $trySetDecorationsFast(id: string, key: string, ranges: number[]): Promise<void> {\n        if (!this.editorsAndDocuments.getEditor(id)) {\n            return Promise.reject(disposed(`TextEditor(${id})`));\n        }\n        this.editorsAndDocuments.getEditor(id)!.setDecorationsFast(key, ranges);\n        return Promise.resolve();\n    }\n\n    $saveAll(includeUntitled?: boolean): Promise<boolean> {\n        return this.editorsAndDocuments.saveAll(includeUntitled);\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2020 Ericsson and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { MAIN_RPC_CONTEXT, ThemingMain, ThemingExt } from '../../common/plugin-api-rpc';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport { ThemeService } from '@theia/core/lib/browser/theming';\nimport { Disposable } from '@theia/core/lib/common/disposable';\n\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n// some code copied and modified from https://github.com/microsoft/vscode/blob/bafca191f55a234fad20ab67bb689aacc80e7a1a/src/vs/workbench/api/browser/mainThreadTheming.ts\n\nexport class ThemingMainImpl implements ThemingMain {\n\n    private readonly proxy: ThemingExt;\n    private readonly themeChangeListener: Disposable;\n\n    constructor(rpc: RPCProtocol, themeService: ThemeService) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.THEMING_EXT);\n        this.themeChangeListener = themeService.onDidColorThemeChange(e => this.proxy.$onColorThemeChange(e.newTheme.type));\n        this.proxy.$onColorThemeChange(themeService.getCurrentTheme().type);\n    }\n\n    dispose(): void {\n        this.themeChangeListener.dispose();\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { MAIN_RPC_CONTEXT, TimelineExt, TimelineMain } from '../../common/plugin-api-rpc';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport { TimelineService } from '@theia/timeline/lib/browser/timeline-service';\nimport { Emitter } from '@theia/core/lib/common';\nimport { URI } from '@theia/core/shared/vscode-uri';\nimport {\n    InternalTimelineOptions,\n    Timeline,\n    TimelineOptions,\n    TimelineProviderDescriptor,\n    TimelineChangeEvent\n} from '@theia/timeline/lib/common/timeline-model';\n\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n// some code copied and modified from https://github.com/microsoft/vscode/blob/afacd2bdfe7060f09df9b9139521718915949757/src/vs/workbench/api/browser/mainThreadTimeline.ts\n\nexport class TimelineMainImpl implements TimelineMain {\n    private readonly proxy: TimelineExt;\n    private readonly timelineService: TimelineService;\n    private readonly providerEmitters = new Map<string, Emitter<TimelineChangeEvent>>();\n    constructor(rpc: RPCProtocol, container: interfaces.Container) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.TIMELINE_EXT);\n        this.timelineService = container.get<TimelineService>(TimelineService);\n    }\n\n    async $registerTimelineProvider(provider: TimelineProviderDescriptor): Promise<void> {\n        const proxy = this.proxy;\n\n        const emitters = this.providerEmitters;\n        let onDidChange = emitters.get(provider.id);\n        if (onDidChange === undefined) {\n            onDidChange = new Emitter<TimelineChangeEvent>();\n            emitters.set(provider.id, onDidChange);\n        }\n\n        this.timelineService.registerTimelineProvider({\n            ...provider,\n            onDidChange: onDidChange.event,\n            provideTimeline(uri: URI, options: TimelineOptions, internalOptions?: InternalTimelineOptions): Promise<Timeline | undefined> {\n                return proxy.$getTimeline(provider.id, uri, options, internalOptions);\n            },\n            dispose(): void {\n                emitters.delete(provider.id);\n                if (onDidChange) {\n                    onDidChange.dispose();\n                }\n            }\n        });\n    }\n\n    async $unregisterTimelineProvider(id: string): Promise<void> {\n        this.timelineService.unregisterTimelineProvider(id);\n    }\n\n    async $fireTimelineChanged(e: TimelineChangeEvent): Promise<void> {\n        const emitter = this.providerEmitters.get(e.id);\n        if (emitter) {\n            emitter.fire(e);\n        }\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2019 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { injectable, inject } from '@theia/core/shared/inversify';\nimport { Emitter, Event } from '@theia/core/lib/common/event';\nimport { ApplicationShell } from '@theia/core/lib/browser/shell/application-shell';\nimport { toArray } from '@theia/core/shared/@phosphor/algorithm';\nimport { TabBar, Widget } from '@theia/core/shared/@phosphor/widgets';\n\n@injectable()\nexport class ViewColumnService {\n    private readonly columnValues = new Map<string, number>();\n    private readonly viewColumnIds = new Map<number, string[]>();\n\n    protected readonly onViewColumnChangedEmitter = new Emitter<{ id: string, viewColumn: number }>();\n\n    constructor(\n        @inject(ApplicationShell) private readonly shell: ApplicationShell,\n    ) {\n        let oldColumnValues = new Map<string, number>();\n        const update = async () => {\n            await new Promise<void>((resolve => setTimeout(resolve)));\n            this.updateViewColumns();\n            this.viewColumnIds.forEach((ids: string[], viewColumn: number) => {\n                ids.forEach((id: string) => {\n                    if (!oldColumnValues.has(id) || oldColumnValues.get(id) !== viewColumn) {\n                        this.onViewColumnChangedEmitter.fire({ id, viewColumn });\n                    }\n                });\n            });\n            oldColumnValues = new Map(this.columnValues.entries());\n        };\n        this.shell.mainPanel.widgetAdded.connect(() => update());\n        this.shell.mainPanel.widgetRemoved.connect(() => update());\n    }\n\n    get onViewColumnChanged(): Event<{ id: string, viewColumn: number }> {\n        return this.onViewColumnChangedEmitter.event;\n    }\n\n    updateViewColumns(): void {\n        this.columnValues.clear();\n        this.viewColumnIds.clear();\n\n        const rows = new Map<number, Set<number>>();\n        const columns = new Map<number, Map<number, TabBar<Widget>>>();\n        for (const tabBar of toArray(this.shell.mainPanel.tabBars())) {\n            if (!tabBar.node.style.top || !tabBar.node.style.left) {\n                continue;\n            }\n            const top = parseInt(tabBar.node.style.top);\n            const left = parseInt(tabBar.node.style.left);\n\n            const row = rows.get(top) || new Set<number>();\n            row.add(left);\n            rows.set(top, row);\n\n            const column = columns.get(left) || new Map<number, TabBar<Widget>>();\n            column.set(top, tabBar);\n            columns.set(left, column);\n        }\n        const firstRow = rows.get([...rows.keys()].sort()[0]);\n        if (!firstRow) {\n            return;\n        }\n        const lefts = [...firstRow.keys()].sort();\n        for (let i = 0; i < lefts.length; i++) {\n            const column = columns.get(lefts[i]);\n            if (!column) {\n                break;\n            }\n            const cellIndexes = [...column.keys()].sort();\n            let viewColumn = Math.min(i, 2);\n            for (let j = 0; j < cellIndexes.length; j++) {\n                const cell = column.get(cellIndexes[j]);\n                if (!cell) {\n                    break;\n                }\n                this.setViewColumn(cell, viewColumn);\n                if (viewColumn < 7) {\n                    viewColumn += 3;\n                }\n            }\n        }\n    }\n\n    protected setViewColumn(tabBar: TabBar<Widget>, viewColumn: number): void {\n        const ids = [];\n        for (const title of tabBar.titles) {\n            const id = title.owner.id;\n            ids.push(id);\n            this.columnValues.set(id, viewColumn);\n        }\n        this.viewColumnIds.set(viewColumn, ids);\n    }\n\n    getViewColumnIds(viewColumn: number): string[] {\n        return this.viewColumnIds.get(viewColumn) || [];\n    }\n\n    getViewColumn(id: string): number | undefined {\n        return this.columnValues.get(id);\n    }\n\n    hasViewColumn(id: string): boolean {\n        return this.columnValues.has(id);\n    }\n\n    viewColumnsSize(): number {\n        return this.viewColumnIds.size;\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { injectable, inject, postConstruct, optional } from '@theia/core/shared/inversify';\nimport {\n    ApplicationShell, ViewContainer as ViewContainerWidget, WidgetManager, QuickViewService,\n    ViewContainerIdentifier, ViewContainerTitleOptions, Widget, FrontendApplicationContribution,\n    StatefulWidget, CommonMenus, TreeViewWelcomeWidget, ViewContainerPart, BaseWidget\n} from '@theia/core/lib/browser';\nimport { ViewContainer, View, ViewWelcome, PluginViewType } from '../../../common';\nimport { PluginSharedStyle } from '../plugin-shared-style';\nimport { DebugWidget } from '@theia/debug/lib/browser/view/debug-widget';\nimport { PluginViewWidget, PluginViewWidgetIdentifier } from './plugin-view-widget';\nimport { SCM_VIEW_CONTAINER_ID, ScmContribution } from '@theia/scm/lib/browser/scm-contribution';\nimport { EXPLORER_VIEW_CONTAINER_ID, FileNavigatorWidget, FILE_NAVIGATOR_ID } from '@theia/navigator/lib/browser';\nimport { FileNavigatorContribution } from '@theia/navigator/lib/browser/navigator-contribution';\nimport { DebugFrontendApplicationContribution } from '@theia/debug/lib/browser/debug-frontend-application-contribution';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\nimport { CommandRegistry } from '@theia/core/lib/common/command';\nimport { MenuModelRegistry } from '@theia/core/lib/common/menu';\nimport { Emitter, Event } from '@theia/core/lib/common/event';\nimport { ContextKey, ContextKeyService } from '@theia/core/lib/browser/context-key-service';\nimport { ViewContextKeyService } from './view-context-key-service';\nimport { PROBLEMS_WIDGET_ID } from '@theia/markers/lib/browser/problem/problem-widget';\nimport { OutputWidget } from '@theia/output/lib/browser/output-widget';\nimport { DebugConsoleContribution } from '@theia/debug/lib/browser/console/debug-console-contribution';\nimport { TreeViewWidget } from './tree-view-widget';\nimport { SEARCH_VIEW_CONTAINER_ID } from '@theia/search-in-workspace/lib/browser/search-in-workspace-factory';\nimport { TEST_VIEW_CONTAINER_ID } from '@theia/test/lib/browser/view/test-view-contribution';\nimport { ThemeIcon } from '@theia/monaco-editor-core/esm/vs/platform/theme/common/themeService';\nimport { WebviewView, WebviewViewResolver } from '../webview-views/webview-views';\nimport { WebviewWidget, WebviewWidgetIdentifier } from '../webview/webview';\nimport { CancellationToken } from '@theia/core/lib/common/cancellation';\nimport { v4 } from 'uuid';\nimport { nls } from '@theia/core';\nimport { TheiaDockPanel } from '@theia/core/lib/browser/shell/theia-dock-panel';\nimport { Deferred } from '@theia/core/lib/common/promise-util';\n\nexport const PLUGIN_VIEW_FACTORY_ID = 'plugin-view';\nexport const PLUGIN_VIEW_CONTAINER_FACTORY_ID = 'plugin-view-container';\nexport const PLUGIN_VIEW_DATA_FACTORY_ID = 'plugin-view-data';\n\nexport type ViewDataProvider = (params: { state?: object, viewInfo: View }) => Promise<TreeViewWidget>;\n\n@injectable()\nexport class PluginViewRegistry implements FrontendApplicationContribution {\n\n    @inject(ApplicationShell)\n    protected readonly shell: ApplicationShell;\n\n    @inject(PluginSharedStyle)\n    protected readonly style: PluginSharedStyle;\n\n    @inject(WidgetManager)\n    protected readonly widgetManager: WidgetManager;\n\n    @inject(ScmContribution)\n    protected readonly scm: ScmContribution;\n\n    @inject(FileNavigatorContribution)\n    protected readonly explorer: FileNavigatorContribution;\n\n    @inject(DebugFrontendApplicationContribution)\n    protected readonly debug: DebugFrontendApplicationContribution;\n\n    @inject(CommandRegistry)\n    protected readonly commands: CommandRegistry;\n\n    @inject(MenuModelRegistry)\n    protected readonly menus: MenuModelRegistry;\n\n    @inject(QuickViewService) @optional()\n    protected readonly quickView: QuickViewService;\n\n    @inject(ContextKeyService)\n    protected readonly contextKeyService: ContextKeyService;\n\n    @inject(ViewContextKeyService)\n    protected readonly viewContextKeys: ViewContextKeyService;\n\n    protected readonly onDidExpandViewEmitter = new Emitter<string>();\n    readonly onDidExpandView = this.onDidExpandViewEmitter.event;\n\n    private readonly views = new Map<string, [string, View]>();\n    private readonly viewsWelcome = new Map<string, ViewWelcome[]>();\n    private readonly viewContainers = new Map<string, [string, ViewContainerTitleOptions]>();\n    private readonly containerViews = new Map<string, string[]>();\n    private readonly viewClauseContexts = new Map<string, Set<string> | undefined>();\n\n    private readonly viewDataProviders = new Map<string, ViewDataProvider>();\n    private readonly viewDataState = new Map<string, object>();\n\n    private readonly webviewViewResolvers = new Map<string, WebviewViewResolver>();\n    protected readonly onNewResolverRegisteredEmitter = new Emitter<{ readonly viewType: string }>();\n    readonly onNewResolverRegistered = this.onNewResolverRegisteredEmitter.event;\n\n    private readonly webviewViewRevivals = new Map<string, { readonly webview: WebviewView; readonly revival: Deferred<void> }>();\n\n    private static readonly ID_MAPPINGS: Map<string, string> = new Map([\n        // VS Code Viewlets\n        [EXPLORER_VIEW_CONTAINER_ID, 'workbench.view.explorer'],\n        [SCM_VIEW_CONTAINER_ID, 'workbench.view.scm'],\n        [SEARCH_VIEW_CONTAINER_ID, 'workbench.view.search'],\n        [DebugWidget.ID, 'workbench.view.debug'],\n        ['vsx-extensions-view-container', 'workbench.view.extensions'], // cannot use the id from 'vsx-registry' package because of circular dependency\n        [PROBLEMS_WIDGET_ID, 'workbench.panel.markers'],\n        [TEST_VIEW_CONTAINER_ID, 'workbench.view.testing'],\n        [OutputWidget.ID, 'workbench.panel.output'],\n        [DebugConsoleContribution.options.id, 'workbench.panel.repl'],\n        // Theia does not have a single terminal widget, but instead each terminal gets its own widget. Therefore \"the terminal widget is active\" doesn't make sense in Theia\n        // [TERMINAL_WIDGET_FACTORY_ID, 'workbench.panel.terminal'],\n        // [?? , 'workbench.panel.comments'] not sure what this mean: we don't show comments in sidebars nor the bottom\n    ]);\n\n    @postConstruct()\n    protected init(): void {\n\n        // TODO workbench.panel.comments - Theia does not have a proper comments view yet\n\n        this.updateFocusedView();\n        this.shell.onDidChangeActiveWidget(() => this.updateFocusedView());\n\n        this.widgetManager.onWillCreateWidget(({ factoryId, widget, waitUntil }) => {\n            if (factoryId === EXPLORER_VIEW_CONTAINER_ID && widget instanceof ViewContainerWidget) {\n                waitUntil(this.prepareViewContainer('explorer', widget));\n            }\n            if (factoryId === SCM_VIEW_CONTAINER_ID && widget instanceof ViewContainerWidget) {\n                waitUntil(this.prepareViewContainer('scm', widget));\n            }\n            if (factoryId === SEARCH_VIEW_CONTAINER_ID && widget instanceof ViewContainerWidget) {\n                waitUntil(this.prepareViewContainer('search', widget));\n            }\n            if (factoryId === TEST_VIEW_CONTAINER_ID && widget instanceof ViewContainerWidget) {\n                waitUntil(this.prepareViewContainer('test', widget));\n            }\n            if (factoryId === DebugWidget.ID && widget instanceof DebugWidget) {\n                const viewContainer = widget['sessionWidget']['viewContainer'];\n                waitUntil(this.prepareViewContainer('debug', viewContainer));\n            }\n            if (factoryId === PLUGIN_VIEW_CONTAINER_FACTORY_ID && widget instanceof ViewContainerWidget) {\n                waitUntil(this.prepareViewContainer(this.toViewContainerId(widget.options), widget));\n            }\n            if (factoryId === PLUGIN_VIEW_FACTORY_ID && widget instanceof PluginViewWidget) {\n                waitUntil(this.prepareView(widget));\n            }\n        });\n        this.widgetManager.onDidCreateWidget(event => {\n            if (event.widget instanceof FileNavigatorWidget) {\n                const disposable = new DisposableCollection();\n                disposable.push(this.registerViewWelcome({\n                    view: 'explorer',\n                    content: nls.localizeByDefault(\n                        'You have not yet opened a folder.\\n{0}',\n                        `[${nls.localizeByDefault('Open Folder')}](command:workbench.action.files.openFolder)`\n                    ),\n                    order: 0\n                }));\n                disposable.push(event.widget.onDidDispose(() => disposable.dispose()));\n            }\n        });\n        this.contextKeyService.onDidChange(e => {\n            for (const [, view] of this.views.values()) {\n                const clauseContext = this.viewClauseContexts.get(view.id);\n                if (clauseContext && e.affects(clauseContext)) {\n                    this.updateViewVisibility(view.id);\n                }\n            }\n            for (const [viewId, viewWelcomes] of this.viewsWelcome) {\n                for (const [index] of viewWelcomes.entries()) {\n                    const viewWelcomeId = this.toViewWelcomeId(index, viewId);\n                    const clauseContext = this.viewClauseContexts.get(viewWelcomeId);\n                    if (clauseContext && e.affects(clauseContext)) {\n                        this.updateViewWelcomeVisibility(viewId);\n                    }\n                }\n            }\n        });\n\n        const hookDockPanelKey = (panel: TheiaDockPanel, key: ContextKey<string>) => {\n            let toDisposeOnActivate = new DisposableCollection();\n            panel.onDidChangeCurrent(title => {\n                toDisposeOnActivate.dispose();\n                toDisposeOnActivate = new DisposableCollection();\n                if (title && title.owner instanceof BaseWidget) {\n                    const widget = title.owner;\n                    let value = PluginViewRegistry.ID_MAPPINGS.get(widget.id);\n                    if (!value) {\n                        if (widget.id.startsWith(PLUGIN_VIEW_CONTAINER_FACTORY_ID)) {\n                            value = this.toViewContainerId({ id: widget.id });\n                        }\n                    }\n                    const setKey = () => {\n                        if (widget.isVisible && value) {\n                            key.set(value);\n                        } else {\n                            key.reset();\n                        }\n                    };\n                    toDisposeOnActivate.push(widget.onDidChangeVisibility(() => {\n                        setKey();\n                    }));\n                    setKey();\n\n                }\n            });\n        };\n\n        hookDockPanelKey(this.shell.leftPanelHandler.dockPanel, this.viewContextKeys.activeViewlet);\n        hookDockPanelKey(this.shell.rightPanelHandler.dockPanel, this.viewContextKeys.activeAuxiliary);\n        hookDockPanelKey(this.shell.bottomPanel, this.viewContextKeys.activePanel);\n    }\n\n    protected async updateViewWelcomeVisibility(viewId: string): Promise<void> {\n        const widget = await this.getTreeViewWelcomeWidget(viewId);\n        if (widget) {\n            widget.handleWelcomeContextChange();\n        }\n    }\n\n    protected async updateViewVisibility(viewId: string): Promise<void> {\n        const widget = await this.getView(viewId);\n        if (!widget) {\n            if (this.isViewVisible(viewId)) {\n                await this.openView(viewId);\n            }\n            return;\n        }\n        const viewInfo = this.views.get(viewId);\n        if (!viewInfo) {\n            return;\n        }\n        const [viewContainerId] = viewInfo;\n        const viewContainer = await this.getPluginViewContainer(viewContainerId);\n        if (!viewContainer) {\n            return;\n        }\n        const part = viewContainer.getPartFor(widget);\n        if (!part) {\n            return;\n        }\n        widget.updateViewVisibility(() =>\n            part.setHidden(!this.isViewVisible(viewId))\n        );\n    }\n\n    protected isViewVisible(viewId: string): boolean {\n        const viewInfo = this.views.get(viewId);\n        if (!viewInfo) {\n            return false;\n        }\n        const [, view] = viewInfo;\n        return view.when === undefined || view.when === 'true' || this.contextKeyService.match(view.when);\n    }\n\n    registerViewContainer(location: string, viewContainer: ViewContainer): Disposable {\n        if (this.viewContainers.has(viewContainer.id)) {\n            console.warn('view container such id already registered: ', JSON.stringify(viewContainer));\n            return Disposable.NULL;\n        }\n        const toDispose = new DisposableCollection();\n        const containerClass = 'theia-plugin-view-container';\n        let themeIconClass = '';\n        const iconClass = 'plugin-view-container-icon-' + viewContainer.id;\n\n        if (viewContainer.themeIcon) {\n            const icon = ThemeIcon.fromString(viewContainer.themeIcon);\n            if (icon) {\n                themeIconClass = ThemeIcon.asClassName(icon) ?? '';\n            }\n        }\n\n        if (!themeIconClass) {\n            const iconUrl = PluginSharedStyle.toExternalIconUrl(viewContainer.iconUrl);\n            toDispose.push(this.style.insertRule('.' + containerClass + '.' + iconClass, () => `\n                mask: url('${iconUrl}') no-repeat 50% 50%;\n                -webkit-mask: url('${iconUrl}') no-repeat 50% 50%;\n            `));\n        }\n\n        toDispose.push(this.doRegisterViewContainer(viewContainer.id, location, {\n            label: viewContainer.title,\n            // The container class automatically sets a mask; if we're using a theme icon, we don't want one.\n            iconClass: (themeIconClass || containerClass) + ' ' + iconClass,\n            closeable: true\n        }));\n        return toDispose;\n    }\n\n    protected async toggleViewContainer(id: string): Promise<void> {\n        let widget = await this.getPluginViewContainer(id);\n        if (widget && widget.isAttached) {\n            widget.dispose();\n        } else {\n            widget = await this.openViewContainer(id);\n            if (widget) {\n                this.shell.activateWidget(widget.id);\n            }\n        }\n    }\n\n    protected doRegisterViewContainer(id: string, location: string, options: ViewContainerTitleOptions): Disposable {\n        const toDispose = new DisposableCollection();\n        this.viewContainers.set(id, [location, options]);\n        toDispose.push(Disposable.create(() => this.viewContainers.delete(id)));\n        const toggleCommandId = `plugin.view-container.${id}.toggle`;\n        toDispose.push(this.commands.registerCommand({\n            id: toggleCommandId,\n            label: 'Toggle ' + options.label + ' View'\n        }, {\n            execute: () => this.toggleViewContainer(id)\n        }));\n        toDispose.push(this.menus.registerMenuAction(CommonMenus.VIEW_VIEWS, {\n            commandId: toggleCommandId,\n            label: options.label\n        }));\n        toDispose.push(this.quickView?.registerItem({\n            label: options.label,\n            open: async () => {\n                const widget = await this.openViewContainer(id);\n                if (widget) {\n                    this.shell.activateWidget(widget.id);\n                }\n            }\n        }));\n        toDispose.push(Disposable.create(async () => {\n            const widget = await this.getPluginViewContainer(id);\n            if (widget) {\n                widget.dispose();\n            }\n        }));\n        return toDispose;\n    }\n\n    getContainerViews(viewContainerId: string): string[] {\n        return this.containerViews.get(viewContainerId) || [];\n    }\n\n    registerView(viewContainerId: string, view: View): Disposable {\n        if (this.views.has(view.id)) {\n            console.warn('view with such id already registered: ', JSON.stringify(view));\n            return Disposable.NULL;\n        }\n        const toDispose = new DisposableCollection();\n\n        view.when = view.when?.trim();\n        this.views.set(view.id, [viewContainerId, view]);\n        toDispose.push(Disposable.create(() => this.views.delete(view.id)));\n\n        const containerViews = this.getContainerViews(viewContainerId);\n        containerViews.push(view.id);\n        this.containerViews.set(viewContainerId, containerViews);\n        toDispose.push(Disposable.create(() => {\n            const index = containerViews.indexOf(view.id);\n            if (index !== -1) {\n                containerViews.splice(index, 1);\n            }\n        }));\n\n        if (view.when && view.when !== 'false' && view.when !== 'true') {\n            const keys = this.contextKeyService.parseKeys(view.when);\n            if (keys) {\n                this.viewClauseContexts.set(view.id, keys);\n                toDispose.push(Disposable.create(() => this.viewClauseContexts.delete(view.id)));\n            }\n        }\n        toDispose.push(this.quickView?.registerItem({\n            label: view.name,\n            when: view.when,\n            open: () => this.openView(view.id, { activate: true })\n        }));\n        toDispose.push(this.commands.registerCommand({ id: `${view.id}.focus` }, {\n            execute: async () => { await this.openView(view.id, { activate: true }); }\n        }));\n        return toDispose;\n    }\n\n    async resolveWebviewView(viewId: string, webview: WebviewView, cancellation: CancellationToken): Promise<void> {\n        const resolver = this.webviewViewResolvers.get(viewId);\n        if (resolver) {\n            return resolver.resolve(webview, cancellation);\n        }\n        const pendingRevival = this.webviewViewRevivals.get(viewId);\n        if (pendingRevival) {\n            return pendingRevival.revival.promise;\n        }\n        const pending = new Deferred<void>();\n        this.webviewViewRevivals.set(viewId, { webview, revival: pending });\n        return pending.promise;\n    }\n\n    async registerWebviewView(viewId: string, resolver: WebviewViewResolver): Promise<Disposable> {\n        if (this.webviewViewResolvers.has(viewId)) {\n            throw new Error(`View resolver already registered for ${viewId}`);\n        }\n        this.webviewViewResolvers.set(viewId, resolver);\n        this.onNewResolverRegisteredEmitter.fire({ viewType: viewId });\n\n        const toDispose = new DisposableCollection(Disposable.create(() => this.webviewViewResolvers.delete(viewId)));\n        this.initView(viewId, toDispose);\n\n        const pendingRevival = this.webviewViewRevivals.get(viewId);\n        if (pendingRevival) {\n            resolver.resolve(pendingRevival.webview, CancellationToken.None).then(() => {\n                this.webviewViewRevivals.delete(viewId);\n                pendingRevival.revival.resolve();\n            });\n        }\n\n        return toDispose;\n    }\n\n    protected async createNewWebviewView(viewId: string): Promise<WebviewView> {\n        const webview = await this.widgetManager.getOrCreateWidget<WebviewWidget>(\n            WebviewWidget.FACTORY_ID, <WebviewWidgetIdentifier>{ id: v4() });\n        webview.setContentOptions({ allowScripts: true });\n\n        let _description: string | undefined;\n        let _resolved = false;\n        let _pendingResolution: Promise<void> | undefined;\n\n        const webviewView: WebviewView = {\n            webview,\n\n            get onDidChangeVisibility(): Event<boolean> { return webview.onDidChangeVisibility; },\n            get onDidDispose(): Event<void> { return webview.onDidDispose; },\n\n            get title(): string | undefined { return webview.title.label; },\n            set title(value: string | undefined) { webview.title.label = value || ''; },\n\n            get description(): string | undefined { return _description; },\n            set description(value: string | undefined) { _description = value; },\n\n            get badge(): number | undefined { return webview.badge; },\n            set badge(badge: number | undefined) { webview.badge = badge; },\n\n            get badgeTooltip(): string | undefined { return webview.badgeTooltip; },\n            set badgeTooltip(badgeTooltip: string | undefined) { webview.badgeTooltip = badgeTooltip; },\n            onDidChangeBadge: webview.onDidChangeBadge,\n            onDidChangeBadgeTooltip: webview.onDidChangeBadgeTooltip,\n\n            dispose: () => {\n                _resolved = false;\n                webview.dispose();\n                toDispose.dispose();\n            },\n            resolve: async () => {\n                if (_resolved) {\n                    return;\n                }\n                if (_pendingResolution) {\n                    return _pendingResolution;\n                }\n                _pendingResolution = this.resolveWebviewView(viewId, webviewView, CancellationToken.None).then(() => {\n                    _resolved = true;\n                    _pendingResolution = undefined;\n                });\n                return _pendingResolution;\n            },\n            show: webview.show\n        };\n\n        const toDispose = this.onNewResolverRegistered(resolver => {\n            if (resolver.viewType === viewId) {\n                // Potentially re-activate if we have a new resolver\n                webviewView.resolve();\n            }\n        });\n\n        webviewView.resolve();\n        return webviewView;\n    }\n\n    registerViewWelcome(viewWelcome: ViewWelcome): Disposable {\n        const toDispose = new DisposableCollection();\n\n        const viewsWelcome = this.viewsWelcome.get(viewWelcome.view) || [];\n        if (viewsWelcome.some(e => e.content === viewWelcome.content)) {\n            return toDispose;\n        }\n        viewsWelcome.push(viewWelcome);\n        this.viewsWelcome.set(viewWelcome.view, viewsWelcome);\n        this.handleViewWelcomeChange(viewWelcome.view);\n        toDispose.push(Disposable.create(() => {\n            const index = viewsWelcome.indexOf(viewWelcome);\n            if (index !== -1) {\n                viewsWelcome.splice(index, 1);\n            }\n            this.handleViewWelcomeChange(viewWelcome.view);\n        }));\n\n        if (viewWelcome.when) {\n            const index = viewsWelcome.indexOf(viewWelcome);\n            const viewWelcomeId = this.toViewWelcomeId(index, viewWelcome.view);\n            this.viewClauseContexts.set(viewWelcomeId, this.contextKeyService.parseKeys(viewWelcome.when));\n            toDispose.push(Disposable.create(() => this.viewClauseContexts.delete(viewWelcomeId)));\n        }\n        return toDispose;\n    }\n\n    async handleViewWelcomeChange(viewId: string): Promise<void> {\n        const widget = await this.getTreeViewWelcomeWidget(viewId);\n        if (widget) {\n            widget.handleViewWelcomeContentChange(this.getViewWelcomes(viewId));\n        }\n    }\n\n    protected async getTreeViewWelcomeWidget(viewId: string): Promise<TreeViewWelcomeWidget | undefined> {\n        switch (viewId) {\n            case 'explorer':\n                return this.widgetManager.getWidget<TreeViewWelcomeWidget>(FILE_NAVIGATOR_ID);\n            default:\n                return this.widgetManager.getWidget<TreeViewWelcomeWidget>(PLUGIN_VIEW_DATA_FACTORY_ID, { id: viewId });\n        }\n    }\n\n    getViewWelcomes(viewId: string): ViewWelcome[] {\n        return this.viewsWelcome.get(viewId) || [];\n    }\n\n    async getView(viewId: string): Promise<PluginViewWidget | undefined> {\n        if (!this.views.has(viewId)) {\n            return undefined;\n        }\n        return this.widgetManager.getWidget<PluginViewWidget>(PLUGIN_VIEW_FACTORY_ID, this.toPluginViewWidgetIdentifier(viewId));\n    }\n\n    async openView(viewId: string, options?: { activate?: boolean, reveal?: boolean }): Promise<PluginViewWidget | undefined> {\n        const view = await this.doOpenView(viewId);\n        if (view && options) {\n            if (options.activate === true) {\n                await this.shell.activateWidget(view.id);\n            } else if (options.reveal === true) {\n                await this.shell.revealWidget(view.id);\n            }\n        }\n        return view;\n    }\n    protected async doOpenView(viewId: string): Promise<PluginViewWidget | undefined> {\n        const widget = await this.getView(viewId);\n        if (widget) {\n            return widget;\n        }\n        const data = this.views.get(viewId);\n        if (!data) {\n            return undefined;\n        }\n        const [containerId] = data;\n        await this.openViewContainer(containerId);\n        return this.getView(viewId);\n    }\n\n    protected async prepareView(widget: PluginViewWidget): Promise<void> {\n        const data = this.views.get(widget.options.viewId);\n        if (!data) {\n            return;\n        }\n        const [, view] = data;\n        if (!widget.title.label) {\n            widget.title.label = view.name;\n        }\n        const currentDataWidget = widget.widgets[0];\n        const webviewId = currentDataWidget instanceof WebviewWidget ? currentDataWidget.identifier?.id : undefined;\n        const viewDataWidget = await this.createViewDataWidget(view.id, webviewId);\n        if (widget.isDisposed) {\n            viewDataWidget?.dispose();\n            return;\n        }\n        if (currentDataWidget !== viewDataWidget) {\n            if (currentDataWidget) {\n                currentDataWidget.dispose();\n            }\n            if (viewDataWidget) {\n                widget.addWidget(viewDataWidget);\n            }\n        }\n    }\n\n    protected getOrCreateViewContainerWidget(containerId: string): Promise<ViewContainerWidget> {\n        const identifier = this.toViewContainerIdentifier(containerId);\n        return this.widgetManager.getOrCreateWidget<ViewContainerWidget>(PLUGIN_VIEW_CONTAINER_FACTORY_ID, identifier);\n    }\n\n    async openViewContainer(containerId: string): Promise<ViewContainerWidget | undefined> {\n        if (containerId === 'explorer') {\n            const widget = await this.explorer.openView();\n            if (widget.parent instanceof ViewContainerWidget) {\n                return widget.parent;\n            }\n            return undefined;\n        }\n        if (containerId === 'scm') {\n            const widget = await this.scm.openView();\n            if (widget.parent instanceof ViewContainerWidget) {\n                return widget.parent;\n            }\n            return undefined;\n        }\n        if (containerId === 'debug') {\n            const widget = await this.debug.openView();\n            return widget['sessionWidget']['viewContainer'];\n        }\n        const data = this.viewContainers.get(containerId);\n        if (!data) {\n            return undefined;\n        }\n        const [location] = data;\n        const containerWidget = await this.getOrCreateViewContainerWidget(containerId);\n        if (!containerWidget.isAttached) {\n            await this.shell.addWidget(containerWidget, {\n                area: ApplicationShell.isSideArea(location) ? location : 'left',\n                rank: Number.MAX_SAFE_INTEGER\n            });\n        }\n        return containerWidget;\n    }\n\n    protected async prepareViewContainer(viewContainerId: string, containerWidget: ViewContainerWidget): Promise<void> {\n        const data = this.viewContainers.get(viewContainerId);\n        if (data) {\n            const [, options] = data;\n            containerWidget.setTitleOptions(options);\n        }\n        for (const viewId of this.getContainerViews(viewContainerId)) {\n            const identifier = this.toPluginViewWidgetIdentifier(viewId);\n            // Keep existing widget in its current container and reregister its part to the plugin view widget events.\n            const existingWidget = this.widgetManager.tryGetWidget<PluginViewWidget>(PLUGIN_VIEW_FACTORY_ID, identifier);\n            if (existingWidget && existingWidget.currentViewContainerId) {\n                const currentContainer = await this.getPluginViewContainer(existingWidget.currentViewContainerId);\n                if (currentContainer && this.registerWidgetPartEvents(existingWidget, currentContainer)) {\n                    continue;\n                }\n            }\n            const widget = await this.widgetManager.getOrCreateWidget<PluginViewWidget>(PLUGIN_VIEW_FACTORY_ID, identifier);\n            if (containerWidget.getTrackableWidgets().indexOf(widget) === -1) {\n                containerWidget.addWidget(widget, {\n                    initiallyCollapsed: !!containerWidget.getParts().length,\n                    initiallyHidden: !this.isViewVisible(viewId)\n                });\n            }\n            this.registerWidgetPartEvents(widget, containerWidget);\n        }\n    }\n\n    protected registerWidgetPartEvents(widget: PluginViewWidget, containerWidget: ViewContainerWidget): ViewContainerPart | undefined {\n        const part = containerWidget.getPartFor(widget);\n        if (part) {\n\n            widget.currentViewContainerId = this.getViewContainerId(containerWidget);\n            part.onDidMove(event => { widget.currentViewContainerId = this.getViewContainerId(event); });\n\n            // if a view is explicitly hidden then suppress updating visibility based on `when` closure\n            part.onDidChangeVisibility(() => widget.suppressUpdateViewVisibility = part.isHidden);\n\n            const tryFireOnDidExpandView = () => {\n                if (widget.widgets.length === 0) {\n                    if (!part.collapsed && part.isVisible) {\n                        const viewId = this.toViewId(widget.options);\n                        this.onDidExpandViewEmitter.fire(viewId);\n                    }\n                } else {\n                    toFire.dispose();\n                }\n            };\n            const toFire = new DisposableCollection(\n                part.onCollapsed(tryFireOnDidExpandView),\n                part.onDidChangeVisibility(tryFireOnDidExpandView)\n            );\n\n            tryFireOnDidExpandView();\n            return part;\n        }\n    };\n\n    protected getViewContainerId(container: ViewContainerWidget): string | undefined {\n        const description = this.widgetManager.getDescription(container);\n        switch (description?.factoryId) {\n            case EXPLORER_VIEW_CONTAINER_ID: return 'explorer';\n            case SCM_VIEW_CONTAINER_ID: return 'scm';\n            case SEARCH_VIEW_CONTAINER_ID: return 'search';\n            case TEST_VIEW_CONTAINER_ID: return 'test';\n            case undefined: return container.parent?.parent instanceof DebugWidget ? 'debug' : container.id;\n            case PLUGIN_VIEW_CONTAINER_FACTORY_ID: return this.toViewContainerId(description.options);\n            default: return container.id;\n        }\n    }\n\n    protected async getPluginViewContainer(viewContainerId: string): Promise<ViewContainerWidget | undefined> {\n        if (viewContainerId === 'explorer') {\n            return this.widgetManager.getWidget<ViewContainerWidget>(EXPLORER_VIEW_CONTAINER_ID);\n        }\n        if (viewContainerId === 'scm') {\n            return this.widgetManager.getWidget<ViewContainerWidget>(SCM_VIEW_CONTAINER_ID);\n        }\n        if (viewContainerId === 'search') {\n            return this.widgetManager.getWidget<ViewContainerWidget>(SEARCH_VIEW_CONTAINER_ID);\n        }\n        if (viewContainerId === 'test') {\n            return this.widgetManager.getWidget<ViewContainerWidget>(TEST_VIEW_CONTAINER_ID);\n        }\n        if (viewContainerId === 'debug') {\n            const debug = await this.widgetManager.getWidget(DebugWidget.ID);\n            if (debug instanceof DebugWidget) {\n                return debug['sessionWidget']['viewContainer'];\n            }\n        }\n        const identifier = this.toViewContainerIdentifier(viewContainerId);\n        return this.widgetManager.getWidget<ViewContainerWidget>(PLUGIN_VIEW_CONTAINER_FACTORY_ID, identifier);\n    }\n\n    protected async initViewContainer(containerId: string): Promise<void> {\n        let viewContainer = await this.getPluginViewContainer(containerId);\n        if (!viewContainer) {\n            viewContainer = await this.openViewContainer(containerId);\n            if (viewContainer && !viewContainer.getParts().filter(part => !part.isHidden).length) {\n                // close view containers without any visible view parts\n                viewContainer.dispose();\n            }\n        } else {\n            await this.prepareViewContainer(this.toViewContainerId(viewContainer.options), viewContainer);\n        }\n    }\n\n    async initWidgets(): Promise<void> {\n        const promises: Promise<void>[] = [];\n        for (const id of this.viewContainers.keys()) {\n            promises.push((async () => {\n                await this.initViewContainer(id);\n            })().catch(console.error));\n        }\n        promises.push((async () => {\n            const explorer = await this.widgetManager.getWidget(EXPLORER_VIEW_CONTAINER_ID);\n            if (explorer instanceof ViewContainerWidget) {\n                await this.prepareViewContainer('explorer', explorer);\n            }\n        })().catch(console.error));\n        promises.push((async () => {\n            const scm = await this.widgetManager.getWidget(SCM_VIEW_CONTAINER_ID);\n            if (scm instanceof ViewContainerWidget) {\n                await this.prepareViewContainer('scm', scm);\n            }\n        })().catch(console.error));\n        promises.push((async () => {\n            const search = await this.widgetManager.getWidget(SEARCH_VIEW_CONTAINER_ID);\n            if (search instanceof ViewContainerWidget) {\n                await this.prepareViewContainer('search', search);\n            }\n        })().catch(console.error));\n        promises.push((async () => {\n            const test = await this.widgetManager.getWidget(TEST_VIEW_CONTAINER_ID);\n            if (test instanceof ViewContainerWidget) {\n                await this.prepareViewContainer('test', test);\n            }\n        })().catch(console.error));\n        promises.push((async () => {\n            const debug = await this.widgetManager.getWidget(DebugWidget.ID);\n            if (debug instanceof DebugWidget) {\n                const viewContainer = debug['sessionWidget']['viewContainer'];\n                await this.prepareViewContainer('debug', viewContainer);\n            }\n        })().catch(console.error));\n        await Promise.all(promises);\n    }\n\n    async removeStaleWidgets(): Promise<void> {\n        const views = this.widgetManager.getWidgets(PLUGIN_VIEW_FACTORY_ID);\n        for (const view of views) {\n            if (view instanceof PluginViewWidget) {\n                const id = this.toViewId(view.options);\n                if (!this.views.has(id)) {\n                    view.dispose();\n                }\n            }\n        }\n        const viewContainers = this.widgetManager.getWidgets(PLUGIN_VIEW_CONTAINER_FACTORY_ID);\n        for (const viewContainer of viewContainers) {\n            if (viewContainer instanceof ViewContainerWidget) {\n                const id = this.toViewContainerId(viewContainer.options);\n                if (!this.viewContainers.has(id)) {\n                    viewContainer.dispose();\n                }\n            }\n        }\n    }\n\n    protected toViewContainerIdentifier(viewContainerId: string): ViewContainerIdentifier {\n        return { id: PLUGIN_VIEW_CONTAINER_FACTORY_ID + ':' + viewContainerId, progressLocationId: viewContainerId };\n    }\n    protected toViewContainerId(identifier: ViewContainerIdentifier): string {\n        return identifier.id.substring(PLUGIN_VIEW_CONTAINER_FACTORY_ID.length + 1);\n    }\n\n    protected toPluginViewWidgetIdentifier(viewId: string): PluginViewWidgetIdentifier {\n        return { id: PLUGIN_VIEW_FACTORY_ID + ':' + viewId, viewId };\n    }\n    protected toViewId(identifier: PluginViewWidgetIdentifier): string {\n        return identifier.viewId;\n    }\n\n    protected toViewWelcomeId(index: number, viewId: string): string {\n        return `view-welcome.${viewId}.${index}`;\n    }\n\n    /**\n     * retrieve restored layout state from previous user session but close widgets\n     * widgets should be opened only when view data providers are registered\n     */\n    onDidInitializeLayout(): void {\n        const widgets = this.widgetManager.getWidgets(PLUGIN_VIEW_DATA_FACTORY_ID);\n        for (const widget of widgets) {\n            if (StatefulWidget.is(widget)) {\n                const state = widget.storeState();\n                if (state) {\n                    this.viewDataState.set(widget.id, state);\n                }\n            }\n            widget.dispose();\n        }\n    }\n\n    registerViewDataProvider(viewId: string, provider: ViewDataProvider): Disposable {\n        if (this.viewDataProviders.has(viewId)) {\n            console.error(`data provider for '${viewId}' view is already registered`);\n            return Disposable.NULL;\n        }\n        this.viewDataProviders.set(viewId, provider);\n        const toDispose = new DisposableCollection(Disposable.create(() => {\n            this.viewDataProviders.delete(viewId);\n            this.viewDataState.delete(viewId);\n        }));\n        this.initView(viewId, toDispose);\n        return toDispose;\n    }\n\n    protected async initView(viewId: string, toDispose: DisposableCollection): Promise<void> {\n        const view = await this.getView(viewId);\n        if (toDispose.disposed) {\n            return;\n        }\n        if (view) {\n            if (view.isVisible) {\n                await this.prepareView(view);\n            } else {\n                const toDisposeOnDidExpandView = new DisposableCollection(this.onDidExpandView(async id => {\n                    if (id === viewId) {\n                        unsubscribe();\n                        await this.prepareView(view);\n                    }\n                }));\n                const unsubscribe = () => toDisposeOnDidExpandView.dispose();\n                view.disposed.connect(unsubscribe);\n                toDisposeOnDidExpandView.push(Disposable.create(() => view.disposed.disconnect(unsubscribe)));\n                toDispose.push(toDisposeOnDidExpandView);\n            }\n        }\n    }\n\n    protected async createViewDataWidget(viewId: string, webviewId?: string): Promise<Widget | undefined> {\n        const view = this.views.get(viewId);\n        if (view?.[1]?.type === PluginViewType.Webview) {\n            return this.createWebviewWidget(viewId, webviewId);\n        }\n        const provider = this.viewDataProviders.get(viewId);\n        if (!view || !provider) {\n            return undefined;\n        }\n        const [, viewInfo] = view;\n        const state = this.viewDataState.get(viewId);\n        const widget = await provider({ state, viewInfo });\n        widget.handleViewWelcomeContentChange(this.getViewWelcomes(viewId));\n        if (StatefulWidget.is(widget)) {\n            this.storeViewDataStateOnDispose(viewId, widget);\n        } else {\n            this.viewDataState.delete(viewId);\n        }\n        return widget;\n    }\n\n    protected async createWebviewWidget(viewId: string, webviewId?: string): Promise<Widget | undefined> {\n        if (!webviewId) {\n            const webviewView = await this.createNewWebviewView(viewId);\n            webviewId = webviewView.webview.identifier.id;\n        }\n        const webviewWidget = this.widgetManager.getWidget(WebviewWidget.FACTORY_ID, <WebviewWidgetIdentifier>{ id: webviewId });\n        return webviewWidget;\n    }\n\n    protected storeViewDataStateOnDispose(viewId: string, widget: Widget & StatefulWidget): void {\n        const dispose = widget.dispose.bind(widget);\n        widget.dispose = () => {\n            const state = widget.storeState();\n            if (state) {\n                this.viewDataState.set(viewId, state);\n            }\n            dispose();\n        };\n    }\n\n    protected isVisibleWidget(widget: Widget): boolean {\n        return !widget.isDisposed && widget.isVisible;\n    }\n\n    protected updateFocusedView(): void {\n        const widget = this.shell.activeWidget;\n        if (widget instanceof PluginViewWidget) {\n            this.viewContextKeys.focusedView.set(widget.options.viewId);\n        } else {\n            this.viewContextKeys.focusedView.reset();\n        }\n    }\n}\n\n","// *****************************************************************************\n// Copyright (C) 2019 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { injectable, inject, postConstruct } from '@theia/core/shared/inversify';\nimport { Panel, Widget } from '@theia/core/shared/@phosphor/widgets';\nimport { MenuModelRegistry } from '@theia/core/lib/common/menu';\nimport { CommandRegistry } from '@theia/core/lib/common/command';\nimport { StatefulWidget } from '@theia/core/lib/browser/shell/shell-layout-restorer';\nimport { Message } from '@theia/core/shared/@phosphor/messaging';\nimport { TreeViewWidget } from './tree-view-widget';\nimport { BadgeWidget, DescriptionWidget, DynamicToolbarWidget } from '@theia/core/lib/browser/view-container';\nimport { DisposableCollection, Emitter, Event } from '@theia/core/lib/common';\nimport { ContextKeyService } from '@theia/core/lib/browser/context-key-service';\n\n@injectable()\nexport class PluginViewWidgetIdentifier {\n    id: string;\n    viewId: string;\n}\n\n@injectable()\nexport class PluginViewWidget extends Panel implements StatefulWidget, DescriptionWidget, BadgeWidget, DynamicToolbarWidget {\n\n    currentViewContainerId?: string;\n\n    protected _message?: string;\n    protected _description: string = '';\n    protected _badge?: number | undefined;\n    protected _badgeTooltip?: string | undefined;\n    protected _suppressUpdateViewVisibility = false;\n    protected updatingViewVisibility = false;\n    protected onDidChangeDescriptionEmitter = new Emitter<void>();\n    protected onDidChangeBadgeEmitter = new Emitter<void>();\n    protected onDidChangeBadgeTooltipEmitter = new Emitter<void>();\n    protected toDispose = new DisposableCollection(this.onDidChangeDescriptionEmitter, this.onDidChangeBadgeEmitter, this.onDidChangeBadgeTooltipEmitter);\n    protected readonly onDidChangeToolbarItemsEmitter = new Emitter<void>();\n\n    get onDidChangeToolbarItems(): Event<void> {\n        return this.onDidChangeToolbarItemsEmitter.event;\n    }\n\n    @inject(MenuModelRegistry)\n    protected readonly menus: MenuModelRegistry;\n\n    @inject(CommandRegistry)\n    protected readonly commands: CommandRegistry;\n\n    @inject(ContextKeyService)\n    protected readonly contextKeyService: ContextKeyService;\n\n    @inject(PluginViewWidgetIdentifier)\n    readonly options: PluginViewWidgetIdentifier;\n\n    constructor() {\n        super();\n        this.node.tabIndex = -1;\n        this.node.style.height = '100%';\n    }\n\n    @postConstruct()\n    protected init(): void {\n        this.id = this.options.id;\n        const localContext = this.contextKeyService.createScoped(this.node);\n        localContext.setContext('view', this.options.viewId);\n        this.toDispose.push(localContext);\n    }\n\n    get onDidChangeDescription(): Event<void> {\n        return this.onDidChangeDescriptionEmitter.event;\n    }\n\n    get onDidChangeBadge(): Event<void> {\n        return this.onDidChangeBadgeEmitter.event;\n    }\n\n    get onDidChangeBadgeTooltip(): Event<void> {\n        return this.onDidChangeBadgeTooltipEmitter.event;\n    }\n\n    protected override onActivateRequest(msg: Message): void {\n        super.onActivateRequest(msg);\n        const widget = this.widgets[0];\n        if (widget) {\n            widget.activate();\n            this.updateWidgetMessage();\n        } else {\n            this.node.focus();\n        }\n    }\n\n    storeState(): PluginViewWidget.State {\n        return {\n            label: this.title.label,\n            message: this.message,\n            widgets: this.widgets,\n            suppressUpdateViewVisibility: this._suppressUpdateViewVisibility,\n            currentViewContainerId: this.currentViewContainerId\n        };\n    }\n\n    restoreState(state: PluginViewWidget.State): void {\n        this.title.label = state.label;\n        this.message = state.message;\n        this.suppressUpdateViewVisibility = state.suppressUpdateViewVisibility;\n        this.currentViewContainerId = state.currentViewContainerId;\n        for (const widget of state.widgets) {\n            this.addWidget(widget);\n        }\n    }\n\n    set suppressUpdateViewVisibility(suppressUpdateViewVisibility: boolean) {\n        this._suppressUpdateViewVisibility = !this.updatingViewVisibility && suppressUpdateViewVisibility;\n    }\n\n    updateViewVisibility(cb: () => void): void {\n        if (this._suppressUpdateViewVisibility) {\n            return;\n        }\n        try {\n            this.updatingViewVisibility = true;\n            cb();\n        } finally {\n            this.updatingViewVisibility = false;\n        }\n    }\n\n    get message(): string | undefined {\n        return this._message;\n    }\n\n    set message(message: string | undefined) {\n        this._message = message;\n        this.updateWidgetMessage();\n    }\n\n    get description(): string {\n        return this._description;\n    }\n\n    set description(description: string) {\n        this._description = description;\n        this.onDidChangeDescriptionEmitter.fire();\n    }\n\n    get badge(): number | undefined {\n        const widget = this.widgets[0];\n        if (BadgeWidget.is(widget)) {\n            return widget.badge;\n        }\n        return this._badge;\n    }\n\n    set badge(badge: number | undefined) {\n        this._badge = badge;\n        this.onDidChangeBadgeEmitter.fire();\n    }\n\n    get badgeTooltip(): string | undefined {\n        const widget = this.widgets[0];\n        if (BadgeWidget.is(widget)) {\n            return widget.badgeTooltip;\n        }\n        return this._badgeTooltip;\n    }\n\n    set badgeTooltip(badgeTooltip: string | undefined) {\n        this._badgeTooltip = badgeTooltip;\n        this.onDidChangeBadgeTooltipEmitter.fire();\n    }\n\n    private updateWidgetMessage(): void {\n        const widget = this.widgets[0];\n        if (widget) {\n            if (widget instanceof TreeViewWidget) {\n                widget.message = this._message;\n            }\n        }\n    }\n\n    override addWidget(widget: Widget): void {\n        super.addWidget(widget);\n        if (BadgeWidget.is(widget)) {\n            widget.onDidChangeBadge(() => this.onDidChangeBadgeEmitter.fire());\n            widget.onDidChangeBadgeTooltip(() => this.onDidChangeBadgeTooltipEmitter.fire());\n        }\n        this.updateWidgetMessage();\n        this.onDidChangeToolbarItemsEmitter.fire();\n    }\n\n    override insertWidget(index: number, widget: Widget): void {\n        super.insertWidget(index, widget);\n        this.updateWidgetMessage();\n        this.onDidChangeToolbarItemsEmitter.fire();\n    }\n\n    override dispose(): void {\n        this.toDispose.dispose();\n        super.dispose();\n    }\n}\nexport namespace PluginViewWidget {\n    export interface State {\n        label: string,\n        message?: string,\n        widgets: ReadonlyArray<Widget>,\n        suppressUpdateViewVisibility: boolean;\n        currentViewContainerId: string | undefined;\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { MAIN_RPC_CONTEXT, TreeViewsMain, TreeViewsExt, TreeViewRevealOptions, RegisterTreeDataProviderOptions } from '../../../common/plugin-api-rpc';\nimport { RPCProtocol } from '../../../common/rpc-protocol';\nimport { PluginViewRegistry, PLUGIN_VIEW_DATA_FACTORY_ID } from './plugin-view-registry';\nimport {\n    SelectableTreeNode,\n    ExpandableTreeNode,\n    CompositeTreeNode,\n    WidgetManager\n} from '@theia/core/lib/browser';\nimport { ViewContextKeyService } from './view-context-key-service';\nimport { Disposable, DisposableCollection } from '@theia/core';\nimport { TreeViewWidget, TreeViewNode, PluginTreeModel, TreeViewWidgetOptions } from './tree-view-widget';\nimport { PluginViewWidget } from './plugin-view-widget';\nimport { BinaryBuffer } from '@theia/core/lib/common/buffer';\nimport { DnDFileContentStore } from './dnd-file-content-store';\nimport { ViewBadge } from '@theia/plugin';\n\nexport class TreeViewsMainImpl implements TreeViewsMain, Disposable {\n\n    private readonly proxy: TreeViewsExt;\n    private readonly viewRegistry: PluginViewRegistry;\n    private readonly contextKeys: ViewContextKeyService;\n    private readonly widgetManager: WidgetManager;\n    private readonly fileContentStore: DnDFileContentStore;\n\n    private readonly treeViewProviders = new Map<string, Disposable>();\n\n    private readonly toDispose = new DisposableCollection(\n        Disposable.create(() => { /* mark as not disposed */ })\n    );\n\n    constructor(rpc: RPCProtocol, private container: interfaces.Container) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.TREE_VIEWS_EXT);\n        this.viewRegistry = container.get(PluginViewRegistry);\n\n        this.contextKeys = this.container.get(ViewContextKeyService);\n        this.widgetManager = this.container.get(WidgetManager);\n        this.fileContentStore = this.container.get(DnDFileContentStore);\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    async $registerTreeDataProvider(treeViewId: string, $options: RegisterTreeDataProviderOptions): Promise<void> {\n        this.treeViewProviders.set(treeViewId, this.viewRegistry.registerViewDataProvider(treeViewId, async ({ state, viewInfo }) => {\n            const options: TreeViewWidgetOptions = {\n                id: treeViewId,\n                manageCheckboxStateManually: $options.manageCheckboxStateManually,\n                showCollapseAll: $options.showCollapseAll,\n                multiSelect: $options.canSelectMany,\n                dragMimeTypes: $options.dragMimeTypes,\n                dropMimeTypes: $options.dropMimeTypes\n            };\n            const widget = await this.widgetManager.getOrCreateWidget<TreeViewWidget>(PLUGIN_VIEW_DATA_FACTORY_ID, options);\n            widget.model.viewInfo = viewInfo;\n            if (state) {\n                widget.restoreState(state);\n                // ensure that state is completely restored\n                await widget.model.refresh();\n            } else if (!widget.model.root) {\n                const root: CompositeTreeNode & ExpandableTreeNode = {\n                    id: '',\n                    parent: undefined,\n                    name: '',\n                    visible: false,\n                    expanded: true,\n                    children: []\n                };\n                widget.model.root = root;\n            }\n            if (this.toDispose.disposed) {\n                widget.model.proxy = undefined;\n            } else {\n                widget.model.proxy = this.proxy;\n                this.toDispose.push(Disposable.create(() => widget.model.proxy = undefined));\n                this.handleTreeEvents(widget.id, widget);\n            }\n            await widget.model.refresh();\n            return widget;\n        }));\n        this.toDispose.push(Disposable.create(() => this.$unregisterTreeDataProvider(treeViewId)));\n    }\n\n    async $unregisterTreeDataProvider(treeViewId: string): Promise<void> {\n        const treeDataProvider = this.treeViewProviders.get(treeViewId);\n        if (treeDataProvider) {\n            this.treeViewProviders.delete(treeViewId);\n            treeDataProvider.dispose();\n        }\n    }\n\n    async $readDroppedFile(contentId: string): Promise<BinaryBuffer> {\n        const file = this.fileContentStore.getFile(contentId);\n        const buffer = await file.arrayBuffer();\n        return BinaryBuffer.wrap(new Uint8Array(buffer));\n    }\n\n    async $refresh(treeViewId: string): Promise<void> {\n        const viewPanel = await this.viewRegistry.getView(treeViewId);\n        const widget = viewPanel && viewPanel.widgets[0];\n        if (widget instanceof TreeViewWidget) {\n            await widget.model.refresh();\n        }\n    }\n\n    // elementParentChain parameter contain a list of tree ids from root to the revealed node\n    // all parents of the revealed node should be fetched and expanded in order for it to reveal\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    async $reveal(treeViewId: string, elementParentChain: string[], options: TreeViewRevealOptions): Promise<any> {\n        const viewPanel = await this.viewRegistry.openView(treeViewId, { activate: options.focus, reveal: true });\n        const widget = viewPanel && viewPanel.widgets[0];\n        if (widget instanceof TreeViewWidget) {\n            // pop last element which is the node to reveal\n            const elementId = elementParentChain.pop();\n            await this.expandParentChain(widget.model, elementParentChain);\n            const treeNode = widget.model.getNode(elementId);\n            if (treeNode) {\n                if (options.expand && ExpandableTreeNode.is(treeNode)) {\n                    await widget.model.expandNode(treeNode);\n                }\n                if (options.select && SelectableTreeNode.is(treeNode)) {\n                    widget.model.selectNode(treeNode);\n                }\n            }\n        }\n    }\n\n    /**\n     * Expand all parents of the node to reveal from root. This should also fetch missing nodes to the frontend.\n     */\n    private async expandParentChain(model: PluginTreeModel, elementParentChain: string[]): Promise<void> {\n        for (const elementId of elementParentChain) {\n            const treeNode = model.getNode(elementId);\n            if (ExpandableTreeNode.is(treeNode)) {\n                await model.expandNode(treeNode);\n            }\n        }\n    }\n\n    async $setMessage(treeViewId: string, message: string): Promise<void> {\n        const viewPanel = await this.viewRegistry.getView(treeViewId);\n        if (viewPanel instanceof PluginViewWidget) {\n            viewPanel.message = message;\n        }\n    }\n\n    async $setTitle(treeViewId: string, title: string): Promise<void> {\n        const viewPanel = await this.viewRegistry.getView(treeViewId);\n        if (viewPanel) {\n            viewPanel.title.label = title;\n        }\n    }\n\n    async $setDescription(treeViewId: string, description: string): Promise<void> {\n        const viewPanel = await this.viewRegistry.getView(treeViewId);\n        if (viewPanel) {\n            viewPanel.description = description;\n        }\n    }\n\n    async $setBadge(treeViewId: string, badge: ViewBadge | undefined): Promise<void> {\n        const viewPanel = await this.viewRegistry.getView(treeViewId);\n        if (viewPanel) {\n            viewPanel.badge = badge?.value;\n            viewPanel.badgeTooltip = badge?.tooltip;\n        }\n    }\n\n    async setChecked(treeViewWidget: TreeViewWidget, changedNodes: TreeViewNode[]): Promise<void> {\n        await this.proxy.$checkStateChanged(treeViewWidget.id, changedNodes.map(node => ({\n            id: node.id,\n            checked: !!node.checkboxInfo?.checked\n        })));\n    }\n\n    protected handleTreeEvents(treeViewId: string, treeViewWidget: TreeViewWidget): void {\n        this.toDispose.push(treeViewWidget.model.onExpansionChanged(event => {\n            this.proxy.$setExpanded(treeViewId, event.id, event.expanded);\n        }));\n\n        this.toDispose.push(treeViewWidget.model.onSelectionChanged(event => {\n            this.contextKeys.view.set(treeViewId);\n            this.proxy.$setSelection(treeViewId, event.map((node: TreeViewNode) => node.id));\n        }));\n\n        const updateVisible = () => this.proxy.$setVisible(treeViewId, treeViewWidget.isVisible);\n        updateVisible();\n        this.toDispose.push(treeViewWidget.onDidChangeVisibility(() => updateVisible()));\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2019 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { injectable, postConstruct, inject } from '@theia/core/shared/inversify';\nimport { ContextKey, ContextKeyService } from '@theia/core/lib/browser/context-key-service';\n\n@injectable()\nexport class ViewContextKeyService {\n    protected _view: ContextKey<string>;\n    get view(): ContextKey<string> {\n        return this._view;\n    }\n\n    protected _viewItem: ContextKey<string>;\n    get viewItem(): ContextKey<string> {\n        return this._viewItem;\n    }\n\n    // for the next three keys, see https://code.visualstudio.com/api/references/when-clause-contexts#visible-view-container-when-clause-context\n\n    protected _activeViewlet: ContextKey<string>;\n    get activeViewlet(): ContextKey<string> {\n        return this._activeViewlet;\n    }\n\n    protected _activePanel: ContextKey<string>;\n    get activePanel(): ContextKey<string> {\n        return this._activePanel;\n    }\n\n    protected _activeAuxiliary: ContextKey<string>;\n    get activeAuxiliary(): ContextKey<string> {\n        return this._activeAuxiliary;\n    }\n\n    protected _focusedView: ContextKey<string>;\n    get focusedView(): ContextKey<string> {\n        return this._focusedView;\n    }\n\n    @inject(ContextKeyService)\n    protected readonly contextKeyService: ContextKeyService;\n\n    @postConstruct()\n    protected init(): void {\n        this._view = this.contextKeyService.createKey('view', '');\n        this._viewItem = this.contextKeyService.createKey('viewItem', '');\n        this._activeViewlet = this.contextKeyService.createKey('activeViewlet', '');\n        this._activePanel = this.contextKeyService.createKey('activePanel', '');\n        this._activeAuxiliary = this.contextKeyService.createKey('activeAuxiliary', '');\n        this._focusedView = this.contextKeyService.createKey('focusedView', '');\n    }\n\n    match(expression: string | undefined): boolean {\n        return !expression || this.contextKeyService.match(expression);\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2021 SAP SE or an SAP affiliate company and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n// some code copied and modified from https://github.com/microsoft/vscode/blob/e1f0f8f51390dea5df9096718fb6b647ed5a9534/src/vs/workbench/api/browser/mainThreadWebviewViews.ts\n\nimport { inject, interfaces } from '@theia/core/shared/inversify';\nimport { WebviewViewsMain, MAIN_RPC_CONTEXT, WebviewViewsExt } from '../../../common/plugin-api-rpc';\nimport { RPCProtocol } from '../../../common/rpc-protocol';\nimport { Disposable, DisposableCollection, ILogger } from '@theia/core';\nimport { WebviewView } from './webview-views';\nimport { CancellationToken } from '@theia/core/lib/common/cancellation';\nimport { WebviewsMainImpl } from '../webviews-main';\nimport { Widget, WidgetManager } from '@theia/core/lib/browser';\nimport { PluginViewRegistry } from '../view/plugin-view-registry';\nimport { ViewBadge } from '@theia/plugin';\n\nexport class WebviewViewsMainImpl implements WebviewViewsMain, Disposable {\n\n    protected readonly proxy: WebviewViewsExt;\n    protected readonly toDispose = new DisposableCollection(\n        Disposable.create(() => { /* mark as not disposed */ })\n    );\n\n    protected readonly webviewViews = new Map<string, WebviewView>();\n    protected readonly webviewViewProviders = new Map<string, Disposable>();\n    protected readonly widgetManager: WidgetManager;\n    protected readonly pluginViewRegistry: PluginViewRegistry;\n\n    @inject(ILogger)\n    protected readonly logger: ILogger;\n\n    constructor(rpc: RPCProtocol,\n        container: interfaces.Container,\n        readonly webviewsMain: WebviewsMainImpl\n    ) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.WEBVIEW_VIEWS_EXT);\n        this.widgetManager = container.get(WidgetManager);\n        this.pluginViewRegistry = container.get(PluginViewRegistry);\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    async $registerWebviewViewProvider(viewType: string, options: { retainContextWhenHidden?: boolean, serializeBuffersForPostMessage: boolean }): Promise<void> {\n\n        if (this.webviewViewProviders.has(viewType)) {\n            throw new Error(`View provider for ${viewType} already registered`);\n        }\n\n        const registration = await this.pluginViewRegistry.registerWebviewView(viewType, {\n            resolve: async (webviewView: WebviewView, cancellation: CancellationToken) => {\n                const handle = webviewView.webview.identifier.id;\n                this.webviewViews.set(handle, webviewView);\n                this.webviewsMain.hookWebview(webviewView.webview);\n\n                let state: string | undefined;\n                if (webviewView.webview.state) {\n                    try {\n                        state = JSON.parse(webviewView.webview.state);\n                        console.log(state);\n                    } catch (e) {\n                        console.error('Could not load webview state', e, webviewView.webview.state);\n                    }\n                }\n                if (options) {\n                    webviewView.webview.options = options;\n                }\n\n                webviewView.onDidChangeVisibility(async visible => {\n                    if (visible) {\n                        await webviewView.resolve();\n                    }\n                    this.proxy.$onDidChangeWebviewViewVisibility(handle, visible);\n                });\n\n                webviewView.onDidDispose(() => {\n                    this.proxy.$disposeWebviewView(handle);\n                    this.webviewViews.delete(handle);\n                });\n\n                try {\n                    await this.proxy.$resolveWebviewView(handle, viewType, webviewView.title, state, cancellation);\n                } catch (error) {\n                    this.logger.error(`Error resolving webview view '${viewType}': ${error}`);\n                    webviewView.webview.setHTML('failed to load plugin webview view');\n                }\n            }\n        });\n\n        this.webviewViewProviders.set(viewType, registration);\n    }\n\n    protected getWebview(handle: string): Widget | undefined {\n        return this.widgetManager.tryGetWidget(handle);\n    }\n\n    $unregisterWebviewViewProvider(viewType: string): void {\n        const provider = this.webviewViewProviders.get(viewType);\n        if (!provider) {\n            throw new Error(`No view provider for ${viewType} registered`);\n        }\n        provider.dispose();\n        this.webviewViewProviders.delete(viewType);\n    }\n\n    $setWebviewViewTitle(handle: string, value: string | undefined): void {\n        const webviewView = this.getWebviewView(handle);\n        webviewView.title = value;\n    }\n\n    $setWebviewViewDescription(handle: string, value: string | undefined): void {\n        const webviewView = this.getWebviewView(handle);\n        webviewView.description = value;\n    }\n\n    async $setBadge(handle: string, badge: ViewBadge | undefined): Promise<void> {\n        const webviewView = this.getWebviewView(handle);\n        if (webviewView) {\n            webviewView.badge = badge?.value;\n            webviewView.badgeTooltip = badge?.tooltip;\n        }\n    }\n\n    $show(handle: string, preserveFocus: boolean): void {\n        const webviewView = this.getWebviewView(handle);\n        webviewView.show(preserveFocus);\n    }\n\n    protected getWebviewView(handle: string): WebviewView {\n        const webviewView = this.webviewViews.get(handle);\n        if (!webviewView) {\n            throw new Error(`No webview view registered for handle '${handle}'`);\n        }\n        return webviewView;\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport debounce = require('@theia/core/shared/lodash.debounce');\nimport { URI } from '@theia/core/shared/vscode-uri';\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { WebviewsMain, MAIN_RPC_CONTEXT, WebviewsExt, WebviewPanelViewState } from '../../common/plugin-api-rpc';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport { ViewBadge, WebviewOptions, WebviewPanelOptions, WebviewPanelShowOptions } from '@theia/plugin';\nimport { ApplicationShell } from '@theia/core/lib/browser/shell/application-shell';\nimport { WebviewWidget, WebviewWidgetIdentifier } from './webview/webview';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\nimport { ViewColumnService } from './view-column-service';\nimport { WidgetManager } from '@theia/core/lib/browser/widget-manager';\nimport { JSONExt } from '@theia/core/shared/@phosphor/coreutils';\nimport { Mutable } from '@theia/core/lib/common/types';\nimport { HostedPluginSupport } from '../../hosted/browser/hosted-plugin';\nimport { IconUrl } from '../../common/plugin-protocol';\nimport { CustomEditorWidget } from './custom-editors/custom-editor-widget';\nimport { ViewColumn, WebviewPanelTargetArea } from '../../plugin/types-impl';\n\nexport class WebviewsMainImpl implements WebviewsMain, Disposable {\n\n    private readonly proxy: WebviewsExt;\n    protected readonly shell: ApplicationShell;\n    protected readonly widgetManager: WidgetManager;\n    protected readonly pluginService: HostedPluginSupport;\n    protected readonly viewColumnService: ViewColumnService;\n    private readonly toDispose = new DisposableCollection();\n\n    constructor(rpc: RPCProtocol, container: interfaces.Container) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.WEBVIEWS_EXT);\n        this.shell = container.get(ApplicationShell);\n        this.viewColumnService = container.get(ViewColumnService);\n        this.widgetManager = container.get(WidgetManager);\n        this.pluginService = container.get(HostedPluginSupport);\n        this.toDispose.push(this.shell.onDidChangeActiveWidget(() => this.updateViewStates()));\n        this.toDispose.push(this.shell.onDidChangeCurrentWidget(() => this.updateViewStates()));\n        this.toDispose.push(this.viewColumnService.onViewColumnChanged(() => this.updateViewStates()));\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    async $createWebviewPanel(\n        panelId: string,\n        viewType: string,\n        title: string,\n        showOptions: WebviewPanelShowOptions,\n        options: WebviewPanelOptions & WebviewOptions\n    ): Promise<void> {\n        const view = await this.widgetManager.getOrCreateWidget<WebviewWidget>(WebviewWidget.FACTORY_ID, <WebviewWidgetIdentifier>{ id: panelId });\n        this.hookWebview(view);\n        view.viewType = viewType;\n        view.title.label = title;\n        const { enableFindWidget, retainContextWhenHidden, enableScripts, enableForms, localResourceRoots, ...contentOptions } = options;\n        view.options = { enableFindWidget, retainContextWhenHidden };\n        view.setContentOptions({\n            allowScripts: enableScripts,\n            allowForms: enableForms,\n            localResourceRoots: localResourceRoots && localResourceRoots.map(root => root.toString()),\n            ...contentOptions\n        });\n        this.addOrReattachWidget(view, showOptions);\n    }\n\n    hookWebview(view: WebviewWidget): void {\n        const handle = view.identifier.id;\n        this.toDispose.push(view.onDidChangeVisibility(() => this.updateViewState(view)));\n        this.toDispose.push(view.onMessage(data => this.proxy.$onMessage(handle, data)));\n        view.disposed.connect(() => {\n            if (this.toDispose.disposed) {\n                return;\n            }\n            this.proxy.$onDidDisposeWebviewPanel(handle);\n        });\n    }\n\n    addOrReattachWidget(widget: WebviewWidget, showOptions: WebviewPanelShowOptions): void {\n        const area = showOptions.area ? showOptions.area : WebviewPanelTargetArea.Main;\n        const widgetOptions: ApplicationShell.WidgetOptions = { area };\n        let mode = 'open-to-right';\n        const canOpenBeside = showOptions.viewColumn === ViewColumn.Beside && (area === WebviewPanelTargetArea.Main || area === WebviewPanelTargetArea.Bottom);\n        if (canOpenBeside) {\n            const activeOrRightmostTabbar = this.shell.getTabBarFor(area);\n            const ref = activeOrRightmostTabbar?.currentTitle?.owner;\n            if (ref) {\n                Object.assign(widgetOptions, { ref, mode });\n            }\n        } else if (widgetOptions.area === 'main' && showOptions.viewColumn !== undefined) {\n            this.viewColumnService.updateViewColumns();\n            let widgetIds = this.viewColumnService.getViewColumnIds(showOptions.viewColumn);\n            if (widgetIds.length > 0) {\n                mode = 'tab-after';\n            } else if (showOptions.viewColumn >= 0) {\n                const columnsSize = this.viewColumnService.viewColumnsSize();\n                if (columnsSize) {\n                    showOptions.viewColumn = columnsSize - 1;\n                    widgetIds = this.viewColumnService.getViewColumnIds(showOptions.viewColumn);\n                }\n            }\n            const ref = this.shell.getWidgets(widgetOptions.area).find(w => !w.isHidden && widgetIds.indexOf(w.id) !== -1);\n            if (ref) {\n                Object.assign(widgetOptions, { ref, mode });\n            }\n        }\n\n        this.shell.addWidget(widget, widgetOptions);\n        if (showOptions.preserveFocus) {\n            this.shell.revealWidget(widget.id);\n        } else {\n            this.shell.activateWidget(widget.id);\n        }\n    }\n\n    async $disposeWebview(handle: string): Promise<void> {\n        const view = await this.tryGetWebview(handle);\n        if (view) {\n            view.dispose();\n        }\n    }\n\n    async $reveal(handle: string, showOptions: WebviewPanelShowOptions): Promise<void> {\n        const widget = await this.getWebview(handle);\n        if (widget.isDisposed) {\n            return;\n        }\n        if ((showOptions.viewColumn !== undefined && showOptions.viewColumn !== widget.viewState.position) || showOptions.area !== undefined) {\n            this.viewColumnService.updateViewColumns();\n            const columnIds = showOptions.viewColumn ? this.viewColumnService.getViewColumnIds(showOptions.viewColumn) : [];\n            const area = this.shell.getAreaFor(widget);\n            if (columnIds.indexOf(widget.id) === -1 || area !== showOptions.area) {\n                this.addOrReattachWidget(widget, showOptions);\n                return;\n            }\n        }\n        if (showOptions.preserveFocus) {\n            this.shell.revealWidget(widget.id);\n        } else {\n            this.shell.activateWidget(widget.id);\n        }\n    }\n\n    async $setTitle(handle: string, value: string): Promise<void> {\n        const webview = await this.getWebview(handle);\n        webview.title.label = value;\n    }\n\n    async $setBadge(handle: string, badge: ViewBadge | undefined): Promise<void> {\n        const webview = await this.getWebview(handle);\n        if (webview) {\n            webview.badge = badge?.value;\n            webview.badgeTooltip = badge?.tooltip;\n        }\n    }\n\n    async $setIconPath(handle: string, iconUrl: IconUrl | undefined): Promise<void> {\n        const webview = await this.getWebview(handle);\n        webview.setIconUrl(iconUrl);\n    }\n\n    async $setHtml(handle: string, value: string): Promise<void> {\n        const webview = await this.getWebview(handle);\n        webview.setHTML(value);\n    }\n\n    async $setOptions(handle: string, options: WebviewOptions): Promise<void> {\n        const webview = await this.getWebview(handle);\n        const { enableScripts, enableForms, localResourceRoots, ...contentOptions } = options;\n        webview.setContentOptions({\n            allowScripts: enableScripts,\n            allowForms: enableForms,\n            localResourceRoots: localResourceRoots && localResourceRoots.map(root => root.toString()),\n            ...contentOptions\n        });\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    async $postMessage(handle: string, value: any): Promise<boolean> {\n        const webview = await this.getWebview(handle);\n        webview.sendMessage(value);\n        return true;\n    }\n\n    $registerSerializer(viewType: string): void {\n        this.pluginService.registerWebviewReviver(viewType, widget => this.restoreWidget(widget));\n        this.toDispose.push(Disposable.create(() => this.$unregisterSerializer(viewType)));\n    }\n\n    $unregisterSerializer(viewType: string): void {\n        this.pluginService.unregisterWebviewReviver(viewType);\n    }\n\n    protected async restoreWidget(widget: WebviewWidget): Promise<void> {\n        this.hookWebview(widget);\n        const handle = widget.identifier.id;\n        const title = widget.title.label;\n\n        let state = undefined;\n        if (widget.state) {\n            try {\n                state = JSON.parse(widget.state);\n            } catch {\n                // noop\n            }\n        }\n\n        const options = widget.options;\n        const { allowScripts, allowForms, localResourceRoots, ...contentOptions } = widget.contentOptions;\n        this.updateViewState(widget);\n        await this.proxy.$deserializeWebviewPanel(handle, widget.viewType, title, state, widget.viewState, {\n            enableScripts: allowScripts,\n            enableForms: allowForms,\n            localResourceRoots: localResourceRoots && localResourceRoots.map(root => URI.parse(root)),\n            ...contentOptions,\n            ...options\n        });\n    }\n\n    protected readonly updateViewStates = debounce(() => {\n        const widgets = this.widgetManager.getWidgets(WebviewWidget.FACTORY_ID);\n        const customEditors = this.widgetManager.getWidgets(CustomEditorWidget.FACTORY_ID);\n\n        for (const widget of widgets.concat(customEditors)) {\n            if (widget instanceof WebviewWidget) {\n                this.updateViewState(widget);\n            }\n        }\n    }, 100);\n\n    private updateViewState(widget: WebviewWidget, viewColumn?: number | undefined): void {\n        const viewState: Mutable<WebviewPanelViewState> = {\n            active: this.shell.activeWidget === widget,\n            visible: !widget.isHidden,\n            position: viewColumn || 0\n        };\n        if (typeof viewColumn !== 'number') {\n            this.viewColumnService.updateViewColumns();\n            viewState.position = this.viewColumnService.getViewColumn(widget.id) || 0;\n        }\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        if (JSONExt.deepEqual(<any>viewState, <any>widget.viewState)) {\n            return;\n        }\n        widget.viewState = viewState;\n        this.proxy.$onDidChangeWebviewPanelViewState(widget.identifier.id, widget.viewState);\n    }\n\n    private async getWebview(viewId: string): Promise<WebviewWidget> {\n        const webview = await this.tryGetWebview(viewId);\n        if (!webview) {\n            throw new Error(`Unknown Webview: ${viewId}`);\n        }\n        return webview;\n    }\n\n    private async tryGetWebview(id: string): Promise<WebviewWidget | undefined> {\n        const webview = await this.widgetManager.getWidget<WebviewWidget>(WebviewWidget.FACTORY_ID, <WebviewWidgetIdentifier>{ id })\n            || await this.widgetManager.getWidget<CustomEditorWidget>(CustomEditorWidget.FACTORY_ID, <WebviewWidgetIdentifier>{ id });\n        return webview;\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { URI } from '@theia/core/shared/vscode-uri';\nimport CoreURI from '@theia/core/lib/common/uri';\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { WindowStateExt, MAIN_RPC_CONTEXT, WindowMain } from '../../common/plugin-api-rpc';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport { UriComponents } from '../../common/uri-components';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\nimport { open, OpenerService } from '@theia/core/lib/browser/opener-service';\nimport { ExternalUriService } from '@theia/core/lib/browser/external-uri-service';\n\nexport class WindowStateMain implements WindowMain, Disposable {\n\n    private readonly proxy: WindowStateExt;\n\n    private readonly openerService: OpenerService;\n\n    private readonly externalUriService: ExternalUriService;\n\n    private readonly toDispose = new DisposableCollection();\n\n    constructor(rpc: RPCProtocol, container: interfaces.Container) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.WINDOW_STATE_EXT);\n        this.openerService = container.get(OpenerService);\n        this.externalUriService = container.get(ExternalUriService);\n\n        const fireDidFocus = () => this.onFocusChanged(true);\n        window.addEventListener('focus', fireDidFocus);\n        this.toDispose.push(Disposable.create(() => window.removeEventListener('focus', fireDidFocus)));\n\n        const fireDidBlur = () => this.onFocusChanged(false);\n        window.addEventListener('blur', fireDidBlur);\n        this.toDispose.push(Disposable.create(() => window.removeEventListener('blur', fireDidBlur)));\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    private onFocusChanged(focused: boolean): void {\n        this.proxy.$onWindowStateChanged(focused);\n    }\n\n    async $openUri(uriComponent: UriComponents): Promise<boolean> {\n        const uri = URI.revive(uriComponent);\n        const url = new CoreURI(encodeURI(uri.toString(true)));\n        try {\n            await open(this.openerService, url);\n            return true;\n        } catch (e) {\n            return false;\n        }\n    }\n\n    async $asExternalUri(uriComponents: UriComponents): Promise<UriComponents> {\n        const uri = URI.revive(uriComponents);\n        const resolved = await this.externalUriService.resolve(new CoreURI(uri));\n        return URI.parse(resolved.toString());\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport * as theia from '@theia/plugin';\nimport { interfaces, injectable } from '@theia/core/shared/inversify';\nimport { WorkspaceExt, StorageExt, MAIN_RPC_CONTEXT, WorkspaceMain, WorkspaceFolderPickOptionsMain } from '../../common/plugin-api-rpc';\nimport { RPCProtocol } from '../../common/rpc-protocol';\nimport { URI as Uri } from '@theia/core/shared/vscode-uri';\nimport { UriComponents } from '../../common/uri-components';\nimport { FileSearchService } from '@theia/file-search/lib/common/file-search-service';\nimport URI from '@theia/core/lib/common/uri';\nimport { WorkspaceService, WorkspaceTrustService, CanonicalUriService } from '@theia/workspace/lib/browser';\nimport { Resource } from '@theia/core/lib/common/resource';\nimport { Disposable, DisposableCollection } from '@theia/core/lib/common/disposable';\nimport { Emitter, Event, ResourceResolver, CancellationToken, isUndefined } from '@theia/core';\nimport { PluginServer } from '../../common/plugin-protocol';\nimport { FileSystemPreferences } from '@theia/filesystem/lib/browser';\nimport { SearchInWorkspaceService } from '@theia/search-in-workspace/lib/browser/search-in-workspace-service';\nimport { FileStat } from '@theia/filesystem/lib/common/files';\nimport { MonacoQuickInputService } from '@theia/monaco/lib/browser/monaco-quick-input-service';\nimport { RequestService } from '@theia/core/shared/@theia/request';\n\nexport class WorkspaceMainImpl implements WorkspaceMain, Disposable {\n\n    private readonly proxy: WorkspaceExt;\n\n    private storageProxy: StorageExt;\n\n    private monacoQuickInputService: MonacoQuickInputService;\n\n    private fileSearchService: FileSearchService;\n\n    private searchInWorkspaceService: SearchInWorkspaceService;\n\n    private roots: string[];\n\n    private resourceResolver: TextContentResourceResolver;\n\n    private pluginServer: PluginServer;\n\n    private requestService: RequestService;\n\n    private workspaceService: WorkspaceService;\n\n    protected readonly canonicalUriService: CanonicalUriService;\n\n    private workspaceTrustService: WorkspaceTrustService;\n\n    private fsPreferences: FileSystemPreferences;\n\n    protected readonly toDispose = new DisposableCollection();\n\n    protected workspaceSearch: Set<number> = new Set<number>();\n\n    protected readonly canonicalUriProviders = new Map<string, Disposable>();\n\n    constructor(rpc: RPCProtocol, container: interfaces.Container) {\n        this.proxy = rpc.getProxy(MAIN_RPC_CONTEXT.WORKSPACE_EXT);\n        this.storageProxy = rpc.getProxy(MAIN_RPC_CONTEXT.STORAGE_EXT);\n        this.monacoQuickInputService = container.get(MonacoQuickInputService);\n        this.fileSearchService = container.get(FileSearchService);\n        this.searchInWorkspaceService = container.get(SearchInWorkspaceService);\n        this.resourceResolver = container.get(TextContentResourceResolver);\n        this.pluginServer = container.get(PluginServer);\n        this.requestService = container.get(RequestService);\n        this.workspaceService = container.get(WorkspaceService);\n        this.canonicalUriService = container.get(CanonicalUriService);\n        this.workspaceTrustService = container.get(WorkspaceTrustService);\n        this.fsPreferences = container.get(FileSystemPreferences);\n\n        this.processWorkspaceFoldersChanged(this.workspaceService.tryGetRoots().map(root => root.resource.toString()));\n        this.toDispose.push(this.workspaceService.onWorkspaceChanged(roots => {\n            this.processWorkspaceFoldersChanged(roots.map(root => root.resource.toString()));\n        }));\n        this.toDispose.push(this.workspaceService.onWorkspaceLocationChanged(stat => {\n            this.proxy.$onWorkspaceLocationChanged(stat);\n        }));\n\n        this.workspaceTrustService.getWorkspaceTrust().then(trust => this.proxy.$onWorkspaceTrustChanged(trust));\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    $resolveProxy(url: string): Promise<string | undefined> {\n        return this.requestService.resolveProxy(url);\n    }\n\n    protected async processWorkspaceFoldersChanged(roots: string[]): Promise<void> {\n        if (this.isAnyRootChanged(roots) === false) {\n            return;\n        }\n        this.roots = roots;\n        this.proxy.$onWorkspaceFoldersChanged({ roots });\n\n        const keyValueStorageWorkspacesData = await this.pluginServer.getAllStorageValues({\n            workspace: this.workspaceService.workspace?.resource.toString(),\n            roots: this.workspaceService.tryGetRoots().map(root => root.resource.toString())\n        });\n        this.storageProxy.$updatePluginsWorkspaceData(keyValueStorageWorkspacesData);\n\n    }\n\n    private isAnyRootChanged(roots: string[]): boolean {\n        if (!this.roots || this.roots.length !== roots.length) {\n            return true;\n        }\n\n        return this.roots.some((root, index) => root !== roots[index]);\n    }\n\n    async $getWorkspace(): Promise<FileStat | undefined> {\n        return this.workspaceService.workspace;\n    }\n\n    $pickWorkspaceFolder(options: WorkspaceFolderPickOptionsMain): Promise<theia.WorkspaceFolder | undefined> {\n        return new Promise((resolve, reject) => {\n            // Return undefined if workspace root is not set\n            if (!this.roots || !this.roots.length) {\n                resolve(undefined);\n                return;\n            }\n\n            // Active before appearing the pick menu\n            const activeElement: HTMLElement | undefined = window.document.activeElement as HTMLElement;\n\n            // WorkspaceFolder to be returned\n            let returnValue: theia.WorkspaceFolder | undefined;\n\n            const items = this.roots.map(root => {\n                const rootUri = Uri.parse(root);\n                const rootPathName = rootUri.path.substring(rootUri.path.lastIndexOf('/') + 1);\n                return {\n                    label: rootPathName,\n                    detail: rootUri.path,\n                    execute: () => {\n                        returnValue = {\n                            uri: rootUri,\n                            name: rootPathName,\n                            index: 0\n                        } as theia.WorkspaceFolder;\n                    }\n                };\n            });\n\n            // Show pick menu\n            this.monacoQuickInputService.showQuickPick(items, {\n                onDidHide: () => {\n                    if (activeElement) {\n                        activeElement.focus({ preventScroll: true });\n                    }\n                    resolve(returnValue);\n                }\n            });\n        });\n    }\n\n    async $startFileSearch(includePattern: string, includeFolderUri: string | undefined, excludePatternOrDisregardExcludes?: string | false,\n        maxResults?: number): Promise<UriComponents[]> {\n        const roots: FileSearchService.RootOptions = {};\n        const rootUris = includeFolderUri ? [includeFolderUri] : this.roots;\n        for (const rootUri of rootUris) {\n            roots[rootUri] = {};\n        }\n        const opts: FileSearchService.Options = {\n            rootOptions: roots,\n            useGitIgnore: excludePatternOrDisregardExcludes !== false\n        };\n        if (includePattern) {\n            opts.includePatterns = [includePattern];\n        }\n        if (typeof excludePatternOrDisregardExcludes === 'string') {\n            opts.excludePatterns = [excludePatternOrDisregardExcludes];\n        }\n        if (excludePatternOrDisregardExcludes !== false) {\n            for (const rootUri of rootUris) {\n                const filesExclude = this.fsPreferences.get('files.exclude', undefined, rootUri);\n                if (filesExclude) {\n                    for (const excludePattern in filesExclude) {\n                        if (filesExclude[excludePattern]) {\n                            const rootOptions = roots[rootUri];\n                            const rootExcludePatterns = rootOptions.excludePatterns || [];\n                            rootExcludePatterns.push(excludePattern);\n                            rootOptions.excludePatterns = rootExcludePatterns;\n                        }\n                    }\n                }\n            }\n        }\n        if (typeof maxResults === 'number') {\n            opts.limit = maxResults;\n        }\n        const uriStrs = await this.fileSearchService.find('', opts);\n        return uriStrs.map(uriStr => Uri.parse(uriStr));\n    }\n\n    async $findTextInFiles(query: theia.TextSearchQuery, options: theia.FindTextInFilesOptions, searchRequestId: number,\n        token: theia.CancellationToken = CancellationToken.None): Promise<theia.TextSearchComplete> {\n        const maxHits = options.maxResults ? options.maxResults : 150;\n        const excludes = options.exclude ? (typeof options.exclude === 'string' ? options.exclude : (<theia.RelativePattern>options.exclude).pattern) : undefined;\n        const includes = options.include ? (typeof options.include === 'string' ? options.include : (<theia.RelativePattern>options.include).pattern) : undefined;\n        let canceledRequest = false;\n        return new Promise(resolve => {\n            let matches = 0;\n            const what: string = query.pattern;\n            this.searchInWorkspaceService.searchWithCallback(what, this.roots, {\n                onResult: (searchId, result) => {\n                    if (canceledRequest) {\n                        return;\n                    }\n                    const hasSearch = this.workspaceSearch.has(searchId);\n                    if (!hasSearch) {\n                        this.workspaceSearch.add(searchId);\n                        token.onCancellationRequested(() => {\n                            this.searchInWorkspaceService.cancel(searchId);\n                            canceledRequest = true;\n                        });\n                    }\n                    if (token.isCancellationRequested) {\n                        this.searchInWorkspaceService.cancel(searchId);\n                        canceledRequest = true;\n                        return;\n                    }\n                    if (result && result.matches && result.matches.length) {\n                        while ((matches + result.matches.length) > maxHits) {\n                            result.matches.splice(result.matches.length - 1, 1);\n                        }\n                        this.proxy.$onTextSearchResult(searchRequestId, false, result);\n                        matches += result.matches.length;\n                        if (maxHits <= matches) {\n                            this.searchInWorkspaceService.cancel(searchId);\n                        }\n                    }\n                },\n                onDone: (searchId, _error) => {\n                    const hasSearch = this.workspaceSearch.has(searchId);\n                    if (hasSearch) {\n                        this.searchInWorkspaceService.cancel(searchId);\n                        this.workspaceSearch.delete(searchId);\n                    }\n                    this.proxy.$onTextSearchResult(searchRequestId, true);\n                    if (maxHits <= matches) {\n                        resolve({ limitHit: true });\n                    } else {\n                        resolve({ limitHit: false });\n                    }\n                }\n            }, {\n                useRegExp: query.isRegExp,\n                matchCase: query.isCaseSensitive,\n                matchWholeWord: query.isWordMatch,\n                exclude: excludes ? [excludes] : undefined,\n                include: includes ? [includes] : undefined,\n                maxResults: maxHits\n            });\n        });\n    }\n\n    async $registerTextDocumentContentProvider(scheme: string): Promise<void> {\n        this.resourceResolver.registerContentProvider(scheme, this.proxy);\n        this.toDispose.push(Disposable.create(() => this.resourceResolver.unregisterContentProvider(scheme)));\n    }\n\n    $unregisterTextDocumentContentProvider(scheme: string): void {\n        this.resourceResolver.unregisterContentProvider(scheme);\n    }\n\n    $onTextDocumentContentChange(uri: string, content: string): void {\n        this.resourceResolver.onContentChange(uri, content);\n    }\n\n    async $updateWorkspaceFolders(start: number, deleteCount?: number, ...rootsToAdd: string[]): Promise<void> {\n        await this.workspaceService.spliceRoots(start, deleteCount, ...rootsToAdd.map(root => new URI(root)));\n    }\n\n    async $requestWorkspaceTrust(_options?: theia.WorkspaceTrustRequestOptions): Promise<boolean | undefined> {\n        return this.workspaceTrustService.requestWorkspaceTrust();\n    }\n\n    async $registerCanonicalUriProvider(scheme: string): Promise<void | undefined> {\n        this.canonicalUriProviders.set(scheme,\n            this.canonicalUriService.registerCanonicalUriProvider(scheme, {\n                provideCanonicalUri: async (uri, targetScheme, token) => {\n                    const canonicalUri = await this.proxy.$provideCanonicalUri(uri.toString(), targetScheme, CancellationToken.None);\n                    return isUndefined(uri) ? undefined : new URI(canonicalUri);\n                },\n                dispose: () => {\n                    this.proxy.$disposeCanonicalUriProvider(scheme);\n                },\n            }));\n    }\n\n    $unregisterCanonicalUriProvider(scheme: string): void {\n        const disposable = this.canonicalUriProviders.get(scheme);\n        if (disposable) {\n            this.canonicalUriProviders.delete(scheme);\n            disposable.dispose();\n        } else {\n            console.warn(`No canonical uri provider registered for '${scheme}'`);\n        }\n    }\n\n    async $getCanonicalUri(uri: string, targetScheme: string, token: theia.CancellationToken): Promise<string | undefined> {\n        const canonicalUri = await this.canonicalUriService.provideCanonicalUri(new URI(uri), targetScheme, token);\n        return isUndefined(canonicalUri) ? undefined : canonicalUri.toString();\n    }\n}\n\n/**\n * Text content provider for resources with custom scheme.\n */\nexport interface TextContentResourceProvider {\n\n    /**\n     * Provides resource for given URI\n     */\n    provideResource(uri: URI): Resource;\n\n}\n\n@injectable()\nexport class TextContentResourceResolver implements ResourceResolver {\n\n    // Resource providers for different schemes\n    private providers = new Map<string, TextContentResourceProvider>();\n\n    // Opened resources\n    private resources = new Map<string, TextContentResource>();\n\n    async resolve(uri: URI): Promise<Resource> {\n        const provider = this.providers.get(uri.scheme);\n        if (provider) {\n            return provider.provideResource(uri);\n        }\n\n        throw new Error(`Unable to find Text Content Resource Provider for scheme '${uri.scheme}'`);\n    }\n\n    registerContentProvider(scheme: string, proxy: WorkspaceExt): void {\n        if (this.providers.has(scheme)) {\n            throw new Error(`Text Content Resource Provider for scheme '${scheme}' is already registered`);\n        }\n\n        const instance = this;\n        this.providers.set(scheme, {\n            provideResource: (uri: URI): Resource => {\n                let resource = instance.resources.get(uri.toString());\n                if (resource) {\n                    return resource;\n                }\n\n                resource = new TextContentResource(uri, proxy, {\n                    dispose(): void {\n                        instance.resources.delete(uri.toString());\n                    }\n                });\n\n                instance.resources.set(uri.toString(), resource);\n                return resource;\n            }\n        });\n    }\n\n    unregisterContentProvider(scheme: string): void {\n        if (!this.providers.delete(scheme)) {\n            throw new Error(`Text Content Resource Provider for scheme '${scheme}' has not been registered`);\n        }\n    }\n\n    onContentChange(uri: string, content: string): void {\n        const resource = this.resources.get(uri);\n        if (resource) {\n            resource.setContent(content);\n        }\n    }\n\n}\n\nexport class TextContentResource implements Resource {\n\n    private onDidChangeContentsEmitter: Emitter<void> = new Emitter<void>();\n    readonly onDidChangeContents: Event<void> = this.onDidChangeContentsEmitter.event;\n\n    // cached content\n    cache: string | undefined;\n\n    constructor(public uri: URI, private proxy: WorkspaceExt, protected disposable: Disposable) {\n    }\n\n    async readContents(options?: { encoding?: string }): Promise<string> {\n        if (this.cache) {\n            const content = this.cache;\n            this.cache = undefined;\n            return content;\n        } else {\n            const content = await this.proxy.$provideTextDocumentContent(this.uri.toString());\n            return content ?? '';\n        }\n    }\n\n    dispose(): void {\n        this.disposable.dispose();\n    }\n\n    setContent(content: string): void {\n        this.cache = content;\n        this.onDidChangeContentsEmitter.fire(undefined);\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nexport const pluginPathsServicePath = '/services/plugin-paths';\n\n// Service to create plugin configuration folders for different purpose.\nexport const PluginPathsService = Symbol('PluginPathsService');\nexport interface PluginPathsService {\n    /** Returns hosted log path. Create directory by this path if it is not exist on the file system. */\n    getHostLogPath(): Promise<string>;\n    /** Returns storage path for given workspace */\n    getHostStoragePath(workspaceUri: string | undefined, rootUris: string[]): Promise<string | undefined>;\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar Semaphore_1 = require(\"./Semaphore\");\nvar Mutex = /** @class */ (function () {\n    function Mutex(cancelError) {\n        this._semaphore = new Semaphore_1.default(1, cancelError);\n    }\n    Mutex.prototype.acquire = function () {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var _a, releaser;\n            return tslib_1.__generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, this._semaphore.acquire()];\n                    case 1:\n                        _a = _b.sent(), releaser = _a[1];\n                        return [2 /*return*/, releaser];\n                }\n            });\n        });\n    };\n    Mutex.prototype.runExclusive = function (callback) {\n        return this._semaphore.runExclusive(function () { return callback(); });\n    };\n    Mutex.prototype.isLocked = function () {\n        return this._semaphore.isLocked();\n    };\n    Mutex.prototype.waitForUnlock = function () {\n        return this._semaphore.waitForUnlock();\n    };\n    Mutex.prototype.release = function () {\n        if (this._semaphore.isLocked())\n            this._semaphore.release();\n    };\n    Mutex.prototype.cancel = function () {\n        return this._semaphore.cancel();\n    };\n    return Mutex;\n}());\nexports.default = Mutex;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar errors_1 = require(\"./errors\");\nvar Semaphore = /** @class */ (function () {\n    function Semaphore(_value, _cancelError) {\n        if (_cancelError === void 0) { _cancelError = errors_1.E_CANCELED; }\n        this._value = _value;\n        this._cancelError = _cancelError;\n        this._weightedQueues = [];\n        this._weightedWaiters = [];\n    }\n    Semaphore.prototype.acquire = function (weight) {\n        var _this = this;\n        if (weight === void 0) { weight = 1; }\n        if (weight <= 0)\n            throw new Error(\"invalid weight \".concat(weight, \": must be positive\"));\n        return new Promise(function (resolve, reject) {\n            if (!_this._weightedQueues[weight - 1])\n                _this._weightedQueues[weight - 1] = [];\n            _this._weightedQueues[weight - 1].push({ resolve: resolve, reject: reject });\n            _this._dispatch();\n        });\n    };\n    Semaphore.prototype.runExclusive = function (callback, weight) {\n        if (weight === void 0) { weight = 1; }\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var _a, value, release;\n            return tslib_1.__generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, this.acquire(weight)];\n                    case 1:\n                        _a = _b.sent(), value = _a[0], release = _a[1];\n                        _b.label = 2;\n                    case 2:\n                        _b.trys.push([2, , 4, 5]);\n                        return [4 /*yield*/, callback(value)];\n                    case 3: return [2 /*return*/, _b.sent()];\n                    case 4:\n                        release();\n                        return [7 /*endfinally*/];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Semaphore.prototype.waitForUnlock = function (weight) {\n        var _this = this;\n        if (weight === void 0) { weight = 1; }\n        if (weight <= 0)\n            throw new Error(\"invalid weight \".concat(weight, \": must be positive\"));\n        return new Promise(function (resolve) {\n            if (!_this._weightedWaiters[weight - 1])\n                _this._weightedWaiters[weight - 1] = [];\n            _this._weightedWaiters[weight - 1].push(resolve);\n            _this._dispatch();\n        });\n    };\n    Semaphore.prototype.isLocked = function () {\n        return this._value <= 0;\n    };\n    Semaphore.prototype.getValue = function () {\n        return this._value;\n    };\n    Semaphore.prototype.setValue = function (value) {\n        this._value = value;\n        this._dispatch();\n    };\n    Semaphore.prototype.release = function (weight) {\n        if (weight === void 0) { weight = 1; }\n        if (weight <= 0)\n            throw new Error(\"invalid weight \".concat(weight, \": must be positive\"));\n        this._value += weight;\n        this._dispatch();\n    };\n    Semaphore.prototype.cancel = function () {\n        var _this = this;\n        this._weightedQueues.forEach(function (queue) { return queue.forEach(function (entry) { return entry.reject(_this._cancelError); }); });\n        this._weightedQueues = [];\n    };\n    Semaphore.prototype._dispatch = function () {\n        var _a;\n        for (var weight = this._value; weight > 0; weight--) {\n            var queueEntry = (_a = this._weightedQueues[weight - 1]) === null || _a === void 0 ? void 0 : _a.shift();\n            if (!queueEntry)\n                continue;\n            var previousValue = this._value;\n            var previousWeight = weight;\n            this._value -= weight;\n            weight = this._value + 1;\n            queueEntry.resolve([previousValue, this._newReleaser(previousWeight)]);\n        }\n        this._drainUnlockWaiters();\n    };\n    Semaphore.prototype._newReleaser = function (weight) {\n        var _this = this;\n        var called = false;\n        return function () {\n            if (called)\n                return;\n            called = true;\n            _this.release(weight);\n        };\n    };\n    Semaphore.prototype._drainUnlockWaiters = function () {\n        for (var weight = this._value; weight > 0; weight--) {\n            if (!this._weightedWaiters[weight - 1])\n                continue;\n            this._weightedWaiters[weight - 1].forEach(function (waiter) { return waiter(); });\n            this._weightedWaiters[weight - 1] = [];\n        }\n    };\n    return Semaphore;\n}());\nexports.default = Semaphore;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.E_CANCELED = exports.E_ALREADY_LOCKED = exports.E_TIMEOUT = void 0;\nexports.E_TIMEOUT = new Error('timeout while waiting for mutex to become available');\nexports.E_ALREADY_LOCKED = new Error('mutex already locked');\nexports.E_CANCELED = new Error('request for lock canceled');\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.tryAcquire = exports.withTimeout = exports.Semaphore = exports.Mutex = void 0;\nvar tslib_1 = require(\"tslib\");\nvar Mutex_1 = require(\"./Mutex\");\nObject.defineProperty(exports, \"Mutex\", { enumerable: true, get: function () { return Mutex_1.default; } });\nvar Semaphore_1 = require(\"./Semaphore\");\nObject.defineProperty(exports, \"Semaphore\", { enumerable: true, get: function () { return Semaphore_1.default; } });\nvar withTimeout_1 = require(\"./withTimeout\");\nObject.defineProperty(exports, \"withTimeout\", { enumerable: true, get: function () { return withTimeout_1.withTimeout; } });\nvar tryAcquire_1 = require(\"./tryAcquire\");\nObject.defineProperty(exports, \"tryAcquire\", { enumerable: true, get: function () { return tryAcquire_1.tryAcquire; } });\ntslib_1.__exportStar(require(\"./errors\"), exports);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.tryAcquire = void 0;\nvar errors_1 = require(\"./errors\");\nvar withTimeout_1 = require(\"./withTimeout\");\n// eslint-disable-next-lisne @typescript-eslint/explicit-module-boundary-types\nfunction tryAcquire(sync, alreadyAcquiredError) {\n    if (alreadyAcquiredError === void 0) { alreadyAcquiredError = errors_1.E_ALREADY_LOCKED; }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return (0, withTimeout_1.withTimeout)(sync, 0, alreadyAcquiredError);\n}\nexports.tryAcquire = tryAcquire;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.withTimeout = void 0;\nvar tslib_1 = require(\"tslib\");\n/* eslint-disable @typescript-eslint/no-explicit-any */\nvar errors_1 = require(\"./errors\");\nfunction withTimeout(sync, timeout, timeoutError) {\n    var _this = this;\n    if (timeoutError === void 0) { timeoutError = errors_1.E_TIMEOUT; }\n    return {\n        acquire: function (weight) {\n            if (weight !== undefined && weight <= 0) {\n                throw new Error(\"invalid weight \".concat(weight, \": must be positive\"));\n            }\n            return new Promise(function (resolve, reject) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                var isTimeout, handle, ticket, release, e_1;\n                return tslib_1.__generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            isTimeout = false;\n                            handle = setTimeout(function () {\n                                isTimeout = true;\n                                reject(timeoutError);\n                            }, timeout);\n                            _a.label = 1;\n                        case 1:\n                            _a.trys.push([1, 3, , 4]);\n                            return [4 /*yield*/, sync.acquire(weight)];\n                        case 2:\n                            ticket = _a.sent();\n                            if (isTimeout) {\n                                release = Array.isArray(ticket) ? ticket[1] : ticket;\n                                release();\n                            }\n                            else {\n                                clearTimeout(handle);\n                                resolve(ticket);\n                            }\n                            return [3 /*break*/, 4];\n                        case 3:\n                            e_1 = _a.sent();\n                            if (!isTimeout) {\n                                clearTimeout(handle);\n                                reject(e_1);\n                            }\n                            return [3 /*break*/, 4];\n                        case 4: return [2 /*return*/];\n                    }\n                });\n            }); });\n        },\n        runExclusive: function (callback, weight) {\n            return tslib_1.__awaiter(this, void 0, void 0, function () {\n                var release, ticket;\n                return tslib_1.__generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            release = function () { return undefined; };\n                            _a.label = 1;\n                        case 1:\n                            _a.trys.push([1, , 7, 8]);\n                            return [4 /*yield*/, this.acquire(weight)];\n                        case 2:\n                            ticket = _a.sent();\n                            if (!Array.isArray(ticket)) return [3 /*break*/, 4];\n                            release = ticket[1];\n                            return [4 /*yield*/, callback(ticket[0])];\n                        case 3: return [2 /*return*/, _a.sent()];\n                        case 4:\n                            release = ticket;\n                            return [4 /*yield*/, callback()];\n                        case 5: return [2 /*return*/, _a.sent()];\n                        case 6: return [3 /*break*/, 8];\n                        case 7:\n                            release();\n                            return [7 /*endfinally*/];\n                        case 8: return [2 /*return*/];\n                    }\n                });\n            });\n        },\n        release: function (weight) {\n            sync.release(weight);\n        },\n        cancel: function () {\n            return sync.cancel();\n        },\n        waitForUnlock: function (weight) {\n            if (weight !== undefined && weight <= 0) {\n                throw new Error(\"invalid weight \".concat(weight, \": must be positive\"));\n            }\n            return new Promise(function (resolve, reject) {\n                sync.waitForUnlock(weight).then(resolve);\n                setTimeout(function () { return reject(timeoutError); }, timeout);\n            });\n        },\n        isLocked: function () { return sync.isLocked(); },\n        getValue: function () { return sync.getValue(); },\n        setValue: function (value) { return sync.setValue(value); },\n    };\n}\nexports.withTimeout = withTimeout;\n","// *****************************************************************************\n// Copyright (C) 2017 Ericsson and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nexport * from './task-service';\nexport * from './task-contribution';\nexport * from './task-definition-registry';\nexport * from './task-problem-matcher-registry';\nexport * from './task-problem-pattern-registry';\nexport * from './task-schema-updater';\n","import api from \"!../../../../../../../style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../../../../../css-loader/dist/cjs.js!./modal-notification.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};"],"names":[],"sourceRoot":""}